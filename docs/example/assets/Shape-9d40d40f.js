var Gf=Object.defineProperty;var Yf=(t,e,n)=>e in t?Gf(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var l=(t,e,n)=>(Yf(t,typeof e!="symbol"?e+"":e,n),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const c of o.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();const Qf=t=>typeof t=="function",u=function(t,e){if(typeof t=="function")return function(){return t(arguments)?e.apply(this,arguments):n=>e(n,...arguments)};switch(t){case 0:case 1:throw new RangeError(`Invalid arity ${t}`);case 2:return function(n,r){return arguments.length>=2?e(n,r):function(s){return e(s,n)}};case 3:return function(n,r,s){return arguments.length>=3?e(n,r,s):function(o){return e(o,n,r)}};case 4:return function(n,r,s,o){return arguments.length>=4?e(n,r,s,o):function(c){return e(c,n,r,s)}};case 5:return function(n,r,s,o,c){return arguments.length>=5?e(n,r,s,o,c):function(i){return e(i,n,r,s,o)}};default:return function(){if(arguments.length>=t)return e.apply(this,arguments);const n=arguments;return function(r){return e(r,...n)}}}},K=t=>t,Pn=t=>()=>t,ri=Pn(!0),Ks=Pn(!1),da=Pn(void 0),si=da;function f(t,e,n,r,s,o,c,i,a){switch(arguments.length){case 1:return t;case 2:return e(t);case 3:return n(e(t));case 4:return r(n(e(t)));case 5:return s(r(n(e(t))));case 6:return o(s(r(n(e(t)))));case 7:return c(o(s(r(n(e(t))))));case 8:return i(c(o(s(r(n(e(t)))))));case 9:return a(i(c(o(s(r(n(e(t))))))));default:{let h=arguments[0];for(let d=1;d<arguments.length;d++)h=arguments[d](h);return h}}}function Et(t,e,n,r,s,o,c,i,a){switch(arguments.length){case 1:return t;case 2:return function(){return e(t.apply(this,arguments))};case 3:return function(){return n(e(t.apply(this,arguments)))};case 4:return function(){return r(n(e(t.apply(this,arguments))))};case 5:return function(){return s(r(n(e(t.apply(this,arguments)))))};case 6:return function(){return o(s(r(n(e(t.apply(this,arguments))))))};case 7:return function(){return c(o(s(r(n(e(t.apply(this,arguments)))))))};case 8:return function(){return i(c(o(s(r(n(e(t.apply(this,arguments))))))))};case 9:return function(){return a(i(c(o(s(r(n(e(t.apply(this,arguments)))))))))}}}const Sr="2.0.0-next.55",Us=Symbol.for(`effect/GlobalValue/globalStoreId/${Sr}`);Us in globalThis||(globalThis[Us]=new Map);const Is=globalThis[Us],P=(t,e)=>(Is.has(t)||Is.set(t,e()),Is.get(t)),Xf=t=>typeof t=="string",ma=t=>typeof t=="number",Zf=t=>typeof t=="bigint",Uo=Qf,th=t=>typeof t=="object"&&t!==null,Bo=t=>th(t)||Uo(t),I=u(2,(t,e)=>Bo(t)&&e in t),ya=u(2,(t,e)=>I(t,"_tag")&&t._tag===e),Fe=t=>t==null,_a=t=>I(t,Symbol.iterator),eh=335903614,nh=4150755663,rh=1481765933>>>0,sh=1284865837>>>0,oh=9007199254740992,ch=134217728;class ba{constructor(e,n,r,s){l(this,"_state");return Fe(n)&&Fe(e)?(n=Math.random()*4294967295>>>0,e=0):Fe(n)&&(n=e,e=0),Fe(s)&&Fe(r)?(s=this._state?this._state[3]:nh,r=this._state?this._state[2]:eh):Fe(s)&&(s=r,r=0),this._state=new Int32Array([0,0,r>>>0,((s||0)|1)>>>0]),this._next(),oi(this._state,this._state[0],this._state[1],e>>>0,n>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(e){this._state[0]=e[0],this._state[1]=e[1],this._state[2]=e[2],this._state[3]=e[3]|1}integer(e){if(!e)return this._next();if(e=e>>>0,!(e&e-1))return this._next()&e-1;let n=0;const r=(-e>>>0)%e>>>0;for(n=this._next();n<r;n=this._next());return n%e}number(){const e=(this._next()&67108863)*1,n=(this._next()&134217727)*1;return(e*ch+n)/oh}_next(){const e=this._state[0]>>>0,n=this._state[1]>>>0;ih(this._state,e,n,rh,sh),oi(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let r=e>>>18,s=(n>>>18|e<<14)>>>0;r=(r^e)>>>0,s=(s^n)>>>0;const o=(s>>>27|r<<5)>>>0,c=e>>>27,i=(-c>>>0&31)>>>0;return(o>>>c|o<<i)>>>0}}function ih(t,e,n,r,s){let o=(n>>>16)*(s&65535)>>>0,c=(n&65535)*(s>>>16)>>>0,i=(n&65535)*(s&65535)>>>0,a=(n>>>16)*(s>>>16)+((c>>>16)+(o>>>16))>>>0;c=c<<16>>>0,i=i+c>>>0,i>>>0<c>>>0&&(a=a+1>>>0),o=o<<16>>>0,i=i+o>>>0,i>>>0<o>>>0&&(a=a+1>>>0),a=a+Math.imul(n,r)>>>0,a=a+Math.imul(e,s)>>>0,t[0]=a,t[1]=i}function oi(t,e,n,r,s){let o=e+r>>>0;const c=n+s>>>0;c>>>0<n>>>0&&(o=o+1|0),t[0]=o,t[1]=c}const Fs=P(Symbol.for("effect/Hash/randomHashCache"),()=>new WeakMap),ah=P(Symbol.for("effect/Hash/pcgr"),()=>new ba),R=Symbol.for("effect/Hash"),y=t=>{switch(typeof t){case"number":return zo(t);case"bigint":return ce(t.toString(10));case"boolean":return ce(String(t));case"symbol":return ce(String(t));case"string":return ce(t);case"undefined":return ce("undefined");case"function":case"object":return t===null?ce("null"):uh(t)?t[R]():Ln(t);default:throw new Error(`BUG: unhandled typeof ${typeof t} - please report an issue at https://github.com/Effect-TS/effect/issues`)}},Ln=t=>(Fs.has(t)||Fs.set(t,zo(ah.integer(Number.MAX_SAFE_INTEGER))),Fs.get(t)),E=t=>e=>e*53^t,Jr=t=>t&3221225471|t>>>1&1073741824,uh=t=>I(t,R),zo=t=>{if(t!==t||t===1/0)return 0;let e=t|0;for(e!==t&&(e^=t*4294967295);t>4294967295;)e^=t/=4294967295;return Jr(t)},ce=t=>{let e=5381,n=t.length;for(;n;)e=e*33^t.charCodeAt(--n);return Jr(e)},lh=(t,e)=>{let n=12289;for(let r=0;r<e.length;r++)n^=f(ce(e[r]),E(y(t[e[r]])));return Jr(n)},Sa=t=>lh(t,Object.keys(t)),Wo=t=>{let e=6151;for(let n=0;n<t.length;n++)e=f(e,E(y(t[n])));return Jr(e)},M=Symbol.for("effect/Equal");function O(){return arguments.length===1?t=>ci(t,arguments[0]):ci(arguments[0],arguments[1])}function ci(t,e){if(t===e)return!0;const n=typeof t;return n!==typeof e?!1:(n==="object"||n==="function")&&t!==null&&e!==null&&ii(t)&&ii(e)?y(t)===y(e)&&t[M](e):!1}const ii=t=>I(t,M),va=()=>(t,e)=>O(t,e),Jo=t=>(e,n)=>e===n||t(e,n),fh=u(2,(t,e)=>Jo((n,r)=>t(e(n),e(r)))),hh=t=>Jo((e,n)=>{if(e.length!==n.length)return!1;for(let r=0;r<e.length;r++)if(!t(e[r],n[r]))return!1;return!0}),V=Symbol.for("nodejs.util.inspect.custom"),z=t=>I(t,"toJSON")&&Uo(t.toJSON)&&t.toJSON.length===0?t.toJSON():Array.isArray(t)?t.map(z):t,H=t=>JSON.stringify(t,null,2),k=(t,e)=>{switch(e.length){case 1:return e[0](t);case 2:return e[1](e[0](t));case 3:return e[2](e[1](e[0](t)));case 4:return e[3](e[2](e[1](e[0](t))));case 5:return e[4](e[3](e[2](e[1](e[0](t)))));case 6:return e[5](e[4](e[3](e[2](e[1](e[0](t))))));case 7:return e[6](e[5](e[4](e[3](e[2](e[1](e[0](t)))))));case 8:return e[7](e[6](e[5](e[4](e[3](e[2](e[1](e[0](t))))))));case 9:return e[8](e[7](e[6](e[5](e[4](e[3](e[2](e[1](e[0](t)))))))));default:{let n=t;for(let r=0,s=e.length;r<s;r++)n=e[r](n);return n}}},gh={[R](){return Sa(this)},[M](t){const e=Object.keys(this),n=Object.keys(t);if(e.length!==n.length)return!1;for(const r of e)if(!(r in t&&O(this[r],t[r])))return!1;return!0}},Vo=function(){function t(e){e&&Object.assign(this,e)}return t.prototype=gh,t}(),hr="Async",wa="Commit",G="Failure",gr="OnFailure",vr="OnSuccess",wr="OnSuccessAndFailure",Y="Success",$a="Sync",ph="Tag",Ye="UpdateRuntimeFlags",$r="While",ka="WithRuntime",pr="Yield",Ho="RevertFlags",Ea=Symbol.for("effect/Effect"),dh=Symbol.for("effect/Stream"),mh=Symbol.for("effect/Sink"),yh=Symbol.for("effect/Channel"),Ae={_R:t=>t,_E:t=>t,_A:t=>t,_V:Sr},_h={_R:t=>t,_E:t=>t,_In:t=>t,_L:t=>t,_Z:t=>t},bh={_Env:t=>t,_InErr:t=>t,_InElem:t=>t,_InDone:t=>t,_OutErr:t=>t,_OutElem:t=>t,_OutDone:t=>t},Vr={[Ea]:Ae,[dh]:Ae,[mh]:_h,[yh]:bh,[M](t){return this===t},[R](){return Ln(this)},pipe(){return k(this,arguments)}},Sh={...Vr,_op:wa};({...Sh,...Vo.prototype});const Oa=Symbol.for("effect/Option"),Ia={...Vr,[Oa]:{_A:t=>t},[V](){return this.toJSON()},toString(){return H(this.toJSON())}},vh=Object.assign(Object.create(Ia),{_tag:"Some",_op:"Some",[M](t){return Fa(t)&&Ma(t)&&O(t.value,this.value)},[R](){return E(y(this._tag))(y(this.value))},toJSON(){return{_id:"Option",_tag:this._tag,value:z(this.value)}}}),wh=Object.assign(Object.create(Ia),{_tag:"None",_op:"None",[M](t){return Fa(t)&&Ra(t)},[R](){return E(y(this._tag))},toJSON(){return{_id:"Option",_tag:this._tag}}}),Fa=t=>I(t,Oa),Ra=t=>t._tag==="None",Ma=t=>t._tag==="Some",Ta=Object.create(wh),Ca=t=>{const e=Object.create(vh);return e.value=t,e},Na=Symbol.for("effect/Either"),Aa={...Vr,[Na]:{_A:t=>t},[V](){return this.toJSON()},toString(){return H(this.toJSON())}},$h=Object.assign(Object.create(Aa),{_tag:"Right",_op:"Right",[M](t){return Pa(t)&&xa(t)&&O(t.right,this.right)},[R](){return E(y(this._tag))(y(this.right))},toJSON(){return{_id:"Either",_tag:this._tag,right:z(this.right)}}}),kh=Object.assign(Object.create(Aa),{_tag:"Left",_op:"Left",[M](t){return Pa(t)&&La(t)&&O(t.left,this.left)},[R](){return E(y(this._tag))(y(this.left))},toJSON(){return{_id:"Either",_tag:this._tag,left:z(this.left)}}}),Pa=t=>I(t,Na),La=t=>t._tag==="Left",xa=t=>t._tag==="Right",Eh=t=>{const e=Object.create(kh);return e.left=t,e},Oh=t=>{const e=Object.create($h);return e.right=t,e},Da=t=>(e,n)=>e===n?0:t(e,n),Ih=Da((t,e)=>t<e?-1:1),Fh=u(2,(t,e)=>Da((n,r)=>t(e(n),e(r)))),Rh=t=>u(2,(e,n)=>t(e,n)===1),w=()=>Ta,v=Ca,U=Ra,A=Ma,jt=u(2,(t,{onNone:e,onSome:n})=>U(t)?e():n(t.value)),Nt=u(2,(t,e)=>U(t)?e():t.value),p$=u(2,(t,e)=>U(t)?e():t),xn=t=>t==null?w():v(t),ie=Nt(da),Mh=u(2,(t,e)=>{if(A(t))return t.value;throw e()}),Th=Mh(()=>new Error("getOrThrow called on a None")),bn=u(2,(t,e)=>U(t)?w():v(e(t.value))),qa=u(2,(t,e)=>U(t)?w():e(t.value)),Ch=t=>e=>t(e)?v(e):w(),Nh=t=>u(2,(e,n)=>U(e)?!1:t(e.value,n)),Ah=va(),Ph=Nh(Ah),Lh=t=>!t,pt=Oh,Ft=Eh,mn=La,yn=xa,xh=u(2,(t,{onLeft:e,onRight:n})=>mn(t)?e(t.left):n(t.right)),Dh=xh({onLeft:K,onRight:K}),qh=t=>t.length>0,Go=(t,e)=>{const n=Math.max(1,Math.floor(t)),r=[e(0)];for(let s=1;s<n;s++)r.push(e(s));return r},jh=(t,e)=>t<=e?Go(e-t+1,n=>t+n):[t],nt=t=>Array.isArray(t)?t:Array.from(t),Kh=u(2,(t,{onEmpty:e,onNonEmpty:n})=>xt(t)?n(t):e()),Lt=u(2,(t,e)=>[e,...t]),ja=u(2,(t,e)=>[...t,e]),Uh=t=>t.length===0,Yo=Uh,xt=qh,Ka=(t,e)=>t<0||t>=e.length,Bh=u(2,(t,e)=>{const n=Math.floor(e);return Ka(n,t)?w():v(t[n])}),Ua=u(2,(t,e)=>{const n=Math.floor(e);if(Ka(n,t))throw new Error(`Index ${n} out of bounds`);return t[n]}),Ba=Bh(0),Z=Ua(0),zh=t=>xt(t)?v(Wh(t)):w(),Wh=t=>t[t.length-1],ge=t=>t.slice(1),ai=t=>Array.from(t).reverse(),za=u(2,(t,e)=>{const n=Array.from(t);return n.sort(e),n}),ui=u(2,(t,e)=>Jh(t,e,(n,r)=>[n,r])),Jh=u(3,(t,e,n)=>{const r=nt(t),s=nt(e);return xt(r)&&xt(s)?Vh(s,n)(r):[]}),Vh=u(3,(t,e,n)=>{const r=[n(Z(t),Z(e))],s=Math.min(t.length,e.length);for(let o=1;o<s;o++)r[o]=n(t[o],e[o]);return r}),Hh=u(2,(t,e)=>{const n=[Z(t)],r=ge(t);for(const s of r)n.every(o=>!e(s,o))&&n.push(s);return n}),d$=u(2,(t,e)=>{const n=Array.from(t);return e>=1&&xt(n)?Yh(n,e):Yo(n)?[n,[]]:[[],n]}),Gh=t=>t.slice(),Yh=u(2,(t,e)=>{const n=Math.max(1,e);return n>=t.length?[Gh(t),[]]:[Lt(t.slice(1,n),Z(t)),t.slice(n)]}),wn=()=>[],kt=t=>[t],Ce=u(2,(t,e)=>t.map(e)),Qh=u(2,(t,e)=>{if(Yo(t))return[];const n=[];for(let r=0;r<t.length;r++)n.push(...e(t[r],r));return n}),Xh=Qh(K),Wa=u(2,(t,e)=>{const n=nt(t),r=[];for(let s=0;s<n.length;s++){const o=e(n[s],s);A(o)&&r.push(o.value)}return r}),Yt=u(3,(t,e,n)=>nt(t).reduce((r,s,o)=>n(r,s,o),e)),li=(t,e)=>{const n=[];let r=t,s;for(;A(s=e(r));){const[o,c]=s.value;n.push(o),r=c}return n},Zh=hh,tg=u(2,(t,e)=>{const n=nt(t);return xt(n)?Hh(e)(n):[]}),eg=tg(va()),Qe=u(2,(t,e)=>nt(t).join(e)),ng=u(3,(t,e,n)=>{let r=e;const s=[];for(const o of t){const c=n(r,o);r=c[0],s.push(c[1])}return[r,s]}),Ja=Symbol.for("effect/Context/Tag"),rg="effect/STM",sg=Symbol.for(rg),og={...Vr,_tag:"Tag",_op:"Tag",[sg]:Ae,[Ja]:{_S:t=>t,_I:t=>t},toString(){return H(this.toJSON())},toJSON(){return{_id:"Tag",identifier:this.identifier,stack:this.stack}},[V](){return this.toJSON()},of(t){return t},context(t){return Ga(this,t)}},Rs=P("effect/Context/Tag/tagRegistry",()=>new Map),cg=t=>{if(t&&Rs.has(t))return Rs.get(t);const e=Error.stackTraceLimit;Error.stackTraceLimit=2;const n=new Error;Error.stackTraceLimit=e;const r=Object.create(og);return Object.defineProperty(r,"stack",{get(){return n.stack}}),t&&(r.identifier=t,Rs.set(t,r)),r},Va=Symbol.for("effect/Context"),ig={[Va]:{_S:t=>t},[M](t){if(Ha(t)&&this.unsafeMap.size===t.unsafeMap.size){for(const e of this.unsafeMap.keys())if(!t.unsafeMap.has(e)||!O(this.unsafeMap.get(e),t.unsafeMap.get(e)))return!1;return!0}return!1},[R](){return zo(this.unsafeMap.size)},pipe(){return k(this,arguments)},toString(){return H(this.toJSON())},toJSON(){return{_id:"Context",services:Array.from(this.unsafeMap).map(z)}},[V](){return this.toJSON()}},Dt=t=>{const e=Object.create(ig);return e.unsafeMap=t,e},ag=t=>{const e=new Error(`Service not found${t.identifier?`: ${String(t.identifier)}`:""}`);if(t.stack){const n=t.stack.split(`
`);if(n.length>2){const r=n[2].match(/at (.*)/);r&&(e.message=e.message+` (defined at ${r[1]})`)}}if(e.stack){const n=e.stack.split(`
`);n.splice(1,3),e.stack=n.join(`
`)}return e},Ha=t=>I(t,Va),ug=t=>I(t,Ja),lg=Dt(new Map),fg=()=>lg,Ga=(t,e)=>Dt(new Map([[t,e]])),hg=u(3,(t,e,n)=>{const r=new Map(t.unsafeMap);return r.set(e,n),Dt(r)}),Ya=u(2,(t,e)=>{if(!t.unsafeMap.has(e))throw ag(e);return t.unsafeMap.get(e)}),gg=Ya,pg=u(2,(t,e)=>t.unsafeMap.has(e)?Ca(t.unsafeMap.get(e)):Ta),dg=u(2,(t,e)=>{const n=new Map(t.unsafeMap);for(const[r,s]of e.unsafeMap)n.set(r,s);return Dt(n)}),mg=(...t)=>e=>{const n=new Set(t),r=new Map;for(const[s,o]of e.unsafeMap.entries())n.has(s)&&r.set(s,o);return Dt(r)},yg=(...t)=>e=>{const n=new Map(e.unsafeMap);for(const r of t)n.delete(r);return Dt(n)},yt=cg,_g=Dt,Qa=Ha,Qo=ug,Hr=fg,Gr=Ga,Wt=hg,Ht=gg,Xo=Ya,$e=pg,Yr=dg,bg=mg,Sg=yg,vg=Object.freeze(Object.defineProperty({__proto__:null,Tag:yt,add:Wt,empty:Hr,get:Ht,getOption:$e,isContext:Qa,isTag:Qo,make:Gr,merge:Yr,omit:Sg,pick:bg,unsafeGet:Xo,unsafeMake:_g},Symbol.toStringTag,{value:"Module"})),Xa=Symbol.for("effect/Chunk");function wg(t,e,n,r,s){for(let o=e;o<Math.min(t.length,e+s);o++)n[r+o-e]=t[o];return n}const Za=[],$g=t=>Jo((e,n)=>e.length===n.length&&At(e).every((r,s)=>t(r,Gt(n,s)))),kg=$g(O),Eg={[Xa]:{_A:t=>t},toString(){return H(this.toJSON())},toJSON(){return{_id:"Chunk",values:At(this).map(z)}},[V](){return this.toJSON()},[M](t){return tu(t)&&kg(this,t)},[R](){return Wo(At(this))},[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return Za[Symbol.iterator]();default:return At(this)[Symbol.iterator]()}},pipe(){return k(this,arguments)}},B=t=>{const e=Object.create(Eg);switch(e.backing=t,t._tag){case"IEmpty":{e.length=0,e.depth=0,e.left=e,e.right=e;break}case"IConcat":{e.length=t.left.length+t.right.length,e.depth=1+Math.max(t.left.depth,t.right.depth),e.left=t.left,e.right=t.right;break}case"IArray":{e.length=t.array.length,e.depth=0,e.left=_t,e.right=_t;break}case"ISingleton":{e.length=1,e.depth=0,e.left=_t,e.right=_t;break}case"ISlice":{e.length=t.length,e.depth=t.chunk.depth+1,e.left=_t,e.right=_t;break}}return e},tu=t=>I(t,Xa),_t=B({_tag:"IEmpty"}),Rt=()=>_t,lt=t=>B({_tag:"ISingleton",a:t}),Dn=t=>tu(t)?t:B({_tag:"IArray",array:nt(t)}),Bs=(t,e,n)=>{switch(t.backing._tag){case"IArray":{wg(t.backing.array,0,e,n,t.length);break}case"IConcat":{Bs(t.left,e,n),Bs(t.right,e,n+t.left.length);break}case"ISingleton":{e[n]=t.backing.a;break}case"ISlice":{let r=0,s=n;for(;r<t.length;)e[s]=Gt(t,r),r+=1,s+=1;break}}},At=t=>{switch(t.backing._tag){case"IEmpty":return Za;case"IArray":return t.backing.array;default:{const e=new Array(t.length);return Bs(t,e,0),t.backing={_tag:"IArray",array:e},t.left=_t,t.right=_t,t.depth=0,e}}},Pe=t=>{switch(t.backing._tag){case"IEmpty":case"ISingleton":return t;case"IArray":return B({_tag:"IArray",array:ai(t.backing.array)});case"IConcat":return B({_tag:"IConcat",left:Pe(t.backing.right),right:Pe(t.backing.left)});case"ISlice":return St(ai(At(t)))}},eu=u(2,(t,e)=>e<0||e>=t.length?w():v(Gt(t,e))),St=t=>B({_tag:"IArray",array:t}),Gt=u(2,(t,e)=>{switch(t.backing._tag){case"IEmpty":throw new Error("Index out of bounds");case"ISingleton":{if(e!==0)throw new Error("Index out of bounds");return t.backing.a}case"IArray":{if(e>=t.length||e<0)throw new Error("Index out of bounds");return t.backing.array[e]}case"IConcat":return e<t.left.length?Gt(t.left,e):Gt(t.right,e-t.left.length);case"ISlice":return Gt(t.backing.chunk,e+t.backing.offset)}}),Og=u(2,(t,e)=>nu(t,lt(e))),mt=u(2,(t,e)=>nu(lt(e),t)),zs=u(2,(t,e)=>{if(e<=0)return _t;if(e>=t.length)return t;switch(t.backing._tag){case"ISlice":return B({_tag:"ISlice",chunk:t.backing.chunk,length:e,offset:t.backing.offset});case"IConcat":return e>t.left.length?B({_tag:"IConcat",left:t.left,right:zs(t.right,e-t.left.length)}):zs(t.left,e);default:return B({_tag:"ISlice",chunk:t,offset:0,length:e})}}),$n=u(2,(t,e)=>{if(e<=0)return t;if(e>=t.length)return _t;switch(t.backing._tag){case"ISlice":return B({_tag:"ISlice",chunk:t.backing.chunk,offset:t.backing.offset+e,length:t.backing.length-e});case"IConcat":return e>t.left.length?$n(t.right,e-t.left.length):B({_tag:"IConcat",left:$n(t.left,e),right:t.right});default:return B({_tag:"ISlice",chunk:t,offset:e,length:t.length-e})}}),Ct=u(2,(t,e)=>{if(t.backing._tag==="IEmpty")return e;if(e.backing._tag==="IEmpty")return t;const n=e.depth-t.depth;if(Math.abs(n)<=1)return B({_tag:"IConcat",left:t,right:e});if(n<-1)if(t.left.depth>=t.right.depth){const r=Ct(t.right,e);return B({_tag:"IConcat",left:t.left,right:r})}else{const r=Ct(t.right.right,e);if(r.depth===t.depth-3){const s=B({_tag:"IConcat",left:t.right.left,right:r});return B({_tag:"IConcat",left:t.left,right:s})}else{const s=B({_tag:"IConcat",left:t.left,right:t.right.left});return B({_tag:"IConcat",left:s,right:r})}}else if(e.right.depth>=e.left.depth){const r=Ct(t,e.left);return B({_tag:"IConcat",left:r,right:e.right})}else{const r=Ct(t,e.left.left);if(r.depth===e.depth-3){const s=B({_tag:"IConcat",left:r,right:e.left.right});return B({_tag:"IConcat",left:s,right:e.right})}else{const s=B({_tag:"IConcat",left:e.left.right,right:e.right});return B({_tag:"IConcat",left:r,right:s})}}}),nu=u(2,(t,e)=>Ct(t,e)),m$=u(2,(t,e)=>St(Wa(t,e))),y$=u(2,(t,e)=>St(Wa(t,Ch(e)))),Zo=t=>t.length===0,pe=t=>t.length>0,Ms=eu(0),kn=t=>Gt(t,0),de=kn,_$=t=>eu(t,t.length-1),Ig=t=>Gt(t,t.length-1),ru=u(2,(t,e)=>t.backing._tag==="ISingleton"?lt(e(t.backing.a,0)):St(f(At(t),Ce((n,r)=>e(n,r))))),b$=u(3,(t,e,n)=>{const[r,s]=ng(t,e,n);return[r,St(s)]}),S$=t=>t.length,Ws=u(2,(t,e)=>St(za(At(t),e))),Fg=u(2,(t,e)=>[zs(t,e),$n(t,e)]),Rg=u(2,(t,e)=>{let n=0;for(const r of At(t)){if(e(r))break;n++}return Fg(t,n)}),Jt=t=>$n(t,1),Mg=t=>St(eg(At(t))),Tg=u(2,(t,e)=>Dn(Go(t,e))),v$=(t,e)=>t<=e?Tg(e-t+1,n=>t+n):lt(t),w$=u(2,(t,e)=>nt(t).every(e)),$$=u(2,(t,e)=>nt(t).some(e)),k$=Yt,me=5,tc=Math.pow(2,me),Cg=tc-1,Ng=tc/2,Ag=tc/4;function Pg(t){return t-=t>>1&1431655765,t=(t&858993459)+(t>>2&858993459),t=t+(t>>4)&252645135,t+=t>>8,t+=t>>16,t&127}function Le(t,e){return e>>>t&Cg}function Te(t){return 1<<t}function su(t,e){return Pg(t&e-1)}class Lg{constructor(e,n){l(this,"value");l(this,"previous");this.value=e,this.previous=n}}function Ne(t,e,n,r){let s=r;if(!t){const o=r.length;s=new Array(o);for(let c=0;c<o;++c)s[c]=r[c]}return s[e]=n,s}function ou(t,e,n){const r=n.length-1;let s=0,o=0,c=n;if(t)s=o=e;else for(c=new Array(r);s<e;)c[o++]=n[s++];for(++s;s<=r;)c[o++]=n[s++];return t&&(c.length=r),c}function xg(t,e,n,r){const s=r.length;if(t){let a=s;for(;a>=e;)r[a--]=r[a];return r[e]=n,r}let o=0,c=0;const i=new Array(s+1);for(;o<e;)i[c++]=r[o++];for(i[e]=n;o<s;)i[++c]=r[o++];return i}class Qt{constructor(){l(this,"_tag","EmptyNode")}modify(e,n,r,s,o,c){const i=r(w());return U(i)?new Qt:(++c.value,new fe(e,s,o,i))}}function bt(t){return ya(t,"EmptyNode")}function Dg(t){return bt(t)||t._tag==="LeafNode"||t._tag==="CollisionNode"}function Qr(t,e){return bt(t)?!1:e===t.edit}class fe{constructor(e,n,r,s){l(this,"edit");l(this,"hash");l(this,"key");l(this,"value");l(this,"_tag","LeafNode");this.edit=e,this.hash=n,this.key=r,this.value=s}modify(e,n,r,s,o,c){if(O(o,this.key)){const a=r(this.value);return a===this.value?this:U(a)?(--c.value,new Qt):Qr(this,e)?(this.value=a,this):new fe(e,s,o,a)}const i=r(w());return U(i)?this:(++c.value,cu(e,n,this.hash,this,s,new fe(e,s,o,i)))}}class ec{constructor(e,n,r){l(this,"edit");l(this,"hash");l(this,"children");l(this,"_tag","CollisionNode");this.edit=e,this.hash=n,this.children=r}modify(e,n,r,s,o,c){if(s===this.hash){const a=Qr(this,e),h=this.updateCollisionList(a,e,this.hash,this.children,r,o,c);return h===this.children?this:h.length>1?new ec(e,this.hash,h):h[0]}const i=r(w());return U(i)?this:(++c.value,cu(e,n,this.hash,this,s,new fe(e,s,o,i)))}updateCollisionList(e,n,r,s,o,c,i){const a=s.length;for(let d=0;d<a;++d){const p=s[d];if("key"in p&&O(c,p.key)){const m=p.value,b=o(m);return b===m?s:U(b)?(--i.value,ou(e,d,s)):Ne(e,d,new fe(n,r,c,b),s)}}const h=o(w());return U(h)?s:(++i.value,Ne(e,a,new fe(n,r,c,h),s))}}class xe{constructor(e,n,r){l(this,"edit");l(this,"mask");l(this,"children");l(this,"_tag","IndexedNode");this.edit=e,this.mask=n,this.children=r}modify(e,n,r,s,o,c){const i=this.mask,a=this.children,h=Le(n,s),d=Te(h),p=su(i,d),m=i&d,b=Qr(this,e);if(!m){const $t=new Qt().modify(e,n+me,r,s,o,c);return $t?a.length>=Ng?jg(e,h,$t,i,a):new xe(e,i|d,xg(b,p,$t,a)):this}const S=a[p],L=S.modify(e,n+me,r,s,o,c);if(S===L)return this;let q=i,j;if(bt(L)){if(q&=~d,!q)return new Qt;if(a.length<=2&&Dg(a[p^1]))return a[p^1];j=ou(b,p,a)}else j=Ne(b,p,L,a);return b?(this.mask=q,this.children=j,this):new xe(e,q,j)}}class nc{constructor(e,n,r){l(this,"edit");l(this,"size");l(this,"children");l(this,"_tag","ArrayNode");this.edit=e,this.size=n,this.children=r}modify(e,n,r,s,o,c){let i=this.size;const a=this.children,h=Le(n,s),d=a[h],p=(d||new Qt).modify(e,n+me,r,s,o,c);if(d===p)return this;const m=Qr(this,e);let b;if(bt(d)&&!bt(p))++i,b=Ne(m,h,p,a);else if(!bt(d)&&bt(p)){if(--i,i<=Ag)return qg(e,i,h,a);b=Ne(m,h,new Qt,a)}else b=Ne(m,h,p,a);return m?(this.size=i,this.children=b,this):new nc(e,i,b)}}function qg(t,e,n,r){const s=new Array(e-1);let o=0,c=0;for(let i=0,a=r.length;i<a;++i)if(i!==n){const h=r[i];h&&!bt(h)&&(s[o++]=h,c|=1<<i)}return new xe(t,c,s)}function jg(t,e,n,r,s){const o=[];let c=r,i=0;for(let a=0;c;++a)c&1&&(o[a]=s[i++]),c>>>=1;return o[e]=n,new nc(t,i+1,o)}function Kg(t,e,n,r,s,o){if(n===s)return new ec(t,n,[o,r]);const c=Le(e,n),i=Le(e,s);if(c===i)return a=>new xe(t,Te(c)|Te(i),[a]);{const a=c<i?[r,o]:[o,r];return new xe(t,Te(c)|Te(i),a)}}function cu(t,e,n,r,s,o){let c,i=e;for(;;){const a=Kg(t,i,n,r,s,o);if(typeof a=="function")c=new Lg(a,c),i=i+me;else{let h=a;for(;c!=null;)h=c.value(h),c=c.previous;return h}}}const iu="effect/HashMap",Js=Symbol.for(iu),Ug={[Js]:Js,[Symbol.iterator](){return new Xr(this,(t,e)=>[t,e])},[R](){let t=y(iu);for(const e of this)t^=f(y(e[0]),E(y(e[1])));return t},[M](t){if(Wg(t)){if(t._size!==this._size)return!1;for(const e of this){const n=f(t,sc(e[0],y(e[0])));if(U(n))return!1;if(!O(e[1],n.value))return!1}return!0}return!1},toString(){return H(this.toJSON())},toJSON(){return{_id:"HashMap",values:Array.from(this).map(z)}},[V](){return this.toJSON()},pipe(){return k(this,arguments)}},rc=(t,e,n,r)=>{const s=Object.create(Ug);return s._editable=t,s._edit=e,s._root=n,s._size=r,s};class Xr{constructor(e,n){l(this,"map");l(this,"f");l(this,"v");this.map=e,this.f=n,this.v=au(this.map._root,this.f,void 0)}next(){if(U(this.v))return{done:!0,value:void 0};const e=this.v.value;return this.v=kr(e.cont),{done:!1,value:e.value}}[Symbol.iterator](){return new Xr(this.map,this.f)}}const kr=t=>t?uu(t[0],t[1],t[2],t[3],t[4]):w(),au=(t,e,n=void 0)=>{switch(t._tag){case"LeafNode":return A(t.value)?v({value:e(t.key,t.value.value),cont:n}):kr(n);case"CollisionNode":case"ArrayNode":case"IndexedNode":{const r=t.children;return uu(r.length,r,0,e,n)}default:return kr(n)}},uu=(t,e,n,r,s)=>{for(;n<t;){const o=e[n++];if(o&&!bt(o))return au(o,r,[t,e,n,r,s])}return kr(s)},Bg=rc(!1,0,new Qt,0),Zr=()=>Bg,zg=(...t)=>lu(t),lu=t=>{const e=hu(Zr());for(const n of t)En(e,n[0],n[1]);return Yg(e)},Wg=t=>I(t,Js),Jg=t=>t&&bt(t._root),Vg=u(2,(t,e)=>sc(t,e,y(e))),sc=u(3,(t,e,n)=>{let r=t._root,s=0;for(;;)switch(r._tag){case"LeafNode":return O(e,r.key)?r.value:w();case"CollisionNode":{if(n===r.hash){const o=r.children;for(let c=0,i=o.length;c<i;++c){const a=o[c];if("key"in a&&O(e,a.key))return a.value}}return w()}case"IndexedNode":{const o=Le(s,n),c=Te(o);if(r.mask&c){r=r.children[su(r.mask,c)],s+=me;break}return w()}case"ArrayNode":{if(r=r.children[Le(s,n)],r){s+=me;break}return w()}default:return w()}}),Hg=u(2,(t,e)=>A(sc(t,e,y(e)))),En=u(3,(t,e,n)=>gu(t,e,()=>v(n))),Gg=u(3,(t,e,n)=>t._editable?(t._root=e,t._size=n,t):e===t._root?t:rc(t._editable,t._edit,e,n)),fu=t=>new Xr(t,e=>e),Er=t=>t._size,hu=t=>rc(!0,t._edit+1,t._root,t._size),Yg=t=>(t._editable=!1,t),gu=u(3,(t,e,n)=>Qg(t,e,y(e),n)),Qg=u(4,(t,e,n,r)=>{const s={value:t._size},o=t._root.modify(t._editable?t._edit:NaN,0,r,n,e,s);return f(t,Gg(o,s.value))}),fi=u(2,(t,e)=>gu(t,e,w)),Xg=u(2,(t,e)=>ts(t,Zr(),(n,r,s)=>En(n,s,e(r,s)))),Zg=u(2,(t,e)=>ts(t,void 0,(n,r,s)=>e(r,s))),ts=u(3,(t,e,n)=>{const r=t._root;if(r._tag==="LeafNode")return A(r.value)?n(e,r.value.value,r.key):e;if(r._tag==="EmptyNode")return e;const s=[r.children];let o;for(;o=s.pop();)for(let c=0,i=o.length;c<i;){const a=o[c++];a&&!bt(a)&&(a._tag==="LeafNode"?A(a.value)&&(e=n(e,a.value.value,a.key)):s.push(a.children))}return e}),pu="effect/HashSet",Vs=Symbol.for(pu),tp={[Vs]:Vs,[Symbol.iterator](){return fu(this._keyMap)},[R](){return E(y(this._keyMap))(y(pu))},[M](t){return du(t)?Er(this._keyMap)===Er(t._keyMap)&&O(this._keyMap,t._keyMap):!1},toString(){return H(this.toJSON())},toJSON(){return{_id:"HashSet",values:Array.from(this).map(z)}},[V](){return this.toJSON()},pipe(){return k(this,arguments)}},es=t=>{const e=Object.create(tp);return e._keyMap=t,e},du=t=>I(t,Vs),ep=es(Zr()),ns=()=>ep,np=t=>{const e=oc(ns());for(const n of t)On(e,n);return cc(e)},rp=(...t)=>{const e=oc(ns());for(const n of t)On(e,n);return cc(e)},sp=u(2,(t,e)=>Hg(t._keyMap,e)),op=t=>Er(t._keyMap),oc=t=>es(hu(t._keyMap)),cc=t=>(t._keyMap._editable=!1,t),mu=u(2,(t,e)=>{const n=oc(t);return e(n),cc(n)}),On=u(2,(t,e)=>t._keyMap._editable?(En(e,!0)(t._keyMap),t):es(En(e,!0)(t._keyMap))),yu=u(2,(t,e)=>t._keyMap._editable?(fi(e)(t._keyMap),t):es(fi(e)(t._keyMap))),cp=u(2,(t,e)=>mu(t,n=>{for(const r of e)yu(n,r)})),ip=u(2,(t,e)=>mu(ns(),n=>{ap(t,r=>On(n,r));for(const r of e)On(n,r)})),ap=u(2,(t,e)=>Zg(t._keyMap,(n,r)=>e(r))),up=u(3,(t,e,n)=>ts(t._keyMap,e,(r,s,o)=>n(r,o))),lp=du,Mt=ns,ic=np,rs=rp,fp=sp,ac=op,Sn=On,_u=yu,hi=cp,Xt=ip,Or=up,gi=Symbol.for("effect/MutableRef"),hp={[gi]:gi,toString(){return H(this.toJSON())},toJSON(){return{_id:"MutableRef",current:z(this.current)}},[V](){return this.toJSON()},pipe(){return k(this,arguments)}},Xe=t=>{const e=Object.create(hp);return e.current=t,e},gp=u(3,(t,e,n)=>O(e,t.current)?(t.current=n,!0):!1),Kt=t=>t.current,pp=t=>yp(t,e=>e+1),ke=u(2,(t,e)=>(t.current=e,t)),dp=u(2,(t,e)=>(t.current=e,t.current)),mp=u(2,(t,e)=>ke(t,e(Kt(t)))),yp=u(2,(t,e)=>dp(t,e(Kt(t)))),ss="effect/FiberId",ye=Symbol.for(ss),In="None",Hs="Runtime",Gs="Composite";var Ew;let _p=class{constructor(){l(this,Ew,ye);l(this,"_tag",In)}[(Ew=ye,R)](){return f(y(ss),E(y(this._tag)))}[M](e){return uc(e)&&e._tag===In}toString(){return H(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag}}[V](){return this.toJSON()}};var Ow;class bp{constructor(e,n){l(this,"id");l(this,"startTimeMillis");l(this,Ow,ye);l(this,"_tag",Hs);this.id=e,this.startTimeMillis=n}[(Ow=ye,R)](){return f(y(ss),E(y(this._tag)),E(y(this.id)),E(y(this.startTimeMillis)))}[M](e){return uc(e)&&e._tag===Hs&&this.id===e.id&&this.startTimeMillis===e.startTimeMillis}toString(){return H(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,id:this.id,startTimeMillis:this.startTimeMillis}}[V](){return this.toJSON()}}var Iw;class Sp{constructor(e,n){l(this,"left");l(this,"right");l(this,Iw,ye);l(this,"_tag",Gs);this.left=e,this.right=n}[(Iw=ye,R)](){return f(y(ss),E(y(this._tag)),E(y(this.left)),E(y(this.right)))}[M](e){return uc(e)&&e._tag===Gs&&O(this.left,e.left)&&O(this.right,e.right)}toString(){return H(this.toJSON())}toJSON(){return{_id:"FiberId",_tag:this._tag,left:z(this.left),right:z(this.right)}}[V](){return this.toJSON()}}const vp=new _p,uc=t=>I(t,ye),wp=u(2,(t,e)=>t._tag===In?e:e._tag===In?t:new Sp(t,e)),Ys=t=>{switch(t._tag){case In:return Mt();case Hs:return rs(t.id);case Gs:return f(Ys(t.left),Xt(Ys(t.right)))}},pi=P(Symbol.for("effect/Fiber/Id/_fiberCounter"),()=>Xe(0)),bu=t=>Array.from(Ys(t)).map(n=>`#${n}`).join(","),$p=()=>{const t=Kt(pi);return f(pi,ke(t+1)),new bp(t,new Date().getTime())},qn=vp,kp=wp,Ep=bu,Su=$p,os=Zr,Op=zg,vu=lu,Ip=Jg,lc=Vg,fc=En,wu=fu,Fp=Er,$u=Xg,ku=ts,Fn=Symbol.for("effect/List"),Ir=t=>Array.from(t),Rp=t=>fh(Zh(t),Ir),Mp=Rp(O),Tp={[Fn]:Fn,_tag:"Cons",toString(){return H(this.toJSON())},toJSON(){return{_id:"List",_tag:"Cons",values:Ir(this).map(z)}},[V](){return this.toJSON()},[M](t){return Ou(t)&&this._tag===t._tag&&Mp(this,t)},[R](){return Wo(Ir(this))},[Symbol.iterator](){let t=!1,e=this;return{next(){if(t)return this.return();if(e._tag==="Nil")return t=!0,this.return();const n=e.head;return e=e.tail,{done:t,value:n}},return(n){return t||(t=!0),{done:!0,value:n}}}},pipe(){return k(this,arguments)}},Fr=(t,e)=>{const n=Object.create(Tp);return n.head=t,n.tail=e,n},Cp={[Fn]:Fn,_tag:"Nil",toString(){return H(this.toJSON())},toJSON(){return{_id:"List",_tag:"Nil"}},[V](){return this.toJSON()},[R](){return Wo(Ir(this))},[M](t){return Ou(t)&&this._tag===t._tag},[Symbol.iterator](){return{next(){return{done:!0,value:void 0}}}},pipe(){return k(this,arguments)}},Eu=Object.create(Cp),Ou=t=>I(t,Fn),Pt=t=>t._tag==="Nil",Iu=t=>t._tag==="Cons",Np=()=>Eu,_e=(t,e)=>Fr(t,e),be=Np,hc=t=>Fr(t,Eu),Ap=u(2,(t,e)=>Pp(e,t)),Fu=u(2,(t,e)=>_e(e,t)),Pp=u(2,(t,e)=>{if(Pt(t))return e;if(Pt(e))return t;{const n=Fr(e.head,t);let r=n,s=e.tail;for(;!Pt(s);){const o=Fr(s.head,t);r.tail=o,r=o,s=s.tail}return n}}),Lp=u(3,(t,e,n)=>{let r=e,s=t;for(;!Pt(s);)r=n(r,s.head),s=s.tail;return r}),xp=t=>{let e=be(),n=t;for(;!Pt(n);)e=Fu(e,n.head),n=n.tail;return e},Dp=Symbol.for("effect/DifferContextPatch");function di(t){return t}const jn={...Vo.prototype,[Dp]:{_Value:di,_Patch:di}},qp=Object.assign(Object.create(jn),{_tag:"Empty"}),jp=Object.create(qp),Ru=()=>jp,Kp=Object.assign(Object.create(jn),{_tag:"AndThen"}),Up=(t,e)=>{const n=Object.create(Kp);return n.first=t,n.second=e,n},Bp=Object.assign(Object.create(jn),{_tag:"AddService"}),zp=(t,e)=>{const n=Object.create(Bp);return n.tag=t,n.service=e,n},Wp=Object.assign(Object.create(jn),{_tag:"RemoveService"}),Jp=t=>{const e=Object.create(Wp);return e.tag=t,e},Vp=Object.assign(Object.create(jn),{_tag:"UpdateService"}),Hp=(t,e)=>{const n=Object.create(Vp);return n.tag=t,n.update=e,n},Gp=(t,e)=>{const n=new Map(t.unsafeMap);let r=Ru();for(const[s,o]of e.unsafeMap.entries())if(n.has(s)){const c=n.get(s);n.delete(s),O(c,o)||(r=dr(Hp(s,()=>o))(r))}else n.delete(s),r=dr(zp(s,o))(r);for(const[s]of n.entries())r=dr(Jp(s))(r);return r},dr=u(2,(t,e)=>Up(t,e)),Yp=u(2,(t,e)=>{let n=!1,r=lt(t);const s=new Map(e.unsafeMap);for(;pe(r);){const c=de(r),i=Jt(r);switch(c._tag){case"Empty":{r=i;break}case"AddService":{s.set(c.tag,c.service),r=i;break}case"AndThen":{r=mt(mt(i,c.second),c.first);break}case"RemoveService":{s.delete(c.tag),r=i;break}case"UpdateService":{s.set(c.tag,c.update(s.get(c.tag))),n=!0,r=i;break}}}if(!n)return Dt(s);const o=new Map;for(const[c]of e.unsafeMap)s.has(c)&&(o.set(c,s.get(c)),s.delete(c));for(const[c,i]of s)o.set(c,i);return Dt(o)}),Qp=Symbol.for("effect/DifferHashSetPatch");function Ts(t){return t}const cs={...Vo.prototype,[Qp]:{_Value:Ts,_Key:Ts,_Patch:Ts}},Xp=Object.assign(Object.create(cs),{_tag:"Empty"}),Zp=Object.create(Xp),Mu=()=>Zp,td=Object.assign(Object.create(cs),{_tag:"AndThen"}),ed=(t,e)=>{const n=Object.create(td);return n.first=t,n.second=e,n},nd=Object.assign(Object.create(cs),{_tag:"Add"}),rd=t=>{const e=Object.create(nd);return e.value=t,e},sd=Object.assign(Object.create(cs),{_tag:"Remove"}),od=t=>{const e=Object.create(sd);return e.value=t,e},cd=(t,e)=>{const[n,r]=Or([t,Mu()],([s,o],c)=>fp(c)(s)?[_u(c)(s),o]:[s,Qs(rd(c))(o)])(e);return Or(r,(s,o)=>Qs(od(o))(s))(n)},Qs=u(2,(t,e)=>ed(t,e)),id=u(2,(t,e)=>{let n=e,r=lt(t);for(;pe(r);){const s=de(r),o=Jt(r);switch(s._tag){case"Empty":{r=o;break}case"AndThen":{r=mt(s.first)(mt(s.second)(o));break}case"Add":{n=Sn(s.value)(n),r=o;break}case"Remove":n=_u(s.value)(n),r=o}}return n}),ad=Symbol.for("effect/Differ"),ud={[ad]:{_P:K,_V:K}},Kn=t=>{const e=Object.create(ud);return e.empty=t.empty,e.diff=t.diff,e.combine=t.combine,e.patch=t.patch,e},ld=()=>Kn({empty:Ru(),combine:(t,e)=>dr(e)(t),diff:(t,e)=>Gp(t,e),patch:(t,e)=>Yp(e)(t)}),fd=()=>Kn({empty:Mu(),combine:(t,e)=>Qs(e)(t),diff:(t,e)=>cd(t,e),patch:(t,e)=>id(e)(t)}),hd=()=>gd((t,e)=>e),gd=t=>Kn({empty:K,combine:(e,n)=>e===K?n:n===K?e:r=>n(e(r)),diff:(e,n)=>O(e,n)?K:Pn(n),patch:(e,n)=>t(n,e(n))}),Rn=255,Tu=8,Xs=t=>t&Rn,Zs=t=>t>>Tu&Rn,Un=(t,e)=>(t&Rn)+((e&t&Rn)<<Tu),pd=Un(0,0),dd=t=>Un(t,t),md=t=>Un(t,0),yd=u(2,(t,e)=>Un(Xs(t)&~e,Zs(t))),_d=u(2,(t,e)=>t|e),bd=t=>~t>>>0&Rn,Sd=0,Ze=1<<0,vd=1<<1,Cu=1<<2,to=1<<4,Nu=1<<5,wd=t=>is(t,Nu),$d=u(2,(t,e)=>t|e),zt=t=>Au(t)&&!Ed(t),Au=t=>is(t,Ze),is=u(2,(t,e)=>(t&e)!==0),Pu=(...t)=>t.reduce((e,n)=>e|n,0),kd=Pu(Sd),Cs=t=>is(t,Cu),Ed=t=>is(t,to),De=u(2,(t,e)=>Un(t^e,e)),eo=u(2,(t,e)=>t&(bd(Xs(e))|Zs(e))|Xs(e)&Zs(e)),mi=Kn({empty:pd,diff:(t,e)=>De(t,e),combine:(t,e)=>_d(e)(t),patch:(t,e)=>eo(e,t)}),Od=dd,Lu=md,yi=yd,qe=(t,e)=>({_tag:"Par",left:t,right:e}),ar=(t,e)=>({_tag:"Seq",left:t,right:e}),Id=t=>{let e=hc(t),n=be();for(;;){const[r,s]=Lp(e,[xu(),be()],([o,c],i)=>{const[a,h]=Fd(i);return[Du(o,a),Ap(c,h)]});if(n=Rd(n,r),Pt(s))return xp(n);e=s}throw new Error("BUG: BlockedRequests.flatten - please report an issue at https://github.com/Effect-TS/effect/issues")},Fd=t=>{let e=t,n=xu(),r=be(),s=be();for(;;)switch(e._tag){case"Empty":{if(Pt(r))return[n,s];e=r.head,r=r.tail;break}case"Par":{r=_e(e.right,r),e=e.left;break}case"Seq":{const o=e.left,c=e.right;switch(o._tag){case"Empty":{e=c;break}case"Par":{const i=o.left,a=o.right;e=qe(ar(i,c),ar(a,c));break}case"Seq":{const i=o.left,a=o.right;e=ar(i,ar(a,c));break}case"Single":{e=o,s=_e(c,s);break}}break}case"Single":{if(n=Du(n,Cd(e.dataSource,e.blockedRequest)),Pt(r))return[n,s];e=r.head,r=r.tail;break}}throw new Error("BUG: BlockedRequests.step - please report an issue at https://github.com/Effect-TS/effect/issues")},Rd=(t,e)=>{if(Pt(t))return hc(Ns(e));if(Nd(e))return t;const n=qd(t.head),r=Ad(e);return n.length===1&&r.length===1&&O(n[0],r[0])?_e(Dd(t.head,Ns(e)),t.tail):_e(Ns(e),t)},Md=Symbol.for("effect/RequestBlock/RequestBlockParallel"),Td={_R:t=>t};var Fw;class gc{constructor(e){l(this,"map");l(this,Fw,Td);this.map=e}}Fw=Md;const xu=()=>new gc(os()),Cd=(t,e)=>new gc(Op([t,Array.of(e)])),Du=(t,e)=>new gc(ku(t.map,e.map,(n,r,s)=>fc(n,s,jt(lc(n,s),{onNone:()=>r,onSome:o=>[...o,...r]})))),Nd=t=>Ip(t.map),Ad=t=>Array.from(wu(t.map)),Ns=t=>xd($u(t.map,e=>Array.of(e))),Pd=Symbol.for("effect/RequestBlock/RequestBlockSequential"),Ld={_R:t=>t};var Rw;class qu{constructor(e){l(this,"map");l(this,Rw,Ld);this.map=e}}Rw=Pd;const xd=t=>new qu(t),Dd=(t,e)=>new qu(ku(e.map,t.map,(n,r,s)=>fc(n,s,jt(lc(n,s),{onNone:()=>[],onSome:o=>[...o,...r]})))),qd=t=>Array.from(wu(t.map)),jd=t=>Array.from(t.map),tn="Die",je="Empty",en="Fail",nn="Interrupt",Ke="Parallel",Ue="Sequential",ju="effect/Cause",Ku=Symbol.for(ju),Kd={_E:t=>t},rn={[Ku]:Kd,[R](){return f(y(ju),E(y(em(this))))},[M](t){return Uu(t)&&tm(this,t)},pipe(){return k(this,arguments)},toJSON(){switch(this._tag){case"Empty":return{_id:"Cause",_tag:this._tag};case"Die":return{_id:"Cause",_tag:this._tag,defect:z(this.defect)};case"Interrupt":return{_id:"Cause",_tag:this._tag,fiberId:this.fiberId.toJSON()};case"Fail":return{_id:"Cause",_tag:this._tag,failure:z(this.error)};case"Sequential":case"Parallel":return{_id:"Cause",_tag:this._tag,left:z(this.left),right:z(this.right)}}},toString(){return us(this)},[V](){return this.toJSON()}},Zt=(()=>{const t=Object.create(rn);return t._tag=je,t})(),Se=t=>{const e=Object.create(rn);return e._tag=en,e.error=t,e},ct=t=>{const e=Object.create(rn);return e._tag=tn,e.defect=t,e},It=t=>{const e=Object.create(rn);return e._tag=nn,e.fiberId=t,e},ft=(t,e)=>{const n=Object.create(rn);return n._tag=Ke,n.left=t,n.right=e,n},tt=(t,e)=>{const n=Object.create(rn);return n._tag=Ue,n.left=t,n.right=e,n},Uu=t=>I(t,Ku),Ud=t=>t._tag===tn,Bd=t=>t._tag===je?!0:Be(t,!0,(e,n)=>{switch(n._tag){case je:return v(e);case tn:case en:case nn:return v(!1);default:return w()}}),zd=t=>A(Gd(t)),as=t=>pc(void 0,rm)(t),Wd=t=>Pe(Be(t,Rt(),(e,n)=>n._tag===en?v(f(e,mt(n.error))):w())),Bu=t=>Pe(Be(t,Rt(),(e,n)=>n._tag===tn?v(f(e,mt(n.defect))):w())),Jd=t=>Be(t,Mt(),(e,n)=>n._tag===nn?v(f(e,Sn(n.fiberId))):w()),Vd=t=>Wu(t,e=>e._tag===en?v(e.error):w()),zu=t=>{const e=Vd(t);switch(e._tag){case"None":return pt(t);case"Some":return Ft(e.value)}},Hd=t=>Bn(t,{onEmpty:v(Zt),onFail:e=>f(e,bn(Se)),onDie:e=>v(ct(e)),onInterrupt:e=>v(It(e)),onSequential:(e,n)=>A(e)&&A(n)?v(tt(e.value,n.value)):U(e)&&A(n)?v(n.value):A(e)&&U(n)?v(e.value):w(),onParallel:(e,n)=>A(e)&&A(n)?v(ft(e.value,n.value)):U(e)&&A(n)?v(n.value):A(e)&&U(n)?v(e.value):w()}),Gd=t=>Wu(t,e=>e._tag===nn?v(e.fiberId):w()),Yd=t=>Bn(t,{onEmpty:w(),onFail:e=>v(ct(e)),onDie:e=>v(ct(e)),onInterrupt:()=>w(),onSequential:(e,n)=>A(e)&&A(n)?v(tt(e.value,n.value)):A(e)&&U(n)?v(e.value):U(e)&&A(n)?v(n.value):w(),onParallel:(e,n)=>A(e)&&A(n)?v(ft(e.value,n.value)):A(e)&&U(n)?v(e.value):U(e)&&A(n)?v(n.value):w()}),Rr=t=>Bn(t,{onEmpty:Zt,onFail:()=>Zt,onDie:e=>ct(e),onInterrupt:e=>It(e),onSequential:tt,onParallel:ft}),Qd=t=>Bn(t,{onEmpty:Zt,onFail:e=>ct(e),onDie:e=>ct(e),onInterrupt:e=>It(e),onSequential:(e,n)=>tt(e,n),onParallel:(e,n)=>ft(e,n)}),Xd=u(2,(t,e)=>Zd(t,n=>Se(e(n)))),Zd=u(2,(t,e)=>Bn(t,{onEmpty:Zt,onFail:n=>e(n),onDie:n=>ct(n),onInterrupt:n=>It(n),onSequential:(n,r)=>tt(n,r),onParallel:(n,r)=>ft(n,r)})),tm=(t,e)=>{let n=lt(t),r=lt(e);for(;pe(n)&&pe(r);){const[s,o]=f(de(n),Be([Mt(),Rt()],([a,h],d)=>{const[p,m]=no(d);return v([f(a,Xt(p)),f(h,Ct(m))])})),[c,i]=f(de(r),Be([Mt(),Rt()],([a,h],d)=>{const[p,m]=no(d);return v([f(a,Xt(p)),f(h,Ct(m))])}));if(!O(s,c))return!1;n=o,r=i}return!0},em=t=>nm(lt(t),Rt()),nm=(t,e)=>{for(;;){const[n,r]=f(t,Yt([Mt(),Rt()],([o,c],i)=>{const[a,h]=no(i);return[f(o,Xt(a)),f(c,Ct(h))]})),s=ac(n)>0?f(e,mt(n)):e;if(Zo(r))return Pe(s);t=r,e=s}throw new Error("BUG: Cause.flattenCauseLoop - please report an issue at https://github.com/Effect-TS/effect/issues")},Wu=u(2,(t,e)=>{const n=[t];for(;n.length>0;){const r=n.pop(),s=e(r);switch(s._tag){case"None":{switch(r._tag){case Ue:case Ke:{n.push(r.right),n.push(r.left);break}}break}case"Some":return s}}return w()}),no=t=>{let e=t;const n=[];let r=Mt(),s=Rt();for(;e!==void 0;)switch(e._tag){case je:{if(n.length===0)return[r,s];e=n.pop();break}case en:{if(r=Sn(r,e.error),n.length===0)return[r,s];e=n.pop();break}case tn:{if(r=Sn(r,e.defect),n.length===0)return[r,s];e=n.pop();break}case nn:{if(r=Sn(r,e.fiberId),n.length===0)return[r,s];e=n.pop();break}case Ue:{switch(e.left._tag){case je:{e=e.right;break}case Ue:{e=tt(e.left.left,tt(e.left.right,e.right));break}case Ke:{e=ft(tt(e.left.left,e.right),tt(e.left.right,e.right));break}default:{s=mt(s,e.right),e=e.left;break}}break}case Ke:{n.push(e.right),e=e.left;break}}throw new Error("BUG: Cause.evaluateCauseLoop - please report an issue at https://github.com/Effect-TS/effect/issues")},rm={emptyCase:ri,failCase:Ks,dieCase:Ks,interruptCase:ri,sequentialCase:(t,e,n)=>e&&n,parallelCase:(t,e,n)=>e&&n},_i="SequentialCase",bi="ParallelCase",Bn=u(2,(t,{onDie:e,onEmpty:n,onFail:r,onInterrupt:s,onParallel:o,onSequential:c})=>pc(t,void 0,{emptyCase:()=>n,failCase:(i,a)=>r(a),dieCase:(i,a)=>e(a),interruptCase:(i,a)=>s(a),sequentialCase:(i,a,h)=>c(a,h),parallelCase:(i,a,h)=>o(a,h)})),Be=u(3,(t,e,n)=>{let r=e,s=t;const o=[];for(;s!==void 0;){const c=n(r,s);switch(r=A(c)?c.value:r,s._tag){case Ue:{o.push(s.right),s=s.left;break}case Ke:{o.push(s.right),s=s.left;break}default:{s=void 0;break}}s===void 0&&o.length>0&&(s=o.pop())}return r}),pc=u(3,(t,e,n)=>{const r=[t],s=[];for(;r.length>0;){const c=r.pop();switch(c._tag){case je:{s.push(pt(n.emptyCase(e)));break}case en:{s.push(pt(n.failCase(e,c.error)));break}case tn:{s.push(pt(n.dieCase(e,c.defect)));break}case nn:{s.push(pt(n.interruptCase(e,c.fiberId)));break}case Ue:{r.push(c.right),r.push(c.left),s.push(Ft({_tag:_i}));break}case Ke:{r.push(c.right),r.push(c.left),s.push(Ft({_tag:bi}));break}}}const o=[];for(;s.length>0;){const c=s.pop();switch(c._tag){case"Left":{switch(c.left._tag){case _i:{const i=o.pop(),a=o.pop(),h=n.sequentialCase(e,i,a);o.push(h);break}case bi:{const i=o.pop(),a=o.pop(),h=n.parallelCase(e,i,a);o.push(h);break}}break}case"Right":{o.push(c.right);break}}}if(o.length===0)throw new Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/effect/issues");return o.pop()}),dc=(t,e)=>{const n={value:e,enumerable:!0},r={...t,toString(){return`${this._tag}: ${this.message}`}};return s=>{const o={_tag:n};return Xf(s)&&(o.message={value:s,enumerable:!0}),Object.create(r,o)}},Si=Symbol.for("effect/Cause/errors/RuntimeException"),sm=dc({[Si]:Si},"RuntimeException"),om=Symbol.for("effect/Cause/errors/InterruptedException"),cm=t=>I(t,om),vi=Symbol.for("effect/Cause/errors/IllegalArgument"),Ju=dc({[vi]:vi},"IllegalArgumentException"),wi=Symbol.for("effect/Cause/errors/NoSuchElement"),mc=dc({[wi]:wi},"NoSuchElementException"),im=t=>{const e=t.split(`
`),n=[];for(let r=0;r<e.length;r++){if(e[r].includes("EffectPrimitive")||e[r].includes("Generator.next")||e[r].includes("FiberRuntime"))return n.join(`
`);n.push(e[r])}return n.join(`
`)},us=t=>as(t)?"All fibers interrupted without errors.":Vu(t).map(n=>{let r=n.message;if(n.stack&&(r+=`\r
${im(n.stack)}`),n.span){let s=n.span,o=0;for(;s&&s._tag==="Span"&&o<10;)r+=`\r
    at ${s.name}`,s=ie(s.parent),o++}return r}).join(`\r
`);class $i{constructor(e,n,r){l(this,"message");l(this,"stack");l(this,"span");this.message=e,this.stack=n,this.span=r}toJSON(){const e={message:this.message};return this.stack&&(e.stack=this.stack),this.span&&(e.span=this.span),e}}const ki=t=>typeof t=="string"?`Error: ${t}`:I(t,"toString")&&Uo(t.toString)&&t.toString!==Object.prototype.toString?t.toString():`Error: ${JSON.stringify(t)}`,Ei=Symbol.for("effect/SpanAnnotation"),Oi=t=>{const e=I(t,Ei)&&t[Ei];return t instanceof Error?new $i(ki(t),t.stack?.split(`
`).filter(n=>n.match(/at (.*)/)).join(`
`),e):new $i(ki(t),void 0,e)},Vu=t=>pc(t,void 0,{emptyCase:()=>[],dieCase:(e,n)=>[Oi(n)],failCase:(e,n)=>[Oi(n)],interruptCase:()=>[],parallelCase:(e,n,r)=>[...n,...r],sequentialCase:(e,n,r)=>[...n,...r]}),zn="Pending",ls="Done",am="effect/Deferred",um=Symbol.for(am),lm={_E:t=>t,_A:t=>t},yc=t=>({_tag:zn,joiners:t}),Hu=t=>({_tag:ls,effect:t}),Ii=Symbol.for("effect/Tracer"),fm=t=>({[Ii]:Ii,...t}),ro=yt(Symbol.for("effect/Tracer")),Gu=yt(Symbol.for("effect/ParentSpan")),hm=P("effect/Tracer/SpanId.ids",()=>Xe(0));class gm{constructor(e,n,r,s,o){l(this,"name");l(this,"parent");l(this,"context");l(this,"links");l(this,"startTime");l(this,"_tag","Span");l(this,"spanId");l(this,"traceId","native");l(this,"sampled",!0);l(this,"status");l(this,"attributes");l(this,"events",[]);l(this,"end",(e,n)=>{this.status={_tag:"Ended",endTime:e,exit:n,startTime:this.status.startTime}});l(this,"attribute",(e,n)=>{this.attributes.set(e,n)});l(this,"event",(e,n,r)=>{this.events.push([e,n,r??{}])});this.name=e,this.parent=n,this.context=r,this.links=s,this.startTime=o,this.status={_tag:"Started",startTime:o},this.attributes=new Map,this.spanId=`span${pp(hm)}`}}const pm=fm({span:(t,e,n,r,s)=>new gm(t,e,n,r,s),context:t=>t()}),dm="effect/EffectError",so=Symbol.for(dm),mm=t=>I(t,so),ym=t=>({[so]:so,_tag:"EffectError",cause:t}),ot=(t,e)=>{const n=new st("Blocked");return n.i0=t,n.i1=e,n},_m=t=>{const e=new st("RunBlocked");return e.i0=t,e},fs=Symbol.for("effect/Effect");class bm{constructor(e,n){l(this,"patch");l(this,"op");l(this,"_op",Ho);this.patch=e,this.op=n}}var Mw;class st{constructor(e){l(this,"_op");l(this,"i0");l(this,"i1");l(this,"i2");l(this,"trace");l(this,Mw,Ae);this._op=e}[(Mw=fs,M)](e){return this===e}[R](){return Ln(this)}pipe(){return k(this,arguments)}toJSON(){return{_id:"Effect",_op:this._op,i0:z(this.i0),i1:z(this.i1),i2:z(this.i2)}}toString(){return H(this.toJSON())}[V](){return this.toJSON()}}var Tw;class Yu{constructor(e){l(this,"_op");l(this,"i0");l(this,"i1");l(this,"i2");l(this,"trace");l(this,Tw,Ae);this._op=e,this._tag=e}[(Tw=fs,M)](e){return this===e}[R](){return Ln(this)}get cause(){return this.i0}pipe(){return k(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,cause:this.cause.toJSON()}}toString(){return H(this.toJSON())}[V](){return this.toJSON()}}var Cw;class Qu{constructor(e){l(this,"_op");l(this,"i0");l(this,"i1");l(this,"i2");l(this,"trace");l(this,Cw,Ae);this._op=e,this._tag=e}[(Cw=fs,M)](e){return this===e}[R](){return Ln(this)}get value(){return this.i0}pipe(){return k(this,arguments)}toJSON(){return{_id:"Exit",_tag:this._op,value:z(this.value)}}toString(){return H(this.toJSON())}[V](){return this.toJSON()}}const te=t=>I(t,fs),rt=t=>{const e=new st(ka);return e.i0=t,e},Wn=u(3,(t,e,n)=>vt(r=>g(t,s=>g(dt(T(()=>r(We(e(s))))),o=>{if(o._tag==="Success"&&o.value._op==="Blocked"){const i=o.value;return ot(i.i0,Wn($(s),()=>i.i1,n))}const c=ry(o);return T(()=>n(s,c)).pipe(Q({onFailure:i=>{switch(c._tag){case G:return D(ft(c.i0,i));case Y:return D(i)}},onSuccess:()=>c}))})))),it=u(2,(t,e)=>g(t,()=>$(e))),ut=t=>it(t,void 0),ze=(t,e=qn)=>T(()=>{let n,r;const s=new st(hr);if(t.length!==1){const o=new AbortController;r=o,s.i0=c=>{n=t(c,o.signal)}}else s.i0=o=>{n=t(o)};return s.i1=e,ol(s,()=>(r&&r.abort(),n??N))}),_c=(t,e=qn)=>ze(n=>{const r=t(n);if(yn(r))n(r.right);else return r.left},e),Xu=u(2,(t,e)=>{const n=new st(gr);return n.i0=t,n.i1=e,n}),Mr=u(2,(t,e)=>Vn(t,{onFailure:e,onSuccess:$})),Tr=Symbol.for("effect/SpanAnnotation"),Fi=Symbol.for("effect/OriginalAnnotation"),Zu=(t,e)=>A(e)?new Proxy(t,{has(n,r){return r===Tr||r===Fi||r in n},get(n,r){return r===Tr?e.value:r===Fi?t:n[r]}}):t,bc=t=>Bo(t)&&!(Tr in t)?rt(e=>D(ct(Zu(t,pl(e))))):D(ct(t)),tl=t=>nl(()=>ct(sm(t))),Sm=t=>g(_(t),bc),Mn=t=>Vn(t,{onFailure:e=>$(Ft(e)),onSuccess:e=>$(pt(e))}),dt=t=>rl(t,{onFailure:x,onSuccess:et}),J=t=>Bo(t)&&!(Tr in t)?rt(e=>D(Se(Zu(t,pl(e))))):D(Se(t)),el=t=>g(_(t),J),D=t=>{const e=new Yu(G);return e.i0=t,e},nl=t=>g(_(t),D),Sc=rt(t=>$(t.id())),hs=t=>rt(e=>t(e.id())),g=u(2,(t,e)=>{const n=new st(vr);return n.i0=t,n.i1=e,n}),We=t=>{const e=new st("OnStep");return e.i0=t,e.i1=et,e},vc=(t,e)=>{const n=new st("OnStep");return n.i0=t,n.i1=e,n},Jn=t=>g(t,K),rl=u(2,(t,{onFailure:e,onSuccess:n})=>Q(t,{onFailure:r=>$(e(r)),onSuccess:r=>$(n(r))})),Q=u(2,(t,{onFailure:e,onSuccess:n})=>{const r=new st(wr);return r.i0=t,r.i1=e,r.i2=n,r}),Vn=u(2,(t,{onFailure:e,onSuccess:n})=>Q(t,{onFailure:r=>{const s=Wd(r);return Bu(r).length>0?D(Qd(r)):s.length>0?e(kn(s)):D(r)},onSuccess:n})),Ot=u(2,(t,e)=>T(()=>{const n=nt(t),r=new Array(n.length);let s=0;return it(Cr({while:()=>s<n.length,body:()=>e(n[s],s),step:o=>{r[s++]=o}}),r)})),Hn=u(2,(t,e)=>T(()=>{const n=nt(t);let r=0;return Cr({while:()=>r<n.length,body:()=>e(n[r],r),step:()=>{r++}})})),vm=g(Sc,t=>sl(t)),sl=t=>D(It(t)),Je=t=>{const e=new st(Ye);e.i0=Od(Ze);const n=r=>r._tag==="Blocked"?ot(r.i0,Je(r.i1)):r;return e.i1=()=>vc(t,n),e},wm=u(2,(t,e)=>vt(n=>g(dt(n(t)),r=>iy(e,r)))),F=u(2,(t,e)=>g(t,n=>_(()=>e(n)))),$m=u(2,(t,{onFailure:e,onSuccess:n})=>Vn(t,{onFailure:r=>el(()=>e(r)),onSuccess:r=>_(()=>n(r))})),Tn=u(2,(t,e)=>Q(t,{onFailure:n=>{const r=zu(n);switch(r._tag){case"Left":return el(()=>e(r.left));case"Right":return D(r.right)}},onSuccess:$})),Cn=u(2,(t,e)=>vt(n=>Q(n(t),{onFailure:r=>{const s=x(r);return Q(e(s),{onFailure:o=>x(tt(r,o)),onSuccess:()=>s})},onSuccess:r=>{const s=et(r);return at(e(s),s)}}))),ol=u(2,(t,e)=>Cn(t,hl({onFailure:n=>as(n)?ut(e(Jd(n))):N,onSuccess:()=>N}))),km=u(2,(t,e)=>Fm(t,e,$)),Em=t=>Om(t,K),Om=u(2,(t,e)=>Vn(t,{onFailure:n=>bc(e(n)),onSuccess:$})),$=t=>{const e=new Qu(Y);return e.i0=t,e},T=t=>g(_(t),K),_=t=>{const e=new st($a);return e.i0=t,e},sn=u(2,(t,e)=>g(t,n=>it(e(n),n))),Im=t=>rt(e=>{const n=e.getFiberRef(io),r=f(n,Nt(()=>e.scope()));return t(on(io,v(r)))}),Fm=u(3,(t,e,n)=>Q(t,{onFailure:r=>Bu(r).length>0?D(Th(Yd(r))):e(),onSuccess:n})),Ve=t=>{const e=new st(Ye);e.i0=Lu(Ze),e.i1=()=>vc(t,n);const n=r=>r._tag==="Blocked"?ot(r.i0,Ve(r.i1)):r;return e},vt=t=>{const e=new st(Ye);e.i0=Lu(Ze);const n=r=>r._op==="Blocked"?ot(r.i0,Ve(r.i1)):r;return e.i1=r=>Au(r)?We(t(Je)):We(t(Ve)),g(e,n)},N=$(void 0),oo=t=>{const e=new st(Ye);return e.i0=t,e.i1=void 0,e},Rm=u(2,(t,e)=>g(e,n=>n?f(t,F(v)):$(w()))),Cr=t=>{const e=new st($r);return e.i0=t.while,e.i1=t.body,e.i2=t.step,e},Mm=u(2,(t,e)=>{const n=new st(Ye);return n.i0=e,n.i1=()=>t,n}),Gn=t=>{const e=new st(pr);return typeof t?.priority<"u"?Vm(e,t.priority):e},cl=u(2,(t,e)=>g(t,n=>F(e,r=>[n,r]))),gs=u(2,(t,e)=>g(t,n=>it(e,n))),at=u(2,(t,e)=>g(t,()=>e)),Tm=u(3,(t,e,n)=>g(t,r=>F(e,s=>n(r,s)))),Yn=t=>g(Sc,e=>f(t,co(e))),co=u(2,(t,e)=>g(t.interruptAsFork(e),()=>t.await)),Cm={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER,pipe(){return k(this,arguments)}},Nm={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4,pipe(){return k(this,arguments)}},Am={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4,pipe(){return k(this,arguments)}},Pm={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4,pipe(){return k(this,arguments)}},il={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4,pipe(){return k(this,arguments)}},al={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4,pipe(){return k(this,arguments)}},Lm={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0,pipe(){return k(this,arguments)}},xm={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER,pipe(){return k(this,arguments)}},Dm="effect/FiberRef",qm=Symbol.for(Dm),jm={_A:t=>t},ps=t=>ul(t,e=>[e,e]),Qn=u(2,(t,e)=>g(ps(t),e)),Ri=u(2,(t,e)=>ul(t,()=>[void 0,e])),ul=u(2,(t,e)=>rt(n=>{const[r,s]=e(n.getFiberRef(t));return n.setFiberRef(t,s),$(r)})),on=u(3,(t,e,n)=>g(Wn(gs(ps(e),Ri(e,n)),()=>We(t),r=>Ri(e,r)),r=>r._op==="Blocked"?ot(r.i0,on(r.i1,e,n)):r)),Km=u(3,(t,e,n)=>Qn(e,r=>on(t,e,n(r)))),ht=(t,e)=>Xn(t,{differ:hd(),fork:e?.fork??K,join:e?.join}),ll=t=>{const e=fd();return Xn(t,{differ:e,fork:e.empty})},fl=t=>{const e=ld();return Xn(t,{differ:e,fork:e.empty})},Xn=(t,e)=>({[qm]:jm,initial:t,diff:(n,r)=>e.differ.diff(n,r),combine:(n,r)=>e.differ.combine(n,r),patch:n=>r=>e.differ.patch(n,r),fork:e.fork,join:e.join??((n,r)=>r),pipe(){return k(this,arguments)}}),Um=t=>Xn(t,{differ:mi,fork:mi.empty}),ee=P(Symbol.for("effect/FiberRef/currentContext"),()=>fl(Hr())),ds=P(Symbol.for("effect/FiberRef/currentSchedulingPriority"),()=>ht(0)),Bm=P(Symbol.for("effect/FiberRef/currentMaxOpsBeforeYield"),()=>ht(2048)),zm=P(Symbol.for("effect/FiberRef/currentLogAnnotation"),()=>ht(os())),Wm=P(Symbol.for("effect/FiberRef/currentLogLevel"),()=>ht(il)),Jm=P(Symbol.for("effect/FiberRef/currentLogSpan"),()=>ht(be())),Vm=u(2,(t,e)=>on(t,ds,e)),Hm=P(Symbol.for("effect/FiberRef/currentConcurrency"),()=>ht("unbounded")),Gm=P(Symbol.for("effect/FiberRef/currentRequestBatching"),()=>ht(!0)),Ym=P(Symbol.for("effect/FiberRef/currentUnhandledErrorLogLevel"),()=>ht(v(al))),As=P(Symbol.for("effect/FiberRef/currentMetricLabels"),()=>ll(Mt())),io=P(Symbol.for("effect/FiberRef/currentForkScopeOverride"),()=>ht(w(),{fork:()=>w(),join:(t,e)=>t})),ur=P(Symbol.for("effect/FiberRef/currentInterruptedCause"),()=>ht(Zt,{fork:()=>Zt,join:(t,e)=>t})),ao=Symbol.for("effect/Scope"),Mi=Symbol.for("effect/CloseableScope"),O$=(t,e)=>t.addFinalizer(()=>ut(e)),Nr=(t,e)=>t.addFinalizer(e),Ar=(t,e)=>t.close(e),wc=(t,e)=>t.fork(e),Ti=u(2,(t,e)=>F(Xm(t,e),jt({onNone:()=>()=>N,onSome:n=>r=>Qm(n,r)(t)}))),Qm=u(3,(t,e,n)=>T(()=>{switch(t.state._tag){case"Exited":return N;case"Running":{const r=t.state.finalizers.get(e);return t.state.finalizers.delete(e),r!=null?t.state.update(r)(n):N}}})),Xm=u(2,(t,e)=>T(()=>{switch(t.state._tag){case"Exited":return t.state.nextKey+=1,it(e(t.state.exit),w());case"Running":{const n=t.state.nextKey;return t.state.finalizers.set(n,e),t.state.nextKey+=1,$(v(n))}}})),Zm=_(()=>({state:{_tag:"Running",nextKey:0,finalizers:new Map,update:K}})),ty=t=>t._tag==="Failure",I$=t=>t._tag==="Success",ey=u(2,(t,e)=>{switch(t._tag){case G:return x(t.i0);case Y:return et(e)}}),Ps=t=>ey(t,void 0),mr=(t,e)=>oy(t,e?.parallel?ft:tt),F$=t=>x(ct(t)),Ci=t=>x(Se(t)),x=t=>{const e=new Yu(G);return e.i0=t,e},ny=u(2,(t,e)=>{switch(t._tag){case G:return x(t.i0);case Y:return e(t.i0)}}),ry=t=>f(t,ny(K)),sy=t=>x(It(t)),Ls=u(2,(t,e)=>{switch(t._tag){case G:return x(t.i0);case Y:return et(e(t.i0))}}),hl=u(2,(t,{onFailure:e,onSuccess:n})=>{switch(t._tag){case G:return e(t.i0);case Y:return n(t.i0)}}),Pr=u(2,(t,{onFailure:e,onSuccess:n})=>{switch(t._tag){case G:return e(t.i0);case Y:return n(t.i0)}}),et=t=>{const e=new Qu(Y);return e.i0=t,e},Vt=et(void 0),R$=u(2,(t,e)=>$c(t,e,{onSuccess:(n,r)=>[n,r],onFailure:tt})),M$=u(2,(t,e)=>$c(t,e,{onSuccess:(n,r)=>r,onFailure:tt})),$c=u(3,(t,e,{onFailure:n,onSuccess:r})=>{switch(t._tag){case G:switch(e._tag){case Y:return x(t.i0);case G:return x(n(t.i0,e.i0))}case Y:switch(e._tag){case Y:return et(r(t.i0,e.i0));case G:return x(e.i0)}}}),oy=(t,e)=>{const n=Dn(t);return pe(n)?f(Jt(n),Yt(f(de(n),Ls(lt)),(r,s)=>f(r,$c(s,{onSuccess:(o,c)=>f(o,mt(c)),onFailure:e}))),Ls(Pe),Ls(r=>Array.from(r)),v):w()},kc=t=>({[um]:lm,state:Xe(yc([])),blockingOn:t,pipe(){return k(this,arguments)}}),Ec=()=>g(Sc,t=>cy(t)),cy=t=>_(()=>kc(t)),ms=t=>_c(e=>{const n=Kt(t.state);switch(n._tag){case ls:return pt(n.effect);case zn:return f(t.state,ke(yc([e,...n.joiners]))),Ft(uy(t,e))}},t.blockingOn),Zn=u(2,(t,e)=>_(()=>{const n=Kt(t.state);switch(n._tag){case ls:return!1;case zn:{f(t.state,ke(Hu(e)));for(let r=0;r<n.joiners.length;r++)n.joiners[r](e);return!0}}})),iy=u(2,(t,e)=>Zn(t,e)),xs=u(2,(t,e)=>Zn(t,J(e))),Oc=u(2,(t,e)=>Zn(t,D(e))),T$=u(2,(t,e)=>Zn(t,sl(e))),ay=t=>_(()=>Kt(t.state)._tag===ls),ys=u(2,(t,e)=>Zn(t,$(e))),Ic=(t,e)=>{const n=Kt(t.state);if(n._tag===zn){f(t.state,ke(Hu(e)));for(let r=n.joiners.length-1;r>=0;r--)n.joiners[r](e)}},uy=(t,e)=>_(()=>{const n=Kt(t.state);n._tag===zn&&f(t.state,ke(yc(n.joiners.filter(r=>r!==e))))}),ly=ps(ee),Fc=()=>ly,cn=t=>g(Fc(),t),Rc=u(2,(t,e)=>on(ee,e)(t)),Mc=u(2,(t,e)=>Km(ee,n=>Yr(n,e))(t)),gl=u(2,(t,e)=>cn(n=>Rc(t,e(n)))),pl=t=>{const e=t.getFiberRef(ee).unsafeMap.get(Gu);return e!==void 0&&e._tag==="Span"?v(e):w()},C$=Ec,fy=ms,N$=Oc,A$=ay,P$=ys,uo=Symbol.for("effect/Duration"),hy=BigInt(1e3),Ni=BigInt(1e9),Ai=/^(-?\d+(?:\.\d+)?)\s+(nanos|micros|millis|seconds|minutes|hours|days|weeks)$/,ve=t=>{if(dl(t))return t;if(ma(t))return fo(t);if(Zf(t))return lo(t);{Ai.lastIndex=0;const e=Ai.exec(t);if(e){const[n,r,s]=e,o=Number(r);switch(s){case"nanos":return lo(BigInt(r));case"micros":return my(BigInt(r));case"millis":return fo(o);case"seconds":return yy(o);case"minutes":return _y(o);case"hours":return by(o);case"days":return Sy(o);case"weeks":return vy(o)}}}throw new Error("Invalid duration input")},Pi={_tag:"Millis",millis:0},gy={_tag:"Infinity"},py={[uo]:uo,[R](){return Sa(this.value)},[M](t){return dl(t)&&Ey(this,t)},toString(){return H(this.toJSON())},toJSON(){switch(this.value._tag){case"Millis":return{_id:"Duration",_tag:"Millis",millis:this.value.millis};case"Nanos":return{_id:"Duration",_tag:"Nanos",hrtime:wy(this)};case"Infinity":return{_id:"Duration",_tag:"Infinity"}}},[V](){return this.toJSON()},pipe(){return k(this,arguments)}},Ut=t=>{const e=Object.create(py);return ma(t)?isNaN(t)||t<0?e.value=Pi:Number.isFinite(t)?Number.isInteger(t)?e.value={_tag:"Millis",millis:t}:e.value={_tag:"Nanos",nanos:BigInt(Math.round(t*1e6))}:e.value=gy:t<BigInt(0)?e.value=Pi:e.value={_tag:"Nanos",nanos:t},e},dl=t=>I(t,uo),dy=Ut(0),lo=t=>Ut(t),my=t=>Ut(t*hy),fo=t=>Ut(t),yy=t=>Ut(t*1e3),_y=t=>Ut(t*6e4),by=t=>Ut(t*36e5),Sy=t=>Ut(t*864e5),vy=t=>Ut(t*6048e5),Lr=t=>{const e=ve(t);switch(e.value._tag){case"Infinity":return 1/0;case"Nanos":return Number(e.value.nanos)/1e6;case"Millis":return e.value.millis}},L$=t=>Lr(t)/1e3,wy=t=>{const e=ve(t);switch(e.value._tag){case"Infinity":return[1/0,0];case"Nanos":return[Number(e.value.nanos/Ni),Number(e.value.nanos%Ni)];case"Millis":return[Math.floor(e.value.millis/1e3),Math.round(e.value.millis%1e3*1e6)]}},ml=u(3,(t,e,n)=>{const r=ve(t),s=ve(e);if(r.value._tag==="Infinity"||s.value._tag==="Infinity")return n.onMillis(Lr(r),Lr(s));if(r.value._tag==="Nanos"||s.value._tag==="Nanos"){const o=r.value._tag==="Nanos"?r.value.nanos:BigInt(Math.round(r.value.millis*1e6)),c=s.value._tag==="Nanos"?s.value.nanos:BigInt(Math.round(s.value.millis*1e6));return n.onNanos(o,c)}return n.onMillis(r.value.millis,s.value.millis)}),$y=(t,e)=>ml(t,e,{onMillis:(n,r)=>n===r,onNanos:(n,r)=>n===r}),ky=u(2,(t,e)=>ml(t,e,{onMillis:(n,r)=>n>=r,onNanos:(n,r)=>n>=r})),Ey=u(2,(t,e)=>$y(ve(t),ve(e))),Li=Symbol.for("effect/MutableHashMap"),Oy={[Li]:Li,[Symbol.iterator](){return this.backingMap.current[Symbol.iterator]()},toString(){return H(this.toJSON())},toJSON(){return{_id:"MutableHashMap",values:Array.from(this).map(z)}},[V](){return this.toJSON()},pipe(){return k(this,arguments)}},Iy=t=>{const e=Object.create(Oy);return e.backingMap=Xe(t),e},Fy=()=>Iy(os()),ae=u(2,(t,e)=>lc(t.backingMap.current,e)),fn=u(2,(t,e)=>A(ae(t,e))),hn=u(3,(t,e,n)=>(mp(t.backingMap,fc(e,n)),t)),yl=typeof process>"u"?!1:!!process?.isBun,Ry=yl?t=>clearInterval(t):t=>clearTimeout(t),_l=yl?(t,e)=>{const n=setInterval(()=>{t(),clearInterval(n)},e);return n}:(t,e)=>setTimeout(t,e),My="effect/Clock",ho=Symbol.for(My),_s=yt(ho),Ty=2**31-1,xi={unsafeSchedule(t,e){const n=Lr(e);if(n>Ty)return Ks;let r=!1;const s=_l(()=>{r=!0,t()},n);return()=>(Ry(s),!r)}},Di=function(){const t=BigInt(1e6);if(typeof performance>"u")return()=>BigInt(Date.now())*t;const e="timeOrigin"in performance&&typeof performance.timeOrigin=="number"?BigInt(Math.round(performance.timeOrigin*1e6)):BigInt(Date.now())*t-BigInt(Math.round(performance.now()*1e6));return()=>e+BigInt(Math.round(performance.now()*1e6))}(),Cy=function(){const t=typeof process=="object"&&"hrtime"in process&&typeof process.hrtime.bigint=="function"?process.hrtime:void 0;if(!t)return Di;const e=Di()-t.bigint();return()=>e+t.bigint()}();var Nw;class Ny{constructor(){l(this,Nw,ho);l(this,"currentTimeMillis",_(()=>this.unsafeCurrentTimeMillis()));l(this,"currentTimeNanos",_(()=>this.unsafeCurrentTimeNanos()))}unsafeCurrentTimeMillis(){return Date.now()}unsafeCurrentTimeNanos(){return Cy()}scheduler(){return $(xi)}sleep(e){return _c(n=>{const r=xi.unsafeSchedule(()=>n(N),e);return Ft(ut(_(r)))})}}Nw=ho;const Ay=()=>new Ny,Nn=Ih,bl="And",Sl="Or",vl="InvalidData",wl="MissingData",$l="SourceUnavailable",kl="Unsupported",Py="effect/ConfigError",qi=Symbol.for(Py),an={[qi]:qi},El=(t,e)=>{const n=Object.create(an);return n._tag=bl,n.left=t,n.right=e,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),n},Ol=(t,e)=>{const n=Object.create(an);return n._tag=Sl,n.left=t,n.right=e,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),n},Ly=(t,e,n={pathDelim:"."})=>{const r=Object.create(an);return r._tag=vl,r.path=t,r.message=e,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`(Invalid data at ${f(this.path,Qe(n.pathDelim))}: "${this.message}")`}}),r},Ee=(t,e,n={pathDelim:"."})=>{const r=Object.create(an);return r._tag=wl,r.path=t,r.message=e,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`(Missing data at ${f(this.path,Qe(n.pathDelim))}: "${this.message}")`}}),r},xy=(t,e,n,r={pathDelim:"."})=>{const s=Object.create(an);return s._tag=$l,s.path=t,s.message=e,s.cause=n,Object.defineProperty(s,"toString",{enumerable:!1,value(){return`(Source unavailable at ${f(this.path,Qe(r.pathDelim))}: "${this.message}")`}}),s},Dy=(t,e,n={pathDelim:"."})=>{const r=Object.create(an);return r._tag=kl,r.path=t,r.message=e,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`(Unsupported operation at ${f(this.path,Qe(n.pathDelim))}: "${this.message}")`}}),r},le=u(2,(t,e)=>{switch(t._tag){case bl:return El(le(e)(t.left),le(e)(t.right));case Sl:return Ol(le(e)(t.left),le(e)(t.right));case vl:return Ly([...e,...t.path],t.message);case wl:return Ee([...e,...t.path],t.message);case $l:return xy([...e,...t.path],t.message,t.cause);case kl:return Dy([...e,...t.path],t.message)}}),qy="Constant",jy="Fail",Ky="Fallback",Uy="Described",By="Lazy",zy="MapOrFail",Wy="Nested",Jy="Primitive",Vy="Sequence",Hy="HashMap",Gy="ZipWith",Yy=t=>e=>Ee([],`Expected ${e.description} with name ${t}`),Qy={_tag:"Empty"},Ds=u(2,(t,e)=>{let n=hc(e),r=t;for(;Iu(n);){const s=n.head;switch(s._tag){case"Empty":{n=n.tail;break}case"AndThen":{n=_e(s.first,_e(s.second,n.tail));break}case"MapName":{r=Ce(r,s.f),n=n.tail;break}case"Nested":{r=Lt(r,s.name),n=n.tail;break}case"Unnested":{if(f(Ba(r),Ph(s.name)))r=ge(r),n=n.tail;else return Ft(Ee(r,`Expected ${s.name} to be in path in ConfigProvider#unnested`));break}}}return pt(r)}),xr=(t,e)=>[...t,...e],Xy="effect/ConfigProvider",go=Symbol.for(Xy),Zy=yt(go),t_="effect/ConfigProviderFlat",ji=Symbol.for(t_),e_=t=>({[go]:go,pipe(){return k(this,arguments)},...t}),n_=t=>({[ji]:ji,patch:t.patch,load:(e,n,r=!0)=>t.load(e,n,r),enumerateChildren:t.enumerateChildren}),r_=t=>e_({load:e=>g(gt(t,wn(),e,!1),n=>jt(Ba(n),{onNone:()=>J(Ee(wn(),`Expected a single value having structure: ${e}`)),onSome:$})),flattened:t}),s_=(t={})=>{const{pathDelim:e,seqDelim:n}=Object.assign({},{pathDelim:"_",seqDelim:","},t),r=a=>f(a,Qe(e)),s=a=>a.split(e),o=()=>typeof process<"u"&&"env"in process&&typeof process.env=="object"?process.env:{};return r_(n_({load:(a,h,d=!0)=>{const p=r(a),m=o(),b=p in m?v(m[p]):w();return f(b,Tn(()=>Ee(a,`Expected ${p} to exist in the process context`)),g(S=>a_(S,a,h,n,d)))},enumerateChildren:a=>_(()=>{const h=o(),d=Object.keys(h),m=Array.from(d).map(b=>s(b.toUpperCase())).filter(b=>{for(let S=0;S<a.length;S++){const L=f(a,Ua(S)),q=b[S];if(q===void 0||L!==q)return!1}return!0}).flatMap(b=>b.slice(a.length,a.length+1));return ic(m)}),patch:Qy}))},o_=(t,e,n,r)=>{const s=li(n.length,a=>a>=r.length?w():v([t(a),a+1])),o=li(r.length,a=>a>=n.length?w():v([e(a),a+1])),c=xr(n,s),i=xr(r,o);return[c,i]},gt=(t,e,n,r)=>{const s=n;switch(s._tag){case qy:return $(kt(s.value));case Uy:return T(()=>gt(t,e,s.config,r));case jy:return J(Ee(e,s.message));case Ky:return f(T(()=>gt(t,e,s.first,r)),Mr(o=>s.condition(o)?f(gt(t,e,s.second,r),Mr(c=>J(Ol(o,c)))):J(o)));case By:return T(()=>gt(t,e,s.config(),r));case zy:return T(()=>f(gt(t,e,s.original,r),g(Ot(o=>f(s.mapOrFail(o),Tn(le(e)))))));case Wy:return T(()=>gt(t,xr(e,kt(s.name)),s.config,r));case Jy:return f(Ds(e,t.patch),g(o=>f(t.load(o,s,r),g(c=>{if(c.length===0){const i=f(zh(o),Nt(()=>"<n/a>"));return J(Yy(i))}return $(c)}))));case Vy:return f(Ds(e,t.patch),g(o=>f(t.enumerateChildren(o),g(f_),g(c=>c.length===0?T(()=>F(gt(t,o,s.config,!0),kt)):f(Ot(c,i=>gt(t,ja(e,`[${i}]`),s.config,!0)),F(i=>{const a=Xh(i);return a.length===0?kt(wn()):kt(a)}))))));case Hy:return T(()=>f(Ds(e,t.patch),g(o=>f(t.enumerateChildren(o),g(c=>f(c,Ot(i=>gt(t,xr(o,kt(i)),s.valueConfig,r)),F(i=>{if(i.length===0)return kt(os());const a=i.map(h=>Array.from(h));return f(u_(a),Ce(h=>vu(ui(nt(c),h))))})))))));case Gy:return T(()=>f(gt(t,e,s.left,r),Mn,g(o=>f(gt(t,e,s.right,r),Mn,g(c=>{if(mn(o)&&mn(c))return J(El(o.left,c.left));if(mn(o)&&yn(c))return J(o.left);if(yn(o)&&mn(c))return J(c.left);if(yn(o)&&yn(c)){const i=f(e,Qe(".")),a=c_(e,i),[h,d]=o_(a,a,f(o.right,Ce(pt)),f(c.right,Ce(pt)));return f(h,ui(d),Ot(([p,m])=>f(cl(p,m),F(([b,S])=>s.zip(b,S)))))}throw new Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/effect/issues")})))))}},c_=(t,e)=>n=>Ft(Ee(t,`The element at index ${n} in a sequence at path "${e}" was missing`)),i_=(t,e)=>t.split(new RegExp(`\\s*${l_(e)}\\s*`)),a_=(t,e,n,r,s)=>s?f(i_(t,r),Ot(o=>n.parse(o.trim())),Tn(le(e))):f(n.parse(t),F(kt),Tn(le(e))),u_=t=>Object.keys(t[0]).map(e=>t.map(n=>n[e])),l_=t=>t.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&"),f_=t=>f(Ot(t,g_),$m({onFailure:()=>wn(),onSuccess:za(Nn)}),Mn,F(Dh)),h_=/^(\[(\d+)\])$/,g_=t=>{const e=t.match(h_);if(e!==null){const n=e[2];return f(n!==void 0&&n.length>0?v(n):w(),qa(p_))}return w()},p_=t=>{const e=Number.parseInt(t);return Number.isNaN(e)?w():v(e)},po=Symbol.for("effect/Console"),Il=yt(po),d_={[po]:po,assert(t,...e){return _(()=>{console.assert(t,...e)})},clear:_(()=>{console.clear()}),count(t){return _(()=>{console.count(t)})},countReset(t){return _(()=>{console.countReset(t)})},debug(...t){return _(()=>{console.debug(...t)})},dir(t,e){return _(()=>{console.dir(t,e)})},dirxml(...t){return _(()=>{console.dirxml(...t)})},error(...t){return _(()=>{console.error(...t)})},group(t){return t?.collapsed?_(()=>console.groupCollapsed(t?.label)):_(()=>console.group(t?.label))},groupEnd:_(()=>{console.groupEnd()}),info(...t){return _(()=>{console.info(...t)})},log(...t){return _(()=>{console.log(...t)})},table(t,e){return _(()=>{console.table(t,e)})},time(t){return _(()=>console.time(t))},timeEnd(t){return _(()=>console.timeEnd(t))},timeLog(t,...e){return _(()=>{console.timeLog(t,...e)})},trace(...t){return _(()=>{console.trace(...t)})},warn(...t){return _(()=>{console.warn(...t)})},unsafe:console},m_="effect/Random",mo=Symbol.for(m_),Fl=yt(mo);var Aw;class y_{constructor(e){l(this,"seed");l(this,Aw,mo);l(this,"PRNG");this.seed=e,this.PRNG=new ba(e)}get next(){return _(()=>this.PRNG.number())}get nextBoolean(){return F(this.next,e=>e>.5)}get nextInt(){return _(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER))}nextRange(e,n){return F(this.next,r=>(n-e)*r+e)}nextIntBetween(e,n){return _(()=>this.PRNG.integer(n-e)+e)}shuffle(e){return __(e,n=>this.nextIntBetween(0,n))}}Aw=mo;const __=(t,e)=>T(()=>f(_(()=>Array.from(t)),g(n=>{const r=[];for(let s=n.length;s>=2;s=s-1)r.push(s);return f(r,Hn(s=>f(e(s),F(o=>b_(n,s-1,o)))),it(Dn(n)))}))),b_=(t,e,n)=>{const r=t[e];return t[e]=t[n],t[n]=r,t},S_=t=>new y_(t),v_=f(Hr(),Wt(_s,Ay()),Wt(Il,d_),Wt(Fl,S_(Math.random()*4294967296>>>0)),Wt(Zy,s_()),Wt(ro,pm)),he=P(Symbol.for("effect/DefaultServices/currentServices"),()=>fl(v_)),w_=t=>{const e=ve(t);return Rl(n=>n.sleep(e))},Rl=t=>Qn(he,e=>t(Ht(e,_s))),$_=Rl(t=>t.currentTimeNanos),k_=t=>Qn(he,e=>t(Ht(e,Fl))),E_=w_,O_=$_;function I_(t){return new tr(t)}function F_(){return I_(new Map)}const Ki=Symbol.for("effect/FiberRefs");var Pw;class tr{constructor(e){l(this,"locals");l(this,Pw,Ki);this.locals=e}pipe(){return k(this,arguments)}}Pw=Ki;const R_=(t,e,n,r=!1)=>{const s=t;let o=e,c=n,i=r,a;for(;a===void 0;)if(xt(o)&&xt(c)){const h=Z(o)[0],d=ge(o),p=Z(c)[0],m=Z(c)[1],b=ge(c);h.startTimeMillis<p.startTimeMillis?(c=b,i=!0):h.startTimeMillis>p.startTimeMillis?o=d:h.id<p.id?(c=b,i=!0):h.id>p.id?o=d:a=[m,i]}else a=[s.initial,!0];return a},M_=u(3,(t,e,n)=>{const r=new Map(t.locals);for(const[s,o]of n.locals){const c=Z(o)[1];if(!O(Z(o)[0],e)){if(!r.has(s)){if(O(c,s.initial))continue;r.set(s,[[e,s.join(s.initial,c)]]);continue}const i=r.get(s),[a,h]=R_(s,i,o);if(h){const d=s.diff(a,c),p=Z(i)[1],m=s.join(p,s.patch(d)(p));if(!O(p,m)){let b;const S=Z(i)[0];O(S,e)?b=Lt([S,m])(ge(i)):b=Lt([e,m])(i),r.set(s,b)}}}}return new tr(new Map(r))}),Ml=u(2,(t,e)=>{const n=new Map;for(const[r,s]of t.locals.entries()){const o=Z(s)[1],c=r.patch(r.fork)(o);O(o,c)?n.set(r,s):n.set(r,Lt([e,c])(s))}return new tr(n)}),Tl=u(2,(t,e)=>{const n=new Map(t.locals);return n.delete(e),new tr(n)}),yo=u(2,(t,e)=>t.locals.has(e)?v(Z(t.locals.get(e))[1]):w()),Tc=u(2,(t,e)=>f(yo(t,e),Nt(()=>e.initial))),Dr=u(2,(t,{fiberId:e,fiberRef:n,value:r})=>{const s=t.locals.has(n)?t.locals.get(n):wn();let o;if(Yo(s))o=kt([e,r]);else{const[i,a]=Z(s);if(O(i,e)){if(O(a,r))return t;o=Lt([e,r])(ge(s))}else o=Lt([e,r])(s)}const c=new Map(t.locals);return new tr(c.set(n,o))}),T_=Ml,C_=Tc,Ui=Dr,N_=F_,A_=Cm,P_=Nm,L_=Am,x_=Pm,Cl=il,D_=al,q_=Lm,j_=xm,K_=f(Nn,Fh(t=>t.ordinal)),U_=Rh(K_),B_=t=>{switch(t){case"All":return A_;case"Debug":return D_;case"Error":return L_;case"Fatal":return P_;case"Info":return Cl;case"Trace":return q_;case"None":return j_;case"Warning":return x_}},z_=t=>e=>`${e.label.replace(/[\s="]/g,"_")}=${t-e.startTime}ms`,W_=z_,Nl=Symbol.for("effect/Ref"),Al={_A:t=>t};var Lw;class J_{constructor(e){l(this,"ref");l(this,Lw,Al);this.ref=e}modify(e){return _(()=>{const n=Kt(this.ref),[r,s]=e(n);return n!==s&&ke(s)(this.ref),r})}pipe(){return k(this,arguments)}}Lw=Nl;const Pl=t=>new J_(Xe(t)),_o=t=>_(()=>Pl(t)),qr=t=>t.modify(e=>[e,e]),Cc=u(2,(t,e)=>t.modify(()=>[void 0,e])),Ll=u(2,(t,e)=>t.modify(e)),bo=u(2,(t,e)=>t.modify(n=>[void 0,e(n)])),V_=u(2,(t,e)=>t.modify(n=>{const r=e(n);return[r,r]})),H_=_o,x$=qr,G_=Ll,D$=Cc,q$=bo,j$=V_,xl="Empty",Dl="Add",ql="Remove",jl="Update",Kl="AndThen",Y_={_tag:xl},Ul=(t,e)=>{const n=new Map(t.locals);let r=Y_;for(const[s,o]of e.locals.entries()){const c=Z(o)[1],i=n.get(s);if(i!==void 0){const a=Z(i)[1];O(a,c)||(r=qs({_tag:jl,fiberRef:s,patch:s.diff(a,c)})(r))}else r=qs({_tag:Dl,fiberRef:s,value:c})(r);n.delete(s)}for(const[s]of n.entries())r=qs({_tag:ql,fiberRef:s})(r);return r},qs=u(2,(t,e)=>({_tag:Kl,first:t,second:e})),Bl=u(3,(t,e,n)=>{let r=n,s=kt(t);for(;xt(s);){const o=Z(s),c=ge(s);switch(o._tag){case xl:{s=c;break}case Dl:{r=Dr(r,{fiberId:e,fiberRef:o.fiberRef,value:o.value}),s=c;break}case ql:{r=Tl(r,o.fiberRef),s=c;break}case jl:{const i=Tc(r,o.fiberRef);r=Dr(r,{fiberId:e,fiberRef:o.fiberRef,value:o.fiberRef.patch(o.patch)(i)}),s=c;break}case Kl:{s=Lt(o.first)(Lt(o.second)(c));break}}}return r}),zl="effect/MetricLabel",So=Symbol.for(zl);var xw;class Q_{constructor(e,n){l(this,"key");l(this,"value");l(this,xw,So);this.key=e,this.value=n}[(xw=So,R)](){return f(y(zl),E(y(this.key)),E(y(this.value)))}[M](e){return Z_(e)&&this.key===e.key&&this.value===e.value}pipe(){return k(this,arguments)}}const X_=(t,e)=>new Q_(t,e),Z_=t=>I(t,So);class Nc{constructor(e){l(this,"self");l(this,"called",!1);this.self=e}next(e){return this.called?{value:e,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(e){return{value:e,done:!0}}throw(e){throw e}[Symbol.iterator](){return new Nc(this.self)}}const Bi=t=>{let e,n;return typeof t=="function"?e=t:(e=t.try,n=t.catch),_(()=>{try{return e()}catch(r){throw ym(Se(n?n(r):r))}})},tb=u(2,(t,e)=>Q(t,{onFailure:n=>{const r=e(n);switch(r._tag){case"None":return D(n);case"Some":return r.value}},onSuccess:$})),eb=u(2,(t,e)=>at(E_(e),t)),nb=t=>Gl(t,ib,Ul),Wl=u(2,(t,{onFailure:e,onSuccess:n})=>Vn(t,{onFailure:r=>$(e(r)),onSuccess:r=>$(n(r))})),rb=t=>{const e=g(g(t,()=>Gn()),()=>e);return e};class sb{constructor(e){l(this,"value");this.value=e}[Symbol.iterator](){return new Nc(this)}}const ob=function(){let t=arguments[0];for(let e=1;e<arguments.length;e++)t=arguments[e](t);return new sb(t)},cb=function(){let t;return arguments.length===1?t=arguments[0]:t=arguments[1].bind(arguments[0]),T(()=>{const e=t(ob),n=e.next(),r=s=>s.done?$(s.value):f(s.value.value,g(o=>r(e.next(o))));return r(n)})},ib=rt(t=>$(t.getFiberRefs())),ab=t=>Wl(t,{onFailure:si,onSuccess:si}),Jl=t=>(e,n)=>{const r=xn(t);let s,o;return Uu(e)?(o=e,s=n??""):(s=e,o=n??Zt),rt(c=>(c.log(s,o,r),N))},ub=Jl(),lb=Jl(Cl),fb=(t,e)=>e.discard?Hl(t,e.while,e.step,e.body):F(Vl(t,e.while,e.step,e.body),n=>Array.from(n)),Vl=(t,e,n,r)=>T(()=>e(t)?g(r(t),s=>F(Vl(n(t),e,n,r),Fu(s))):_(()=>be())),Hl=(t,e,n,r)=>T(()=>e(t)?g(r(t),()=>Hl(n(t),e,n,r)):N),zi=u(2,(t,e)=>Q(t,{onFailure:n=>nl(()=>e(n)),onSuccess:$})),hb=t=>F(t,e=>!e),vo=t=>Sb((e,n)=>f(t,Bl(e,n))),gb=u(3,(t,e,n)=>cn(r=>Rc(t,Wt(r,e,n)))),pb=k_($),db=u(3,(t,e,n)=>nt(t).reduce((r,s,o)=>g(r,c=>n(c,s,o)),$(e))),Gl=u(3,(t,e,n)=>g(e,r=>g(t,s=>F(e,o=>[n(r,o),s])))),mb=u(2,(t,e)=>Q(t,{onFailure:n=>at(e(n),D(n)),onSuccess:$})),yb=t=>_b(t,O_),_b=u(2,(t,e)=>Gl(t,e,(n,r)=>lo(r-n))),bb=t=>{let e,n;return typeof t=="function"?e=t:(e=t.try,n=t.catch),e.length>=1?T(()=>{const r=new AbortController;return g(Bi(()=>e(r.signal)),s=>ze(o=>(s.then(c=>o(et(c))).catch(c=>o(J(n?n(c):c))),_(()=>r.abort()))))}):g(Bi(t),r=>ze(s=>{r.then(o=>s(et(o))).catch(o=>s(J(n?n(o):o)))}))},Sb=t=>rt(e=>(e.setFiberRefs(t(e.id(),e.getFiberRefs())),N)),vb=u(3,(t,e,n)=>gl(t,r=>Wt(r,e,n(Xo(r,e))))),wb=u(2,(t,e)=>T(()=>e()?F(t,v):$(w()))),$b=t=>F(Fc(),$e(t)),kb=t=>t==null?J(mc()):$(t),Wi=Ea,Yl="Sequential",Ql="Parallel",Eb="ParallelN",Ac={_tag:Yl},Ob={_tag:Ql},Ib=t=>({_tag:Eb,parallelism:t}),Fb=t=>t._tag===Yl,Rb=t=>t._tag===Ql,wo=Ac,$o=Ob,ko=Ib,jr=Ul,Ji=Bl,bs="effect/FiberStatus",we=Symbol.for(bs),Eo="Done",Vi="Running",Hi="Suspended";var Dw;class Mb{constructor(){l(this,Dw,we);l(this,"_tag",Eo)}[(Dw=we,R)](){return f(y(bs),E(y(this._tag)))}[M](e){return Pc(e)&&e._tag===Eo}}var qw;class Tb{constructor(e){l(this,"runtimeFlags");l(this,qw,we);l(this,"_tag",Vi);this.runtimeFlags=e}[(qw=we,R)](){return f(y(bs),E(y(this._tag)),E(y(this.runtimeFlags)))}[M](e){return Pc(e)&&e._tag===Vi&&this.runtimeFlags===e.runtimeFlags}}var jw;class Cb{constructor(e,n){l(this,"runtimeFlags");l(this,"blockingOn");l(this,jw,we);l(this,"_tag",Hi);this.runtimeFlags=e,this.blockingOn=n}[(jw=we,R)](){return f(y(bs),E(y(this._tag)),E(y(this.runtimeFlags)),E(y(this.blockingOn)))}[M](e){return Pc(e)&&e._tag===Hi&&this.runtimeFlags===e.runtimeFlags&&O(this.blockingOn,e.blockingOn)}}const Nb=new Mb,Ab=t=>new Tb(t),Pb=(t,e)=>new Cb(t,e),Pc=t=>I(t,we),Lb=t=>t._tag===Eo,xb=Nb,Xl=Ab,Db=Pb,qb=Lb;class jb{constructor(){l(this,"buckets",[])}scheduleTask(e,n){let r,s;for(s=0;s<this.buckets.length&&this.buckets[s][0]<=n;s++)r=this.buckets[s];if(r)r[1].push(e);else{const o=[];for(let c=0;c<s;c++)o.push(this.buckets[c]);o.push([n,[e]]);for(let c=s;c<this.buckets.length;c++)o.push(this.buckets[c]);this.buckets=o}}}class Kb{constructor(e){l(this,"maxNextTickBeforeTimer");l(this,"running",!1);l(this,"tasks",new jb);this.maxNextTickBeforeTimer=e}starveInternal(e){const n=this.tasks.buckets;this.tasks.buckets=[];for(const[r,s]of n)for(let o=0;o<s.length;o++)s[o]();this.tasks.buckets.length===0?this.running=!1:this.starve(e)}starve(e=0){e>=this.maxNextTickBeforeTimer?_l(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(e+1))}shouldYield(e){return e.currentOpCount>e.getFiberRef(Bm)?e.getFiberRef(ds):!1}scheduleTask(e,n){this.tasks.scheduleTask(e,n),this.running||(this.running=!0,this.starve())}}const Ub=P(Symbol.for("effect/Scheduler/defaultScheduler"),()=>new Kb(2048)),Kr=P(Symbol.for("effect/FiberRef/currentScheduler"),()=>ht(Ub)),Zl=P(Symbol.for("effect/FiberRef/currentRequestMap"),()=>ht(new Map)),Gi=(t,e,n,r)=>{switch(t){case void 0:return e();case"unbounded":return n();case"inherit":return Qn(Hm,s=>s==="unbounded"?n():s>1?r(s):e());default:return t>1?r(t):e()}},Lc="InterruptSignal",xc="Stateful",Dc="Resume",qc="YieldNow",Yi=t=>({_tag:Lc,cause:t}),yr=t=>({_tag:xc,onFiber:t}),Re=t=>({_tag:Dc,effect:t}),Bb=()=>({_tag:qc}),zb="effect/FiberScope",Ur=Symbol.for(zb);var Kw;class Wb{constructor(){l(this,Kw,Ur);l(this,"fiberId",qn);l(this,"roots",new Set)}add(e,n){this.roots.add(n),n.addObserver(()=>{this.roots.delete(n)})}}Kw=Ur;var Uw;class Jb{constructor(e,n){l(this,"fiberId");l(this,"parent");l(this,Uw,Ur);this.fiberId=e,this.parent=n}add(e,n){this.parent.tell(yr(r=>{r.addChild(n),n.addObserver(()=>{r.removeChild(n)})}))}}Uw=Ur;const Vb=t=>new Jb(t.id(),t),tf=P(Symbol.for("effect/FiberScope/Global"),()=>new Wb),Hb="effect/Fiber",Gb=Symbol.for(Hb),Yb={_E:t=>t,_A:t=>t},Qb="effect/Fiber",Xb=Symbol.for(Qb),Zb=t=>t.await,tS=t=>t.inheritAll,Qi=t=>gs(Jn(t.await),t.inheritAll),se="effect/FiberCurrent",eS="effect/Logger",nS=Symbol.for(eS),rS={_Message:t=>t,_Output:t=>t},jc=t=>({[nS]:rS,log:t,pipe(){return k(this,arguments)}}),sS=jc(({annotations:t,cause:e,date:n,fiberId:r,logLevel:s,message:o,spans:c})=>{const i=n.getTime();let h=[`timestamp=${n.toISOString()}`,`level=${s.label}`,`fiber=${bu(r)}`].join(" ");const d=Oo(o);if(d.length>0&&(h=h+" message=",h=js(d,h)),e!=null&&e._tag!=="Empty"&&(h=h+" cause=",h=js(us(e),h)),Iu(c)){h=h+" ";let p=!0;for(const m of c)p?p=!1:h=h+" ",h=h+f(m,W_(i))}if(f(t,Fp)>0){h=h+" ";let p=!0;for(const[m,b]of t)p?p=!1:h=h+" ",h=h+iS(m),h=h+"=",h=js(Oo(b),h)}return h}),Oo=t=>{try{return typeof t=="object"?JSON.stringify(t):String(t)}catch{return String(t)}},oS=t=>`"${t.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`,cS=/^[^\s"=]+$/,js=(t,e)=>e+(t.match(cS)?t:oS(t)),iS=t=>t.replace(/[\s="]/g,"_"),ef="effect/MetricBoundaries",Io=Symbol.for(ef);var Bw;class aS{constructor(e){l(this,"values");l(this,Bw,Io);this.values=e}[(Bw=Io,R)](){return f(y(ef),E(y(this.values)))}[M](e){return uS(e)&&O(this.values,e.values)}pipe(){return k(this,arguments)}}const uS=t=>I(t,Io),lS=t=>{const e=f(t,Ct(lt(Number.POSITIVE_INFINITY)),Mg);return new aS(e)},fS=t=>f(Go(t.count-1,e=>t.start*Math.pow(t.factor,e)),St,lS),hS="effect/MetricKeyType",nf=Symbol.for(hS),rf="effect/MetricKeyType/Counter",Fo=Symbol.for(rf),gS="effect/MetricKeyType/Frequency",pS=Symbol.for(gS),dS="effect/MetricKeyType/Gauge",mS=Symbol.for(dS),sf="effect/MetricKeyType/Histogram",Ro=Symbol.for(sf),yS="effect/MetricKeyType/Summary",_S=Symbol.for(yS),of={_In:t=>t,_Out:t=>t};var zw,Ww;class bS{constructor(e,n){l(this,"incremental");l(this,"bigint");l(this,zw,of);l(this,Ww,Fo);this.incremental=e,this.bigint=n}[(zw=nf,Ww=Fo,R)](){return y(rf)}[M](e){return cf(e)}pipe(){return k(this,arguments)}}var Jw,Vw;class SS{constructor(e){l(this,"boundaries");l(this,Jw,of);l(this,Vw,Ro);this.boundaries=e}[(Jw=nf,Vw=Ro,R)](){return f(y(sf),E(y(this.boundaries)))}[M](e){return af(e)&&O(this.boundaries,e.boundaries)}pipe(){return k(this,arguments)}}const vS=t=>new bS(t?.incremental??!1,t?.bigint??!1),wS=t=>new SS(t),cf=t=>I(t,Fo),$S=t=>I(t,pS),kS=t=>I(t,mS),af=t=>I(t,Ro),ES=t=>I(t,_S),OS="effect/MetricKey",uf=Symbol.for(OS),IS={_Type:t=>t};var Hw;class Kc{constructor(e,n,r,s=Mt()){l(this,"name");l(this,"keyType");l(this,"description");l(this,"tags");l(this,Hw,IS);this.name=e,this.keyType=n,this.description=r,this.tags=s}[(Hw=uf,R)](){return f(y(this.name),E(y(this.keyType)),E(y(this.description)),E(y(this.tags)))}[M](e){return FS(e)&&this.name===e.name&&O(this.keyType,e.keyType)&&O(this.description,e.description)&&O(this.tags,e.tags)}pipe(){return k(this,arguments)}}const FS=t=>I(t,uf),RS=(t,e)=>new Kc(t,vS(e),xn(e?.description)),MS=(t,e,n)=>new Kc(t,wS(e),xn(n)),TS=u(2,(t,e)=>ac(e)===0?t:new Kc(t.name,t.keyType,t.description,f(t.tags,Xt(e)))),CS="effect/MetricState",er=Symbol.for(CS),lf="effect/MetricState/Counter",Mo=Symbol.for(lf),ff="effect/MetricState/Frequency",To=Symbol.for(ff),hf="effect/MetricState/Gauge",Co=Symbol.for(hf),gf="effect/MetricState/Histogram",No=Symbol.for(gf),pf="effect/MetricState/Summary",Ao=Symbol.for(pf),nr={_A:t=>t};var Gw,Yw;class NS{constructor(e){l(this,"count");l(this,Gw,nr);l(this,Yw,Mo);this.count=e}[(Gw=er,Yw=Mo,R)](){return f(y(lf),E(y(this.count)))}[M](e){return BS(e)&&this.count===e.count}pipe(){return k(this,arguments)}}var Qw,Xw;class AS{constructor(e){l(this,"occurrences");l(this,Qw,nr);l(this,Xw,To);this.occurrences=e}[(Qw=er,Xw=To,R)](){return f(y(ff),E(y(this.occurrences)))}[M](e){return zS(e)&&O(this.occurrences,e.occurrences)}pipe(){return k(this,arguments)}}var Zw,t$;class PS{constructor(e){l(this,"value");l(this,Zw,nr);l(this,t$,Co);this.value=e}[(Zw=er,t$=Co,R)](){return f(y(hf),E(y(this.value)))}[M](e){return WS(e)&&this.value===e.value}pipe(){return k(this,arguments)}}var e$,n$;class LS{constructor(e,n,r,s,o){l(this,"buckets");l(this,"count");l(this,"min");l(this,"max");l(this,"sum");l(this,e$,nr);l(this,n$,No);this.buckets=e,this.count=n,this.min=r,this.max=s,this.sum=o}[(e$=er,n$=No,R)](){return f(y(gf),E(y(this.buckets)),E(y(this.count)),E(y(this.min)),E(y(this.max)),E(y(this.sum)))}[M](e){return JS(e)&&O(this.buckets,e.buckets)&&this.count===e.count&&this.min===e.min&&this.max===e.max&&this.sum===e.sum}pipe(){return k(this,arguments)}}var r$,s$;class xS{constructor(e,n,r,s,o,c){l(this,"error");l(this,"quantiles");l(this,"count");l(this,"min");l(this,"max");l(this,"sum");l(this,r$,nr);l(this,s$,Ao);this.error=e,this.quantiles=n,this.count=r,this.min=s,this.max=o,this.sum=c}[(r$=er,s$=Ao,R)](){return f(y(pf),E(y(this.error)),E(y(this.quantiles)),E(y(this.count)),E(y(this.min)),E(y(this.max)),E(y(this.sum)))}[M](e){return VS(e)&&this.error===e.error&&O(this.quantiles,e.quantiles)&&this.count===e.count&&this.min===e.min&&this.max===e.max&&this.sum===e.sum}pipe(){return k(this,arguments)}}const DS=t=>new NS(t),qS=t=>new AS(t),jS=t=>new PS(t),KS=t=>new LS(t.buckets,t.count,t.min,t.max,t.sum),US=t=>new xS(t.error,t.quantiles,t.count,t.min,t.max,t.sum),BS=t=>I(t,Mo),zS=t=>I(t,To),WS=t=>I(t,Co),JS=t=>I(t,No),VS=t=>I(t,Ao),HS="effect/MetricHook",GS=Symbol.for(HS),YS={_In:t=>t,_Out:t=>t},rr=t=>({[GS]:YS,pipe(){return k(this,arguments)},...t}),Xi=BigInt(0),QS=t=>{let e=t.keyType.bigint?Xi:0;const n=t.keyType.incremental?t.keyType.bigint?r=>r>=Xi:r=>r>=0:r=>!0;return rr({get:()=>DS(e),update:r=>{n(r)&&(e=e+r)}})},XS=t=>{const e=new Map,n=s=>{const o=e.get(s)??0;e.set(s,o+1)},r=()=>vu(e.entries());return rr({get:()=>qS(r()),update:n})},ZS=(t,e)=>{let n=e;return rr({get:()=>jS(n),update:r=>{n=r}})},t0=t=>{const e=t.keyType.boundaries.values,n=e.length,r=new Uint32Array(n+1),s=new Float32Array(n);let o=0,c=0,i=Number.MAX_VALUE,a=Number.MIN_VALUE;f(e,Ws(Nn),ru((p,m)=>{s[m]=p}));const h=p=>{let m=0,b=n;for(;m!==b;){const S=Math.floor(m+(b-m)/2),L=s[S];p<=L?b=S:m=S,b===m+1&&(p<=s[m]?b=m:m=b)}r[m]=r[m]+1,o=o+1,c=c+p,p<i&&(i=p),p>a&&(a=p)},d=()=>{const p=Array(n);let m=0;for(let b=0;b<n;b++){const S=s[b],L=r[b];m=m+L,p[b]=[S,m]}return St(p)};return rr({get:()=>KS({buckets:d(),count:o,min:i,max:a,sum:c}),update:h})},e0=t=>{const{error:e,maxAge:n,maxSize:r,quantiles:s}=t.keyType,o=f(s,Ws(Nn)),c=Array(r);let i=0,a=0,h=0,d=Number.MAX_VALUE,p=Number.MIN_VALUE;const m=S=>{const L=[];let q=0;for(;q!==r-1;){const j=c[q];if(j!=null){const[$t,re]=j,ln=fo(S-$t);ky(ln,dy)&&ln<=n&&L.push(re)}q=q+1}return n0(e,o,f(St(L),Ws(Nn)))},b=(S,L)=>{if(r>0){i=i+1;const q=i%r;c[q]=[L,S]}a=a+1,h=h+S,S<d&&(d=S),S>p&&(p=S)};return rr({get:()=>US({error:e,quantiles:m(Date.now()),count:a,min:d,max:p,sum:h}),update:([S,L])=>b(S,L)})},n0=(t,e,n)=>{const r=n.length;if(Zo(e))return Rt();const s=kn(e),o=f(e,$n(1)),c=f(o,Yt(lt(Zi(t,r,w(),0,s,n)),(i,a)=>{const h=kn(i);return f(i,Og(Zi(t,r,h.value,h.consumed,a,h.rest)))}));return f(c,ru(i=>[i.quantile,i.value]))},Zi=(t,e,n,r,s,o)=>{let c=t,i=e,a=n,h=r,d=s,p=o,m=t,b=e,S=n,L=r,q=s,j=o;for(;;){if(Zo(p))return{quantile:d,value:w(),consumed:h,rest:Rt()};if(d===1)return{quantile:d,value:v(Ig(p)),consumed:h+p.length,rest:Rt()};const $t=f(p,Rg(Os=>Os>kn(p))),re=d*i,ln=c/2*re,Ie=h+$t[0].length,Hf=Math.abs(Ie-re);if(Ie<re-ln){m=c,b=i,S=Ms(p),L=Ie,q=d,j=$t[1],c=m,i=b,a=S,h=L,d=q,p=j;continue}if(Ie>re+ln)return{quantile:d,value:a,consumed:h,rest:p};switch(a._tag){case"None":{m=c,b=i,S=Ms(p),L=Ie,q=d,j=$t[1],c=m,i=b,a=S,h=L,d=q,p=j;continue}case"Some":{const Os=Math.abs(re-a.value);if(Hf<Os){m=c,b=i,S=Ms(p),L=Ie,q=d,j=$t[1],c=m,i=b,a=S,h=L,d=q,p=j;continue}return{quantile:d,value:v(a.value),consumed:h,rest:p}}}}throw new Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/effect/issues")},r0="effect/MetricPair",s0=Symbol.for(r0),o0={_Type:t=>t},c0=(t,e)=>({[s0]:o0,metricKey:t,metricState:e,pipe(){return k(this,arguments)}}),i0="effect/MetricRegistry",ta=Symbol.for(i0);var o$;class a0{constructor(){l(this,o$,ta);l(this,"map",Fy())}snapshot(){const e=[];for(const[n,r]of this.map)e.push(c0(n,r.get()));return ic(e)}get(e){const n=f(this.map,ae(e),ie);if(n==null){if(cf(e.keyType))return this.getCounter(e);if(kS(e.keyType))return this.getGauge(e);if($S(e.keyType))return this.getFrequency(e);if(af(e.keyType))return this.getHistogram(e);if(ES(e.keyType))return this.getSummary(e);throw new Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/effect/issues")}else return n}getCounter(e){let n=f(this.map,ae(e),ie);if(n==null){const r=QS(e);f(this.map,fn(e))||f(this.map,hn(e,r)),n=r}return n}getFrequency(e){let n=f(this.map,ae(e),ie);if(n==null){const r=XS();f(this.map,fn(e))||f(this.map,hn(e,r)),n=r}return n}getGauge(e){let n=f(this.map,ae(e),ie);if(n==null){const r=ZS(e,e.keyType.bigint?BigInt(0):0);f(this.map,fn(e))||f(this.map,hn(e,r)),n=r}return n}getHistogram(e){let n=f(this.map,ae(e),ie);if(n==null){const r=t0(e);f(this.map,fn(e))||f(this.map,hn(e,r)),n=r}return n}getSummary(e){let n=f(this.map,ae(e),ie);if(n==null){const r=e0(e);f(this.map,fn(e))||f(this.map,hn(e,r)),n=r}return n}}o$=ta;const u0=()=>new a0,l0="effect/Metric",f0=Symbol.for(l0),h0={_Type:t=>t,_In:t=>t,_Out:t=>t},g0=P(Symbol.for("effect/Metric/globalMetricRegistry"),()=>u0()),df=function(t,e,n){return Object.assign(s=>sn(s,o=>_(()=>e(o,Mt()))),{[f0]:h0,keyType:t,unsafeUpdate:e,unsafeValue:n,pipe(){return k(this,arguments)}})},Ss=(t,e)=>mf(RS(t,e)),mf=t=>{const e=n=>{const r=f(t,TS(n));return g0.get(r)};return df(t.keyType,(n,r)=>e(r).update(n),n=>e(n).get())},p0=(t,e,n)=>mf(MS(t,e,n)),d0=u(3,(t,e,n)=>m0(t,rs(X_(e,n)))),m0=u(2,(t,e)=>{const n=lp(e)?e:ic(e);return df(t.keyType,(r,s)=>t.unsafeUpdate(r,f(n,Xt(s))),r=>t.unsafeValue(f(n,Xt(r))))}),y0=u(2,(t,e)=>Qn(Zl,n=>_(()=>{if(n.has(t)){const r=n.get(t);r.state.completed||(r.state.completed=!0,Ic(r.result,e))}}))),_0="effect/Supervisor",vs=Symbol.for(_0),Uc={_T:t=>t};var c$;const ei=class{constructor(e,n){l(this,"underlying");l(this,"value0");l(this,c$,Uc);this.underlying=e,this.value0=n}get value(){return this.value0}onStart(e,n,r,s){this.underlying.onStart(e,n,r,s)}onEnd(e,n){this.underlying.onEnd(e,n)}onEffect(e,n){this.underlying.onEffect(e,n)}onSuspend(e){this.underlying.onSuspend(e)}onResume(e){this.underlying.onResume(e)}map(e){return new ei(this,f(this.value,F(e)))}zip(e){return new zr(this,e)}};let Br=ei;c$=vs;var i$;const ni=class{constructor(e,n){l(this,"left");l(this,"right");l(this,"_tag","Zip");l(this,i$,Uc);this.left=e,this.right=n}get value(){return cl(this.left.value,this.right.value)}onStart(e,n,r,s){this.left.onStart(e,n,r,s),this.right.onStart(e,n,r,s)}onEnd(e,n){this.left.onEnd(e,n),this.right.onEnd(e,n)}onEffect(e,n){this.left.onEffect(e,n),this.right.onEffect(e,n)}onSuspend(e){this.left.onSuspend(e),this.right.onSuspend(e)}onResume(e){this.left.onResume(e),this.right.onResume(e)}map(e){return new Br(this,f(this.value,F(e)))}zip(e){return new ni(this,e)}};let zr=ni;i$=vs;const yf=t=>I(t,vs)&&ya(t,"Zip");var a$;class b0{constructor(e){l(this,"effect");l(this,a$,Uc);this.effect=e}get value(){return this.effect}onStart(e,n,r,s){}onEnd(e,n){}onEffect(e,n){}onSuspend(e){}onResume(e){}map(e){return new Br(this,f(this.value,F(e)))}zip(e){return new zr(this,e)}onRun(e,n){return e()}}a$=vs;const S0=t=>new b0(t),ws=P("effect/Supervisor/none",()=>S0(N)),v0=Kn,_f="Empty",bf="AddSupervisor",Sf="RemoveSupervisor",vf="AndThen",vn={_tag:_f},_r=(t,e)=>({_tag:vf,first:t,second:e}),w0=(t,e)=>$0(e,lt(t)),$0=(t,e)=>{let n=t,r=e;for(;pe(r);){const s=de(r);switch(s._tag){case _f:{r=Jt(r);break}case bf:{n=n.zip(s.supervisor),r=Jt(r);break}case Sf:{n=Po(n,s.supervisor),r=Jt(r);break}case vf:{r=mt(s.first)(mt(s.second)(Jt(r)));break}}}return n},Po=(t,e)=>O(t,e)?ws:yf(t)?Po(t.left,e).zip(Po(t.right,e)):t,Wr=t=>O(t,ws)?Mt():yf(t)?f(Wr(t.left),Xt(Wr(t.right))):rs(t),k0=(t,e)=>{if(O(t,e))return vn;const n=Wr(t),r=Wr(e),s=f(r,hi(n),Or(vn,(c,i)=>_r(c,{_tag:bf,supervisor:i}))),o=f(n,hi(r),Or(vn,(c,i)=>_r(c,{_tag:Sf,supervisor:i})));return _r(s,o)},E0=v0({empty:vn,patch:w0,combine:_r,diff:k0}),O0=Ss("effect_fiber_started"),ea=Ss("effect_fiber_active"),I0=Ss("effect_fiber_successes"),F0=Ss("effect_fiber_failures"),R0=d0(p0("effect_fiber_lifetimes",fS({start:1,factor:1.3,count:100})),"time_unit","milliseconds"),gn="Continue",M0="Done",na="Yield",T0={_E:t=>t,_A:t=>t},pn=t=>{throw new Error(`BUG: FiberRuntime - ${JSON.stringify(t)} - please report an issue at https://github.com/Effect-TS/effect/issues`)},lr={[vr]:(t,e,n)=>e.i1(n),OnStep:(t,e,n)=>e.i1(et(n)),[wr]:(t,e,n)=>e.i2(n),[Ho]:(t,e,n)=>(t.patchRuntimeFlags(t._runtimeFlags,e.patch),zt(t._runtimeFlags)&&t.isInterrupted()?x(t.getInterruptedCause()):et(n)),[$r]:(t,e,n)=>(e.i2(n),e.i0()?(t.pushStack(e),e.i1()):N)},C0={[Lc]:(t,e,n,r)=>(t.processNewInterruptSignal(r.cause),zt(e)?x(r.cause):n),[Dc]:(t,e,n,r)=>{throw new Error("It is illegal to have multiple concurrent run loops in a single fiber")},[xc]:(t,e,n,r)=>(r.onFiber(t,Xl(e)),n),[qc]:(t,e,n,r)=>g(Gn(),()=>n)},N0=t=>Hn(Id(t),e=>Ge(jd(e),([n,r])=>{const s=new Map;for(const o of r)for(const c of o)s.set(c.request,c);return on(tv(n.runAll(r),r.flat()),Zl,s)},!1));var u$,l$;class wf{constructor(e,n,r){l(this,u$,Yb);l(this,l$,T0);l(this,"_fiberRefs");l(this,"_fiberId");l(this,"_runtimeFlags");l(this,"_queue",new Array);l(this,"_children",null);l(this,"_observers",new Array);l(this,"_running",!1);l(this,"_stack",[]);l(this,"_asyncInterruptor",null);l(this,"_asyncBlockingOn",null);l(this,"_exitValue",null);l(this,"_steps",[!1]);l(this,"_supervisor");l(this,"_scheduler");l(this,"_tracer");l(this,"currentOpCount",0);l(this,"isYielding",!1);l(this,"run",()=>{this.drainQueueOnCurrentThread()});if(this._runtimeFlags=r,this._fiberId=e,this._fiberRefs=n,this._supervisor=this.getFiberRef(ia),this._scheduler=this.getFiberRef(Kr),Cs(r)){const s=this.getFiberRef(As);O0.unsafeUpdate(1,s),ea.unsafeUpdate(1,s)}this._tracer=Ht(this.getFiberRef(he),ro)}pipe(){return k(this,arguments)}id(){return this._fiberId}resume(e){this.tell(Re(e))}get status(){return this.ask((e,n)=>n)}get runtimeFlags(){return this.ask((e,n)=>qb(n)?e._runtimeFlags:n.runtimeFlags)}scope(){return Vb(this)}get children(){return this.ask(e=>Array.from(e.getChildren()))}getChildren(){return this._children===null&&(this._children=new Set),this._children}getInterruptedCause(){return this.getFiberRef(ur)}fiberRefs(){return this.ask(e=>e.getFiberRefs())}ask(e){return T(()=>{const n=kc(this._fiberId);return this.tell(yr((r,s)=>{Ic(n,_(()=>e(r,s)))})),ms(n)})}tell(e){this._queue.push(e),this._running||(this._running=!0,this.drainQueueLaterOnExecutor())}get await(){return ze(e=>{const n=r=>e($(r));return this.tell(yr((r,s)=>{r._exitValue!==null?n(this._exitValue):r.addObserver(n)})),_(()=>this.tell(yr((r,s)=>{r.removeObserver(n)})))},this.id())}get inheritAll(){return rt((e,n)=>{const r=e.id(),s=e.getFiberRefs(),o=n.runtimeFlags,c=this.getFiberRefs(),i=M_(s,r,c);e.setFiberRefs(i);const a=e.getFiberRef(ca),h=f(De(o,a),yi(Ze),yi(to));return oo(h)})}get poll(){return _(()=>xn(this._exitValue))}unsafePoll(){return this._exitValue}interruptAsFork(e){return _(()=>this.tell(Yi(It(e))))}addObserver(e){this._exitValue!==null?e(this._exitValue):this._observers.push(e)}removeObserver(e){this._observers=this._observers.filter(n=>n!==e)}getFiberRefs(){return this.setFiberRef(ca,this._runtimeFlags),this._fiberRefs}unsafeDeleteFiberRef(e){this._fiberRefs=Tl(this._fiberRefs,e)}getFiberRef(e){return this._fiberRefs.locals.has(e)?this._fiberRefs.locals.get(e)[0][1]:e.initial}setFiberRef(e,n){this._fiberRefs=Dr(this._fiberRefs,{fiberId:this._fiberId,fiberRef:e,value:n}),this.refreshRefCache()}refreshRefCache(){this._tracer=Ht(this.getFiberRef(he),ro),this._supervisor=this.getFiberRef(ia),this._scheduler=this.getFiberRef(Kr)}setFiberRefs(e){this._fiberRefs=e,this.refreshRefCache()}addChild(e){this.getChildren().add(e)}removeChild(e){this.getChildren().delete(e)}drainQueueOnCurrentThread(){let e=!0;for(;e;){let n=gn;const r=globalThis[se];globalThis[se]=this;try{for(;n===gn;)n=this._queue.length===0?M0:this.evaluateMessageWhileSuspended(this._queue.splice(0,1)[0])}finally{this._running=!1,globalThis[se]=r}this._queue.length>0&&!this._running?(this._running=!0,n===na?(this.drainQueueLaterOnExecutor(),e=!1):e=!0):e=!1}}drainQueueLaterOnExecutor(){this._scheduler.scheduleTask(this.run,this.getFiberRef(ds))}drainQueueWhileRunning(e,n){let r=n;for(;this._queue.length>0;){const s=this._queue.splice(0,1)[0];r=C0[s._tag](this,e,r,s)}return r}isInterrupted(){return!Bd(this.getFiberRef(ur))}addInterruptedCause(e){const n=this.getFiberRef(ur);this.setFiberRef(ur,tt(n,e))}processNewInterruptSignal(e){this.addInterruptedCause(e),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(this._children===null||this._children.size===0)return!1;let e=!1;for(const n of this._children)n.tell(Yi(It(this.id()))),e=!0;return e}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){const e=this._children.values();this._children=null;let n=!1;return Cr({while:()=>!n,body:()=>{const s=e.next();return s.done?_(()=>{n=!0}):ut(s.value.await)},step:()=>{}})}return null}reportExitValue(e){if(Cs(this._runtimeFlags)){const n=this.getFiberRef(As);switch(ea.unsafeUpdate(-1,n),e._tag){case Y:{I0.unsafeUpdate(1,n);break}case G:{F0.unsafeUpdate(1,n);break}}}if(e._tag==="Failure"){const n=this.getFiberRef(Ym);!as(e.cause)&&n._tag==="Some"&&this.log("Fiber terminated with a non handled error",e.cause,n)}}setExitValue(e){if(this._exitValue=e,Cs(this._runtimeFlags)){const n=this.getFiberRef(As),r=this.id().startTimeMillis,s=new Date().getTime();R0.unsafeUpdate(s-r,n)}this.reportExitValue(e);for(let n=this._observers.length-1;n>=0;n--)this._observers[n](e)}getLoggers(){return this.getFiberRef(D0)}log(e,n,r){const s=A(r)?r.value:this.getFiberRef(Wm),o=this.getFiberRef(A0);if(U_(o,s))return;const c=this.getFiberRef(Jm),i=this.getFiberRef(zm),a=this.getLoggers(),h=this.getFiberRefs();if(ac(a)>0){const d=Ht(this.getFiberRef(he),_s),p=new Date(d.unsafeCurrentTimeMillis());for(const m of a)m.log({fiberId:this.id(),logLevel:s,message:e,cause:n,context:h,spans:c,annotations:i,date:p})}}evaluateMessageWhileSuspended(e){switch(e._tag){case qc:return na;case Lc:return this.processNewInterruptSignal(e.cause),this._asyncInterruptor!==null&&(this._asyncInterruptor(x(e.cause)),this._asyncInterruptor=null),gn;case Dc:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(e.effect),gn;case xc:return e.onFiber(this,this._exitValue!==null?xb:Db(this._runtimeFlags,this._asyncBlockingOn)),gn;default:return pn(e)}}evaluateEffect(e){this._supervisor.onResume(this);try{let n=zt(this._runtimeFlags)&&this.isInterrupted()?x(this.getInterruptedCause()):e;for(;n!==null;)try{const r=n,s=this.runLoop(r);this._runtimeFlags=f(this._runtimeFlags,$d(to));const o=this.interruptAllChildren();o!==null?n=g(o,()=>s):(this._queue.length===0?this.setExitValue(s):this.tell(Re(s)),n=null)}catch(r){if(te(r))r._op===pr?wd(this._runtimeFlags)?(this.tell(Bb()),this.tell(Re(Vt)),n=null):n=Vt:r._op===hr&&(n=null);else throw r}}finally{this._supervisor.onSuspend(this)}}start(e){if(this._running)this.tell(Re(e));else{this._running=!0;const n=globalThis[se];globalThis[se]=this;try{this.evaluateEffect(e)}finally{this._running=!1,globalThis[se]=n,this._queue.length>0&&this.drainQueueLaterOnExecutor()}}}startFork(e){this.tell(Re(e))}patchRuntimeFlags(e,n){const r=eo(e,n);return globalThis[se]=this,this._runtimeFlags=r,r}initiateAsync(e,n){let r=!1;const s=o=>{r||(r=!0,this.tell(Re(o)))};zt(e)&&(this._asyncInterruptor=s);try{n(s)}catch(o){s(D(ct(o)))}}pushStack(e){this._stack.push(e),e._op==="OnStep"&&this._steps.push(!0),e._op==="RevertFlags"&&this._steps.push(!1)}popStack(){const e=this._stack.pop();if(e)return(e._op==="OnStep"||e._op==="RevertFlags")&&this._steps.pop(),e}getNextSuccessCont(){let e=this.popStack();for(;e;){if(e._op!==gr)return e;e=this.popStack()}}getNextFailCont(){let e=this.popStack();for(;e;){if(e._op!==vr&&e._op!==$r)return e;e=this.popStack()}}[(u$=Gb,l$=Xb,ph)](e){return F(ps(ee),n=>{try{return Xo(n,e)}catch(r){throw console.log(r),r}})}Left(e){return J(e.left)}None(e){return J(mc())}Right(e){return et(e.right)}Some(e){return et(e.value)}[$a](e){const n=e.i0(),r=this.getNextSuccessCont();if(r!==void 0)return r._op in lr||pn(r),lr[r._op](this,r,n);throw et(n)}[Y](e){const n=e,r=this.getNextSuccessCont();if(r!==void 0)return r._op in lr||pn(r),lr[r._op](this,r,n.i0);throw n}[G](e){const n=e.i0,r=this.getNextFailCont();if(r!==void 0)switch(r._op){case gr:case wr:return zt(this._runtimeFlags)&&this.isInterrupted()?x(Rr(n)):r.i1(n);case"OnStep":return zt(this._runtimeFlags)&&this.isInterrupted()?x(Rr(n)):r.i1(x(n));case Ho:return this.patchRuntimeFlags(this._runtimeFlags,r.patch),zt(this._runtimeFlags)&&this.isInterrupted()?x(tt(n,this.getInterruptedCause())):x(n);default:pn(r)}else throw x(n)}[ka](e){return e.i0(this,Xl(this._runtimeFlags))}Blocked(e){if(this._steps[this._steps.length-1]){const n=this.popStack();if(n)switch(n._op){case"OnStep":return n.i1(e);case"OnSuccess":return ot(e.i0,g(e.i1,n.i1));case"OnSuccessAndFailure":return ot(e.i0,Q(e.i1,{onFailure:n.i1,onSuccess:n.i2}));case"OnFailure":return ot(e.i0,Xu(e.i1,n.i1));case"While":return ot(e.i0,g(e.i1,r=>(n.i2(r),n.i0()?Cr({while:n.i0,body:n.i1,step:n.i2}):N)));case"RevertFlags":{this.pushStack(n);break}}}return vt(n=>g(br(_m(e.i0)),()=>n(e.i1)))}RunBlocked(e){return N0(e.i0)}[Ye](e){const n=e.i0,r=this._runtimeFlags,s=eo(r,n);if(zt(s)&&this.isInterrupted())return x(this.getInterruptedCause());if(this.patchRuntimeFlags(this._runtimeFlags,n),e.i1){const o=De(s,r);return this.pushStack(new bm(o,e)),e.i1(r)}else return Vt}[vr](e){return this.pushStack(e),e.i0}OnStep(e){return this.pushStack(e),e.i0}[gr](e){return this.pushStack(e),e.i0}[wr](e){return this.pushStack(e),e.i0}[hr](e){throw this._asyncBlockingOn=e.i1,this.initiateAsync(this._runtimeFlags,e.i0),e}[pr](e){throw this.isYielding=!1,e}[$r](e){const n=e.i0,r=e.i1;return n()?(this.pushStack(e),r()):Vt}[wa](e){return e.commit()}runLoop(e){let n=e;for(this.currentOpCount=0;;){if(this._runtimeFlags&vd&&this._supervisor.onEffect(this,n),this._queue.length>0&&(n=this.drainQueueWhileRunning(this._runtimeFlags,n)),!this.isYielding){this.currentOpCount+=1;const r=this._scheduler.shouldYield(this);if(r!==!1){this.isYielding=!0,this.currentOpCount=0;const s=n;n=g(Gn({priority:r}),()=>s)}}try{(!("_op"in n)||!(n._op in this))&&(console.log(n),pn(n)),n=this._tracer.context(()=>Sr!==n[Wi]._V?tl(`Cannot execute an Effect versioned ${n[Wi]._V} with a Runtime of version ${Sr}`):this[n._op](n),this)}catch(r){if(te(r)){if(r._op===pr||r._op===hr)throw r;if(r._op===Y||r._op===G)return r}else mm(r)?n=x(r.cause):cm(r)?n=x(tt(ct(r),It(qn))):n=x(ct(r))}}}}const A0=P("effect/FiberRef/currentMinimumLogLevel",()=>ht(B_("Info"))),P0=t=>{const e=C_(t,he);return Ht(e,Il).unsafe},L0=P(Symbol.for("effect/Logger/defaultLogger"),()=>jc(t=>{const e=sS.log(t);P0(t.context).log(e)})),x0=P(Symbol.for("effect/Logger/tracerLogger"),()=>jc(({annotations:t,cause:e,context:n,fiberId:r,logLevel:s,message:o})=>{const c=qa(yo(n,ee),$e(Gu)),i=bn(yo(n,he),h=>Ht(h,_s));if(c._tag==="None"||c.value._tag==="ExternalSpan"||i._tag==="None")return;const a=Object.fromEntries($u(t,h=>Oo(h)));a["effect.fiberId"]=Ep(r),a["effect.logLevel"]=s.label,e!==null&&e._tag!=="Empty"&&(a["effect.cause"]=us(e)),c.value.event(String(o),i.value.unsafeCurrentTimeNanos(),a)})),D0=P(Symbol.for("effect/FiberRef/currentLoggers"),()=>ll(rs(L0,x0))),q0=u(t=>te(t[0]),(t,e)=>Ve(sn(t,n=>$f(r=>e(n,r))))),$f=t=>rt(e=>{const n=e.getFiberRefs(),r=e._runtimeFlags;return g(If,s=>Nr(s,o=>rt(c=>{const i=c.getFiberRefs(),a=c._runtimeFlags,h=jr(i,n),d=De(a,r),p=jr(n,i);return c.setFiberRefs(Ji(h,c.id(),n)),Wc(Mm(t(o),d),_(()=>{c.setFiberRefs(Ji(p,c.id(),c.getFiberRefs()))}))})))}),j0=t=>{if(Array.isArray(t)||_a(t))return[t,w()];const e=Object.keys(t),n=e.length;return[e.map(r=>t[r]),v(r=>{const s={};for(let o=0;o<n;o++)s[e[o]]=r[o];return s})]},K0=(t,e,n)=>{const r=[];for(const s of t)r.push(Mn(s));return g(He(r,K,{concurrency:n?.concurrency,batching:n?.batching}),s=>{const o=w(),c=s.length,i=new Array(c),a=new Array(c);let h=!1;for(let d=0;d<c;d++){const p=s[d];p._tag==="Left"?(i[d]=v(p.left),h=!0):(a[d]=p.right,i[d]=o)}return h?e._tag==="Some"?J(e.value(i)):J(i):n?.discard?N:e._tag==="Some"?$(e.value(a)):$(a)})},U0=(t,e,n)=>{const r=[];for(const s of t)r.push(Mn(s));return n?.discard?He(r,K,{concurrency:n?.concurrency,batching:n?.batching,discard:!0}):F(He(r,K,{concurrency:n?.concurrency,batching:n?.batching}),s=>e._tag==="Some"?e.value(s):s)},kf=(t,e)=>{const[n,r]=j0(t);return e?.mode==="validate"?K0(n,r,e):e?.mode==="either"?U0(n,r,e):r._tag==="Some"?F(He(n,K,e),r.value):He(n,K,e)},He=u(t=>_a(t[0]),(t,e,n)=>rt(r=>{const s=n?.batching===!0||n?.batching==="inherit"&&r.getFiberRef(Gm);return n?.discard?Gi(n.concurrency,()=>Me(wo)(o=>s?Lo(t,(c,i)=>o(e(c,i))):Hn(t,(c,i)=>o(e(c,i)))),()=>Me($o)(o=>Ge(t,(c,i)=>o(e(c,i)),s)),o=>Me(ko(o))(c=>zc(t,o,(i,a)=>c(e(i,a)),s))):Gi(n?.concurrency,()=>Me(wo)(o=>s?xo(t,1,(c,i)=>o(e(c,i)),!0):Ot(t,(c,i)=>o(e(c,i)))),()=>Me($o)(o=>Bc(t,(c,i)=>o(e(c,i)),s)),o=>Me(ko(o))(c=>xo(t,o,(i,a)=>c(e(i,a)),s)))})),Bc=(t,e,n)=>T(()=>{const r=nt(t),s=new Array(r.length);return at(Ge(r,(c,i)=>g(e(c,i),a=>_(()=>s[i]=a)),n),$(s))}),Lo=(t,e)=>T(()=>{const n=nt(t),r=n.length;if(r===0)return N;if(r===1)return ut(e(n[0],0));const s=n.map(e),o=new Array,c=i=>i===s.length?T(()=>{if(o.length>0){const a=o.map(h=>h.i0).reduce(qe);return ot(a,Lo(o.map(h=>h.i1),K))}return N}):vc(s[i],a=>a._op==="Blocked"?(o.push(a),c(i+1)):a._op==="Failure"?T(()=>{if(o.length>0){const h=o.map(d=>d.i0).reduce(qe);return ot(h,g(Lo(o.map(d=>d.i1),K),()=>a))}return N}):c(i+1));return c(0)}),Ge=(t,e,n)=>T(()=>{const r=nt(t),s=r.length;return s===0?N:s===1?ut(e(r[0],0)):vt(o=>{const c=kc(qn);let i=0;const a=[],h=[],d=Im(p=>Ot(r,(m,b)=>f(p(f(T(()=>o((n?We:dt)(e(m,b)))),g(S=>{switch(S._op){case"Failure":{if(a.length>0){const L=a.map(j=>j.i0).reduce(qe),q=Ge(a,j=>j.i1,n);return ot(L,Q(q,{onFailure:j=>at(xs(c,void 0),D(ft(j,S.cause))),onSuccess:()=>at(xs(c,void 0),D(S.cause))}))}return at(xs(c,void 0),D(S.cause))}default:{if(S._op==="Blocked"&&a.push(S),i+1===s)if(a.length>0){const L=a.map(j=>j.i0).reduce(qe),q=Ge(a,j=>j.i1,n);return ys(c,ot(L,q))}else Ic(c,et(Vt));else i=i+1;return N}}}))),$s,F(S=>(S.addObserver(()=>{h.push(S)}),S)))));return g(d,p=>Q(o(ms(c)),{onFailure:m=>g(Bc(p,Yn,n),b=>{const S=mr(b,{parallel:!0});return S._tag==="Some"&&ty(S.value)?D(ft(Rr(m),S.value.i0)):D(Rr(m))}),onSuccess:m=>g(m,()=>Hn(h,b=>b.inheritAll))}))})}),xo=(t,e,n,r)=>T(()=>{const s=nt(t),o=new Array(s.length);return at(zc(s,e,(i,a)=>F(n(i,a),h=>o[a]=h),r),$(o))}),zc=(t,e,n,r)=>T(()=>{let s=0;const o=t[Symbol.iterator](),c=[],i=g(_(()=>o.next()),h=>h.done?N:g((r?We:dt)(ut(n(h.value,s++))),d=>{switch(d._op){case"Blocked":return c.push(d),i;case"Failure":return d;case"Success":return i}})),a=[];for(let h=0;h<e;h++)a.push(i);return g(dt(Ge(a,K,r)),h=>{if(c.length===0)return h;const d=c.map(m=>m.i0).reduce(qe),p=zc(c,e,m=>m.i1,r);return h._tag==="Failure"?ot(d,Q(p,{onFailure:m=>x(ft(h.cause,m)),onSuccess:()=>h})):ot(d,p)})}),br=t=>rt((e,n)=>$(Ef(t,e,n.runtimeFlags))),$s=t=>B0(t,tf),Ef=(t,e,n,r=null)=>{const s=Do(t,e,n,r);return s.resume(t),s},Do=(t,e,n,r=null)=>{const s=Su(),o=e.getFiberRefs(),c=Ml(o,s),i=new wf(s,c,n),a=Tc(c,ee),h=i._supervisor;return h.onStart(a,t,v(e),i),i.addObserver(p=>h.onEnd(p,i)),(r!==null?r:f(e.getFiberRef(io),Nt(()=>e.scope()))).add(n,i),i},B0=(t,e)=>rt((n,r)=>$(Ef(t,n,r.runtimeFlags,e))),z0=t=>{const e=Dn(t);if(!pe(e))return Sm(()=>Ju("Received an empty collection of effects"));const n=de(e),r=Jt(e),s=o=>f(tS(o[1]),it(o[0]));return f(Ec(),g(o=>f(H_(r.length),g(c=>vt(i=>f(br(Je(n)),g(a=>f(r,Ot(h=>br(Je(h))),F(St),F(h=>f(h,mt(a))),sn(h=>f(h,Yt(N,(d,p)=>f(d,at(f(Zb(p),g(W0(h,p,o,c)),br,ut)))))),g(h=>f(i(f(fy(o),g(s))),ol(()=>f(h,Yt(N,(d,p)=>f(d,gs(Yn(p))))))))))))))))},W0=(t,e,n,r)=>s=>Pr(s,{onFailure:o=>f(G_(r,c=>[c===0?f(Oc(n,o),ut):N,c-1]),Jn),onSuccess:o=>f(ys(n,[o,e]),g(c=>c?f(Dn(t),Yt(N,(i,a)=>a===e?i:f(i,gs(Yn(a))))):N))}),ra=t=>cn(e=>jt($e(e,Oe),{onNone:()=>t,onSome:n=>{switch(n.strategy._tag){case"Parallel":return t;case"Sequential":case"ParallelN":return g(wc(n,$o),r=>or(t,r))}}})),sa=t=>e=>cn(n=>jt($e(n,Oe),{onNone:()=>e,onSome:r=>r.strategy._tag==="ParallelN"&&r.strategy.parallelism===t?e:g(wc(r,ko(t)),s=>or(e,s))})),Me=t=>e=>cn(n=>jt($e(n,Oe),{onNone:()=>e(K),onSome:r=>{const s=t._tag==="Parallel"?ra:t._tag==="Sequential"?oa:sa(t.parallelism);switch(r.strategy._tag){case"Parallel":return s(e(ra));case"Sequential":return s(e(oa));case"ParallelN":return s(e(sa(r.strategy.parallelism)))}}})),Of=t=>g(Oe,t),J0=t=>g(ks(),e=>Q0(e)(t)),oa=t=>cn(e=>jt($e(e,Oe),{onNone:()=>t,onSome:n=>{switch(n.strategy._tag){case"Sequential":return t;case"Parallel":case"ParallelN":return g(wc(n,wo),r=>or(t,r))}}})),V0=u(t=>te(t[1]),(t,e,n)=>sr(t,e,(r,s)=>[r,s],n)),H0=u(t=>te(t[1]),(t,e,n)=>sr(t,e,(r,s)=>r,n)),G0=u(t=>te(t[1]),(t,e,n)=>sr(t,e,(r,s)=>s,n)),sr=u(t=>te(t[1]),(t,e,n,r)=>F(kf([t,e],{concurrency:r?.concurrent?2:1,batching:r?.batching}),([s,o])=>n(s,o))),Y0=(t,e)=>n=>T(()=>{switch(n.state._tag){case"Exited":return N;case"Running":{const r=n.state.finalizers,s=n.state.update,o=Array.from(r.keys()).sort((c,i)=>i-c).map(c=>r.get(c));return n.state={_tag:"Exited",nextKey:n.state.nextKey,exit:e,update:s},Fb(t)?f(o,Ot(c=>dt(s(c)(e))),g(c=>f(mr(c),bn(Ps),Nt(()=>Vt)))):Rb(t)?f(Bc(o,c=>dt(s(c)(e)),!1),g(c=>f(mr(c,{parallel:!0}),bn(Ps),Nt(()=>Vt)))):f(xo(o,t.parallelism,c=>dt(s(c)(e)),!1),g(c=>f(mr(c,{parallel:!0}),bn(Ps),Nt(()=>Vt))))}}}),Oe=yt(ao),If=Oe,ks=(t=Ac)=>F(Zm,e=>({[ao]:ao,[Mi]:Mi,strategy:t,pipe(){return k(this,arguments)},fork:n=>Ve(f(ks(n),g(r=>f(Ti(e,s=>Ar(r,s)),sn(s=>Nr(r,s)),it(r))))),close:n=>ut(Y0(t,n)(e)),addFinalizer:n=>ut(Ti(n)(e))})),or=u(2,(t,e)=>gl(t,Yr(Gr(Oe,e)))),Q0=u(2,(t,e)=>f(t,or(e),Cn(n=>e.close(n)))),X0=t=>Xn(t,{differ:E0,fork:vn}),ca=Um(kd),ia=X0(ws),Ff=u(3,(t,e,n)=>Z0(t,e,{onSelfWin:(r,s)=>g(r.await,o=>{switch(o._tag){case Y:return g(r.inheritAll,()=>n.onSelfDone(o,s));case G:return n.onSelfDone(o,s)}}),onOtherWin:(r,s)=>g(r.await,o=>{switch(o._tag){case Y:return g(r.inheritAll,()=>n.onOtherDone(o,s));case G:return n.onOtherDone(o,s)}})})),Rf=u(2,(t,e)=>hs(n=>Ff(t,e,{onSelfDone:(r,s)=>Pr(r,{onFailure:o=>f(Qi(s),zi(c=>ft(o,c))),onSuccess:o=>f(s,co(n),it(o))}),onOtherDone:(r,s)=>Pr(r,{onFailure:o=>f(Qi(s),zi(c=>ft(c,o))),onSuccess:o=>f(s,co(n),it(o))})}))),Z0=u(3,(t,e,n)=>rt((r,s)=>{const o=s.runtimeFlags,c=Xe(!0),i=Do(t,r,o,n.selfScope),a=Do(e,r,o,n.otherScope);return ze(h=>{i.addObserver(()=>aa(i,a,n.onSelfWin,c,h)),a.addObserver(()=>aa(a,i,n.onOtherWin,c,h)),i.startFork(t),a.startFork(e)},kp(i.id(),a.id()))})),aa=(t,e,n,r,s)=>{gp(!0,!1)(r)&&s(n(t,e))},Wc=u(2,(t,e)=>vt(n=>Q(n(t),{onFailure:r=>Q(e,{onFailure:s=>D(tt(r,s)),onSuccess:()=>D(r)}),onSuccess:r=>it(e,r)}))),tv=(t,e)=>hs(n=>g(g($s(Je(t)),r=>ze(s=>{const o=e.map(a=>a.listeners.count),c=()=>{o.every(a=>a===0)&&(i.forEach(a=>a()),s(Yn(r)))};r.addObserver(a=>{i.forEach(h=>h()),s(a)});const i=e.map((a,h)=>{const d=p=>{o[h]=p,c()};return a.listeners.addObserver(d),()=>a.listeners.removeObserver(d)});return c(),_(()=>{i.forEach(a=>a())})})),()=>T(()=>{const r=e.flatMap(s=>s.state.completed?[]:[s]);return Hn(r,s=>y0(s.request,sy(n)))}))),K$=Se,U$=ct,B$=It,z$=Ud,W$=zd,J$=as,ev=zu,V$=Hd,H$=Xd,G$=Ju,nv=u(2,(t,e)=>Jc(t,n=>_(()=>e(n)))),Jc=u(2,(t,e)=>g(t,n=>g(e(n),r=>r?$(n):g(Gn(),()=>Jc(t,e))))),rv=u(2,(t,e)=>sv(t,n=>_(()=>e(n)))),sv=u(2,(t,e)=>Jc(t,n=>hb(e(n)))),ov=u(2,(t,e)=>Mf(t,e)),Mf=(t,e)=>Mr(t,n=>e<0?J(n):g(Gn(),()=>Mf(t,e-1)));class cv{constructor(e){l(this,"permits");l(this,"waiters",new Array);l(this,"taken",0);l(this,"take",e=>_c(n=>{if(this.free<e){const r=()=>{if(this.free>=e){const s=this.waiters.findIndex(o=>o===r);s!==-1&&this.waiters.splice(s,1),this.taken+=e,n($(e))}};return this.waiters.push(r),Ft(_(()=>{const s=this.waiters.findIndex(o=>o===r);s!==-1&&this.waiters.splice(s,1)}))}return this.taken+=e,pt($(e))}));l(this,"release",e=>rt(n=>(this.taken-=e,n.getFiberRef(Kr).scheduleTask(()=>{this.waiters.forEach(r=>r())},n.getFiberRef(ds)),N)));l(this,"withPermits",e=>n=>vt(r=>g(r(this.take(e)),s=>Wc(r(n),this.release(s)))));this.permits=e}get free(){return this.permits-this.taken}}const Tf=t=>new cv(t),iv=t=>_(()=>Tf(t)),av=u(2,(t,e)=>vt(n=>g(e.fork(Ac),r=>f(n(t),Cn(s=>r.close(s)),$s,sn(s=>r.addFinalizer(()=>hs(o=>O(o,s.id())?N:ut(Yn(s))))))))),uv=t=>Of(e=>av(t,e)),lv=u(2,(t,e)=>f(dt(t),Rf(dt(e)),n=>Jn(n))),fv="effect/Ref/SynchronizedRef",hv=Symbol.for(fv),gv={_A:t=>t};var f$,h$;class pv{constructor(e,n){l(this,"ref");l(this,"withLock");l(this,f$,gv);l(this,h$,Al);this.ref=e,this.withLock=n}modify(e){return this.modifyEffect(n=>$(e(n)))}modifyEffect(e){return this.withLock(f(g(qr(this.ref),e),g(([n,r])=>it(Cc(this.ref,r),n))))}pipe(){return k(this,arguments)}}f$=hv,h$=Nl;const dv=t=>_(()=>mv(t)),mv=t=>{const e=Pl(t),n=Tf(1);return new pv(e,n.withPermits(1))},yv="Fold",_v="Fresh",bv="FromEffect",Sv="Suspend",vv="ProvideTo",wv="ZipWith",$v=t=>(e,n)=>{const r=Su(),s=e;let o=Ui(t.fiberRefs,{fiberId:r,fiberRef:ee,value:t.context});n?.scheduler&&(o=Ui(o,{fiberId:r,fiberRef:Kr,value:n.scheduler})),n?.updateRefs&&(o=n.updateRefs(o,r));const c=new wf(r,T_(o,r),t.runtimeFlags),i=c._supervisor;return i!==ws&&(i.onStart(t.context,s,w(),c),c.addObserver(a=>i.onEnd(a,c))),tf.add(t.runtimeFlags,c),c.start(s),c},ua=Symbol.for("effect/Runtime/FiberFailure"),kv=Symbol.for("effect/Runtime/FiberFailure/Cause"),Ev=t=>{const e=Error.stackTraceLimit;Error.stackTraceLimit=0;const n=new Error;Error.stackTraceLimit=e;const r=Vu(t);if(r.length>0){const s=r[0];n.name=s.message.split(":")[0],n.message=s.message.substring(n.name.length+2),n.stack=us(t)}return n[ua]=ua,n[kv]=t,n.toJSON=()=>({_id:"FiberFailure",cause:t.toJSON()}),n.toString=()=>H(n.toJSON()),n[V]=()=>n.toJSON(),n},Ov=t=>{const e=t;switch(e._op){case"Failure":case"Success":return e;case"Left":return Ci(e.left);case"Right":return et(e.right);case"Some":return et(e.value);case"None":return Ci(mc())}},Iv=t=>e=>Fv(t)(e).then(n=>{switch(n._tag){case Y:return n.i0;case G:throw Ev(n.i0)}}),Fv=t=>e=>new Promise(n=>{const r=Ov(e);r&&n(r),$v(t)(e).addObserver(s=>{n(s)})});class Rv{constructor(e,n,r){l(this,"context");l(this,"runtimeFlags");l(this,"fiberRefs");this.context=e,this.runtimeFlags=n,this.fiberRefs=r}pipe(){return k(this,arguments)}}const Mv=t=>new Rv(t.context,t.runtimeFlags,t.fiberRefs),Tv=Pu(Ze,Nu,Cu),_n=Mv({context:Hr(),runtimeFlags:Tv,fiberRefs:N_()}),Cv=Iv(_n),Nv=u(2,(t,e)=>t.modifyEffect(e)),Av="effect/Layer",Cf=Symbol.for(Av),Pv={_RIn:t=>t,_E:t=>t,_ROut:t=>t},An={[Cf]:Pv,pipe(){return k(this,arguments)}},Lv=t=>I(t,Cf),xv=t=>t._tag===_v;class Dv{constructor(e){l(this,"ref");this.ref=e}getOrElseMemoize(e,n){return f(Nv(this.ref,r=>{const s=r.get(e);if(s!==void 0){const[o,c]=s,i=f(o,g(([a,h])=>f(vo(a),it(h))),Cn(hl({onFailure:()=>N,onSuccess:()=>Nr(n,c)})));return $([i,r])}return f(_o(0),g(o=>f(Ec(),g(c=>f(_o(()=>N),F(i=>{const a=vt(d=>f(ks(),g(p=>f(d(g(Af(e,p),m=>nb(m(this)))),dt,g(m=>{switch(m._tag){case G:return f(Oc(c,m.i0),at(Ar(p,m)),at(D(m.i0)));case Y:return f(Cc(i,b=>f(Ar(p,b),Rm(Ll(o,S=>[S===1,S-1])),ut)),at(bo(o,b=>b+1)),at(Nr(n,b=>f(qr(i),g(S=>S(b))))),at(ys(c,m.i0)),it(m.i0[1]))}}))))),h=[f(ms(c),Cn(Pr({onFailure:()=>N,onSuccess:()=>bo(o,d=>d+1)}))),d=>f(qr(i),g(p=>p(d)))];return[a,xv(e)?r:r.set(e,h)]}))))))}),Jn)}}const qv=()=>F(dv(new Map),t=>new Dv(t)),Nf=u(2,(t,e)=>g(qv(),n=>g(Af(t,e),r=>r(n)))),Af=(t,e)=>{const n=t;switch(n._tag){case"Locally":return _(()=>r=>n.f(r.getOrElseMemoize(n.self,e)));case"ExtendScope":return _(()=>r=>Of(s=>r.getOrElseMemoize(n.layer,s)));case"Fold":return _(()=>r=>f(r.getOrElseMemoize(n.layer,e),Q({onFailure:s=>r.getOrElseMemoize(n.failureK(s),e),onSuccess:s=>r.getOrElseMemoize(n.successK(s),e)})));case"Fresh":return _(()=>r=>f(n.layer,Nf(e)));case"FromEffect":return _(()=>r=>n.effect);case"ProvideTo":return _(()=>r=>f(r.getOrElseMemoize(n.first,e),g(s=>f(r.getOrElseMemoize(n.second,e),Rc(s)))));case"Scoped":return _(()=>r=>or(n.effect,e));case"Suspend":return _(()=>r=>r.getOrElseMemoize(n.evaluate(),e));case"ZipWith":return _(()=>r=>f(r.getOrElseMemoize(n.first,e),Tm(r.getOrElseMemoize(n.second,e),n.zipK)));case"ZipWithPar":return _(()=>r=>f(r.getOrElseMemoize(n.first,e),sr(r.getOrElseMemoize(n.second,e),n.zipK,{concurrent:!0})))}},jv=u(2,(t,e)=>Wv(t,{onFailure:e,onSuccess:Hv})),Kv=()=>un(Fc()),Uv=t=>un(D(t)),Bv=u(2,(t,e)=>{const n=Qo(t),r=n?t:e;return un(F(n?e:t,o=>Gr(r,o)))});function un(t){const e=Object.create(An);return e._tag=bv,e.effect=t,e}const zv=u(2,(t,{onFailure:e,onSuccess:n})=>{const r=Object.create(An);return r._tag=yv,r.layer=t,r.failureK=e,r.successK=n,r}),Wv=u(2,(t,{onFailure:e,onSuccess:n})=>zv(t,{onFailure:r=>{const s=ev(r);switch(s._tag){case"Left":return e(s.left);case"Right":return Uv(s.right)}},onSuccess:n})),Jv=u(2,(t,e)=>Gv(()=>{const n=Object.create(An);return n._tag=vv,n.first=Object.create(An,{_tag:{value:wv,enumerable:!0},first:{value:Kv(),enumerable:!0},second:{value:t},zipK:{value:(r,s)=>Yr(r,s)}}),n.second=e,n})),Vv=u(2,(t,e)=>{const n=Qo(t);return un($(Gr(n?t:e,n?e:t)))}),Hv=t=>un($(t)),Gv=t=>{const e=Object.create(An);return e._tag=Sv,e.evaluate=t,e},Yv=u(2,(t,e)=>jv(t,n=>un(g(e(n),()=>J(n))))),Qv=u(2,(t,e)=>Wn(ks(),n=>g(Nf(e,n),r=>Mc(t,r)),(n,r)=>Ar(n,r))),Xv=u(2,(t,e)=>{const n=De(_n.runtimeFlags,e.runtimeFlags),r=De(e.runtimeFlags,_n.runtimeFlags),s=jr(_n.fiberRefs,e.fiberRefs),o=jr(e.fiberRefs,_n.fiberRefs);return Wn(g(oo(n),()=>vo(s)),()=>Mc(t,e.context),()=>g(oo(r),()=>vo(o)))}),Zv=u(2,(t,e)=>Lv(e)?Qv(t,e):Qa(e)?Mc(t,e):Xv(t,e)),Y$=te,ue=kf,qo=He,Q$=db,X$=J,Z$=D,tk=bc,ek=tl,nk=cb,rk=$,dn=T,W=_,jo=N,sk=Mr,ok=Xu,ck=tb,ik=ab,ak=ov,uk=bb,lk=vm,fk=Je,hk=Ve,gk=vt,Vc=it,pk=ut,Hc=F,Pf=Tn,dk=q0,t1=Wn,mk=$f,yk=Wc,_k=If,e1=J0,bk=hs,Sk=$s,vk=uv,n1=eb,wk=yb,Ko=Zv,Lf=gb,r1=$b,s1=vb,$k=dt,kk=wm,Ek=wb,qt=g,Ok=Jn,Ik=z0,Fk=Rf,Rk=lv,Mk=Ff,o1=sn,Tk=mb,Ck=rb,Nk=fb,Ak=nv,Pk=rv,Lk=Wl,xk=rl,Dk=Q,c1=ub,qk=lb,jk=Em,i1=km,Kk=pb,Uk=iv,Bk=Cv,a1=V0,xf=H0,Tt=G0,zk=sr,u1=kb,cr=Bv,l1=Jv,f1=Vv,h1=Yv,g1=t=>t.length===0,p1=(t,e,n,r)=>({_tag:"Hsla",h:t,s:e,l:n,a:r}),Df=(t,e,n)=>p1(t,e,n,1),Wk=Df(0,0,0),Jk=Df(360,1,1),fr=t=>{switch(t._tag){case"Hex":return t.value;case"Hsla":{const{h:e,s:n,l:r,a:s}=t,o=d=>Math.round(d*100)/100,c=o(e),i=o(n*100)+"%",a=o(r*100)+"%",h=String(s);return s===1?`hsl(${c}, ${i}, ${a})`:`hsla(${c}, ${i}, ${a}, ${h})`}}},{Tag:qf}=vg;qf();class Gc{constructor(e){this.message=e,this._tag="CanvasError"}}const ne=qf(),d1=C(t=>t.canvas.width),m1=C(t=>t.canvas.height),Vk=ue({width:d1,height:m1});C(t=>t.canvas.toDataURL());const la=t=>C(e=>{e.fillStyle=t});C(t=>t.fillStyle);C(t=>t.font);function y1(t){return C(e=>(e.font=t,e))}C(t=>t.globalAlpha);C(t=>t.globalCompositeOperation);C(t=>t.imageSmoothingEnabled);C(t=>t.lineCap);C(t=>t.lineDashOffset);C(t=>t.lineJoin);function _1(t){return C(e=>(e.lineWidth=t,e))}C(t=>t.lineWidth);C(t=>t.miterLimit);function b1(t){return C(e=>{e.strokeStyle=t})}C(t=>t.strokeStyle);function S1(t){return C(e=>(e.shadowBlur=t,e))}C(t=>t.shadowBlur);function v1(t){return C(e=>e.shadowColor=t)}C(t=>t.shadowColor);function w1(t){return X(e=>f(W(()=>e.shadowOffsetX=t),Vc(e)))}C(t=>t.shadowOffsetX);function $1(t){return X(e=>f(W(()=>e.shadowOffsetY=t),Vc(e)))}C(t=>t.shadowOffsetY);C(t=>t.textAlign);X(t=>W(()=>t.textBaseline));function k1(t,e,n,r,s,o=!1){return X(c=>f(W(()=>c.arc(t,e,n,r,s,o)),Vc(c)))}const Yc=C(t=>{t.beginPath()});function Hk(t,e,n,r){return X(s=>W(()=>{s.clearRect(t,e,n,r)}))}function E1(t,e){return X(n=>W(()=>{typeof e<"u"?n.clip(e,t):typeof t<"u"?n.clip(t):n.clip()}))}const O1=X(t=>W(()=>{t.closePath()})),jf=(t,e,n)=>X(r=>W(()=>{r.drawImage(t,e,n)}));function I1(t,e,n,r,s,o,c,i=!1){return X(a=>W(()=>{a.ellipse(t,e,n,r,s,o,c,i)}))}const F1=(t,e)=>X(n=>W(()=>{typeof e<"u"?n.fill(e,t):typeof t<"u"?n.fill(t):n.fill()}));function Gk(t,e,n,r){return X(s=>W(()=>{s.fillRect(t,e,n,r)}))}const R1=(t,e,n,r)=>X(s=>W(()=>{typeof r<"u"?s.fillText(t,e,n,r):s.fillText(t,e,n)}));function Yk(t,e,n,r){return X(s=>W(()=>s.getImageData(t,e,n,r)))}X(t=>W(()=>t.getLineDash()));X(t=>W(()=>t.getTransform()));const M1=(t,e)=>C(n=>{n.lineTo(t,e)});function T1(t,e){return C(n=>{n.moveTo(t,e)})}function C1(t,e,n,r){return C(s=>s.rect(t,e,n,r))}const N1=X(t=>W(()=>{t.restore()})),A1=t=>C(e=>e.rotate(t)),P1=C(t=>t.save()),L1=(t,e)=>C(n=>n.scale(t,e));function x1(t){return X(e=>W(()=>{typeof t<"u"?e.stroke(t):e.stroke()}))}const D1=(t,e)=>C(n=>n.translate(t,e)),q1=t=>Yc.pipe(Tt(t),xf(F1())),j1=t=>Yc.pipe(Tt(t),xf(x1()));function C(t){return X(e=>W(()=>t(e)))}function Bt(t){return e1(t1(P1,e=>t,e=>N1))}function X(t){return ne.pipe(qt(t))}function Qk(t){const e=typeof t=="string"?U1(t):t instanceof HTMLElement?z1(t):B1(t);return Ko(e.pipe(h1(()=>c1(`i got an error for ${t}`))))}const K1=yt();function U1(t){return cr(ne,W1(t))}function B1(t){return f1(ne,t)}function z1(t){return cr(ne,qt(Uf(t),Kf))}function W1(t){return qt(J1(t),Kf)}function J1(t){return W(()=>document.getElementById(t)).pipe(qt(xn),Pf(()=>new Gc(`No such element with id ${t} exists`)),qt(Uf))}function Kf(t){return r1(K1).pipe(qt(jt({onNone:()=>W(()=>t.getContext("2d")),onSome:e=>W(()=>t.getContext("2d",e))})),qt(u1),Pf(e=>new Gc(`Cannot get 2d rendering context from "${t.id}"`)))}const Uf=t=>t instanceof HTMLCanvasElement?pt(t):Ft(new Gc("element is not an instance of HTMLCanvasElement"));function V1(t,e){return function(n){if(Array.isArray(n))return n.reduce(e,t);let r=t;for(const s of n)r=e(r,s);return r}}function H1(t){return function(e){return Array.isArray(e)?e.map(t):function*(){for(const n of e)yield t(n)}()}}const G1=t=>e=>{const n=Object.keys(e);return t.imap(t.productAll(n.map(r=>e[r])),r=>{const s={};for(let o=0;o<r.length;o++)s[n[o]]=r[o];return s},r=>n.map(s=>r[s]))},wt=(t,e=(n,r)=>V1(n,t)(r))=>({combine:t,combineMany:e}),Xk=t=>wt((e,n)=>t(e,n)===1?e:n),Y1=t=>wt(()=>t,()=>t),Q1=()=>wt(t=>t,t=>t),X1=u(3,(t,e,n)=>wt((r,s)=>e(t.combine(n(r),n(s))),(r,s)=>e(t.combineMany(n(r),H1(n)(s))))),Z1=(t,e)=>wt(([n,r],[s,o])=>[t.combine(n,s),e.combine(r,o)]),Bf=t=>wt((e,n)=>{const r=Math.min(e.length,n.length),s=[];let o=0;for(const c of t){if(o>=r)break;s.push(c.combine(e[o],n[o])),o++}return s}),tw=(t,e)=>{const n=Bf(e);return wt((r,s)=>[t.combine(r[0],s[0]),...n.combine(r.slice(1),s.slice(1))])},ew=Y1,nw={of:ew,imap:X1,product:Z1,productMany:tw,productAll:Bf},rw=()=>wt((t,e)=>t.concat(e)),sw=G1(nw),ir=(t,e)=>({combine:t.combine,combineMany:t.combineMany,empty:e,combineAll:n=>t.combineMany(e,n)}),zf=()=>ir(rw(),[]),Es=t=>{const e={};for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n].empty);return ir(sw(t),e)},ow=t=>ir(wt((e,n)=>U(e)?n:U(n)?e:v(t.combine(e.value,n.value))),w()),Wf=yt(),cw=cr(Wf,ne.pipe(Hc(uw))),Qc=yt(),iw=l1(cw,cr(Qc,Wf.pipe(Hc(aw)))),Zk=t=>s1(Qc,e=>n=>n._tag!="Composite"?n1(t)(e(n)):e(n));function aw(t){return function e(n){switch(n._tag){case"Arc":return t.arc(n.x,n.y,n.r,n.start,n.end,n.anticlockwise);case"Composite":return qo(n.shapes,r=>e(r),{concurrency:n.shapes.length});case"Ellipse":return t.ellipse(n.x,n.y,n.rx,n.ry,n.rotation,n.start,n.end,n.anticlockwise);case"Path":return f(n.points,Kh({onEmpty:()=>jo,onNonEmpty:([r,...s])=>t.moveTo(r.x,r.y).pipe(Tt(qo(s,({x:o,y:c})=>t.lineTo(o,c))),Tt(n.closed?t.closePath:jo))}));case"Rect":return t.rect(n.x,n.y,n.width,n.height)}}}function uw(t){const e=Lf(ne,t);return{moveTo:Et(T1,e),lineTo:Et(M1,e),closePath:e(O1),ellipse:Et(I1,e),rect:Et(C1,e),arc:Et(k1,e),drawImage:Et(jf,e)}}const lw={show:t=>[t.style,t.variant,t.weight].filter(A).map(Nt(Pn(""))).join(" ")},fw=Et(g1,Lh),hw={show:({fontFamily:t,size:e,fontOptions:n})=>[lw.show(n),`${e}px`,t].filter(fw).join(" ")},Xc=yt(),gw=f(Qc.pipe(a1(ne),Hc(([t,e])=>mw(t,e)),cr(Xc)));function pw(t){return Xc.pipe(o1(e=>e(t)))}function dw(t){return Xc.pipe(qt(e=>e(t)),Ko(gw),Ko(iw))}function mw(t,e){const n=Lf(ne,e);function r(o){return s(o).pipe(n)}return r;function s(o){switch(o._tag){case"Clipped":return ue([Yc,t(o.shape),E1(),dn(()=>r(o.drawing))]).pipe(Bt);case"Fill":return ue([oe(o.style.color,c=>la(fr(c))),q1(t(o.shape))],{discard:!0}).pipe(Bt);case"Many":return qo(o.drawings,s,{discard:!0});case"Outline":return ue([oe(o.style.color,Et(fr,b1)),oe(o.style.lineWidth,_1),j1(t(o.shape))],{discard:!0}).pipe(Bt);case"Rotate":return A1(o.angle).pipe(Tt(dn(()=>r(o.drawing))),Bt);case"Scale":return ue([L1(o.scaleX,o.scaleY).pipe(Tt(dn(()=>r(o.drawing))))]).pipe(Bt);case"Text":return ue([y1(hw.show(o.font)),oe(o.style.color,Et(fr,la)),R1(o.text,o.x,o.y)]).pipe(Bt);case"Translate":return D1(o.translateX,o.translateY).pipe(Tt(dn(()=>r(o.drawing))),Bt);case"WithShadow":return ue([oe(o.shadow.color,Et(fr,v1)),oe(o.shadow.blur,S1),oe(o.shadow.offset,({x:c,y:i})=>w1(c).pipe(Tt($1(i))))],{discard:!0}).pipe(Tt(dn(()=>r(o.drawing))),Bt);case"Image":return jf(o.image,o.source.x,o.source.y)}}}const oe=(t,e)=>t.pipe(qt(e),i1(()=>jo)),fa=zf(),Zc=()=>ow(Q1()),ti=Zc(),Jf=Zc(),yw=Zc(),tE=t=>e=>({_tag:"Clipped",shape:t,drawing:e}),eE=u(2,(t,e)=>({_tag:"Fill",shape:t,style:e})),nE=t=>({color:v(t)}),rE=u(2,(t,e)=>({_tag:"Outline",shape:t,style:e})),sE=t=>({color:v(t),lineWidth:w()}),ha=t=>({_tag:"Many",drawings:t}),oE=u(2,(t,e)=>({_tag:"Rotate",angle:e,drawing:t})),cE=u(3,(t,e,n)=>({_tag:"Scale",scaleX:e,scaleY:n,drawing:t})),iE=(t,e,n)=>({_tag:"Image",image:t,source:e,dest:n}),aE=u(3,(t,e,n)=>({_tag:"Translate",translateX:e,translateY:n,drawing:t})),uE=u(2,(t,e)=>({_tag:"WithShadow",shadow:e,drawing:t})),lE=t=>({color:w(),blur:v(t),offset:w()}),fE=t=>({color:v(t),blur:w(),offset:w()}),hE=dw,gE=pw;Es({color:ti});Es({color:ti,lineWidth:Jf});const pE=Es({color:ti,blur:Jf,offset:yw}),Vf=ir(wt((t,e)=>{const n=fa,r=t._tag==="Many"&&e._tag==="Many"?n.combineAll([t.drawings,e.drawings]):t._tag==="Many"?n.combineAll([t.drawings,[e]]):e._tag==="Many"?n.combineAll([[t],e.drawings]):[t,e];return ha(r)}),ha(fa.empty)),dE=Vf.combineAll,mE=Vf.combine,_w={reduce:Yt},bw=zf,Sw=wt((t,e)=>t||e,(t,e)=>{if(t===!0)return!0;for(const n of e)if(n===!0)return!0;return!1}),vw=ir(Sw,!1),yE=t=>({_tag:"Degrees",degrees:t}),ga=t=>({_tag:"Radians",radians:t}),pa=t=>{switch(t._tag){case"Degrees":return t.degrees*(Math.PI/180);case"Radians":return t.radians}},ww=(t,e)=>({x:t,y:e});function _E(t,e){return function(n){return n.x>t.x&&n.y>t.y&&n.x<e.y&&n.y<e.y}}const bE=(t,e,n)=>({_tag:"Arc",x:t,y:e,r:n,start:pa(ga(0)),end:pa(ga(Math.PI*2)),anticlockwise:!1});function $w(t){return t.reduce(kw.empty,(e,n)=>({_tag:"Path",closed:!0,points:ja(n)(e.points)}))}const SE=(t,e,n,r)=>({_tag:"Rect",x:t,y:e,width:n,height:r}),vE=t=>f(jh(0,t-1),Ce(e=>f(e*Math.PI/(t/2),n=>ww(Math.sin(n),Math.cos(n)))),$w(_w)),kw=Es({_tag:{combineAll:()=>"Path",combineMany:()=>"Path",combine:()=>"Path",empty:"Path"},closed:vw,points:bw()});export{S$ as $,Hk as A,A1 as B,Jk as C,f as D,oE as E,ir as F,Xk as G,Hc as H,aE as I,Vk as J,yE as K,Kk as L,pa as M,Df as N,Nn as O,$$ as P,ww as Q,o1 as R,qo as S,cE as T,L$ as U,Nt as V,wk as W,_E as X,lt as Y,jo as Z,Og as _,ue as a,Yn as a$,X$ as a0,sk as a1,ak as a2,Gt as a3,rk as a4,bE as a5,mE as a6,Wk as a7,yt as a8,cr as a9,k1 as aA,_1 as aB,I$ as aC,hl as aD,ty as aE,mr as aF,F$ as aG,x as aH,et as aI,Vt as aJ,M$ as aK,Ci as aL,Ls as aM,R$ as aN,H as aO,z as aP,V as aQ,k as aR,u as aS,mt as aT,Pe as aU,Ar as aV,or as aW,wc as aX,ks as aY,O$ as aZ,tS as a_,ne as aa,Lf as ab,Et as ac,Vc as ad,Yc as ae,x1 as af,l1 as ag,T1 as ah,M1 as ai,nk as aj,H_ as ak,D$ as al,x$ as am,j$ as an,Yk as ao,uk as ap,jk as aq,iE as ar,L1 as as,W as at,Rt as au,w$ as av,K1 as aw,qa as ax,xn as ay,q1 as az,b1 as b,t1 as b$,Qi as b0,Zb as b1,g as b2,_ as b3,F as b4,Xe as b5,Ec as b6,N as b7,$ as b8,T as b9,K$ as bA,xh as bB,ev as bC,K as bD,I as bE,Y$ as bF,ik as bG,zk as bH,$k as bI,Dk as bJ,dn as bK,Sk as bL,U$ as bM,yk as bN,hk as bO,A as bP,gk as bQ,_k as bR,vk as bS,mk as bT,fy as bU,xf as bV,wo as bW,C$ as bX,ek as bY,ok as bZ,e1 as b_,Mr as ba,vm as bb,Kt as bc,w as bd,v as be,Ve as bf,rt as bg,ke as bh,ut as bi,Rm as bj,ys as bk,at as bl,Ge as bm,T$ as bn,ms as bo,nt as bp,wn as bq,d$ as br,Zo as bs,kc as bt,ol as bu,Dn as bv,Ct as bw,Sc as bx,y$ as by,Ic as bz,j1 as c,pE as c$,kk as c0,Tk as c1,Z$ as c2,P$ as c3,Ok as c4,G_ as c5,bk as c6,lk as c7,Ft as c8,pt as c9,Lk as cA,ru as cB,b$ as cC,G$ as cD,tk as cE,Q$ as cF,St as cG,v$ as cH,zs as cI,k$ as cJ,Rg as cK,V$ as cL,Ms as cM,m$ as cN,Qn as cO,he as cP,Ht as cQ,Il as cR,ck as cS,J$ as cT,iw as cU,Zk as cV,gw as cW,Nk as cX,gE as cY,qk as cZ,uE as c_,N$ as ca,H$ as cb,xk as cc,B$ as cd,dk as ce,fk as cf,Mk as cg,z$ as ch,O as ci,Uk as cj,pk as ck,Rk as cl,Ck as cm,si as cn,jt as co,Fk as cp,A$ as cq,Ek as cr,Pk as cs,Ak as ct,q$ as cu,W$ as cv,ri as cw,p$ as cx,_$ as cy,Pf as cz,D1 as d,fE as d0,lE as d1,ha as d2,vE as d3,Vf as d4,jh as d5,Ce as d6,Qh as d7,Go as d8,tE as d9,Ik as da,dE as e,Gk as f,eE as g,SE as h,nE as i,sE as j,p1 as k,qt as l,Tt as m,Qk as n,rE as o,Ko as p,Bk as q,C1 as r,la as s,fr as t,C as u,n1 as v,Bt as w,fo as x,hE as y,a1 as z};
