(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();const l=(e,t)=>function(){return arguments.length>=e?t.apply(this,arguments):n=>t(n,...arguments)},Q=e=>e,dn=e=>()=>e,zo=dn(!0),Ys=dn(!1),_a=dn(void 0),Go=_a;function st(e,t,n,s,r,o,i,c,u){switch(arguments.length){case 1:return e;case 2:return function(){return t(e.apply(this,arguments))};case 3:return function(){return n(t(e.apply(this,arguments)))};case 4:return function(){return s(n(t(e.apply(this,arguments))))};case 5:return function(){return r(s(n(t(e.apply(this,arguments)))))};case 6:return function(){return o(r(s(n(t(e.apply(this,arguments))))))};case 7:return function(){return i(o(r(s(n(t(e.apply(this,arguments)))))))};case 8:return function(){return c(i(o(r(s(n(t(e.apply(this,arguments))))))))};case 9:return function(){return u(c(i(o(r(s(n(t(e.apply(this,arguments)))))))))}}}function a(e,t,n,s,r,o,i,c,u){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return n(t(e));case 4:return s(n(t(e)));case 5:return r(s(n(t(e))));case 6:return o(r(s(n(t(e)))));case 7:return i(o(r(s(n(t(e))))));case 8:return c(i(o(r(s(n(t(e)))))));case 9:return u(c(i(o(r(s(n(t(e))))))));default:{let f=arguments[0];for(let h=1;h<arguments.length;h++)f=arguments[h](f);return f}}}function he(e){return e==null}const Jl=335903614,Yl=4150755663,Ql=1481765933>>>0,Xl=1284865837>>>0,Zl=9007199254740992,tf=134217728;class ba{constructor(t,n,s,r){return he(n)&&he(t)?(n=Math.random()*4294967295>>>0,t=0):he(n)&&(n=t,t=0),he(r)&&he(s)?(r=this._state?this._state[3]:Yl,s=this._state?this._state[2]:Jl):he(r)&&(r=s,s=0),this._state=new Int32Array([0,0,s>>>0,((r||0)|1)>>>0]),this._next(),Ho(this._state,this._state[0],this._state[1],t>>>0,n>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(t){this._state[0]=t[0],this._state[1]=t[1],this._state[2]=t[2],this._state[3]=t[3]|1}integer(t){if(!t)return this._next();if(t=t>>>0,!(t&t-1))return this._next()&t-1;let n=0;const s=(-t>>>0)%t>>>0;for(n=this._next();n<s;n=this._next());return n%t}number(){const t=(this._next()&67108863)*1,n=(this._next()&134217727)*1;return(t*tf+n)/Zl}_next(){const t=this._state[0]>>>0,n=this._state[1]>>>0;ef(this._state,t,n,Ql,Xl),Ho(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let s=t>>>18,r=(n>>>18|t<<14)>>>0;s=(s^t)>>>0,r=(r^n)>>>0;const o=(r>>>27|s<<5)>>>0,i=t>>>27,c=(-i>>>0&31)>>>0;return(o>>>i|o<<c)>>>0}}function ef(e,t,n,s,r){let o=(n>>>16)*(r&65535)>>>0,i=(n&65535)*(r>>>16)>>>0,c=(n&65535)*(r&65535)>>>0,u=(n>>>16)*(r>>>16)+((i>>>16)+(o>>>16))>>>0;i=i<<16>>>0,c=c+i>>>0,c>>>0<i>>>0&&(u=u+1>>>0),o=o<<16>>>0,c=c+o>>>0,c>>>0<o>>>0&&(u=u+1>>>0),u=u+Math.imul(n,s)>>>0,u=u+Math.imul(t,r)>>>0,e[0]=u,e[1]=c}function Ho(e,t,n,s,r){let o=t+s>>>0;const i=n+r>>>0;i>>>0<n>>>0&&(o=o+1|0),e[0]=o,e[1]=i}const qs=new WeakMap,nf=new ba,A=Symbol.for("@effect/data/Hash"),y=e=>{switch(typeof e){case"number":return Fr(e);case"bigint":return J(e.toString(10));case"boolean":return J(String(e));case"symbol":return J(String(e));case"string":return J(e);case"undefined":return J("undefined");case"function":case"object":return e===null?J("null"):sf(e)?e[A]():Sa(e);default:throw new Error("Bug in Equal.hashGeneric")}},Sa=e=>(qs.has(e)||qs.set(e,Fr(nf.integer(Number.MAX_SAFE_INTEGER))),qs.get(e)),M=e=>t=>t*53^e,rs=e=>e&3221225471|e>>>1&1073741824,sf=e=>typeof e=="object"&&e!==null&&A in e,Fr=e=>{if(e!==e||e===1/0)return 0;let t=e|0;for(t!==e&&(t^=e*4294967295);e>4294967295;)t^=e/=4294967295;return rs(e)},J=e=>{let t=5381,n=e.length;for(;n;)t=t*33^e.charCodeAt(--n);return rs(t)},rf=e=>{const t=Object.keys(e);let n=12289;for(let s=0;s<t.length;s++)n^=a(J(t[s]),M(y(e[t[s]])));return rs(n)},va=e=>{let t=6151;for(let n=0;n<e.length;n++)t=a(t,M(y(e[n])));return rs(t)},O=Symbol.for("@effect/data/Equal");function S(){return arguments.length===1?e=>Bo(e,arguments[0]):Bo(arguments[0],arguments[1])}function Bo(e,t){if(e===t)return!0;const n=typeof e;return n!==typeof t?!1:(n==="object"||n==="function")&&e!==null&&t!==null&&Vo(e)&&Vo(t)?y(e)===y(t)&&e[O](t):!1}const Vo=e=>typeof e=="object"&&e!==null&&O in e,of=()=>(e,t)=>y(e)===y(t)&&S(e,t),af=(()=>{const e={[A](){return rf(this)},[O](t){const n=Object.keys(this),s=Object.keys(t);if(n.length!==s.length)return!1;for(const r of n)if(!(r in t&&S(this[r],t[r])))return!1;return!0}};return Object.setPrototypeOf(e,Object.prototype)})(),os=e=>cf(Object.assign({},e)),cf=e=>Object.setPrototypeOf(e,af),uf=e=>e._tag==="None",lf=e=>e._tag==="Some",ff=os({_tag:"None"}),hf=e=>os({_tag:"Some",value:e}),df=e=>e._tag==="Left",gf=e=>e._tag==="Right",pf=e=>os({_tag:"Left",left:e}),mf=e=>os({_tag:"Right",right:e}),yf=e=>e.length>0,is=e=>Array.isArray(e)?e:Array.from(e),_f=e=>t=>{const n=Object.keys(t);return e.imap(e.productAll(n.map(s=>t[s])),s=>{const r={};for(let o=0;o<s.length;o++)r[n[o]]=s[o];return r},s=>n.map(r=>s[r]))},ot=(e,t=(n,s)=>is(s).reduce(e,n))=>({combine:e,combineMany:t}),bf=ot((e,t)=>e+t),Ea=ot((e,t)=>e+t),$a=ot((e,t)=>e*t,(e,t)=>{if(e===0)return 0;let n=e;for(const s of t){if(s===0)return 0;n=n*s}return n}),Pr=ot((e,t)=>e&&t,(e,t)=>{if(e===!1)return!1;for(const n of t)if(n===!1)return!1;return!0}),Nr=ot((e,t)=>e||t,(e,t)=>{if(e===!0)return!0;for(const n of t)if(n===!0)return!0;return!1}),Sf=ot((e,t)=>e!==t),vf=ot((e,t)=>e===t),Ef=e=>ot(()=>e,()=>e),$f=l(3,(e,t,n)=>ot((s,r)=>t(e.combine(n(s),n(r))),(s,r)=>t(e.combineMany(n(s),is(r).map(n))))),wf=(e,t)=>ot(([n,s],[r,o])=>[e.combine(n,r),t.combine(s,o)]),wa=e=>{const t=is(e);return ot((n,s)=>{const r=Math.min(n.length,s.length,t.length),o=[];for(let i=0;i<r;i++)o.push(t[i].combine(n[i],s[i]));return o})},kf=(e,t)=>{const n=wa(t);return ot((s,r)=>[e.combine(s[0],r[0]),...n.combine(s.slice(1),r.slice(1))])},If=Ef,Tf={of:If,imap:$f,product:wf,productMany:kf,productAll:wa},Mf=()=>ot((e,t)=>e.concat(t)),Af=_f(Tf),Ot=(e,t)=>({combine:e.combine,combineMany:e.combineMany,empty:t,combineAll:n=>e.combineMany(t,n)}),Of=Ot(Ea,0),Cf=Ot($a,1),Rf=Ot(Pr,!0),ka=Ot(Nr,!1),Ff=()=>Ot(Mf(),[]),as=e=>{const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n].empty);return Ot(Af(e),t)},Ia=e=>({compare:(t,n)=>t===n?0:e(t,n)}),Ta=Ia((e,t)=>e<t?-1:1),Pf=l(2,(e,t)=>Ia((n,s)=>e.compare(t(n),t(s)))),Nf=e=>l(2,(t,n)=>e.compare(t,n)!==-1);Ta.compare;const Lf=(e,t)=>e===t,xf=()=>Lf,jf=xf();Ea.combine;$a.combine;const zn=Ta,Df=Of,qf=Cf;Df.combineAll;qf.combineAll;const Kf=e=>l(3,(t,n,s)=>e(t,n)),Uf=e=>()=>({combine:e.coproduct,combineMany:e.coproductMany}),v=()=>ff,T=hf,U=uf,q=lf,Lr=l(3,(e,t,n)=>U(e)?t():n(e.value)),It=l(2,(e,t)=>U(e)?t():e.value),Wf=l(2,(e,t)=>U(e)?t():e),zf=e=>{let t=v();for(t of e)if(q(t))return t;return t},Ma=e=>e==null?v():T(e),de=It(_a),Vt=l(2,(e,t)=>U(e)?v():T(t(e.value))),Gf=Kf(Vt),kE=l(2,(e,t)=>U(e)?v():t(e.value)),Hf=(e,t)=>q(e)?e:t,Bf=(e,t)=>q(e)?e:zf(t),Vf={imap:Gf,coproduct:Hf,coproductMany:Bf},Jf=Uf(Vf),Yf=e=>t=>e(t)?T(t):v(),Qf=e=>l(2,(t,n)=>U(t)?!1:e(t.value,n)),ut=mf,lt=pf,Je=df,Ye=gf,IE=l(3,(e,t,n)=>Je(e)?t(e.left):n(e.right)),Xf=(e,t)=>n=>e(n)?ut(n):lt(t(n)),Zf=jf,th=bf;th.combine;const eh=e=>e.length===0,nh=(e,t)=>{const n=Math.max(1,Math.floor(e)),s=[t(0)];for(let r=1;r<n;r++)s.push(t(r));return s},be=is,sh=l(3,(e,t,n)=>te(e)?n(e):t()),Zt=l(2,(e,t)=>[t,...e]),rh=e=>e.length===0,oh=rh,te=yf,ih=(e,t)=>e<0||e>=t.length,Aa=(e,t)=>Math.floor(Math.min(Math.max(0,e),t.length)),ah=l(2,(e,t)=>{const n=Math.floor(t);if(ih(n,e))throw new Error(`Index ${n} out of bounds`);return e[n]}),et=ah(0),Se=e=>e.slice(1),ch=l(2,(e,t)=>{const n=be(e);return n.slice(0,Aa(t,n))}),uh=l(2,(e,t)=>{const n=be(e);return n.slice(Aa(t,n),n.length)}),lh=e=>Array.from(e).reverse(),fh=l(2,(e,t)=>{const n=Array.from(e);return n.sort(t.compare),n}),hh=l(3,(e,t,n)=>{const s=be(e),r=be(t);return te(s)&&te(r)?dh(r,n)(s):[]}),dh=l(3,(e,t,n)=>{const s=[n(et(e),et(t))],r=Math.min(e.length,t.length);for(let o=1;o<r;o++)s[o]=n(e[o],t[o]);return s}),gh=l(2,(e,t)=>{const n=be(e);return te(n)?ph(t)(n):[]}),ph=l(2,(e,t)=>{const n=[et(e)],s=Se(e);for(const r of s)n.every(o=>!t(r,o))&&n.push(r);return n}),mh=()=>[],Oa=e=>[e],Ca=l(2,(e,t)=>e.map(t)),yh=l(3,(e,t,n)=>be(e).reduce((s,r,o)=>n(s,r,o),t)),Ra=Ff,Fa=Symbol.for("@effect/data/Chunk"),Jo=[];function _h(e,t,n,s,r){for(let o=t;o<Math.min(e.length,t+r);o++)n[s+o-t]=e[o];return n}class Z{constructor(t){switch(this.backing=t,this._id=Fa,t._tag){case"IEmpty":{this.length=0,this.depth=0,this.left=this,this.right=this;break}case"IConcat":{this.length=t.left.length+t.right.length,this.depth=1+Math.max(t.left.depth,t.right.depth),this.left=t.left,this.right=t.right;break}case"IArray":{this.length=t.array.length,this.depth=0,this.left=St,this.right=St;break}case"ISingleton":{this.length=1,this.depth=0,this.left=St,this.right=St;break}}}get array(){return this.toReadonlyArray()}toReadonlyArray(){switch(this.backing._tag){case"IEmpty":return Jo;case"IArray":return this.backing.array;default:{const t=new Array(this.length);return Qs(this,t,0),this.backing={_tag:"IArray",array:t},this.left=St,this.right=St,this.depth=0,t}}}toString(){return`Chunk(${this.toReadonlyArray().map(String).join(", ")})`}toJSON(){return{_tag:"Chunk",values:this.toReadonlyArray()}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}isNonEmpty(){return this.length>0}isEmpty(){return!this.isNonEmpty()}map(t){return this.backing._tag==="ISingleton"?K(t(this.backing.a)):z(Ca(t)(G(this)))}flatMap(t){if(this.backing._tag==="ISingleton")return t(this.backing.a);let n=St;for(const s of this)n=W(t(s))(n);return n}forEach(t){return this.backing._tag==="ISingleton"?t(this.backing.a):G(this).forEach(t)}append(t){return this.concat(K(t))}prepend(t){return K(t).concat(this)}concat(t){if(this.backing._tag==="IEmpty")return t;if(t.backing._tag==="IEmpty")return this;const n=t.depth-this.depth;if(Math.abs(n)<=1)return new Z({_tag:"IConcat",left:this,right:t});if(n<-1)if(this.left.depth>=this.right.depth){const s=W(t)(this.right);return new Z({_tag:"IConcat",left:this.left,right:s})}else{const s=W(t)(this.right.right);if(s.depth===this.depth-3){const r=new Z({_tag:"IConcat",left:this.right.left,right:s});return new Z({_tag:"IConcat",left:this.left,right:r})}else{const r=new Z({_tag:"IConcat",left:this.left,right:this.right.left});return new Z({_tag:"IConcat",left:r,right:s})}}else if(t.right.depth>=t.left.depth){const s=W(t.left)(this);return new Z({_tag:"IConcat",left:s,right:t.right})}else{const s=W(t.left.left)(this);if(s.depth===t.depth-3){const r=new Z({_tag:"IConcat",left:s,right:t.left.right});return new Z({_tag:"IConcat",left:r,right:t.right})}else{const r=new Z({_tag:"IConcat",left:t.left.right,right:t.right});return new Z({_tag:"IConcat",left:s,right:r})}}}get(t){return t<0||t>=this.length?v():T(this.unsafeGet(t))}unsafeGet(t){switch(this.backing._tag){case"IEmpty":throw new Error("Index out of bounds");case"ISingleton":{if(t!==0)throw new Error("Index out of bounds");return this.backing.a}case"IArray":{if(t>=this.length||t<0)throw new Error("Index out of bounds");return this.backing.array[t]}case"IConcat":return t<this.left.length?this.left.unsafeGet(t):this.right.unsafeGet(t-this.left.length)}}[O](t){return Pa(t)&&this.length===t.length?G(this).every((n,s)=>S(n,t.unsafeGet(s))):!1}[A](){return va(G(this))}[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return Jo[Symbol.iterator]();default:return G(this)[Symbol.iterator]()}}}const Qs=(e,t,n)=>{switch(e.backing._tag){case"IArray":{_h(e.backing.array,0,t,n,e.length);break}case"IConcat":{Qs(e.left,t,n),Qs(e.right,t,n+e.left.length);break}case"ISingleton":{t[n]=e.backing.a;break}}},Pa=e=>typeof e=="object"&&e!=null&&"_id"in e&&e._id===Fa,St=new Z({_tag:"IEmpty"}),at=()=>St,Ae=e=>Pa(e)?e:new Z({_tag:"IArray",array:Array.from(e)}),G=e=>e.toReadonlyArray(),Na=l(2,(e,t)=>e.get(t)),z=e=>new Z({_tag:"IArray",array:e}),xr=l(2,(e,t)=>e.unsafeGet(t)),bh=l(2,(e,t)=>e.append(t)),mt=l(2,(e,t)=>e.prepend(t)),jr=l(2,(e,t)=>t<=0?St:t>=e.length?e:z(ch(t)(e.toReadonlyArray()))),Dr=l(2,(e,t)=>t<=0?e:t>=e.length?St:z(uh(t)(e.toReadonlyArray()))),W=l(2,(e,t)=>e.concat(t)),La=e=>{const t=[];let n=v();for(const s of e)(U(n)||!S(s,n.value))&&(t.push(s),n=T(s));return z(t)},TE=l(2,(e,t)=>G(e).every(n=>t(n))),me=Na(0),cs=e=>e.isEmpty(),ee=e=>e.isNonEmpty(),us=l(3,(e,t,n)=>a(G(e),yh(t,n))),Oe=l(2,(e,t)=>us(e,"",(n,s)=>n.length>0?`${n}${t}${s}`:s)),Sh=e=>Na(e,e.length-1),vh=(...e)=>z(e),K=e=>new Z({_tag:"ISingleton",a:e}),Eh=l(2,(e,t)=>vh(...nh(e,t))),ye=l(2,(e,t)=>e.map(t)),$h=l(2,(e,t)=>e.backing._tag==="ISingleton"?K(t(e.backing.a,0)):z(a(G(e),Ca(t)))),ME=l(3,(e,t,n)=>{let s=t;const r=[];for(const o of G(e)){const i=n(s,o);s=i[0],r.push(i[1])}return[s,z(r)]}),wh=(e,t)=>e<=t?Eh(t-e+1,n=>e+n):K(e),qr=e=>z(lh(G(e))),Xs=l(2,(e,t)=>a(G(e),fh(t),z)),kh=l(2,(e,t)=>[jr(t)(e),Dr(t)(e)]),Ih=l(2,(e,t)=>{let n=0;for(const s of G(e)){if(t(s))break;n++}return kh(n)(e)}),Yo=(e,t)=>{const n=[];let s=!0,r=e;for(;s;){const o=t(r);q(o)?(r=o.value[1],n.push(o.value[0])):s=!1}return z(n)},Th=e=>z(gh(of())(G(e))),Gn=e=>xr(0)(e),Ze=e=>xr(e.length-1)(e),Qo=l(2,(e,t)=>Mh(e,t,(n,s)=>[n,s])),Mh=l(3,(e,t,n)=>{const s=G(e),r=G(t);return a(s,hh(r,n),z)}),ve=Gn,Lt=e=>Dr(e,1),Zs=Symbol.for("@effect/data/Global/globalStoreId");Zs in globalThis||(globalThis[Zs]=new Map);const Ks=globalThis[Zs],Ah=(e,t)=>(Ks.has(e)||Ks.set(e,t()),Ks.get(e)),Oh=Symbol.for("@effect/data/Context/Tag");class Ch{constructor(t){if(this._id=Oh,this._S=n=>n,typeof t<"u")return Ah(t,()=>this)}}const xa=Symbol.for("@effect/data/Context");class Ee{[O](t){if(Rh(t)&&this.unsafeMap.size===t.unsafeMap.size){for(const n of this.unsafeMap.keys())if(!t.unsafeMap.has(n)||!S(this.unsafeMap.get(n),t.unsafeMap.get(n)))return!1;return!0}return!1}[A](){return Fr(this.unsafeMap.size)}constructor(t){this.unsafeMap=t,this._id=xa,this._S=n=>n}}const Rh=e=>typeof e=="object"&&e!==null&&"_id"in e&&e._id===xa,Fh=()=>new Ee(new Map),Ph=(e,t)=>new Ee(new Map([[e,t]])),Nh=l(3,(e,t,n)=>{const s=new Map(e.unsafeMap);return s.set(t,n),new Ee(s)}),Lh=l(2,(e,t)=>{if(!e.unsafeMap.has(t))throw new Error("Service not found");return e.unsafeMap.get(t)}),xh=l(2,(e,t)=>{if(!e.unsafeMap.has(t))throw new Error("Service not found");return e.unsafeMap.get(t)}),jh=l(2,(e,t)=>{const n=new Map(e.unsafeMap);for(const[s,r]of t.unsafeMap)n.set(s,r);return new Ee(n)}),Ct=e=>new Ch(e),Kr=Fh,Ur=Ph,Nn=Nh,Dh=Lh,qh=xh,Wr=jh,gn=Symbol.for("@effect/data/Differ/ContextPatch");function Et(e){return e}let Kh=class{constructor(){this._tag="Empty",this._Input=Et,this._Output=Et,this._id=gn}[A](){return J("ContextPatch(Empty)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id}},Uh=class{constructor(t,n){this.first=t,this.second=n,this._tag="AndThen",this._id=gn,this._Input=Et,this._Output=Et}[A](){return J("ContextPatch(AndThen)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&S(this.first,t.first)&&S(this.second,t.second)}};class Wh{constructor(t,n){this.tag=t,this.service=n,this._tag="AddService",this._id=gn,this._Input=Et,this._Output=Et}[A](){return J("ContextPatch(AddService)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&S(this.tag,t.tag)&&S(this.service,t.service)}}class zh{constructor(t){this.tag=t,this._tag="RemoveService",this._id=gn,this._Input=Et,this._Output=Et}[A](){return J("ContextPatch(RemoveService)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&S(this.tag,t.tag)}}class Gh{constructor(t,n){this.tag=t,this.update=n,this._tag="UpdateService",this._id=gn,this._Input=Et,this._Output=Et}[A](){return J("ContextPatch(AndThen)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&S(this.tag,t.tag)&&S(this.update,t.update)}}const ja=()=>new Kh,Hh=(e,t)=>{const n=new Map(e.unsafeMap);let s=ja();for(const[r,o]of t.unsafeMap.entries())if(n.has(r)){const i=n.get(r);n.delete(r),S(i,o)||(s=Ln(new Gh(r,()=>o))(s))}else n.delete(r),s=Ln(new Wh(r,o))(s);for(const[r]of n.entries())s=Ln(new zh(r))(s);return s},Ln=l(2,(e,t)=>new Uh(e,t)),Bh=l(2,(e,t)=>{let n=!1,s=K(e);const r=new Map(t.unsafeMap);for(;ee(s);){const i=ve(s),c=Lt(s);switch(i._tag){case"Empty":{s=c;break}case"AddService":{r.set(i.tag,i.service),s=c;break}case"AndThen":{s=mt(mt(c,i.second),i.first);break}case"RemoveService":{r.delete(i.tag),s=c;break}case"UpdateService":{r.set(i.tag,i.update(r.get(i.tag))),n=!0,s=c;break}}}if(!n)return new Ee(r);const o=new Map;for(const[i]of t.unsafeMap)r.has(i)&&(o.set(i,r.get(i)),r.delete(i));for(const[i,c]of r)o.set(i,c);return new Ee(o)}),Da=ja,Vh=Hh,Jh=Ln,Yh=Bh,ne=5,zr=Math.pow(2,ne),Qh=zr-1,Xh=zr/2,Zh=zr/4;function td(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function $e(e,t){return t>>>e&Qh}function pe(e){return 1<<e}function qa(e,t){return td(e&t-1)}function _e(e,t,n,s){let r=s;if(!e){const o=s.length;r=new Array(o);for(let i=0;i<o;++i)r[i]=s[i]}return r[t]=n,r}function Ka(e,t,n){const s=n.length-1;let r=0,o=0,i=n;if(e)r=o=t;else for(i=new Array(s);r<t;)i[o++]=n[r++];for(++r;r<=s;)i[o++]=n[r++];return e&&(i.length=s),i}function ed(e,t,n,s){const r=s.length;if(e){let u=r;for(;u>=t;)s[u--]=s[u];return s[t]=n,s}let o=0,i=0;const c=new Array(r+1);for(;o<t;)c[i++]=s[o++];for(c[t]=n;o<r;)c[++i]=s[o++];return c}class nd{constructor(t,n){this.value=t,this.previous=n}}class At{constructor(){this._tag="EmptyNode"}modify(t,n,s,r,o,i){const c=s(v());return U(c)?new At:(++i.value,new Jt(t,r,o,c))}}function vt(e){return e instanceof At}function sd(e){return vt(e)||e._tag==="LeafNode"||e._tag==="CollisionNode"}function ls(e,t){return vt(e)?!1:t===e.edit}class Jt{constructor(t,n,s,r){this.edit=t,this.hash=n,this.key=s,this.value=r,this._tag="LeafNode"}modify(t,n,s,r,o,i){if(S(o,this.key)){const u=s(this.value);return u===this.value?this:U(u)?(--i.value,new At):ls(this,t)?(this.value=u,this):new Jt(t,r,o,u)}const c=s(v());return U(c)?this:(++i.value,Ua(t,n,this.hash,this,r,new Jt(t,r,o,c)))}}class Gr{constructor(t,n,s){this.edit=t,this.hash=n,this.children=s,this._tag="CollisionNode"}modify(t,n,s,r,o,i){if(r===this.hash){const u=ls(this,t),f=this.updateCollisionList(u,t,this.hash,this.children,s,o,i);return f===this.children?this:f.length>1?new Gr(t,this.hash,f):f[0]}const c=s(v());return U(c)?this:(++i.value,Ua(t,n,this.hash,this,r,new Jt(t,r,o,c)))}updateCollisionList(t,n,s,r,o,i,c){const u=r.length;for(let h=0;h<u;++h){const d=r[h];if("key"in d&&S(i,d.key)){const m=d.value,b=o(m);return b===m?r:U(b)?(--c.value,Ka(t,h,r)):_e(t,h,new Jt(n,s,i,b),r)}}const f=o(v());return U(f)?r:(++c.value,_e(t,u,new Jt(n,s,i,f),r))}}class we{constructor(t,n,s){this.edit=t,this.mask=n,this.children=s,this._tag="IndexedNode"}modify(t,n,s,r,o,i){const c=this.mask,u=this.children,f=$e(n,r),h=pe(f),d=qa(c,h),m=c&h,b=ls(this,t);if(!m){const _t=new At().modify(t,n+ne,s,r,o,i);return _t?u.length>=Xh?od(t,f,_t,c,u):new we(t,c|h,ed(b,d,_t,u)):this}const $=u[d],L=$.modify(t,n+ne,s,r,o,i);if($===L)return this;let j=c,it;if(vt(L)){if(j&=~h,!j)return new At;if(u.length<=2&&sd(u[d^1]))return u[d^1];it=Ka(b,d,u)}else it=_e(b,d,L,u);return b?(this.mask=j,this.children=it,this):new we(t,j,it)}}class Hr{constructor(t,n,s){this.edit=t,this.size=n,this.children=s,this._tag="ArrayNode"}modify(t,n,s,r,o,i){let c=this.size;const u=this.children,f=$e(n,r),h=u[f],d=(h||new At).modify(t,n+ne,s,r,o,i);if(h===d)return this;const m=ls(this,t);let b;if(vt(h)&&!vt(d))++c,b=_e(m,f,d,u);else if(!vt(h)&&vt(d)){if(--c,c<=Zh)return rd(t,c,f,u);b=_e(m,f,new At,u)}else b=_e(m,f,d,u);return m?(this.size=c,this.children=b,this):new Hr(t,c,b)}}function rd(e,t,n,s){const r=new Array(t-1);let o=0,i=0;for(let c=0,u=s.length;c<u;++c)if(c!==n){const f=s[c];f&&!vt(f)&&(r[o++]=f,i|=1<<c)}return new we(e,i,r)}function od(e,t,n,s,r){const o=[];let i=s,c=0;for(let u=0;i;++u)i&1&&(o[u]=r[c++]),i>>>=1;return o[t]=n,new Hr(e,c+1,o)}function id(e,t,n,s,r,o){if(n===r)return new Gr(e,n,[o,s]);const i=$e(t,n),c=$e(t,r);if(i===c)return u=>new we(e,pe(i)|pe(c),[u]);{const u=i<c?[s,o]:[o,s];return new we(e,pe(i)|pe(c),u)}}function Ua(e,t,n,s,r,o){let i,c=t;for(;;){const u=id(e,c,n,s,r,o);if(typeof u=="function")i=new nd(u,i),c=c+ne;else{let f=u;for(;i!=null;)f=i.value(f),i=i.previous;return f}}}const Wa=Symbol.for("@effect/data/HashMap");class Br{constructor(t,n,s,r){this._editable=t,this._edit=n,this._root=s,this._size=r,this._id=Wa}[Symbol.iterator](){return new fs(this,(t,n)=>[t,n])}[A](){let t=y("HashMap");for(const n of this)t^=M(y(n[0]))(y(n[1]));return t}[O](t){if(cd(t)){if(t._size!==this._size)return!1;for(const n of this){const s=a(t,Ha(n[0],y(n[0])));if(U(s))return!1;if(!S(n[1],s.value))return!1}return!0}return!1}toString(){return`HashMap(${Array.from(this).map(([t,n])=>`[${String(t)}, ${String(n)}]`).join(", ")})`}toJSON(){return{_tag:"HashMap",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}}class fs{constructor(t,n){this.map=t,this.f=n,this.v=za(this.map._root,this.f,void 0)}next(){if(U(this.v))return{done:!0,value:void 0};const t=this.v.value;return this.v=Hn(t.cont),{done:!1,value:t.value}}[Symbol.iterator](){return new fs(this.map,this.f)}}const Hn=e=>e?Ga(e[0],e[1],e[2],e[3],e[4]):v(),za=(e,t,n=void 0)=>{switch(e._tag){case"LeafNode":return q(e.value)?T({value:t(e.key,e.value.value),cont:n}):Hn(n);case"CollisionNode":case"ArrayNode":case"IndexedNode":{const s=e.children;return Ga(s.length,s,0,t,n)}default:return Hn(n)}},Ga=(e,t,n,s,r)=>{for(;n<e;){const o=t[n++];if(o&&!vt(o))return za(o,s,[e,t,n,s,r])}return Hn(r)},Vr=()=>new Br(!1,0,new At,0),ad=e=>{const t=Ba(Vr());for(const n of e)tr(n[0],n[1])(t);return hd(t)},cd=e=>typeof e=="object"&&e!=null&&"_id"in e&&e._id===Wa,Ha=l(3,(e,t,n)=>{let s=e._root,r=0;for(;;)switch(s._tag){case"LeafNode":return S(t,s.key)?s.value:v();case"CollisionNode":{if(n===s.hash){const o=s.children;for(let i=0,c=o.length;i<c;++i){const u=o[i];if("key"in u&&S(t,u.key))return u.value}}return v()}case"IndexedNode":{const o=$e(r,n),i=pe(o);if(s.mask&i){s=s.children[qa(s.mask,i)],r+=ne;break}return v()}case"ArrayNode":{if(s=s.children[$e(r,n)],s){r+=ne;break}return v()}default:return v()}}),ud=l(2,(e,t)=>q(Ha(e,t,y(t)))),tr=l(3,(e,t,n)=>Va(e,t,()=>T(n))),ld=l(3,(e,t,n)=>e._editable?(e._root=t,e._size=n,e):t===e._root?e:new Br(e._editable,e._edit,t,n)),fd=e=>new fs(e,t=>t),Bn=e=>e._size,Ba=e=>new Br(!0,e._edit+1,e._root,e._size),hd=e=>(e._editable=!1,e),Va=l(3,(e,t,n)=>dd(e,t,y(t),n)),dd=l(4,(e,t,n,s)=>{const r={value:e._size},o=e._root.modify(e._editable?e._edit:NaN,0,s,n,t,r);return a(e,ld(o,r.value))}),Xo=l(2,(e,t)=>Va(e,t,v)),gd=l(2,(e,t)=>Ja(e,void 0,(n,s,r)=>t(s,r))),Ja=l(3,(e,t,n)=>{const s=e._root;if(s._tag==="LeafNode")return q(s.value)?n(t,s.value.value,s.key):t;if(s._tag==="EmptyNode")return t;const r=[s.children];let o;for(;o=r.pop();)for(let i=0,c=o.length;i<c;){const u=o[i++];u&&!vt(u)&&(u._tag==="LeafNode"?q(u.value)&&(t=n(t,u.value.value,u.key)):r.push(u.children))}return t}),Ya=Symbol.for("@effect/data/HashSet");class hs{constructor(t){this._keyMap=t,this._id=Ya}[Symbol.iterator](){return fd(this._keyMap)}[A](){return M(y(this._keyMap))(y("HashSet"))}[O](t){return pd(t)?Bn(this._keyMap)===Bn(t._keyMap)&&S(this._keyMap,t._keyMap):!1}toString(){return`HashSet(${Array.from(this).map(String).join(", ")})`}toJSON(){return{_tag:"HashSet",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}}const pd=e=>typeof e=="object"&&e!=null&&"_id"in e&&e._id===Ya,ds=()=>new hs(Vr()),md=e=>{const t=Jr(ds());for(const n of e)tn(t,n);return Yr(t)},yd=(...e)=>{const t=Jr(ds());for(const n of e)tn(t,n);return Yr(t)},_d=l(2,(e,t)=>ud(e._keyMap,t)),bd=e=>Bn(e._keyMap),Jr=e=>new hs(Ba(e._keyMap)),Yr=e=>(e._keyMap._editable=!1,e),Qa=l(2,(e,t)=>{const n=Jr(e);return t(n),Yr(n)}),tn=l(2,(e,t)=>e._keyMap._editable?(tr(t,!0)(e._keyMap),e):new hs(tr(t,!0)(e._keyMap))),Xa=l(2,(e,t)=>e._keyMap._editable?(Xo(t)(e._keyMap),e):new hs(Xo(t)(e._keyMap))),Sd=l(2,(e,t)=>Qa(e,n=>{for(const s of t)Xa(n,s)})),vd=l(2,(e,t)=>Qa(ds(),n=>{Za(e,s=>tn(n,s));for(const s of t)tn(n,s)})),Za=l(2,(e,t)=>gd(e._keyMap,(n,s)=>t(s))),Ed=l(3,(e,t,n)=>Ja(e._keyMap,t,(s,r,o)=>n(s,o))),tc=Vr,ec=ad,$d=Bn,$t=ds,nc=md,Qr=yd,wd=_d,sc=bd,Pt=tn,rc=Xa,Zo=Sd,ke=vd,kd=Za,Vn=Ed,gs=Symbol.for("@effect/data/Differ/HashSetPatch");function ps(e){return e}class Id{constructor(){this._tag="Empty",this._Value=ps,this._id=gs}[A](){return J("HashSetPatch(Empty)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id}}class Td{constructor(t,n){this.first=t,this.second=n,this._tag="AndThen",this._Value=ps,this._id=gs}[A](){return J("HashSetPatch(AndThen)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&S(this.first,t.first)&&S(this.second,t.second)}}class Md{constructor(t){this.value=t,this._tag="Add",this._Value=ps,this._id=gs}[A](){return J("HashSetPatch(Add)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&S(this.value,t.value)}}class Ad{constructor(t){this.value=t,this._tag="Remove",this._Value=ps,this._id=gs}[A](){return J("HashSetPatch(Remove)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&S(this.value,t.value)}}const oc=()=>new Id,Od=(e,t)=>{const[n,s]=Vn([e,oc()],([r,o],i)=>wd(i)(r)?[rc(i)(r),o]:[r,er(new Md(i))(o)])(t);return Vn(s,(r,o)=>er(new Ad(o))(r))(n)},er=l(2,(e,t)=>new Td(e,t)),Cd=l(2,(e,t)=>{let n=t,s=K(e);for(;ee(s);){const r=ve(s),o=Lt(s);switch(r._tag){case"Empty":{s=o;break}case"AndThen":{s=mt(r.first)(mt(r.second)(o));break}case"Add":{n=Pt(r.value)(n),s=o;break}case"Remove":n=rc(r.value)(n),s=o}}return n}),ic=oc,Rd=Od,Fd=er,Pd=Cd,Nd=Symbol.for("@effect/data/Differ");class Ld{constructor(t){this._id=Nd,this._P=Q,this._V=Q,this.empty=t.empty,this.diff=t.diff,this.combine=t.combine,this.patch=t.patch}}const ms=e=>new Ld(e),xd=()=>ms({empty:Da(),combine:(e,t)=>Jh(t)(e),diff:(e,t)=>Vh(e,t),patch:(e,t)=>Yh(t)(e)}),jd=()=>ms({empty:ic(),combine:(e,t)=>Fd(t)(e),diff:(e,t)=>Rd(e,t),patch:(e,t)=>Pd(t)(e)}),Dd=()=>qd((e,t)=>t),qd=e=>ms({empty:Q,combine:(t,n)=>t===Q?n:n===Q?t:s=>n(t(s)),diff:(t,n)=>S(t,n)?Q:dn(n),patch:(t,n)=>e(n,t(n))}),Kd=l(3,(e,t,n)=>e.diff(t,n)),Ud=l(3,(e,t,n)=>e.combine(t,n)),Wd=l(3,(e,t,n)=>e.patch(t,n)),ac=ms,zd=xd,Gd=jd,Hd=Dd,Bd=Symbol.for("@effect/data/MutableRef");class Vd{constructor(t){this.current=t,this._T=n=>n,this._id=Bd}get(){return this.current}set(t){return this.current=t,this}setAndGet(t){return this.current=t,this.current}getAndSet(t){const n=this.current;return this.current=t,n}compareAndSet(t,n){return S(t,this.current)?(this.current=n,!0):!1}pipe(t){return t(this)}update(t){return this.set(t(this.get()))}updateAndGet(t){return this.setAndGet(t(this.get()))}getAndUpdate(t){return this.getAndSet(t(this.get()))}toString(){return`MutableRef(${String(this.current)})`}toJSON(){return{_tag:"MutableRef",current:this.current}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}}const Ce=e=>new Vd(e),Jd=l(3,(e,t,n)=>e.compareAndSet(t,n)),ae=e=>e.current,Yd=e=>e.getAndUpdate(t=>t+1),ce=l(2,(e,t)=>e.set(t)),Qd=["All","Fatal","Error","Warning","Info","Debug","Trace","None"],Re=e=>function(){if(Yt.tracingEnabled)return e.apply(this,arguments);Yt.tracingEnabled=!0;try{return e.apply(this,arguments)}finally{Yt.tracingEnabled=!1}},Fe=e=>function(){if(!Yt.tracingEnabled)return e.apply(this,arguments);Yt.tracingEnabled=!1;try{return e.apply(this,arguments)}finally{Yt.tracingEnabled=!0}},bt=typeof process<"u"?process.env:void 0,Yt={minumumLogLevel:bt&&bt.EFFECT_LOG_LEVEL&&Qd.includes(bt.EFFECT_LOG_LEVEL)?bt.EFFECT_LOG_LEVEL:"Info",traceStackLimit:bt&&bt.EFFECT_TRACING_STACK_LIMIT?Number.parseInt(bt.EFFECT_TRACING_STACK_LIMIT):5,tracingEnabled:!(bt&&bt.EFFECT_TRACING_ENABLED&&bt.EFFECT_TRACING_ENABLED==="false"),parseStack:e=>{const t=e.stack;if(t){const n=t.split(`
`);let s=0;for(let o=0;o<n.length;o++)n[o].startsWith("Error")&&(s=o);const r=[];for(let o=s+1;o<n.length;o++)if(n[o].includes("at")){const i=n[o].split(" ").filter(h=>h.length>0&&h!=="at"),c=i.length===2&&!i[0].includes("<anonymous>")?i[0]:void 0,f=(i.length===2?i[1]:i[0])?.match(/\(?(.*):(\d+):(\d+)/);f?r.push({name:c,fileName:f[1],line:Number.parseInt(f[2]),column:Number.parseInt(f[3])}):r.push(void 0)}else r.push(void 0);return r}return[]},filterStackFrame:e=>e!=null&&!e.fileName.match(/\/internal_effect_untraced/)},F=Yt,Xd=Object.setPrototypeOf({toFrame(){if("parsed"in this)return this.parsed;const e=F.parseStack(this);return e&&e.length>=2&&e[0]&&e[1]?this.parsed={...e[this.depth-1],name:e[this.depth-2]?.name}:this.parsed=void 0,this.parsed}},Error.prototype),Xr=e=>(e.depth=Error.stackTraceLimit,Object.setPrototypeOf(e,Xd),e),D=e=>{if(!F.tracingEnabled)return e(void 0,Fe);F.tracingEnabled=!1;try{const t=Error.stackTraceLimit;Error.stackTraceLimit=3;const n=Xr(new Error);return Error.stackTraceLimit=t,e(n,Re)}finally{F.tracingEnabled=!0}},g=e=>function(){if(!F.tracingEnabled)return e(void 0,Fe).apply(this,arguments);F.tracingEnabled=!1;try{const t=Error.stackTraceLimit;Error.stackTraceLimit=2;const n=Xr(new Error);return Error.stackTraceLimit=t,e(n,Re).apply(this,arguments)}finally{F.tracingEnabled=!0}},_=(e,t)=>{const n=typeof e=="number"?s=>s.length===e:e;return function(){if(!F.tracingEnabled){const s=t(void 0,Fe);return n(arguments)?Y(()=>s.apply(this,arguments)):r=>Y(()=>s(r,...arguments))}F.tracingEnabled=!1;try{const s=Error.stackTraceLimit;Error.stackTraceLimit=2;const r=Xr(new Error);Error.stackTraceLimit=s;const o=t(r,Re);return n(arguments)?Y(()=>o.apply(this,arguments)):i=>Y(()=>o(i,...arguments))}finally{F.tracingEnabled=!0}}},Y=e=>{if(!F.tracingEnabled)return e(Fe);F.tracingEnabled=!1;try{return e(Re)}finally{F.tracingEnabled=!0}},Zd=(e,t)=>function(){if(!F.tracingEnabled){const n=t(Fe);return arguments.length===e?Y(()=>n.apply(this,arguments)):s=>Y(()=>n(s,...arguments))}F.tracingEnabled=!1;try{const n=t(Re);return arguments.length===e?Y(()=>n.apply(this,arguments)):s=>Y(()=>n(s,...arguments))}finally{F.tracingEnabled=!0}},ys=e=>function(){if(!F.tracingEnabled)return Y(()=>e(Fe).apply(this,arguments));F.tracingEnabled=!1;try{return Y(()=>e(Re).apply(this,arguments))}finally{F.tracingEnabled=!0}};var ti,ei,ni;const _s="@effect/io/Fiber/Id",se=Symbol.for(_s),en="None",nr="Runtime",sr="Composite";let tg=class{constructor(){this[ti]=se,this._tag=en}[(ti=se,A)](){return a(y(_s),M(y(this._tag)))}[O](t){return Zr(t)&&t._tag===en}};class eg{constructor(t,n){this.id=t,this.startTimeMillis=n,this[ei]=se,this._tag=nr}[(ei=se,A)](){return a(y(_s),M(y(this._tag)),M(y(this.id)),M(y(this.startTimeMillis)))}[O](t){return Zr(t)&&t._tag===nr&&this.id===t.id&&this.startTimeMillis===t.startTimeMillis}}class ng{constructor(t,n){this.left=t,this.right=n,this[ni]=se,this._tag=sr}[(ni=se,A)](){return a(y(_s),M(y(this._tag)),M(y(this.left)),M(y(this.right)))}[O](t){return Zr(t)&&t._tag===sr&&S(this.left,t.left)&&S(this.right,t.right)}}const sg=new tg,Zr=e=>typeof e=="object"&&e!=null&&se in e,rg=l(2,(e,t)=>e._tag===en?t:t._tag===en?e:new ng(e,t)),Jn=e=>{switch(e._tag){case en:return $t();case nr:return Qr(e.id);case sr:return a(Jn(e.left),ke(Jn(e.right)))}},si=Ce(0),og=e=>Array.from(Jn(e)).map(n=>`#${n}`).join(","),ig=()=>{const e=ae(si);return a(si,ce(e+1)),new eg(e,new Date().getTime())},Dt=sg,ag=rg,cg=Jn,cc=ig,nn=255,uc=8,rr=e=>e&nn,or=e=>e>>uc&nn,pn=(e,t)=>(e&nn)+((t&e&nn)<<uc),lc=pn(0,0),ug=e=>pn(e,e),lg=e=>pn(e,0),fg=l(2,(e,t)=>pn(rr(e)&~t,or(e))),hg=l(2,(e,t)=>e|t),dg=e=>~e>>>0&nn,gg=0,Pe=1<<0,pg=1<<1,mg=1<<2,ir=1<<4,fc=1<<5,yg=e=>mn(e,fc),_g=l(2,(e,t)=>e|t),Ht=e=>hc(e)&&!vg(e),hc=e=>mn(e,Pe),mn=l(2,(e,t)=>(e&t)!==0),dc=(...e)=>e.reduce((t,n)=>t|n,0),bg=dc(gg),Sg=e=>mn(e,pg),Us=e=>mn(e,mg),vg=e=>mn(e,ir),ar=l(2,(e,t)=>pn(e^t,t)),cr=l(2,(e,t)=>e&(dg(rr(t))|or(t))|rr(t)&or(t)),Eg=()=>ac({empty:lc,diff:(e,t)=>ar(e,t),combine:(e,t)=>hg(t)(e),patch:(e,t)=>cr(t,e)}),$g=lc,wg=ug,gc=lg,ri=fg,Ne="Die",re="Empty",yn="Fail",_n="Interrupt",oe="Annotated",Ie="Parallel",Te="Sequential";var pc;const mc="@effect/io/Cause",yc=Symbol.for(mc),kg={_E:e=>e},ue={[yc]:kg,[A](){return a(y(mc),M(y(Pg(this))))},[O](e){return Ig(e)&&Fg(this,e)}},jt=(()=>{const e=Object.create(ue);return e._tag=re,e})(),Le=e=>{const t=Object.create(ue);return t._tag=yn,t.error=e,t},Tt=e=>{const t=Object.create(ue);return t._tag=Ne,t.defect=e,t},Qt=e=>{const t=Object.create(ue);return t._tag=_n,t.fiberId=e,t},sn=(e,t)=>{const n=Object.create(ue);return n._tag=oe,n.cause=e,n.annotation=t,n},wt=(e,t)=>{const n=Object.create(ue);return n._tag=Ie,n.left=e,n.right=t,n},tt=(e,t)=>{const n=Object.create(ue);return n._tag=Te,n.left=e,n.right=t,n},Ig=e=>typeof e=="object"&&e!=null&&yc in e,Tg=e=>e._tag===re,RE=e=>e._tag===Ne,Mg=e=>e._tag===oe,Ag=e=>e._tag===re?!0:on(e,!0,(t,n)=>{switch(n._tag){case re:return T(t);case Ne:case yn:case _n:return T(!1);default:return v()}}),_c=e=>bs(void 0,jg)(e),Og=e=>qr(on(e,at(),(t,n)=>n._tag===Ne?T(a(t,mt(n.defect))):v())),bc=e=>on(e,$t(),(t,n)=>n._tag===_n?T(a(t,Pt(n.fiberId))):v()),Sc=e=>xg(e,t=>t._tag===yn?T(t.error):v()),vc=e=>{const t=Sc(e);switch(t._tag){case"None":return ut(e);case"Some":return lt(t.value)}},Cg=e=>to(e,v(),()=>v(),t=>T(Tt(t)),()=>v(),(t,n)=>a(t,Vt(s=>sn(s,n))),(t,n)=>q(t)&&q(n)?T(tt(t.value,n.value)):q(t)&&U(n)?T(t.value):U(t)&&q(n)?T(n.value):v(),(t,n)=>q(t)&&q(n)?T(wt(t.value,n.value)):q(t)&&U(n)?T(t.value):U(t)&&q(n)?T(n.value):v()),rn=e=>to(e,jt,()=>jt,t=>Tt(t),t=>Qt(t),(t,n)=>Tg(t)?t:sn(t,n),(t,n)=>tt(t,n),(t,n)=>wt(t,n)),FE=l(2,(e,t)=>Rg(e,n=>Le(t(n)))),Rg=l(2,(e,t)=>to(e,jt,n=>t(n),n=>Tt(n),n=>Qt(n),(n,s)=>sn(n,s),(n,s)=>tt(n,s),(n,s)=>wt(n,s))),Fg=(e,t)=>{let n=K(e),s=K(t);for(;ee(n)&&ee(s);){const[r,o]=a(ve(n),on([$t(),at()],([u,f],h)=>{const[d,m]=ur(h);return T([a(u,ke(d)),a(f,W(m))])})),[i,c]=a(ve(s),on([$t(),at()],([u,f],h)=>{const[d,m]=ur(h);return T([a(u,ke(d)),a(f,W(m))])}));if(!S(r,i))return!1;n=o,s=c}return!0},Pg=e=>Ng(K(e),at()),Ng=(e,t)=>{for(;;){const[n,s]=a(e,us([$t(),at()],([o,i],c)=>{const[u,f]=ur(c);return[a(o,ke(u)),a(i,W(f))]})),r=sc(n)>0?a(t,mt(n)):t;if(cs(s))return qr(r);e=s,t=r}throw new Error("BUG: Cause.flattenCauseLoop - please report an issue at https://github.com/Effect-TS/io/issues")},Lg=l(2,(e,t)=>{const n=a(e,Sc,Vt(t));switch(n._tag){case"None":return a(Og(e),me,Lr(()=>{const s=Array.from(bc(e)).flatMap(r=>Array.from(cg(r)).map(o=>`#${o}`));return qg(s?`Interrupted by fibers: ${s.join(", ")}`:void 0)},Q));case"Some":return n.value}}),xg=l(2,(e,t)=>{const n=[e];for(;n.length>0;){const s=n.pop(),r=t(s);switch(r._tag){case"None":{switch(s._tag){case Te:case Ie:{n.push(s.right),n.push(s.left);break}case oe:{n.push(s.cause);break}}break}case"Some":return r}}return v()}),ur=e=>{let t=e;const n=[];let s=$t(),r=at();for(;t!==void 0;)switch(t._tag){case re:{if(n.length===0)return[s,r];t=n.pop();break}case yn:{if(n.length===0)return[a(s,Pt(t.error)),r];s=a(s,Pt(t.error)),t=n.pop();break}case Ne:{if(n.length===0)return[a(s,Pt(t.defect)),r];s=a(s,Pt(t.defect)),t=n.pop();break}case _n:{if(n.length===0)return[a(s,Pt(t.fiberId)),r];s=a(s,Pt(t.fiberId)),t=n.pop();break}case oe:{t=t.cause;break}case Te:{switch(t.left._tag){case re:{t=t.right;break}case Te:{t=tt(t.left.left,tt(t.left.right,t.right));break}case Ie:{t=wt(tt(t.left.left,t.right),tt(t.left.right,t.right));break}case oe:{t=tt(t.left.cause,t.right);break}default:{r=a(r,mt(t.right)),t=t.left;break}}break}case Ie:{n.push(t.right),t=t.left;break}}throw new Error("BUG: Cause.evaluateCauseLoop - please report an issue at https://github.com/Effect-TS/io/issues")},jg={emptyCase:zo,failCase:Ys,dieCase:Ys,interruptCase:zo,annotatedCase:(e,t)=>t,sequentialCase:(e,t,n)=>t&&n,parallelCase:(e,t,n)=>t&&n},oi="SequentialCase",ii="ParallelCase",ai="AnnotatedCase",to=l(8,(e,t,n,s,r,o,i,c)=>bs(e,void 0,{emptyCase:()=>t,failCase:(u,f)=>n(f),dieCase:(u,f)=>s(f),interruptCase:(u,f)=>r(f),annotatedCase:(u,f,h)=>o(f,h),sequentialCase:(u,f,h)=>i(f,h),parallelCase:(u,f,h)=>c(f,h)})),on=l(3,(e,t,n)=>{let s=t,r=e;const o=[];for(;r!==void 0;){const i=n(s,r);switch(s=q(i)?i.value:s,r._tag){case Te:{o.push(r.right),r=r.left;break}case Ie:{o.push(r.right),r=r.left;break}case oe:{r=r.cause;break}default:{r=void 0;break}}r===void 0&&o.length>0&&(r=o.pop())}return s}),bs=l(3,(e,t,n)=>{const s=[e],r=[];for(;s.length>0;){const i=s.pop();switch(i._tag){case re:{r.push(ut(n.emptyCase(t)));break}case yn:{r.push(ut(n.failCase(t,i.error)));break}case Ne:{r.push(ut(n.dieCase(t,i.defect)));break}case _n:{r.push(ut(n.interruptCase(t,i.fiberId)));break}case oe:{s.push(i.cause),r.push(lt({_tag:ai,annotation:i.annotation}));break}case Te:{s.push(i.right),s.push(i.left),r.push(lt({_tag:oi}));break}case Ie:{s.push(i.right),s.push(i.left),r.push(lt({_tag:ii}));break}}}const o=[];for(;r.length>0;){const i=r.pop();switch(i._tag){case"Left":{switch(i.left._tag){case oi:{const c=o.pop(),u=o.pop(),f=n.sequentialCase(t,c,u);o.push(f);break}case ii:{const c=o.pop(),u=o.pop(),f=n.parallelCase(t,c,u);o.push(f);break}case ai:{const c=o.pop(),u=n.annotatedCase(t,c,i.left.annotation);o.push(u);break}}break}case"Right":{o.push(i.right);break}}}if(o.length===0)throw new Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/io/issues");return o.pop()}),eo=(e,t)=>{const n={value:t,enumerable:!0},s={...e,toString(){return`${this._tag}: ${this.message}`}};return r=>Object.create(s,{_tag:n,message:{value:r,enumerable:!0}})},ci=Symbol.for("@effect/io/Cause/errors/RuntimeException"),Dg=eo({[ci]:ci},"RuntimeException"),lr=Symbol.for("@effect/io/Cause/errors/InterruptedException"),qg=eo({[lr]:lr},"InterruptedException"),Kg=e=>typeof e=="object"&&e!=null&&lr in e,ui=Symbol.for("@effect/io/Cause/errors/IllegalArgument"),PE=eo({[ui]:ui},"IllegalArgumentException"),no=Symbol.for("@effect/io/Cause/StackAnnotation");class fr{constructor(t,n){this.stack=t,this.seq=n,this[pc]=no}}pc=no;const Ug=Ce(0),Ec=e=>typeof e=="object"&&e!=null&&no in e,Wg=()=>({emptyCase:()=>jt,failCase:(e,t)=>Le(t),dieCase:(e,t)=>Tt(t),interruptCase:(e,t)=>Qt(t),annotatedCase:(e,t,n)=>t,sequentialCase:(e,t,n)=>tt(t,n),parallelCase:(e,t,n)=>wt(t,n)}),NE=e=>bs(e,void 0,Wg()),bn="Pending",so="Done",zg="@effect/io/Deferred",Gg=Symbol.for(zg),Hg={_E:e=>e,_A:e=>e},ro=e=>({_tag:bn,joiners:e}),$c=e=>({_tag:so,effect:e}),xn="Async",Bg="Commit",H="Failure",jn="OnFailure",Yn="OnSuccess",Qn="OnSuccessAndFailure",Dn="OpTraced",B="Success",wc="Sync",Sn="UpdateRuntimeFlags",Xn="While",kc="WithRuntime",qn="Yield",oo="RevertFlags";class Vg{constructor(){this.running=!1,this.tasks=[]}get preferredExecution(){return"Async"}starveInternal(t){const n=this.tasks;this.tasks=[];for(let s=0;s<n.length;s++)n[s]();this.tasks.length===0?this.running=!1:this.starve(t)}starve(t=0){t>=2048?setTimeout(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(t+1))}scheduleTask(t){this.tasks.push(t),this.running||(this.running=!0,this.starve())}}const Jg=new Vg,Yg="@effect/io/Effect/Error",hr=Symbol.for(Yg),Qg=e=>typeof e=="object"&&e!=null&&hr in e,Xg=e=>({[hr]:hr,_tag:"EffectError",cause:e}),Ic=Symbol.for("@effect/io/Effect");class Zg{constructor(t){this.patch=t,this._tag=oo}}const tp={_R:e=>e,_E:e=>e,_A:e=>e},X={[Ic]:tp,[O](e){return this===e},[A](){return Sa(this)},traced(e){if(e){const t=Object.create(X);return t._tag=Dn,t.self=this,t.trace=e,t}return this}},li=e=>typeof e=="object"&&e!=null&&Ic in e,io=_(3,(e,t)=>(n,s,r)=>kt(o=>a(n,p(i=>a(C(()=>o(t(s)(i))),Xt,p(c=>a(C(()=>t(r)(i,c)),nt(u=>{switch(c._tag){case H:return x(wt(c.cause,u));case B:return x(u)}},()=>c))))))).traced(e)),ft=_(2,e=>(t,n)=>a(t,p(()=>k(n))).traced(e)),ht=g(e=>t=>a(t,ft(void 0)).traced(e)),Ss=g(e=>(t,n=Dt)=>{const s=Object.create(X);return s._tag=xn,s.register=t,s.blockingOn=n,s.trace=void 0,e?s.traced(e):s}),vs=g((e,t)=>(n,s=Dt)=>C(()=>{let r=P();return a(Ss(o=>{const i=t(n)(o);Ye(i)?o(i.right):r=i.left},s),Nc(()=>r))}).traced(e)),ep=g((e,t)=>(n,s=Dt)=>C(()=>{let r=P();return a(Ss(o=>{r=t(n)(o)},s),Nc(()=>r))}).traced(e)),np=_(2,(e,t)=>(n,s)=>{const r=Object.create(X);return r._tag=jn,r.first=n,r.failK=t(s),r.trace=void 0,e?r.traced(e):r}),fi=_(2,(e,t)=>(n,s)=>a(n,Es(t(s),k)).traced(e)),Tc=g(e=>t=>x(Tt(t)).traced(e)),Mc=g(e=>t=>C(()=>t).traced(e)),hi=g(e=>t=>a(t,Es(n=>k(lt(n)),n=>k(ut(n)))).traced(e)),ao=g(e=>()=>C(()=>Ts($n)).traced(e)),Ac=g((e,t)=>n=>a(ao(),p(t(n))).traced(e)),Xt=g(e=>t=>a(t,Rc(x,k)).traced(e)),gt=g(e=>t=>x(Le(t)).traced(e)),sp=g((e,t)=>n=>Oc(()=>Le(t(n)())).traced(e)),x=g(e=>t=>{const n=Object.create(X);return n._tag=H,n.cause=t,n.trace=void 0,e?n.traced(e):n}),Oc=g((e,t)=>n=>a(I(t(n)),p(x)).traced(e)),co=g(e=>()=>yt(t=>k(t.id())).traced(e)),Cc=g((e,t)=>n=>yt(s=>t(n)(s.id())).traced(e)),p=_(2,(e,t)=>(n,s)=>{const r=Object.create(X);return r._tag=Yn,r.first=n,r.successK=t(s),r.trace=void 0,e?r.traced(e):r}),uo=g(e=>t=>a(t,p(Q)).traced(e)),Rc=_(3,(e,t)=>(n,s,r)=>a(n,nt(o=>k(t(s)(o)),o=>k(t(r)(o)))).traced(e)),nt=_(3,(e,t)=>(n,s,r)=>{const o=Object.create(X);return o._tag=Qn,o.first=n,o.failK=t(s),o.successK=t(r),o.trace=void 0,e?o.traced(e):o}),Es=_(3,(e,t)=>(n,s,r)=>nt(n,o=>{const i=vc(o);switch(i._tag){case"Left":return t(s)(i.left);case"Right":return t(x)(i.right)}},r).traced(e)),Mt=_(2,(e,t)=>(n,s)=>C(()=>{const r=Array.from(n),o=new Array(r.length);let i=0;return a(lo(()=>i<r.length,()=>t(s)(r[i]),c=>{o[i++]=c}),ft(z(o)))}).traced(e)),$s=_(2,(e,t)=>(n,s)=>C(()=>{const r=Array.from(n);let o=0;return lo(()=>o<r.length,()=>t(s)(r[o++]),()=>{})}).traced(e)),Fc=g(e=>t=>{switch(t._tag){case"None":return gt(v()).traced(e);case"Some":return k(t.value).traced(e)}}),Nt=g(e=>t=>{switch(t._tag){case"Left":return gt(t.left).traced(e);case"Right":return k(t.right).traced(e)}}),rp=g(e=>()=>a(co(),p(t=>op(t))).traced(e)),op=g(e=>t=>x(Qt(t)).traced(e)),Pc=g(e=>t=>{const n=Object.create(X);return n._tag=Sn,n.update=wg(Pe),n.scope=()=>t,n.trace=void 0,e?n.traced(e):n}),ip=_(2,e=>(t,n)=>kt(s=>a(s(t),Xt,p(r=>Up(n,r)))).traced(e)),N=_(2,(e,t)=>(n,s)=>a(n,p(r=>I(()=>t(s)(r)))).traced(e)),an=_(2,(e,t)=>(n,s)=>nt(n,r=>{const o=vc(r);switch(o._tag){case"Left":return sp(()=>t(s)(o.left));case"Right":return x(o.right)}},k).traced(e)),ap=g(e=>()=>vs(()=>{const t=setInterval(()=>{},2147483647);return lt(I(()=>clearInterval(t)))}).traced(e)),cn=_(2,(e,t)=>(n,s)=>kt(r=>nt(r(n),o=>{const i=V(o);return a(t(s)(i),nt(c=>V(tt(o,c)),()=>i))},o=>{const i=Rt(o);return a(t(s)(i),rt(i))})).traced(e)),Nc=_(2,(e,t)=>(n,s)=>cn(n,Ms(r=>_c(r)?ht(t(s)(bc(r))):P(),()=>P())).traced(e)),cp=_(2,(e,t)=>(n,s)=>a(n,dp(t(s),k)).traced(e)),up=g(e=>t=>lp(t,Q).traced(e)),lp=_(2,(e,t)=>(n,s)=>a(n,Es(r=>Tc(t(s)(r)),k)).traced(e)),xe=_(2,e=>(t,n)=>a(t,po($n,n)).traced(e)),fp=_(2,(e,t)=>(n,s)=>Ac(r=>a(n,xe(t(s)(r)))).traced(e)),Lc=g(e=>t=>ws(t,k).traced(e)),hp=g((e,t)=>(n,s)=>ws(n,r=>I(()=>t(s)(r))).traced(e)),ws=g((e,t)=>(n,s)=>C(()=>a(Ts($n),p(r=>t(s)(a(r,qh(n)))))).traced(e)),k=g(e=>t=>{const n=Object.create(X);return n._tag=B,n.value=t,n.trace=void 0,e?n.traced(e):n}),C=g((e,t)=>n=>a(I(t(n)),p(Q)).traced(e)),I=g((e,t)=>n=>{const s=Object.create(X);return s._tag=wc,s.evaluate=t(n),s.trace=void 0,e?s.traced(e):s}),vn=_(2,(e,t)=>(n,s)=>a(n,p(r=>a(t(s)(r),ft(r)))).traced(e)),xc=g((e,t)=>n=>yt(s=>{const r=s.getFiberRef(ln),o=a(r,It(()=>s.scope()));return t(n)(po(ln,T(o)))}).traced(e)),dp=_(3,(e,t)=>(n,s,r)=>nt(n,o=>{const i=Cg(o);switch(i._tag){case"None":return t(s)();case"Some":return x(i.value)}},t(r)).traced(e)),ks=g(e=>t=>{const n=Object.create(X);return n._tag=Sn,n.update=gc(Pe),n.scope=()=>t,n.trace=void 0,e?n.traced(e):n}),kt=g((e,t)=>n=>{const s=Object.create(X);return s._tag=Sn,s.update=gc(Pe),s.scope=r=>hc(r)?t(n)(Pc):t(n)(ks),s.trace=void 0,e?s.traced(e):s}),P=g(e=>t=>k(void 0).traced(e)),gp=g(e=>t=>{const n=Object.create(X);return n._tag=Sn,n.update=t,n.scope=void 0,n.trace=void 0,e?n.traced(e):n}),pp=_(2,e=>(t,n)=>a(n,p(s=>s?a(t,N(T)):k(v()))).traced(e)),lo=g((e,t)=>(n,s,r)=>{const o=Object.create(X);return o._tag=Xn,o.check=t(n),o.body=t(s),o.process=t(r),o.trace=void 0,e?o.traced(e):o}),yt=g((e,t)=>n=>{const s=Object.create(X);return s._tag=kc,s.withRuntime=t(n),s.trace=void 0,e?s.traced(e):s}),mp=_(2,e=>(t,n)=>C(()=>po(yo,T(n))(t)).traced(e)),jc=g(e=>(t="normal")=>{const n=Object.create(X);return n._tag=qn,n.priority=t,n.trace=void 0,e?n.traced(e):n}),un=_(2,e=>(t,n)=>p(t,s=>N(n,r=>[s,r])).traced(e)),fo=_(2,e=>(t,n)=>p(t,s=>ft(n,s)).traced(e)),rt=_(2,e=>(t,n)=>p(t,()=>n).traced(e)),ho=_(3,(e,t)=>(n,s,r)=>p(n,o=>N(s,i=>t(r)(o,i))).traced(e)),Is=g(e=>t=>a(co(),p(n=>a(t,Dc(n)))).traced(e)),Dc=_(2,e=>(t,n)=>a(t.interruptAsFork(n),p(()=>t.await())).traced(e)),yp={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER},_p={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4},bp={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4},Sp={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4},qc={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4},vp={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4},Ep={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0},$p={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER},wp="@effect/io/FiberRef",kp=Symbol.for(wp),Ip={_A:e=>e},Ts=g(e=>t=>Kc(t,n=>[n,n]).traced(e)),go=_(2,(e,t)=>(n,s)=>p(Ts(n),t(s)).traced(e)),di=_(2,e=>(t,n)=>Kc(t,()=>[void 0,n]).traced(e)),Kc=_(2,(e,t)=>(n,s)=>yt(r=>{const[o,i]=t(s)(r.getFiberRef(n));return r.setFiberRef(n,i),k(o)}).traced(e)),po=_(3,e=>(t,n,s)=>io(fo(Ts(n),di(n,s)),()=>t,r=>di(n,r)).traced(e)),qt=(e,t=Q,n=(s,r)=>r)=>En(e,Hd(),t,n),Uc=e=>En(e,Gd(),ic()),Wc=e=>En(e,zd(),Da()),En=(e,t,n,s=(r,o)=>o)=>({[kp]:Ip,initial:e,diff:(r,o)=>a(t,Kd(r,o)),combine:(r,o)=>a(t,Ud(r,o)),patch:r=>o=>a(t,Wd(r,o)),fork:n,join:s}),Tp=e=>En(e,Eg(),$g),$n=Wc(Kr()),Mp=qt(tc()),Ap=qt(qc),Op=qt(at()),mo=qt(Jg),yo=qt(v()),Ws=Uc($t()),ln=qt(v(),()=>v(),(e,t)=>e),On=qt(jt,()=>jt,(e,t)=>e),gi=Symbol.for("@effect/io/Scope"),pi=Symbol.for("@effect/io/CloseableScope"),LE=g(e=>(t,n)=>t.addFinalizer(()=>ht(n)).traced(e)),Zn=g((e,t)=>(n,s)=>n.addFinalizer(t(s)).traced(e)),ts=g(e=>(t,n)=>t.close(n).traced(e)),xE=g(e=>(t,n)=>t.fork(n).traced(e)),mi=_(2,(e,t)=>(n,s)=>a(n,Rp(t(s)),N(Lr(()=>()=>P(),r=>o=>Cp(r,o)(n)))).traced(e)),Cp=_(3,e=>(t,n,s)=>C(()=>{switch(t.state._tag){case"Exited":return P();case"Running":{const r=t.state.finalizers.get(n);return t.state.finalizers.delete(n),r!=null?t.state.update(r)(s):P()}}}).traced(e)),Rp=_(2,(e,t)=>(n,s)=>C(()=>{switch(n.state._tag){case"Exited":return n.state.nextKey+=1,a(t(s)(n.state.exit),ft(v()));case"Running":{const r=n.state.nextKey;return n.state.finalizers.set(r,s),n.state.nextKey+=1,k(T(r))}}}).traced(e)),Fp=g(e=>()=>I(()=>({state:{_tag:"Running",nextKey:0,finalizers:new Map,update:Q}})).traced(e)),zc=e=>e._tag==="Failure",Pp=e=>e._tag==="Success",Np=l(2,(e,t)=>{switch(e._tag){case H:return e;case B:return Rt(t)}}),zs=e=>Np(e,void 0),Gc=e=>Bc(e,tt),dr=e=>Bc(e,wt),Hc=e=>V(Le(e)),V=e=>{const t=Object.create(X);return t._tag=H,t.cause=e,t.trace=void 0,t},Lp=l(2,(e,t)=>{switch(e._tag){case H:return e;case B:return t(e.value)}}),xp=e=>a(e,Lp(Q)),gr=l(2,(e,t)=>{switch(e._tag){case H:return e;case B:return Rt(t(e.value))}}),Ms=l(3,(e,t,n)=>{switch(e._tag){case H:return t(e.cause);case B:return n(e.value)}}),jp=l(3,(e,t,n)=>{switch(e._tag){case H:return t(e.cause);case B:return n(e.value)}}),Rt=e=>{const t=Object.create(X);return t._tag=B,t.value=e,t.trace=void 0,t},xt=()=>Rt(void 0),Dp=l(2,(e,t)=>_o(e,t,(n,s)=>s,tt)),_o=l(4,(e,t,n,s)=>{switch(e._tag){case H:switch(t._tag){case B:return e;case H:return V(s(e.cause,t.cause))}case B:switch(t._tag){case B:return Rt(n(e.value,t.value));case H:return t}}}),Bc=(e,t)=>{const n=Ae(e);return ee(n)?a(Lt(n),us(a(ve(n),gr(K)),(s,r)=>a(s,_o(r,(o,i)=>a(o,mt(i)),t))),gr(qr),T):v()},As=e=>({[Gg]:Hg,state:Ce(ro([])),blockingOn:e}),qp=g(e=>()=>a(co(),p(t=>Kp(t))).traced(e)),Kp=g(e=>t=>I(()=>As(t)).traced(e)),Os=g(e=>t=>vs(n=>{const s=ae(t.state);switch(s._tag){case so:return ut(s.effect);case bn:return a(t.state,ce(ro([n,...s.joiners]))),lt(Gp(t,n))}},t.blockingOn).traced(e)),Cs=_(2,e=>(t,n)=>I(()=>{const s=ae(t.state);switch(s._tag){case so:return!1;case bn:{a(t.state,ce($c(n)));for(let r=0;r<s.joiners.length;r++)s.joiners[r](n);return!0}}}).traced(e)),Up=_(2,e=>(t,n)=>Cs(t,Mc(n)).traced(e)),Vc=_(2,e=>(t,n)=>Cs(t,gt(n)).traced(e)),Wp=_(2,e=>(t,n)=>Cs(t,x(n)).traced(e)),zp=_(2,e=>(t,n)=>Cs(t,k(n)).traced(e)),bo=(e,t)=>{const n=ae(e.state);if(n._tag===bn){a(e.state,ce($c(t)));for(let s=n.joiners.length-1;s>=0;s--)n.joiners[s](t)}},Gp=(e,t)=>I(()=>{const n=ae(e.state);n._tag===bn&&a(e.state,ce(ro(n.joiners.filter(s=>s!==t))))});var Jc;const Hp="@effect/io/Clock",So=Symbol.for(Hp),Yc=Ct(So),Bp=2**31-1,yi={unsafeSchedule(e,t){if(t.millis>Bp)return Ys;let n=!1;const s=setTimeout(()=>{n=!0,e()},t.millis);return()=>(clearTimeout(s),!n)}};class Vp{constructor(){this[Jc]=So}unsafeCurrentTimeMillis(){return new Date().getTime()}currentTimeMillis(){return D(t=>I(()=>this.unsafeCurrentTimeMillis()).traced(t))}scheduler(){return D(t=>k(yi).traced(t))}sleep(t){return D(n=>vs(s=>{const r=yi.unsafeSchedule(()=>s(P()),t);return lt(ht(I(r)))}).traced(n))}}Jc=So;const Jp=()=>new Vp,Qc="And",Xc="Or",Zc="InvalidData",tu="MissingData",eu="SourceUnavailable",nu="Unsupported",Yp="@effect/io/Config/Error",_i=Symbol.for(Yp),je={[_i]:_i},su=(e,t)=>{const n=Object.create(je);return n._tag=Qc,n.left=e,n.right=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),n},ru=(e,t)=>{const n=Object.create(je);return n._tag=Xc,n.left=e,n.right=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),n},Qp=(e,t)=>{const n=Object.create(je);return n._tag=Zc,n.path=e,n.message=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`(Invalid data at ${a(this.path,Oe("."))}: "${this.message}")`}}),n},le=(e,t)=>{const n=Object.create(je);return n._tag=tu,n.path=e,n.message=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`(Missing data at ${a(this.path,Oe("."))}: "${this.message}")`}}),n},Xp=(e,t,n)=>{const s=Object.create(je);return s._tag=eu,s.path=e,s.message=t,s.cause=n,Object.defineProperty(s,"toString",{enumerable:!1,value(){return`(Source unavailable at ${a(this.path,Oe("."))}: "${this.message}")`}}),s},Zp=(e,t)=>{const n=Object.create(je);return n._tag=nu,n.path=e,n.message=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`(Unsupported operation at ${a(this.path,Oe("."))}: "${this.message}")`}}),n},Bt=l(2,(e,t)=>{switch(e._tag){case Qc:return su(Bt(t)(e.left),Bt(t)(e.right));case Xc:return ru(Bt(t)(e.left),Bt(t)(e.right));case Zc:return Qp(a(t,W(e.path)),e.message);case tu:return le(a(t,W(e.path)),e.message);case eu:return Xp(a(t,W(e.path)),e.message,e.cause);case nu:return Zp(a(t,W(e.path)),e.message)}}),tm="Constant",em="Fail",nm="Fallback",sm="Described",rm="Lazy",om="MapOrFail",im="Nested",am="Primitive",cm="Sequence",um="Table",lm="ZipWith",fm=e=>t=>le(at(),`Expected ${t.description} with name ${e}`);var bi,Si;const ou="@effect/data/List",vo=Symbol.for(ou),iu={_A:e=>e};class au{constructor(t,n){this.head=t,this.tail=n,this._tag="Cons",this[bi]=iu}toString(){return`List.Cons(${$i(this).map(String).join(", ")})`}toJSON(){return{_tag:"List.Cons",values:$i(this)}}[(bi=vo,Symbol.for("nodejs.util.inspect.custom"))](){return this.toJSON()}[O](t){return cu(t)&&this._tag===t._tag&&pm(this,t,S)}[A](){return J(ou)}[Symbol.iterator](){let t=!1,n=this;return{next(){if(t)return this.return();if(n._tag==="Nil")return t=!0,this.return();const s=n.head;return n=n.tail,{done:t,value:s}},return(s){return t||(t=!0),{done:!0,value:s}}}}}class hm{constructor(){this._tag="Nil",this[Si]=iu}toString(){return"List.Nil"}toJSON(){return{_tag:"List.Nil"}}[(Si=vo,Symbol.for("nodejs.util.inspect.custom"))](){return this.toJSON()}[A](){return va(Array.from(this))}[O](t){return cu(t)&&this._tag===t._tag}[Symbol.iterator](){return{next(){return{done:!0,value:void 0}}}}}const cu=e=>typeof e=="object"&&e!=null&&vo in e,dm=e=>e._tag==="Nil",gm=e=>e._tag==="Cons",vi=e=>{let t=e,n=0;for(;!dm(t);)n+=1,t=t.tail;return n},pm=l(3,(e,t,n)=>{if(e===t)return!0;if(vi(e)!==vi(t))return!1;const s=e[Symbol.iterator](),r=t[Symbol.iterator]();let o,i;for(;!(o=s.next()).done&&!(i=r.next()).done;)if(!n(o.value,i.value))return!1;return!0}),mm=new hm,Ei=(e,t)=>new au(e,t),ym=e=>new au(e,mm),$i=e=>Array.from(e),_m={_tag:"Empty"},wi=l(2,(e,t)=>{let n=ym(t),s=e;for(;gm(n);){const r=n.head;switch(r._tag){case"Empty":{n=n.tail;break}case"AndThen":{n=Ei(r.first,Ei(r.second,n.tail));break}case"MapName":{s=ye(s,r.f),n=n.tail;break}case"Nested":{s=mt(s,r.name),n=n.tail;break}case"Unnested":{if(a(me(s),Qf(Zf)(r.name)))s=Lt(s),n=n.tail;else return lt(le(s,`Expected ${r.name} to be in path in ConfigProvider#unnested`));break}}}return ut(s)}),bm="@effect/io/Config/Provider",pr=Symbol.for(bm),Sm=Ct(pr),vm="@effect/io/Config/Provider/Flat",ki=Symbol.for(vm),Em=ys(e=>(t,n)=>({[pr]:pr,load:g(s=>r=>e(t)(r).traced(s)),flattened:n})),$m=ys(e=>(t,n,s)=>({[ki]:ki,patch:s,load:g(r=>(o,i,c=!0)=>e(t)(o,i,c).traced(r)),enumerateChildren:g(r=>o=>e(n)(o).traced(r))})),wm=ys(()=>e=>Em(t=>p(dt(e,at(),t,!1),n=>a(me(n),Lr(()=>gt(le(at(),`Expected a single value having structure: ${t}`)),k))),e)),km=ys(()=>(e={})=>{const{pathDelim:t,seqDelim:n}=Object.assign({},{pathDelim:"_",seqDelim:","},e),s=u=>a(u,Oe(t)),r=u=>u.split(t),o=()=>typeof process<"u"&&"env"in process&&typeof process.env=="object"?process.env:{};return wm($m((u,f,h=!0)=>{const d=s(u),m=o(),b=d in m?T(m[d]):v();return a(Fc(b),an(()=>le(u,`Expected ${d} to exist in the process context`)),p($=>Am($,u,f,n,h)))},u=>I(()=>{const f=o(),h=Object.keys(f),m=Array.from(h).map(b=>r(b.toUpperCase())).filter(b=>{for(let $=0;$<u.length;$++){const L=a(u,xr($)),j=b[$];if(j===void 0||L!==j)return!1}return!0}).flatMap(b=>b.slice(u.length,u.length+1));return nc(m)}),_m))}),Im=(e,t,n,s)=>{const r=Yo(n.length,u=>u>=s.length?v():T([e(u),u+1])),o=Yo(s.length,u=>u>=n.length?v():T([t(u),u+1])),i=a(n,W(r)),c=a(s,W(o));return[i,c]},dt=(e,t,n,s)=>{const r=n;switch(r._tag){case tm:return k(K(r.value));case sm:return C(()=>dt(e,t,r.config,s));case em:return gt(le(t,r.message));case nm:return a(C(()=>dt(e,t,r.first,s)),fi(o=>r.condition(o)?a(dt(e,t,r.second,s),fi(i=>gt(ru(o,i)))):gt(o)));case rm:return C(()=>dt(e,t,r.config(),s));case om:return C(()=>a(dt(e,t,r.original,s),p(Mt(o=>a(Nt(r.mapOrFail(o)),an(Bt(t)))))));case im:return C(()=>dt(e,a(t,W(K(r.name))),r.config,s));case am:return a(Nt(wi(t,e.patch)),p(o=>a(e.load(o,r,s),p(i=>{if(cs(i)){const c=a(Sh(o),It(()=>"<n/a>"));return gt(fm(c))}return k(i)}))));case cm:return C(()=>a(dt(e,t,r.config,!0),N(K)));case um:return C(()=>a(Nt(wi(t,e.patch)),p(o=>a(e.enumerateChildren(o),p(i=>a(i,Mt(c=>dt(e,a(o,W(K(c))),r.valueConfig,s)),N(c=>{if(c.length===0)return K(tc());const u=G(c).map(G);return a(z(Om(u).map(z)),ye(f=>ec(Qo(Ae(i),f))))})))))));case lm:return C(()=>a(dt(e,t,r.left,s),hi,p(o=>a(dt(e,t,r.right,s),hi,p(i=>{if(Je(o)&&Je(i))return gt(su(o.left,i.left));if(Je(o)&&Ye(i))return gt(o.left);if(Ye(o)&&Je(i))return gt(i.left);if(Ye(o)&&Ye(i)){const c=a(t,Oe(".")),u=Tm(t,c),[f,h]=Im(u,u,a(o.right,ye(ut)),a(i.right,ye(ut)));return a(f,Qo(h),Mt(([d,m])=>a(Nt(d),un(Nt(m)),N(([b,$])=>r.zip(b,$)))))}throw new Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/io/issues")})))))}},Tm=(e,t)=>n=>lt(le(e,`The element at index ${n} in a sequence at path "${t}" was missing`)),Mm=(e,t)=>{const n=e.split(new RegExp(`\\s*${Cm(t)}\\s*`));return z(n)},Am=(e,t,n,s,r)=>r?a(Mm(e,s),Mt(o=>Nt(n.parse(o.trim()))),an(Bt(t))):a(Nt(n.parse(e)),N(K),an(Bt(t))),Om=e=>Object.keys(e[0]).map(t=>e.map(n=>n[t])),Cm=e=>e.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&");var uu;const Rm="@effect/io/Random",Eo=Symbol.for(Rm),Fm=Ct(Eo);class Pm{constructor(t){this.seed=t,this[uu]=Eo,this.PRNG=new ba(t)}next(){return D(t=>I(()=>this.PRNG.number()).traced(t))}nextBoolean(){return D(t=>N(this.next(),n=>n>.5).traced(t))}nextInt(){return D(t=>I(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER)).traced(t))}nextRange(t,n){return D(s=>N(this.next(),r=>(n-t)*r+t).traced(s))}nextIntBetween(t,n){return D(s=>I(()=>this.PRNG.integer(1+n-t)+t).traced(s))}shuffle(t){return D(n=>Nm(t,s=>this.nextIntBetween(0,s)).traced(n))}}uu=Eo;const Nm=(e,t)=>C(()=>a(I(()=>Array.from(e)),p(n=>{const s=[];for(let r=n.length;r>=2;r=r-1)s.push(r);return a(s,$s(r=>a(t(r),N(o=>Lm(n,r-1,o)))),ft(Ae(n)))}))),Lm=(e,t,n)=>{const s=e[t];return e[t]=e[n],e[n]=s,e},xm=e=>new Pm(e),jm=a(Kr(),Nn(Yc,Jp()),Nn(Fm,xm(Math.random()*4294967296>>>0)),Nn(Sm,km())),Dm=Wc(jm),qm=g(e=>()=>lu(t=>t.currentTimeMillis()).traced(e)),Km=g(e=>t=>lu(n=>n.sleep(t)).traced(e)),lu=g((e,t)=>n=>go(Dm,s=>t(n)(a(s,Dh(Yc)))).traced(e)),fu=Symbol.for("@effect/data/Duration");class Rs{constructor(t){this.millis=t,this._id=fu}[A](){return y(this.millis)}[O](t){return Um(t)&&this.millis===t.millis}}const Um=e=>typeof e=="object"&&e!=null&&"_id"in e&&e._id===fu,hu=new Rs(0),Wm=new Rs(1/0),du=e=>new Rs(e),zm={compare:(e,t)=>e.millis<t.millis?-1:e.millis>t.millis?1:0};zm.compare;const Gm=l(2,(e,t)=>new Rs(e.millis+t.millis)),Hm=ot(Gm),Bm=Ot(Hm,hu);Bm.combineAll;const Vm=Km,Jm=qm,jE=zc,DE=Pp,qE=Gc,KE=Hc,UE=V,Ym=xp,WE=gr,zE=Ms,GE=Rt,HE=xt,BE=Dp;var gu;function Qm(e){return new wn(e)}const pu=Symbol.for("@effect/io/FiberRefs");class wn{constructor(t){this.locals=t,this[gu]=pu}}gu=pu;const Xm=(e,t,n,s=!1)=>{const r=e;let o=t,i=n,c=s,u;for(;u===void 0;)if(te(o)&&te(i)){const f=et(o)[0],h=Se(o),d=et(i)[0],m=et(i)[1],b=Se(i);f.startTimeMillis<d.startTimeMillis?(i=b,c=!0):f.startTimeMillis>d.startTimeMillis?o=h:f.id<d.id?(i=b,c=!0):f.id>d.id?o=h:u=[m,c]}else u=[r.initial,!0];return u},Zm=l(3,(e,t,n)=>{const s=new Map(e.locals);for(const[r,o]of n.locals){const i=et(o)[1];if(!S(et(o)[0],t)){if(!s.has(r)){if(S(i,r.initial))continue;s.set(r,[[t,r.join(r.initial,i)]]);continue}const c=s.get(r),[u,f]=Xm(r,c,o);if(f){const h=r.diff(u,i),d=et(c)[1],m=r.join(d,r.patch(h)(d));if(!S(d,m)){let b;const $=et(c)[0];S($,t)?b=Zt([$,m])(Se(c)):b=Zt([t,m])(c),s.set(r,b)}}}}return new wn(new Map(s))}),mu=l(2,(e,t)=>{const n=new Map;for(const[s,r]of e.locals.entries()){const o=et(r)[1],i=s.patch(s.fork)(o);S(o,i)?n.set(s,r):n.set(s,Zt([t,i])(r))}return new wn(n)}),yu=l(2,(e,t)=>{const n=new Map(e.locals);return n.delete(t),new wn(n)}),ty=l(2,(e,t)=>e.locals.has(t)?T(et(e.locals.get(t))[1]):v()),Fs=l(2,(e,t)=>a(ty(e,t),It(()=>t.initial))),es=l(4,(e,t,n,s)=>{const r=e.locals.has(n)?e.locals.get(n):mh();let o;if(oh(r))o=Oa([t,s]);else{const[c,u]=et(r);if(S(c,t)){if(S(u,s))return e;o=Zt([t,s])(Se(r))}else o=Zt([t,s])(r)}const i=new Map(e.locals);return new wn(i.set(n,o))}),ey=mu,Ii=es,ny=Qm,_u="Empty",bu="Add",Su="Remove",vu="Update",Eu="AndThen",sy=()=>({_tag:_u}),ry=(e,t)=>{const n=new Map(e.locals);let s=sy();for(const[r,o]of t.locals.entries()){const i=et(o)[1],c=n.get(r);if(c!==void 0){const u=et(c)[1];S(u,i)||(s=Gs({_tag:vu,fiberRef:r,patch:r.diff(u,i)})(s))}else s=Gs({_tag:bu,fiberRef:r,value:i})(s);n.delete(r)}for(const[r]of n.entries())s=Gs({_tag:Su,fiberRef:r})(s);return s},Gs=l(2,(e,t)=>({_tag:Eu,first:e,second:t})),oy=l(3,(e,t,n)=>{let s=n,r=Oa(e);for(;te(r);){const o=et(r),i=Se(r);switch(o._tag){case _u:{r=i;break}case bu:{s=es(s,t,o.fiberRef,o.value),r=i;break}case Su:{s=yu(s,o.fiberRef),r=i;break}case vu:{const c=Fs(s,o.fiberRef);s=es(s,t,o.fiberRef,o.fiberRef.patch(o.patch)(c)),r=i;break}case Eu:{r=Zt(o.first)(Zt(o.second)(i));break}}}return s});class $o{constructor(t){this.self=t,this.called=!1}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new $o(this.self)}}const iy=yp,ay=_p,cy=bp,uy=Sp,ly=qc,fy=vp,hy=Ep,dy=$p,gy=a(zn,Pf(e=>e.ordinal)),py=Nf(gy),my=e=>{switch(e){case"All":return iy;case"Debug":return fy;case"Error":return cy;case"Fatal":return ay;case"Info":return ly;case"Trace":return hy;case"None":return dy;case"Warning":return uy}},yy=e=>t=>`${t.label.replace(/[\s="]/g,"_")}=${e-t.startTime}ms`,_y=yy;var $u;const wu=Symbol.for("@effect/io/Ref"),ku={_A:e=>e};class by{constructor(t){this.ref=t,this[$u]=ku}modify(t){return D((n,s)=>I(()=>{const r=ae(this.ref),[o,i]=s(t)(r);return r!==i&&ce(i)(this.ref),o}).traced(n))}}$u=wu;const Iu=e=>new by(Ce(e)),Ti=g(e=>t=>I(()=>Iu(t)).traced(e)),mr=g(e=>t=>t.modify(n=>[n,n]).traced(e)),Tu=_(2,e=>(t,n)=>t.modify(()=>[void 0,n]).traced(e)),Sy=_(2,(e,t)=>(n,s)=>n.modify(t(s)).traced(e)),Mi=_(2,(e,t)=>(n,s)=>n.modify(r=>[void 0,t(s)(r)]).traced(e)),VE=_(2,(e,t)=>(n,s)=>n.modify(r=>{const o=t(s)(r);return[o,o]}).traced(e)),vy=g((e,t)=>n=>I(()=>{try{return t(n)()}catch(s){throw Xg(Le(s))}}).traced(e)),Mu=g(e=>t=>Mt(t,Q).traced(e)),Ey=g(e=>t=>$s(t,Q).traced(e)),$y=_(2,e=>(t,n)=>rt(Vm(n),t).traced(e)),wy=g(e=>t=>Oc(()=>Tt(Dg(t))).traced(e)),ky=g(e=>t=>a(t,Cu(My(),ry)).traced(e)),Au=_(3,(e,t)=>(n,s,r)=>Es(n,o=>k(t(s)(o)),o=>k(t(r)(o))).traced(e));class Iy{constructor(t){this.value=t}[Symbol.iterator](){return new $o(this)}}const Ty=g((e,t)=>n=>C(()=>{const s=t(()=>n(i=>new Iy(i)))(),r=t(()=>s.next())(),o=i=>i.done?k(i.value):a(i.value.value,p(c=>o(t(()=>s.next(c))())));return o(r)}).traced(e)),My=g(e=>()=>yt(t=>k(t.unsafeGetFiberRefs())).traced(e)),Ay=g(e=>t=>Au(t,Go,Go).traced(e)),Oy=g(e=>t=>yt(n=>(n.log(t,jt,v()),P())).traced(e)),Ou=g((e,t)=>(n,s,r,o)=>C(()=>t(s)(n)?p(t(o)(n),()=>Ou(t(r)(n),t(s),t(r),t(o))):P()).traced(e)),Cy=g(e=>t=>qy((n,s)=>a(t,oy(n,s))).traced(e)),Ry=_(3,e=>(t,n,s)=>Fy(t,n,k(s)).traced(e)),Fy=_(3,e=>(t,n,s)=>Ac(r=>p(s,o=>xe(t,a(r,Nn(n,o))))).traced(e)),Cu=_(3,(e,t)=>(n,s,r)=>p(s,o=>p(n,i=>N(s,c=>[t(r)(o,c),i]))).traced(e)),Py=g(e=>t=>a(Mt(Object.entries(t),([n,s])=>N(s,r=>[n,r])),N(n=>{const s={};for(const[r,o]of n)s[r]=o;return s})).traced(e)),Ny=_(2,(e,t)=>(n,s)=>nt(n,r=>rt(t(s)(r),x(r)),k).traced(e)),Ly=g(e=>t=>xy(t,Jm()).traced(e)),xy=_(2,e=>(t,n)=>Cu(t,n,(s,r)=>du(r-s)).traced(e)),jy=g((e,t)=>n=>p(t(vy)(n),s=>Ss(r=>{s.then(o=>r(Rt(o))).catch(o=>r(Hc(o)))})).traced(e)),Dy=g(e=>(...t)=>N(Mu(t),G).traced(e)),qy=g((e,t)=>n=>yt(s=>(s.setFiberRefs(t(n)(s.id(),s.unsafeGetFiberRefs())),P())).traced(e)),Ky=Symbol.for("@effect/data/MutableHashMap");class Ai{constructor(t,n,s){this.k=t,this.v=n,this.next=s}[Symbol.iterator](){let t=this,n=0;return{next:()=>{if(t){const s=[t.k,t.v];return t=t.next,n++,{value:s,done:!1}}else return{value:n,done:!0}}}}}class Uy{constructor(){this._id=Ky,this.backingMap=new Map,this.length=0}[Symbol.iterator](){return Array.from(this.backingMap.values()).flatMap(t=>{const n=[[t.k,t.v]];let s=t.next;for(;s;)n.push([s.k,s.v]),s=s.next;return n})[Symbol.iterator]()}toString(){return`MutableHashMap(${Array.from(this).map(([t,n])=>`[${String(t)}, ${String(n)}]`).join(", ")})`}toJSON(){return{_tag:"MutableHashMap",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}}const Wy=()=>new Uy,Gt=l(2,(e,t)=>{const n=y(t),s=e.backingMap.get(n);if(s===void 0)return v();let r=s;for(;r!==void 0;){if(S(t,r.k))return T(r.v);r=r.next}return v()}),Ke=l(2,(e,t)=>q(Gt(e,t))),Ue=l(3,(e,t,n)=>{const s=y(t),r=e.backingMap.get(s);if(r===void 0)return e.backingMap.set(s,new Ai(t,n)),e.length=e.length+1,e;let o=r,i=r;for(;o!==void 0;){if(S(t,o.k))return o.v=n,e;i=o,o=o.next}return e.length=e.length+1,i.next=new Ai(t,n),e}),Ru="Sequential",zy="Parallel",Gy={_tag:Ru},Hy=e=>e._tag===Ru,By=e=>e._tag===zy,Fu=Gy,Vy=Hy,Jy=By;var Oi,Ci,Ri;const Ps="@effect/io/Fiber/Status",ie=Symbol.for(Ps),yr="Done",Fi="Running",Pi="Suspended";class Yy{constructor(){this[Oi]=ie,this._tag=yr}[(Oi=ie,A)](){return a(y(Ps),M(y(this._tag)))}[O](t){return wo(t)&&t._tag===yr}}class Qy{constructor(t){this.runtimeFlags=t,this[Ci]=ie,this._tag=Fi}[(Ci=ie,A)](){return a(y(Ps),M(y(this._tag)),M(y(this.runtimeFlags)))}[O](t){return wo(t)&&t._tag===Fi&&this.runtimeFlags===t.runtimeFlags}}class Xy{constructor(t,n){this.runtimeFlags=t,this.blockingOn=n,this[Ri]=ie,this._tag=Pi}[(Ri=ie,A)](){return a(y(Ps),M(y(this._tag)),M(y(this.runtimeFlags)),M(y(this.blockingOn)))}[O](t){return wo(t)&&t._tag===Pi&&this.runtimeFlags===t.runtimeFlags&&S(this.blockingOn,t.blockingOn)}}const Zy=new Yy,t_=e=>new Qy(e),e_=(e,t)=>new Xy(e,t),wo=e=>typeof e=="object"&&e!=null&&ie in e,n_=e=>e._tag===yr,s_=Zy,Pu=t_,r_=e_,o_=n_,ko="InterruptSignal",Io="Stateful",To="Resume",Mo="YieldNow",Ni=e=>({_tag:ko,cause:e}),Kn=e=>({_tag:Io,onFiber:e}),ge=e=>({_tag:To,effect:e}),i_=e=>({_tag:Mo,priority:e});var Nu,Lu;const a_="@effect/io/Fiber/Scope",Ns=Symbol.for(a_),Li="@effect/io/FiberScope/Global";class c_{add(t,n){this.roots.add(n),n.unsafeAddObserver(()=>{this.roots.delete(n)})}constructor(){if(this[Nu]=Ns,this.fiberId=Dt,this.roots=new Set,typeof globalThis[Li]>"u")globalThis[Li]=this;else throw new Error("Bug: FiberScope.Global initialized twice (maybe coming from a duplicated module)")}}Nu=Ns;class u_{constructor(t,n){this.fiberId=t,this.parent=n,this[Lu]=Ns}add(t,n){this.parent.tell(Kn(s=>{s.addChild(n),n.unsafeAddObserver(()=>{s.removeChild(n)})}))}}Lu=Ns;const l_=e=>new u_(e.id(),e),xu=new c_,f_="@effect/io/Fiber",h_=Symbol.for(f_),d_={_E:e=>e,_A:e=>e},g_="@effect/io/Fiber",p_=Symbol.for(g_),_r=g(e=>t=>t.await().traced(e)),m_=g(e=>t=>t.inheritAll().traced(e)),br=g(e=>t=>fo(uo(t.await()),t.inheritAll()).traced(e)),Wt="@effect/io/Fiber/Current",y_=Symbol.for("@effect/data/MutableList");class __{constructor(){this._id=y_,this.head=void 0,this.tail=void 0,this._length=0}[Symbol.iterator](){let t=!1,n=this.head;return{next(){if(t)return this.return();if(n==null)return t=!0,this.return();const s=n.value;return n=n.next,{done:t,value:s}},return(s){return t||(t=!0),{done:!0,value:s}}}}toString(){return`MutableList(${Array.from(this).map(String).join(", ")})`}toJSON(){return{_tag:"MutableList",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}}class b_{constructor(t){this.value=t,this.removed=!1,this.prev=void 0,this.next=void 0}}const S_=()=>new __,ju=e=>Du(e)===0,Du=e=>e._length,v_=l(2,(e,t)=>{const n=new b_(t);return e.head===void 0&&(e.head=n),e.tail===void 0||(e.tail.next=n,n.prev=e.tail),e.tail=n,e._length+=1,e}),E_=e=>{const t=e.head;if(t!==void 0)return $_(e,t),t.value},$_=(e,t)=>{t.removed||(t.removed=!0,t.prev!==void 0&&t.next!==void 0?(t.prev.next=t.next,t.next.prev=t.prev):t.prev!==void 0?(e.tail=t.prev,t.prev.next=void 0):t.next!==void 0?(e.head=t.next,t.next.prev=void 0):(e.tail=void 0,e.head=void 0),e._length>0&&(e._length-=1))},w_=Symbol.for("@effect/data/MutableQueue");class k_{constructor(t=void 0){this.capacity=t,this._tag="Bounded",this._id=w_,this.queue=S_()}[Symbol.iterator](){return Array.from(this.queue)[Symbol.iterator]()}toString(){return`MutableQueue(${Array.from(this).map(String).join(", ")})`}toJSON(){return{_tag:"MutableQueue",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}}const I_=()=>new k_,We=e=>ju(e.queue),T_=l(2,(e,t)=>{const n=Du(e.queue);return e.capacity!==void 0&&n===e.capacity?!1:(v_(t)(e.queue),!0)}),xi=l(2,(e,t)=>ju(e.queue)?t:E_(e.queue)),qu=e=>{if(typeof e=="object"&&e!=null&&"toString"in e&&typeof e.toString=="function"&&e.toString!==Object.prototype.toString)return e.toString();if(typeof e=="string")return`Error: ${e}`;if(typeof e=="object"&&e!==null&&"message"in e&&typeof e.message=="string"){const t=JSON.parse(JSON.stringify(e)),n=new Set(Object.keys(t));if(n.delete("name"),n.delete("message"),n.delete("_tag"),n.size===0)return`${"name"in e&&typeof e.name=="string"?e.name:"Error"}${"_tag"in e&&typeof e._tag=="string"?`(${e._tag})`:""}: ${e.message}`}return`Error: ${JSON.stringify(e)}`},M_=e=>{const t=[];for(const n of e){const s=n?.toFrame();s&&F.filterStackFrame(s)&&t.push(Ku(s))}return t},A_=e=>U(e)?[]:e.value.stack.length>0?M_(e.value.stack):[],O_=(e,t)=>[new R_(t._tag==="Some"?t.value.seq:0,e,A_(t).join(`\r
`))],C_=e=>{if(e.stack){const t=F.parseStack(e),n=[];for(const s of t)if(s)if(F.filterStackFrame(s))n.push(Ku(s));else break;return[qu(e),...n].join(`\r
`)}return String(e)},ji=e=>e instanceof Error?C_(e):qu(e);class R_{constructor(t,n,s){this.seq=t,this.message=n,this.stack=s}}const F_=e=>{if(_c(e))return"All fibers interrupted without errors.";const t=bs(e,void 0,{emptyCase:()=>[],dieCase:(s,r)=>[{message:ji(r),stack:v()}],failCase:(s,r)=>[{message:ji(r),stack:v()}],interruptCase:()=>[],parallelCase:(s,r,o)=>[...r,...o],sequentialCase:(s,r,o)=>[...r,...o],annotatedCase:(s,r,o)=>Ec(o)?r.map(i=>({message:i.message,stack:a(Vt(i.stack,c=>new fr(c.stack.length<F.traceStackLimit&&o.stack.length>0&&(c.stack.length>0&&Ze(o.stack)!==Ze(c.stack)||c.stack.length===0)?a(c.stack,W(o.stack),La,jr(F.traceStackLimit)):c.stack,c.seq)),Wf(()=>T(o)))})):r}).flatMap(s=>O_(s.message,s.stack)),n=Array.from(t).sort((s,r)=>s.seq===r.seq?0:s.seq>r.seq?1:-1).map(s=>{let r=s.message;return s.stack&&s.stack.length>0&&(r+=`\r
${s.stack}`),r}).join(`\r
\r
`);return n.includes(`\r
`)?`\r
${n}\r
`:n};function Ku(e){return e?e.name?`    at ${e.name} (${e.fileName}:${e.line}:${e.column})`:`    at ${e.fileName}:${e.line}:${e.column}`:"    at <unknown>"}const P_="@effect/io/Logger",N_=Symbol.for(P_),L_={_Message:e=>e,_Output:e=>e},Uu=e=>({[N_]:L_,log:e}),x_=Uu((e,t,n,s,r,o,i)=>{const c=new Date,u=c.getTime();let h=[`timestamp=${c.toISOString()}`,`level=${t.label}`,`fiber=${og(e)}`].join(" ");if(n.length>0&&(h=h+" message=",h=Hs(n,h)),s!=null&&s!=jt&&(h=h+" cause=",h=Hs(F_(s),h)),ee(o)){h=h+" ";let d=!0;for(const m of o)d?d=!1:h=h+" ",h=h+a(m,_y(u))}if(a(i,$d)>0){h=h+" ";let d=!0;for(const[m,b]of i)d?d=!1:h=h+" ",h=h+q_(m),h=h+"=",h=Hs(b,h)}return h}),j_=e=>`"${e.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`,D_=/^[^\s"=]+$/,Hs=(e,t)=>t+(e.match(D_)?e:j_(e)),q_=e=>e.replace(/[\s="]/g,"_");function fn(){const e=[];return{promise:()=>new Promise(n=>e.push(n)),resolve:n=>e.forEach(s=>s(n))}}const R={tasks:[],idleDeadline:void 0,frameTimeElapsed:!1,onIdleCallback:fn(),onAnimationFrame:fn(),frameWorkStartTime:void 0};function K_(){const e=fn(),t={ready:e.promise,resolve:e.resolve};return R.tasks.push(t),R.tasks.length===1&&U_(),t}let Bs=!1,Di;function U_(){if(Bs)return;Bs=!0;const e=()=>{R.idleDeadline=void 0,R.frameTimeElapsed=!1,R.frameWorkStartTime=void 0},t=()=>{typeof requestIdleCallback<"u"&&(Di=requestIdleCallback(s=>{e(),R.idleDeadline=s,R.onIdleCallback.resolve(),R.onIdleCallback=fn()}));const n=()=>{e(),R.onAnimationFrame.resolve(),R.onAnimationFrame=fn(),R.tasks.length===0?(Bs=!1,typeof cancelIdleCallback<"u"&&cancelIdleCallback(Di)):t()};typeof requestAnimationFrame<"u"?requestAnimationFrame(n):setTimeout(n,16)};t()}function W_(e){const t=R.tasks.indexOf(e);t!==-1&&R.tasks.splice(t,1)}function z_(){R.tasks.length>0&&R.tasks[0].resolve()}let qi=0,ze=!1;function Wu(){const e=Date.now();return!ze&&e-qi===0||(qi=e,ze=e>=G_()||typeof navigator<"u"&&navigator.scheduling?.isInputPending?.()===!0,ze&&(R.frameTimeElapsed=!0)),ze}function G_(){if(R.frameWorkStartTime===void 0)return-1;const e=R.idleDeadline===void 0?Number.MAX_SAFE_INTEGER:Date.now()+R.idleDeadline.timeRemaining();return Math.min(R.frameWorkStartTime+5,e)}let Ki=0;const Un=new Set;function H_(e){const t=Ki;return Un.add(t),Promise.resolve().then(()=>{Promise.resolve().then(()=>{Un.has(t)&&(e(),Un.delete(t))})}),Ki+=1,t}function Ui(e){e!==void 0&&Un.delete(e)}let Cn=[];function B_(e){if(Cn.length===0){const t=new MessageChannel;t.port2.postMessage(void 0),t.port1.onmessage=()=>{t.port1.close(),t.port2.close();const n=Cn;Cn=[];for(const s of n)s()}}Cn.push(e)}let Vs;async function V_(){Ui(Vs);const e=K_();await Sr(),R.tasks[0]!==e&&(await e.ready(),Wu()&&await Sr()),W_(e),Ui(Vs),Vs=H_(()=>{z_()})}async function Sr(){R.frameTimeElapsed&&await R.onAnimationFrame.promise(),typeof requestIdleCallback>"u"?(await new Promise(e=>B_(e)),typeof navigator<"u"&&navigator.scheduling?.isInputPending?.()===!0?await Sr():R.frameWorkStartTime===void 0&&(R.frameWorkStartTime=Date.now())):(await R.onIdleCallback.promise(),R.frameWorkStartTime===void 0&&(R.frameWorkStartTime=Date.now()))}function J_(){return Wu()?V_():Promise.resolve()}var Wi;const zu="@effect/io/Metric/Boundaries",vr=Symbol.for(zu);class Y_{constructor(t){this.values=t,this[Wi]=vr}[(Wi=vr,A)](){return a(y(zu),M(y(this.values)))}[O](t){return Q_(t)&&S(this.values,t.values)}}const Q_=e=>typeof e=="object"&&e!=null&&vr in e,X_=e=>{const t=a(e,W(K(Number.POSITIVE_INFINITY)),Th);return new Y_(t)},Z_=(e,t,n)=>a(wh(0,n-1),ye(s=>e*Math.pow(t,s)),X_);var zi,Gi,Hi,Bi;const tb="@effect/io/Metric/KeyType",Gu=Symbol.for(tb),Hu="effect/io/Metric/KeyType/Counter",Er=Symbol.for(Hu),eb="effect/io/Metric/KeyType/Frequency",nb=Symbol.for(eb),sb="effect/io/Metric/KeyType/Gauge",rb=Symbol.for(sb),Bu="effect/io/Metric/KeyType/Histogram",$r=Symbol.for(Bu),ob="effect/io/Metric/KeyType/Summary",ib=Symbol.for(ob),Vu={_In:e=>e,_Out:e=>e};class ab{constructor(){this[zi]=Vu,this[Gi]=Er}[(zi=Gu,Gi=Er,A)](){return y(Hu)}[O](t){return Ju(t)}}class cb{constructor(t){this.boundaries=t,this[Hi]=Vu,this[Bi]=$r}[(Hi=Gu,Bi=$r,A)](){return a(y(Bu),M(y(this.boundaries)))}[O](t){return Yu(t)&&S(this.boundaries,t.boundaries)}}const ub=new ab,lb=e=>new cb(e),Ju=e=>typeof e=="object"&&e!=null&&Er in e,fb=e=>typeof e=="object"&&e!=null&&nb in e,hb=e=>typeof e=="object"&&e!=null&&rb in e,Yu=e=>typeof e=="object"&&e!=null&&$r in e,db=e=>typeof e=="object"&&e!=null&&ib in e;var Vi;const gb="@effect/io/Metric/Key",Qu=Symbol.for(gb),pb={_Type:e=>e};class Ao{constructor(t,n,s=$t()){this.name=t,this.keyType=n,this.tags=s,this[Vi]=pb}[(Vi=Qu,A)](){return a(y(this.name),M(y(this.keyType)),M(y(this.tags)))}[O](t){return mb(t)&&this.name===t.name&&S(this.keyType,t.keyType)&&S(this.tags,t.tags)}}const mb=e=>typeof e=="object"&&e!=null&&Qu in e,yb=e=>new Ao(e,ub),_b=(e,t)=>new Ao(e,lb(t)),bb=l(2,(e,t)=>sc(t)===0?e:new Ao(e.name,e.keyType,a(e.tags,ke(t))));var Ji,Yi,Qi,Xi,Zi,ta,ea,na,sa,ra;const Sb="@effect/io/Metric/State",kn=Symbol.for(Sb),Xu="effect/io/Metric/State/Counter",wr=Symbol.for(Xu),Zu="effect/io/Metric/State/Frequency",kr=Symbol.for(Zu),tl="effect/io/Metric/State/Gauge",Ir=Symbol.for(tl),el="effect/io/Metric/State/Histogram",Tr=Symbol.for(el),nl="effect/io/Metric/State/Summary",Mr=Symbol.for(nl),In={_A:e=>e};class vb{constructor(t){this.count=t,this[Ji]=In,this[Yi]=wr}[(Ji=kn,Yi=wr,A)](){return a(y(Xu),M(y(this.count)))}[O](t){return Cb(t)&&this.count===t.count}}class Eb{constructor(t){this.occurrences=t,this[Qi]=In,this[Xi]=kr}[(Qi=kn,Xi=kr,A)](){return a(y(Zu),M(y(this.occurrences)))}[O](t){return Rb(t)&&S(this.occurrences,t.occurrences)}}class $b{constructor(t){this.value=t,this[Zi]=In,this[ta]=Ir}[(Zi=kn,ta=Ir,A)](){return a(y(tl),M(y(this.value)))}[O](t){return Fb(t)&&this.value===t.value}}class wb{constructor(t,n,s,r,o){this.buckets=t,this.count=n,this.min=s,this.max=r,this.sum=o,this[ea]=In,this[na]=Tr}[(ea=kn,na=Tr,A)](){return a(y(el),M(y(this.buckets)),M(y(this.count)),M(y(this.min)),M(y(this.max)),M(y(this.sum)))}[O](t){return Pb(t)&&S(this.buckets,t.buckets)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}}class kb{constructor(t,n,s,r,o,i){this.error=t,this.quantiles=n,this.count=s,this.min=r,this.max=o,this.sum=i,this[sa]=In,this[ra]=Mr}[(sa=kn,ra=Mr,A)](){return a(y(nl),M(y(this.error)),M(y(this.quantiles)),M(y(this.count)),M(y(this.min)),M(y(this.max)),M(y(this.sum)))}[O](t){return Nb(t)&&this.error===t.error&&S(this.quantiles,t.quantiles)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}}const Ib=e=>new vb(e),Tb=e=>new Eb(e),Mb=e=>new $b(e),Ab=(e,t,n,s,r)=>new wb(e,t,n,s,r),Ob=(e,t,n,s,r,o)=>new kb(e,t,n,s,r,o),Cb=e=>typeof e=="object"&&e!=null&&wr in e,Rb=e=>typeof e=="object"&&e!=null&&kr in e,Fb=e=>typeof e=="object"&&e!=null&&Ir in e,Pb=e=>typeof e=="object"&&e!=null&&Tr in e,Nb=e=>typeof e=="object"&&e!=null&&Mr in e,Lb="@effect/io/Metric/Hook",xb=Symbol.for(Lb),jb={_In:e=>e,_Out:e=>e},Tn=(e,t)=>({[xb]:jb,update:t,get:e}),Db=e=>{let t=0;return Tn(()=>Ib(t),n=>{t=t+n})},qb=e=>{const t=new Map,n=r=>{const o=t.get(r)??0;t.set(r,o+1)},s=()=>ec(Array.from(t.entries()).map(([r,o])=>[r,o]));return Tn(()=>Tb(s()),n)},Kb=(e,t)=>{let n=t;return Tn(()=>Mb(n),s=>{n=s})},Ub=e=>{const t=e.keyType.boundaries.values,n=t.length,s=Array(n+1),r=Array(n);let o=0,i=0,c=Number.MAX_VALUE,u=Number.MIN_VALUE;a(t,Xs(zn),$h((d,m)=>{r[d]=m}));const f=d=>{let m=0,b=n;for(;m!==b;){const $=Math.floor(m+(b-m)/2),L=r[$];d<=L?b=$:m=$,b===m+1&&(d<=r[m]?b=m:m=b)}s[m]=s[m]+1,o=o+1,i=i+d,d<c&&(c=d),d>u&&(u=d)},h=()=>{const d=[];let m=0,b=0;for(;m!=n;){const $=r[m],L=s[m];b=b+L,d.push([$,b]),m=m+1}return Ae(d)};return Tn(()=>Ab(h(),o,c,u,i),f)},Wb=e=>{const{error:t,maxAge:n,maxSize:s,quantiles:r}=e.keyType,o=a(r,Xs(zn)),i=Array(s);let c=0,u=0,f=0,h=Number.MAX_VALUE,d=Number.MIN_VALUE;const m=$=>{const L=[];let j=0;for(;j!==s-1;){const it=i[j];if(it!=null){const[_t,Ut]=it,qe=du($-_t);qe.millis>=0&&qe<=n&&L.push(Ut)}j=j+1}return zb(t,o,a(Ae(L),Xs(zn)))},b=($,L)=>{if(s>0){c=c+1;const j=c%s;i[j]=[L,$]}u=u+1,f=f+$,$<h&&(h=$),$>d&&(d=$)};return Tn(()=>Ob(t,m(Date.now()),u,h,d,f),([$,L])=>b($,L))},zb=(e,t,n)=>{const s=n.length;if(cs(t))return at();const r=Gn(t),o=a(t,Dr(1)),i=a(o,us(K(oa(e,s,v(),0,r,n)),(c,u)=>{const f=Gn(c);return a(c,bh(oa(e,s,f.value,f.consumed,u,f.rest)))}));return a(i,ye(c=>[c.quantile,c.value]))},oa=(e,t,n,s,r,o)=>{let i=e,c=t,u=n,f=s,h=r,d=o,m=e,b=t,$=n,L=s,j=r,it=o;for(;;){if(cs(d))return{quantile:h,value:v(),consumed:f,rest:at()};if(h===1)return{quantile:h,value:T(Ze(d)),consumed:f+d.length,rest:at()};const _t=a(d,Ih(Ds=>Ds>Gn(d))),Ut=h*c,qe=i/2*Ut,fe=f+_t[0].length,Vl=Math.abs(fe-Ut);if(fe<Ut-qe){m=i,b=c,$=me(d),L=fe,j=h,it=_t[1],i=m,c=b,u=$,f=L,h=j,d=it;continue}if(fe>Ut+qe)return{quantile:h,value:u,consumed:f,rest:d};switch(u._tag){case"None":{m=i,b=c,$=me(d),L=fe,j=h,it=_t[1],i=m,c=b,u=$,f=L,h=j,d=it;continue}case"Some":{const Ds=Math.abs(Ut-u.value);if(Vl<Ds){m=i,b=c,$=me(d),L=fe,j=h,it=_t[1],i=m,c=b,u=$,f=L,h=j,d=it;continue}return{quantile:h,value:T(u.value),consumed:f,rest:d}}}}throw new Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/io/issues")},Gb="@effect/io/Metric/Pair",Hb=Symbol.for(Gb),Bb={_Type:e=>e},Vb=(e,t)=>({[Hb]:Bb,metricKey:e,metricState:t});var sl;const Jb="@effect/io/Metric/Registry",rl=Symbol.for(Jb);class Yb{constructor(){this[sl]=rl,this.map=Wy()}snapshot(){const t=[];for(const[n,s]of this.map)t.push(Vb(n,s.get()));return nc(t)}get(t){const n=a(this.map,Gt(t),de);if(n==null){if(Ju(t.keyType))return this.getCounter(t);if(hb(t.keyType))return this.getGauge(t);if(fb(t.keyType))return this.getFrequency(t);if(Yu(t.keyType))return this.getHistogram(t);if(db(t.keyType))return this.getSummary(t);throw new Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/io/issues")}else return n}getCounter(t){let n=a(this.map,Gt(t),de);if(n==null){const s=Db();a(this.map,Ke(t))||a(this.map,Ue(t,s)),n=s}return n}getFrequency(t){let n=a(this.map,Gt(t),de);if(n==null){const s=qb();a(this.map,Ke(t))||a(this.map,Ue(t,s)),n=s}return n}getGauge(t){let n=a(this.map,Gt(t),de);if(n==null){const s=Kb(t,0);a(this.map,Ke(t))||a(this.map,Ue(t,s)),n=s}return n}getHistogram(t){let n=a(this.map,Gt(t),de);if(n==null){const s=Ub(t);a(this.map,Ke(t))||a(this.map,Ue(t,s)),n=s}return n}getSummary(t){let n=a(this.map,Gt(t),de);if(n==null){const s=Wb(t);a(this.map,Ke(t))||a(this.map,Ue(t,s)),n=s}return n}}sl=rl;const Qb=()=>new Yb,Xb="@effect/io/Metric",Zb=Symbol.for(Xb),tS={_Type:e=>e,_In:e=>e,_Out:e=>e},eS=Qb(),nS=function(e,t,n){return Object.assign(g((r,o)=>i=>vn(i,c=>I(()=>o(t)(c,$t()))).traced(r)),{[Zb]:tS,keyType:e,unsafeUpdate:t,unsafeValue:n})},Oo=e=>ol(yb(e)),ol=e=>{const t=n=>{const s=a(e,bb(n));return eS.get(s)};return nS(e.keyType,(n,s)=>t(s).update(n),n=>t(n).get())},sS=(e,t)=>ol(_b(e,t));var il,al,cl;const rS="@effect/io/Supervisor",Co=Symbol.for(rS),Ro={_T:e=>e};class Ls{constructor(t,n){this.underlying=t,this.value0=n,this[il]=Ro}value(){return D(t=>this.value0().traced(t))}onStart(t,n,s,r){this.underlying.onStart(t,n,s,r)}onEnd(t,n){this.underlying.onEnd(t,n)}onEffect(t,n){this.underlying.onEffect(t,n)}onSuspend(t){this.underlying.onSuspend(t)}onResume(t){this.underlying.onResume(t)}map(t){return new Ls(this,()=>a(this.value(),N(t)))}zip(t){return new De(this,t)}}il=Co;class De{constructor(t,n){this.left=t,this.right=n,this[al]=Ro}value(){return D(t=>un(this.left.value(),this.right.value()).traced(t))}onStart(t,n,s,r){this.left.onStart(t,n,s,r),this.right.onStart(t,n,s,r)}onEnd(t,n){this.left.onEnd(t,n),this.right.onEnd(t,n)}onEffect(t,n){this.left.onEffect(t,n),this.right.onEffect(t,n)}onSuspend(t){this.left.onSuspend(t),this.right.onSuspend(t)}onResume(t){this.left.onResume(t),this.right.onResume(t)}map(t){return new Ls(this,()=>a(this.value(),N(t)))}zip(t){return new De(this,t)}}al=Co;class oS{constructor(t){this.effect=t,this[cl]=Ro}value(){return D(t=>this.effect.traced(t))}onStart(t,n,s,r){}onEnd(t,n){}onEffect(t,n){}onSuspend(t){}onResume(t){}map(t){return new Ls(this,()=>a(this.value(),N(t)))}zip(t){return new De(this,t)}}cl=Co;const iS=e=>new oS(e),xs=iS(P()),ul="Empty",ll="AddSupervisor",fl="RemoveSupervisor",hl="AndThen",Qe={_tag:ul},Wn=(e,t)=>({_tag:hl,first:e,second:t}),aS=(e,t)=>cS(t,K(e)),cS=(e,t)=>{let n=e,s=t;for(;ee(s);){const r=ve(s);switch(r._tag){case ul:{s=Lt(s);break}case ll:{n=n.zip(r.supervisor),s=Lt(s);break}case fl:{n=Ar(n,r.supervisor),s=Lt(s);break}case hl:{s=mt(r.first)(mt(r.second)(Lt(s)));break}}}return n},Ar=(e,t)=>S(e,t)?xs:e instanceof De?Ar(e.left,t).zip(Ar(e.right,t)):e,ns=e=>S(e,xs)?$t():e instanceof De?a(ns(e.left),ke(ns(e.right))):Qr(e),uS=(e,t)=>{if(S(e,t))return Qe;const n=ns(e),s=ns(t),r=a(s,Zo(n),Vn(Qe,(i,c)=>Wn(i,{_tag:ll,supervisor:c}))),o=a(n,Zo(s),Vn(Qe,(i,c)=>Wn(i,{_tag:fl,supervisor:c})));return Wn(r,o)},lS=ac({empty:Qe,patch:aS,combine:Wn,diff:uS});var ia,aa;const fS=Oo("effect_fiber_started"),hS=Oo("effect_fiber_successes"),dS=Oo("effect_fiber_failures"),gS=sS("effect_fiber_lifetimes",Z_(1,2,100)),Ge="Continue",pS="Done",ca="Yield",ua="YieldInBackground",mS={_E:e=>e,_A:e=>e},He=e=>{throw new Error(`BUG: FiberRuntime - ${JSON.stringify(e)} - please report an issue at https://github.com/Effect-TS/io/issues`)},Rn={[Yn]:(e,t,n)=>t.successK(n),[Qn]:(e,t,n)=>t.successK(n),[oo]:(e,t,n)=>(e.patchRuntimeFlags(e._runtimeFlags,t.patch),Ht(e._runtimeFlags)&&e.isInterrupted()?V(e.getInterruptedCause()):Rt(n)),[Xn]:(e,t,n)=>(t.process(n),t.check()?(e.pushStack(t),t.body()):P())},yS={[ko]:(e,t,n,s)=>(e.processNewInterruptSignal(s.cause),Ht(t)?V(s.cause):n),[To]:(e,t,n,s)=>{throw new Error("It is illegal to have multiple concurrent run loops in a single fiber")},[Io]:(e,t,n,s)=>(s.onFiber(e,Pu(t)),n),[Mo]:(e,t,n,s)=>a(jc(s.priority),p(()=>n))};class dl{constructor(t,n,s){if(this[ia]=d_,this[aa]=mS,this._queue=I_(),this._children=null,this._observers=new Array,this._running=!1,this._stack=[],this._asyncInterruptor=null,this._asyncBlockingOn=null,this._exitValue=null,this._traceStack=[],this.run=()=>{this.drainQueueOnCurrentThread()},this._runtimeFlags=s,this._fiberId=t,this._fiberRefs=n,Us(s)){const r=this.getFiberRef(Ws);fS.unsafeUpdate(1,r)}}id(){return this._fiberId}resume(t){this.tell(ge(t))}status(){return this.ask((t,n)=>n)}runtimeFlags(){return this.ask((t,n)=>o_(n)?t._runtimeFlags:n.runtimeFlags)}scope(){return l_(this)}children(){return this.ask(t=>Ae(t.getChildren()))}getChildren(){return this._children===null&&(this._children=new Set),this._children}getSupervisor(){return this.getFiberRef(CS)}getInterruptedCause(){return this.getFiberRef(On)}fiberRefs(){return this.ask(t=>t.unsafeGetFiberRefs())}ask(t){return Y(()=>C(()=>{const n=As(this._fiberId);return this.tell(Kn((s,r)=>{bo(n,I(()=>t(s,r)))})),Os(n)}))}tell(t){a(this._queue,T_(t)),this._running||(this._running=!0,this.drainQueueLaterOnExecutor("normal"))}await(){return Y(()=>ep(t=>{const n=s=>t(k(s));return this.tell(Kn((s,r)=>{s._exitValue!==null?n(this._exitValue):s.unsafeAddObserver(n)})),I(()=>this.tell(Kn((s,r)=>{s.unsafeRemoveObserver(n)})))},this.id()))}inheritAll(){return Y(()=>yt((t,n)=>{const s=t.id(),r=t.unsafeGetFiberRefs(),o=n.runtimeFlags,i=this.unsafeGetFiberRefs(),c=Zm(r,s,i);t.setFiberRefs(c);const u=t.getFiberRef(fa),f=a(ar(o,u),ri(Pe),ri(ir));return gp(f)}))}poll(){return Y(()=>I(()=>Ma(this._exitValue)))}unsafePoll(){return this._exitValue}interruptAsFork(t){return Y(()=>I(()=>this.tell(Ni(Qt(t)))))}unsafeAddObserver(t){this._exitValue!==null?t(this._exitValue):this._observers.push(t)}unsafeRemoveObserver(t){this._observers=this._observers.filter(n=>n!==t)}unsafeGetFiberRefs(){return this.setFiberRef(fa,this._runtimeFlags),this._fiberRefs}unsafeDeleteFiberRef(t){this._fiberRefs=yu(this._fiberRefs,t)}getFiberRef(t){return Fs(this._fiberRefs,t)}setFiberRef(t,n){this._fiberRefs=es(this._fiberRefs,this._fiberId,t,n)}setFiberRefs(t){this._fiberRefs=t}addChild(t){this.getChildren().add(t)}removeChild(t){this.getChildren().delete(t)}drainQueueOnCurrentThread(){let t=!0;for(;t;){let n=Ge;const s=globalThis[Wt];globalThis[Wt]=this;try{for(;n===Ge;)n=We(this._queue)?pS:this.evaluateMessageWhileSuspended(a(this._queue,xi(null)))}finally{this._running=!1,globalThis[Wt]=s}!We(this._queue)&&!this._running?(this._running=!0,n===ca?(this.drainQueueLaterOnExecutor("normal"),t=!1):n===ua?(this.drainQueueLaterOnExecutor("background"),t=!1):t=!0):t=!1}}drainQueueLaterOnExecutor(t){t==="normal"?this.getFiberRef(mo).scheduleTask(this.run):J_().then(()=>{this.run()})}drainQueueWhileRunning(t,n){let s=n;for(;!We(this._queue);){const r=a(this._queue,xi(void 0));s=yS[r._tag](this,t,s,r)}return s}isInterrupted(){return!Ag(this.getFiberRef(On))}addInterruptedCause(t){const n=this.getFiberRef(On);this.setFiberRef(On,tt(n,t))}processNewInterruptSignal(t){this.addInterruptedCause(t),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(this._children===null||this._children.size===0)return!1;let t=!1;for(const n of this._children)n.tell(Ni(Qt(this.id()))),t=!0;return t}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){const t=this._children.values();this._children=null;let n=!1;const s=()=>{const r=t.next();return r.done?I(()=>{n=!0}):ht(r.value.await())};return lo(()=>!n,()=>s(),()=>{})}return null}reportExitValue(t){if(Us(this._runtimeFlags)){const n=this.getFiberRef(Ws);switch(t._tag){case B:{hS.unsafeUpdate(1,n);break}case H:{dS.unsafeUpdate(1,n);break}}}}setExitValue(t){if(this._exitValue=t,Us(this._runtimeFlags)){const n=this.getFiberRef(Ws),s=this.id().startTimeMillis,r=new Date().getTime();gS.unsafeUpdate((r-s)/1e3,n)}this.reportExitValue(t);for(let n=this._observers.length-1;n>=0;n--)this._observers[n](t)}getLoggers(){return this.getFiberRef(SS)}log(t,n,s){const r=q(s)?s.value:this.getFiberRef(Ap),o=this.getFiberRef(Op),i=this.getFiberRef(Mp),c=this.getLoggers(),u=this.unsafeGetFiberRefs();a(c,kd(f=>{f.log(this.id(),r,t,n,u,o,i)}))}evaluateMessageWhileSuspended(t){switch(t._tag){case Mo:return t.priority==="background"?ua:ca;case ko:return this.processNewInterruptSignal(t.cause),this._asyncInterruptor!==null&&(this._asyncInterruptor(V(t.cause)),this._asyncInterruptor=null),Ge;case To:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(t.effect),Ge;case Io:return t.onFiber(this,this._exitValue!==null?s_:r_(this._runtimeFlags,this._asyncBlockingOn)),Ge;default:return He(t)}}evaluateEffect(t){this.getSupervisor().onResume(this);try{let n=Ht(this._runtimeFlags)&&this.isInterrupted()?V(this.getInterruptedCause()):t;for(;n!==null;)try{const s=this.runLoop(n);this._runtimeFlags=a(this._runtimeFlags,_g(ir));const r=this.interruptAllChildren();r!==null?n=Y(()=>p(r,()=>s)):(We(this._queue)?this.setExitValue(s):this.tell(ge(s)),n=null)}catch(s){if(li(s))s._tag===qn?yg(this._runtimeFlags)?(this.tell(i_(s.priority)),this.tell(ge(xt())),n=null):n=xt():s._tag===xn&&(n=null);else throw s}}finally{this.getSupervisor().onSuspend(this)}}start(t){if(this._running)this.tell(ge(t));else{this._running=!0;const n=globalThis[Wt];globalThis[Wt]=this;try{this.evaluateEffect(t)}finally{this._running=!1,globalThis[Wt]=n,We(this._queue)||this.drainQueueLaterOnExecutor("normal")}}}startFork(t){this.tell(ge(t))}patchRuntimeFlags(t,n){const s=cr(t,n);return globalThis[Wt]=this,this._runtimeFlags=s,s}initiateAsync(t,n){let s=!1;const r=o=>{s||(s=!0,this.tell(ge(o)))};Ht(t)&&(this._asyncInterruptor=r);try{n(r)}catch(o){r(x(Tt(o)))}}pushStack(t){this._stack.push(t),"trace"in t&&t.trace&&this._traceStack.push(t.trace)}popStack(){const t=this._stack.pop();if(t)return"trace"in t&&t.trace&&this._traceStack.pop(),t}getNextSuccessCont(){let t=this.popStack();for(;t;){if(t._tag!==jn&&t._tag!==Dn)return t;t=this.popStack()}}getNextFailCont(){let t=this.popStack();for(;t;){if(t._tag!==Yn&&t._tag!==Xn&&t._tag!==Dn)return t;t=this.popStack()}}[(ia=h_,aa=p_,wc)](t){const n=t.evaluate(),s=this.getNextSuccessCont();if(s!==void 0)return s._tag in Rn||He(s),Rn[s._tag](this,s,n);throw Rt(n)}[B](t){const n=t,s=this.getNextSuccessCont();if(s!==void 0)return s._tag in Rn||He(s),Rn[s._tag](this,s,n.value);throw n}[H](t){let n=t.cause;if(Mg(n)&&Ec(n.annotation)){const r=n.annotation.stack,o=this.stackToLines();n=sn(n.cause,new fr(a(r.length===0?o:o.length===0||Ze(r)===Ze(o)?r:a(r,W(o)),La,jr(F.traceStackLimit)),n.annotation.seq))}else n=sn(t.cause,new fr(this.stackToLines(),Yd(Ug)));const s=this.getNextFailCont();if(s!==void 0)switch(s._tag){case jn:case Qn:return Ht(this._runtimeFlags)&&this.isInterrupted()?V(rn(n)):s.failK(n);case oo:return this.patchRuntimeFlags(this._runtimeFlags,s.patch),Ht(this._runtimeFlags)&&this.isInterrupted()?V(tt(n,this.getInterruptedCause())):V(n);default:He(s)}else throw V(n)}[kc](t){return t.withRuntime(this,Pu(this._runtimeFlags))}[Sn](t){if(t.scope===void 0)return this.patchRuntimeFlags(this._runtimeFlags,t.update),xt();{const n=t.update,s=this._runtimeFlags,r=cr(s,n);if(r===s)return t.scope(s);if(Ht(r)&&this.isInterrupted())return V(this.getInterruptedCause());{this.patchRuntimeFlags(this._runtimeFlags,n);const o=ar(r,s);return this.pushStack(new Zg(o)),t.scope(s)}}}[Yn](t){return this.pushStack(t),t.first}[Dn](t){return this.pushStack(t),t.self}[jn](t){return this.pushStack(t),t.first}[Qn](t){return this.pushStack(t),t.first}[xn](t){throw this._asyncBlockingOn=t.blockingOn,this.initiateAsync(this._runtimeFlags,t.register),t}[qn](t){throw t}[Xn](t){const n=t.check,s=t.body;return n()?(this.pushStack(t),s()):xt()}[Bg](t){return t.commit()}runLoop(t){let n=t,s=0;for(;;){if(Sg(this._runtimeFlags)&&this.getSupervisor().onEffect(this,n),n=this.drainQueueWhileRunning(this._runtimeFlags,n),s+=1,s>=2048){s=0;const r=n;n=a(jc(),p(()=>r))}try{n._tag in this||He(n),n=this[n._tag](n)}catch(r){if(li(r)){if(r._tag===qn||r._tag===xn)throw r;if(r._tag===B||r._tag===H)return r}else Qg(r)?n=V(r.cause):Kg(r)?n=V(tt(Tt(r),Qt(Dt))):n=V(Tt(r))}}}stackToLines(){if(this._traceStack.length===0)return at();const t=[];let n=this._traceStack.length-1;for(;n>=0&&t.length<F.traceStackLimit;){const s=this._traceStack[n];t.push(s),n=n-1}return z(t)}}const _S=qt(my(F.minumumLogLevel)),bS=Uu((e,t,n,s,r,o,i)=>{const c=x_.log(e,t,n,s,r,o,i),u=Fs(r,_S);py(u)(t)&&globalThis.console.log(c)}),SS=Uc(Qr(bS)),vS=g((e,t)=>(n,s)=>a(vn(n,r=>ES(o=>t(s)(r,o))),ks).traced(e)),ES=g((e,t)=>n=>p(ao(),s=>p(ml(),r=>Zn(r,o=>a(t(n)(o),xe(s),ht)))).traced(e)),la=_(2,(e,t)=>(n,s)=>go(yo,r=>r._tag==="None"?gl(n,t(s)):wS(n,r.value,s)).traced(e)),$S=_(2,(e,t)=>(n,s)=>go(yo,r=>r._tag==="None"?Fo(n,t(s)):pl(n,r.value,s)).traced(e)),gl=(e,t)=>C(()=>{const n=Array.from(e).map((o,i)=>[o,i]),s=new Array(n.length);return rt(Fo(n,([o,i])=>p(t(o),c=>I(()=>s[i]=c))),k(z(s)))}),Fo=(e,t)=>C(()=>{const n=Array.from(e),s=n.length;return s===0?P():s===1?ht(t(n[0])):kt(r=>{const o=As(Dt);let i=0;const c=xc(u=>Mt(n,f=>a(u(a(r(C(()=>t(f))),nt(h=>rt(Vc(o,void 0),x(h)),()=>(i+1===s?bo(o,P()):i=i+1,P())))),Mn)));return p(c,u=>nt(r(Os(o)),f=>p(gl(u,Is),h=>{const d=dr(h);return d._tag==="Some"&&zc(d.value)?x(wt(rn(f),d.value.cause)):x(rn(f))}),()=>$s(u,f=>f.inheritAll())))})}),wS=(e,t,n)=>C(()=>{const s=Array.from(e).map((i,c)=>[i,c]),r=new Array(s.length);return rt(pl(s,t,([i,c])=>N(n(i),u=>r[c]=u)),k(z(r)))}),pl=(e,t,n)=>C(()=>{const s=e[Symbol.iterator](),r=p(I(()=>s.next()),i=>i.done?P():p(ht(n(i.value)),()=>r)),o=[];for(let i=0;i<t;i++)o.push(r);return Fo(o,Q)}),Mn=g(e=>t=>IS(t,xu).traced(e)),kS=(e,t,n,s=null)=>{const r=Or(e,t,n,s);return r.resume(e),r},Or=(e,t,n,s=null)=>{const r=cc(),o=t.unsafeGetFiberRefs(),i=mu(o,r),c=new dl(r,i,n),u=Fs(i,$n),f=c.getSupervisor();return f.onStart(u,e,T(t),c),c.unsafeAddObserver(d=>f.onEnd(d,c)),(s!==null?s:a(t.getFiberRef(ln),It(()=>t.scope()))).add(n,c),c},IS=(e,t)=>yt((n,s)=>k(kS(e,n,s.runtimeFlags,t))),ml=g(e=>()=>Lc(Po).traced(e)),yl=g((e,t)=>n=>ws(Po,t(n)).traced(e)),TS=g(e=>t=>p(js(),n=>AS(n)(t)).traced(e)),MS=(e,t)=>n=>C(()=>{switch(n.state._tag){case"Exited":return P();case"Running":{const s=n.state.finalizers,r=n.state.update,o=Array.from(s.keys()).sort((i,c)=>c-i).map(i=>s.get(i));return n.state={_tag:"Exited",nextKey:n.state.nextKey,exit:t,update:r},Vy(e)?a(o,Mt(i=>Xt(r(i)(t))),p(i=>a(Gc(i),Vt(zs),It(()=>xt())))):Jy(e)?a(o,la(i=>Xt(r(i)(t))),p(i=>a(dr(i),Vt(zs),It(()=>xt())))):a(o,la(i=>Xt(r(i)(t))),p(i=>a(dr(i),Vt(zs),It(()=>xt()))),mp(e.parallelism))}}}),Po=Ct(),js=g(e=>(t=Fu)=>N(Fp(),n=>({[gi]:gi,[pi]:pi,fork:s=>D(r=>ks(a(js(s),p(o=>a(n,mi(i=>ts(o,i)),vn(i=>Zn(o,i)),ft(o))))).traced(r)),close:s=>D(r=>ht(MS(t,s)(n)).traced(r)),addFinalizer:s=>D(r=>ht(mi(s)(n)).traced(r))})).traced(e)),_l=_(2,e=>(t,n)=>fp(t,Wr(Ur(Po,n))).traced(e)),AS=_(2,e=>(t,n)=>a(t,_l(n),cn(s=>n.close(s))).traced(e)),OS=e=>En(e,lS,Qe),fa=Tp(bg),CS=OS(xs),ha=g(e=>t=>a(Is(t),Mn,ht).traced(e));var bl,Sl;class RS{constructor(t){this.permits=t,this.waiters=new Array,this.taken=0,this.take=n=>D(s=>vs(r=>{if(this.free<n){const o=()=>{if(this.free>=n){const i=this.waiters.findIndex(c=>c===o);i!==-1&&this.waiters.splice(i,1),this.taken+=n,r(k(n))}};return this.waiters.push(o),lt(I(()=>{const i=this.waiters.findIndex(c=>c===o);i!==-1&&this.waiters.splice(i,1)}))}return this.taken+=n,ut(k(n))}).traced(s)),this.release=n=>D(s=>yt(r=>(this.taken-=n,r.getFiberRef(mo).scheduleTask(()=>{this.waiters.forEach(o=>o())}),P())).traced(s)),this.withPermits=n=>D(s=>r=>Y(()=>kt(o=>p(o(this.take(n)),i=>vl(o(r),this.release(i))))).traced(s))}get free(){return this.permits-this.taken}}const FS=e=>new RS(e),vl=_(2,e=>(t,n)=>kt(s=>nt(s(t),r=>nt(n,o=>x(tt(r,o)),()=>x(r)),r=>ft(n,r))).traced(e)),PS=_(2,e=>(t,n)=>kt(s=>p(n.fork(Fu),r=>a(s(t),cn(o=>r.close(o)),Mn,vn(o=>r.addFinalizer(()=>Cc(i=>S(i,o.id())?P():ht(Is(o)))))))).traced(e)),NS=g(e=>t=>yl(n=>PS(t,n)).traced(e)),LS=_(4,(e,t)=>(n,s,r,o)=>yt((i,c)=>{const u=c.runtimeFlags,f=Ce(!0),h=Or(n,i,u),d=Or(s,i,u);return h.startFork(n),d.startFork(s),h.setFiberRef(ln,T(i.scope())),d.setFiberRef(ln,T(i.scope())),a(Ss(m=>{h.unsafeAddObserver(()=>da(h,d,t(r),f,m)),d.unsafeAddObserver(()=>da(d,h,t(o),f,m))},a(h.id(),ag(d.id()))))}).traced(e)),da=(e,t,n,s,r)=>{Jd(!0,!1)(s)&&r(n(e,t))},xS=_(4,(e,t)=>(n,s,r,o)=>LS(n,s,(i,c)=>p(i.await(),u=>{switch(u._tag){case B:return p(i.inheritAll(),()=>t(r)(u,c));case H:return t(r)(u,c)}}),(i,c)=>p(i.await(),u=>{switch(u._tag){case B:return p(i.inheritAll(),()=>t(o)(u,c));case H:return t(o)(u,c)}})).traced(e)),jS=_(2,e=>(t,n)=>El(t,n,(s,r)=>r).traced(e)),El=_(3,(e,t)=>(n,s,r)=>kt(o=>xc(i=>{const c=As(Dt),u=Ce(!1);return a(ga(n,i,o,c,u),un(ga(s,i,o,c,u)),p(([f,h])=>a(o(Os(c)),nt(d=>a(ha(f),rt(ha(h)),rt(a(_r(f),un(_r(h)),p(([m,b])=>a(m,_o(b,r,wt),Ms($=>x(wt(rn(d),$)),()=>x(rn(d)))))))),()=>ho(br(f),br(h),t(r))))))})).traced(e)),ga=(e,t,n,s,r)=>Mn(nt(t(n(e)),o=>rt(Vc(s,void 0),x(o)),o=>ae(r)?(bo(s,P()),k(o)):(a(r,ce(!0)),k(o)))),DS="@effect/io/Ref/Synchronized",qS=Symbol.for(DS),KS={_A:e=>e};class US{constructor(t,n){this.ref=t,this.withLock=n,this[bl]=KS,this[Sl]=ku}modify(t){return D((n,s)=>this.modifyEffect(r=>k(s(t)(r))).traced(n))}modifyEffect(t){return D((n,s)=>this.withLock(a(p(mr(this.ref),s(t)),p(([r,o])=>ft(Tu(this.ref,o),r)))).traced(n))}}bl=qS,Sl=wu;const WS=g(e=>t=>I(()=>zS(t)).traced(e)),zS=e=>{const t=Iu(e),n=FS(1);return new US(t,n.withPermits(1))},GS="ExtendScope",HS="Fold",$l="Fresh",wl="FromEffect",BS="Scoped",kl="Suspend",Il="ProvideTo",Tl="ZipWith",Ml="ZipWithPar",JE=_r,YE=m_,QE=Is,VS=Dc,XE=br,JS=e=>(t,n)=>{const s=cc();let r=Ii(e.fiberRefs,s,$n,e.context);n&&(r=Ii(r,s,mo,n));const o=new dl(s,ey(r,s),e.runtimeFlags),i=o.getSupervisor();return i!==xs&&(i.onStart(e.context,t,v(),o),o.unsafeAddObserver(c=>i.onEnd(c,o))),xu.add(e.runtimeFlags,o),o.start(t),o},Al=e=>(t,n)=>{const s=JS(e)(t);return n&&s.unsafeAddObserver(r=>{n(r)}),(r,o)=>Al(e)(a(s,VS(r??Dt)),o?i=>o(Ym(i)):void 0)},YS=e=>t=>new Promise((n,s)=>{Al(e)(t,r=>{switch(r._tag){case B:{n(r.value);break}case H:{s(a(r.cause,Lg(Q)));break}}})});class QS{constructor(t,n,s){this.context=t,this.runtimeFlags=n,this.fiberRefs=s}}const XS=(e,t,n)=>new QS(e,t,n),ZS=dc(Pe,fc),tv=XS(Kr(),ZS,ny(new Map)),ev=YS(tv),nv=_(2,(e,t)=>(n,s)=>n.modifyEffect(t(s)).traced(e)),sv="@effect/io/Layer",rv=Symbol.for(sv),ov={_RIn:e=>e,_E:e=>e,_ROut:e=>e},hn={[rv]:ov},iv=e=>e._tag===$l;class av{constructor(t){this.ref=t}getOrElseMemoize(t,n){return a(nv(this.ref,s=>{const r=s.get(t);if(r!==void 0){const[o,i]=r,c=a(o,p(([u,f])=>a(Cy(u),ft(f))),cn(Ms(()=>P(),()=>Zn(n,i))));return k([c,s])}return a(Ti(0),p(o=>a(qp(),p(i=>a(Ti(()=>P()),N(c=>{const u=kt(h=>a(js(),p(d=>a(h(p(Cl(t,d),m=>ky(m(this)))),Xt,p(m=>{switch(m._tag){case H:return a(Wp(i,m.cause),rt(ts(d,m)),rt(x(m.cause)));case B:return a(Tu(c,b=>a(ts(d,b),pp(Sy(o,$=>[$===1,$-1])),ht)),rt(Mi(o,b=>b+1)),rt(Zn(n,b=>a(mr(c),p($=>$(b))))),rt(zp(i,m.value)),ft(m.value[1]))}}))))),f=[a(Os(i),cn(jp(()=>P(),()=>Mi(o,h=>h+1)))),h=>a(mr(c),p(d=>d(h)))];return[u,iv(t)?s:s.set(t,f)]}))))))}),uo)}}const cv=()=>a(WS(new Map),N(e=>new av(e))),Ol=_(2,e=>(t,n)=>p(cv(),s=>p(Cl(t,n),r=>r(s))).traced(e)),Cl=(e,t)=>{const n=e;switch(n._tag){case GS:return I(()=>s=>yl(r=>s.getOrElseMemoize(n.layer,r)));case HS:return I(()=>s=>a(s.getOrElseMemoize(n.layer,t),nt(r=>s.getOrElseMemoize(n.failureK(r),t),r=>s.getOrElseMemoize(n.successK(r),t))));case $l:return I(()=>s=>a(n.layer,Ol(t)));case wl:return I(()=>s=>n.effect);case Il:return I(()=>s=>a(s.getOrElseMemoize(n.first,t),p(r=>a(s.getOrElseMemoize(n.second,t),xe(r)))));case BS:return I(()=>s=>_l(n.effect,t));case kl:return I(()=>s=>s.getOrElseMemoize(n.evaluate(),t));case Tl:return I(()=>s=>a(s.getOrElseMemoize(n.first,t),ho(s.getOrElseMemoize(n.second,t),n.zipK)));case Ml:return I(()=>s=>a(s.getOrElseMemoize(n.first,t),El(s.getOrElseMemoize(n.second,t),n.zipK)))}},Rl=()=>No(ao()),Fl=(e,t)=>No(N(t,n=>Ur(e,n)));function No(e){const t=Object.create(hn);return t._tag=wl,t.effect=e,t}const uv=l(2,(e,t)=>hv(e,t,(n,s)=>a(n,Wr(s)))),lv=l(2,(e,t)=>Pl(()=>{const n=Object.create(hn);return n._tag=Il,n.first=Object.create(hn,{_tag:{value:Tl,enumerable:!0},first:{value:Rl(),enumerable:!0},second:{value:e},zipK:{value:(s,r)=>a(s,Wr(r))}}),n.second=t,n})),fv=(e,t)=>No(k(Ur(e,t))),Pl=e=>{const t=Object.create(hn);return t._tag=kl,t.evaluate=e,t},hv=Zd(3,e=>(t,n,s)=>Pl(()=>{const r=Object.create(hn);return r._tag=Ml,r.first=t,r.second=n,r.zipK=e(s),r})),dv=_(2,e=>(t,n)=>io(js(),s=>p(Ol(n,s),r=>xe(t,r)),(s,r)=>ts(s,r)).traced(e)),gv=_(2,e=>(t,n)=>dv(t,a(Rl(),uv(n))).traced(e)),pv=l(2,(e,t)=>Fl(t,e)),ZE=vS,mv=io,An=ft,t$=np,e$=Mu,Js=Ey,n$=$y,s$=Tc,r$=wy,o$=Mc,i$=vl,a$=Xt,c$=x,u$=Cc,Me=p,l$=uo,yv=Mt,_v=$s,bv=$S,f$=Mn,h$=NS,Sv=Nt,Lo=Fc,d$=Ty,g$=Ay,p$=rp,m$=Pc,y$=ip,_$=Oy,vv=Ou,Ev=N,Nl=an,b$=Au,S$=Rc,v$=nt,E$=ap,$v=up,wv=cp,$$=xe,Ll=Ry,Cr=gv,w$=xS,k$=ml,kv=TS,Xe=Lc,xl=hp,jl=ws,Iv=Py,I$=k,Be=C,E=I,T$=vn,M$=Ny,A$=Ly,xo=pv,O$=jy,Tv=Dy,C$=ks,R$=kt,Rr=P,F$=ev,Mv=un,ss=fo,ct=rt,P$=ho,N$=jS,Av=(e,t,n,s)=>({_tag:"Hsla",h:e,s:t,l:n,a:s}),Ov=(e,t,n)=>Av(e,t,n,1),L$=Ov(360,1,1),Fn=e=>{switch(e._tag){case"Hex":return e.value;case"Hsla":{const{h:t,s:n,l:s,a:r}=e,o=h=>Math.round(h*100)/100,i=o(t),c=o(n*100)+"%",u=o(s*100)+"%",f=String(r);return r===1?`hsl(${i}, ${c}, ${u})`:`hsla(${i}, ${c}, ${u}, ${f})`}}};class jo{constructor(t){this.message=t,this._tag="CanvasError"}}const pt=Ct(),Cv=w(e=>E(()=>e.canvas.width)),Rv=w(e=>E(()=>e.canvas.height)),x$=Iv({width:Cv,height:Rv});w(e=>E(()=>e.canvas.toDataURL()));const pa=e=>Kt(t=>{t.fillStyle=e});Kt(e=>e.fillStyle);w(e=>E(()=>e.font));function Fv(e){return w(t=>a(E(()=>t.font=e),An(t)))}w(e=>E(()=>e.globalAlpha));w(e=>E(()=>e.globalCompositeOperation));w(e=>E(()=>e.imageSmoothingEnabled));w(e=>a(E(()=>e.lineCap)));w(e=>a(E(()=>e.lineDashOffset)));w(e=>a(E(()=>e.lineJoin)));function Pv(e){return Kt(t=>{t.lineWidth=e})}w(e=>a(E(()=>e.lineWidth)));w(e=>E(()=>e.miterLimit));function Nv(e){return Kt(t=>{t.strokeStyle=e})}Kt(e=>e.strokeStyle);function Lv(e){return w(t=>a(E(()=>t.shadowBlur=e),An(t)))}w(e=>E(()=>e.shadowBlur));function xv(e){return w(t=>E(()=>t.shadowColor=e))}w(e=>a(E(()=>e.shadowColor)));function jv(e){return w(t=>a(E(()=>t.shadowOffsetX=e),An(t)))}w(e=>a(E(()=>e.shadowOffsetX)));function Dv(e){return w(t=>a(E(()=>t.shadowOffsetY=e),An(t)))}w(e=>a(E(()=>e.shadowOffsetY)));Kt(e=>e.textAlign);w(e=>E(()=>e.textBaseline));function qv(e,t,n,s,r,o=!1){return w(i=>a(E(()=>i.arc(e,t,n,s,r,o)),An(i)))}const Do=Kt(e=>{e.beginPath()});function j$(e,t,n,s){return w(r=>E(()=>{r.clearRect(e,t,n,s)}))}function Kv(e,t){return w(n=>E(()=>{typeof t<"u"?n.clip(t,e):typeof e<"u"?n.clip(e):n.clip()}))}const Uv=w(e=>E(()=>{e.closePath()})),Dl=(e,t,n)=>w(s=>E(()=>{s.drawImage(e,t,n)}));function Wv(e,t,n,s,r,o,i,c=!1){return w(u=>E(()=>{u.ellipse(e,t,n,s,r,o,i,c)}))}const zv=(e,t)=>w(n=>E(()=>{typeof t<"u"?n.fill(t,e):typeof e<"u"?n.fill(e):n.fill()}));function D$(e,t,n,s){return w(r=>E(()=>{r.fillRect(e,t,n,s)}))}const Gv=(e,t,n,s)=>w(r=>E(()=>{typeof s<"u"?r.fillText(e,t,n,s):r.fillText(e,t,n)}));function q$(e,t,n,s){return w(r=>E(()=>r.getImageData(e,t,n,s)))}w(e=>E(()=>e.getLineDash()));w(e=>E(()=>e.getTransform()));const Hv=(e,t)=>Kt(n=>{n.lineTo(e,t)});function Bv(e,t){return w(n=>E(()=>{n.moveTo(e,t)}))}function Vv(e,t,n,s){return w(r=>E(()=>{r.rect(e,t,n,s)}))}const Jv=w(e=>E(()=>{e.restore()})),Yv=e=>w(t=>E(()=>{t.rotate(e)})),Qv=w(e=>E(()=>{e.save()})),Xv=(e,t)=>w(n=>E(()=>{n.scale(e,t)}));function Zv(e){return w(t=>E(()=>{typeof e<"u"?t.stroke(e):t.stroke()}))}const tE=(e,t)=>w(n=>E(()=>{n.translate(e,t)})),eE=e=>a(Do,ct(e),ss(zv())),nE=e=>a(Do,ct(e),ss(Zv()));function Kt(e){return w(t=>E(()=>e(t)))}function Ft(e){return kv(mv(Qv,t=>e,t=>Jv))}function w(e){return jl(pt,e)}const qo=Fl,sE=lv,rE=fv;function K$(e){const t=typeof e=="string"?oE(e):e instanceof HTMLElement?aE(e):iE(e);return Cr(t)}function oE(e){return qo(pt,cE(e))}function iE(e){return rE(pt,e)}function aE(e){return qo(pt,Me(Ul(e),Kl))}function cE(e){return Me(uE(e),Kl)}function uE(e){return a(E(()=>document.getElementById(e)),Me(ql),Nl(()=>new jo(`No such element with id ${e} exists`)),Me(Ul))}const ql=st(Ma,Lo);function Kl(e){return a(E(()=>e.getContext("2d")),Me(ql),Nl(t=>new jo(`${e.id} is not an instance of HTMLCanvasElement`)))}const Ul=st(Xf(e=>e instanceof HTMLCanvasElement,()=>new jo("element is not an instance of HTMLCanvasElement")),Sv),Wl=Ct(),lE=xo(xl(pt,e=>dE(e)),Wl),zl=Ct(),fE=sE(lE,qo(zl,xl(Wl,e=>hE(e))));function hE(e){return function t(n){switch(n._tag){case"Arc":return e.arc(n.x,n.y,n.r,n.start,n.end,n.anticlockwise);case"Composite":return bv(n.shapes,s=>t(s));case"Ellipse":return e.ellipse(n.x,n.y,n.rx,n.ry,n.rotation,n.start,n.end,n.anticlockwise);case"Path":return a(n.points,sh(Rr,([s,...r])=>Tv(e.moveTo(s.x,s.y),yv(r,({x:o,y:i})=>e.lineTo(o,i)))),ct(n.closed?e.closePath:Rr()));case"Rect":return e.rect(n.x,n.y,n.width,n.height)}}}function dE(e){const t=Ll(pt,e);return{moveTo:st(Bv,t),lineTo:st(Hv,t),closePath:t(Uv),ellipse:st(Wv,t),rect:st(Vv,t),arc:st(qv,t),drawImage:st(Dl,t)}}const gE=Rf,pE=ka,Ko=e=>!e;Pr.combine;Pr.combine;Nr.combine;Nr.combine;Sf.combine;vf.combine;gE.combineAll;pE.combineAll;const mE={show:e=>[e.style,e.variant,e.weight].filter(q).map(It(dn(""))).join(" ")},yE=st(eh,Ko),_E={show:({fontFamily:e,size:t,fontOptions:n})=>[mE.show(n),`${t}px`,e].filter(yE).join(" ")},Gl=Ct(),bE=a(Xe(zl),Mv(Xe(pt)),Ev(([e,t])=>vE(e,t)),xo(Gl));function SE(e){return a(jl(Gl,t=>t(e)),Cr(bE),Cr(fE))}function vE(e,t){return n;function n(r){return Ll(s(r),pt,t)}function s(r){switch(r._tag){case"Clipped":return Ft(a(Do,ct(e(r.shape)),ct(Kv()),ct(Be(()=>n(r.drawing)))));case"Fill":return Ft(a(zt(r.style.color,st(Fn,pa)),ct(eE(e(r.shape)))));case"Many":return a(Xe(pt),ss(_v(r.drawings,o=>n(o))));case"Outline":return a(Xe(pt),ss(a(Js([zt(r.style.color,st(Fn,Nv)),zt(r.style.lineWidth,Pv),nE(e(r.shape))]),Ft)));case"Rotate":return Ft(a(Yv(r.angle),ct(Be(()=>n(r.drawing)))));case"Scale":return Ft(a(Xv(r.scaleX,r.scaleY),ct(Be(()=>n(r.drawing)))));case"Text":return a(Js([Fv(_E.show(r.font)),zt(r.style.color,st(Fn,pa)),Gv(r.text,r.x,r.y)]),Ft,ct(Xe(pt)));case"Translate":return Ft(a(tE(r.translateX,r.translateY),ct(Be(()=>n(r.drawing)))));case"WithShadow":return Ft(a(Js([zt(r.shadow.color,st(Fn,xv)),zt(r.shadow.blur,Lv),zt(r.shadow.offset,o=>a(jv(o.x),ct(Dv(o.y))))]),ct(Be(()=>n(r.drawing)))));case"Image":return Dl(r.image,r.source.x,r.source.y)}}}const zt=(e,t)=>a(Lo(e),Me(t),wv(Rr)),ma=e=>({_tag:"Radians",radians:e}),ya=e=>{switch(e._tag){case"Degrees":return e.degrees*(Math.PI/180);case"Radians":return e.radians}},U$=(e,t)=>({x:e,y:t}),W$=(e,t,n)=>({_tag:"Arc",x:e,y:t,r:n,start:ya(ma(0)),end:ya(ma(Math.PI*2)),anticlockwise:!1}),z$=(e,t,n,s)=>({_tag:"Rect",x:e,y:t,width:n,height:s});as({_tag:{combineAll:()=>"Path",combineMany:()=>"Path",combine:()=>"Path",empty:"Path"},closed:ka,points:Ra()});const Pn=Ra(),Uo=()=>Ot(Jf(),v()),Wo=Uo(),Hl=Uo(),EE=Uo(),G$=(e,t)=>({_tag:"Fill",shape:e,style:t}),H$=e=>({color:T(e)}),B$=(e,t)=>({_tag:"Outline",shape:e,style:t}),V$=e=>({color:T(e),lineWidth:v()}),Ve=e=>({_tag:"Many",drawings:e});function J$(e){return t=>({_tag:"Rotate",angle:e,drawing:t})}const Y$=(e,t,n)=>({_tag:"Image",image:e,source:t,dest:n});function Q$(e,t){return n=>({_tag:"Translate",translateX:e,translateY:t,drawing:n})}const X$=SE;as({color:Wo});as({color:Wo,lineWidth:Hl});as({color:Wo,blur:Hl,offset:EE});const Bl=Ot(ot((e,t)=>e._tag==="Many"&&t._tag==="Many"?Ve(Pn.combineAll([e.drawings,t.drawings])):e._tag==="Many"?Ve(Pn.combineAll([e.drawings,[t]])):t._tag==="Many"?Ve(Pn.combineAll([[e],t.drawings])):Ve([e,t])),Ve(Pn.empty)),Z$=Bl.combineAll;Bl.combine;const $E=Ct(),wE=Yf(e=>e instanceof HTMLButtonElement),tw=a(Lo(wE(document.getElementById("restart"))),$v,xo($E)),ew=e=>t=>E(()=>{t.disabled?t.addEventListener("click",e):t.removeEventListener("click",e),t.disabled=!t.disabled});function nw(e){return vv(0,t=>t<=360,t=>t+5,t=>e(-t*Math.PI/180))}export{Ec as $,ew as A,N$ as B,K$ as C,Js as D,j$ as E,Yv as F,Q$ as G,J$ as H,L$ as I,Ti as J,mr as K,Tu as L,VE as M,Sy as N,qp as O,Os as P,Wp as Q,$E as R,zp as S,Le as T,vc as U,PE as V,fr as W,Tt as X,sn as Y,RE as Z,Mg as _,Nv as a,ys as a$,NE as a0,Ug as a1,Qt as a2,FE as a3,ts as a4,_l as a5,js as a6,xE as a7,LE as a8,Ct as a9,v as aA,Q as aB,E as aC,$$ as aD,v$ as aE,Be as aF,zE as aG,f$ as aH,QE as aI,at as aJ,F as aK,z as aL,Y as aM,i$ as aN,Mv as aO,C$ as aP,o$ as aQ,GE as aR,jr as aS,La as aT,Ze as aU,W as aV,Yd as aW,UE as aX,_v as aY,I$ as aZ,q as a_,xo as aa,xl as ab,pt as ac,Ll as ad,st as ae,An as af,Do as ag,Zv as ah,sE as ai,Bv as aj,Hv as ak,d$ as al,Xe as am,Me as an,Ev as ao,T$ as ap,Rr as aq,g$ as ar,jE as as,D as at,a$ as au,P$ as av,BE as aw,_ as ax,g as ay,IE as az,nE as b,eE as b$,r$ as b0,t$ as b1,WE as b2,yv as b3,qE as b4,It as b5,HE as b6,kv as b7,k$ as b8,Fu as b9,T as bA,l as bB,K as bC,cs as bD,Nl as bE,b$ as bF,Lr as bG,ME as bH,ye as bI,us as bJ,DE as bK,wh as bL,s$ as bM,q$ as bN,O$ as bO,Y$ as bP,x$ as bQ,Xv as bR,Lo as bS,Ma as bT,TE as bU,U$ as bV,$v as bW,_$ as bX,A$ as bY,kE as bZ,W$ as b_,h$ as ba,ss as bb,YE as bc,mv as bd,E$ as be,y$ as bf,M$ as bg,c$ as bh,l$ as bi,u$ as bj,p$ as bk,lt as bl,ut as bm,KE as bn,S$ as bo,JE as bp,m$ as bq,XE as br,w$ as bs,ZE as bt,S as bu,R$ as bv,ee as bw,xr as bx,Dr as by,zo as bz,e$ as c,qv as c0,Pv as c1,tE as d,Z$ as e,D$ as f,G$ as g,H$ as h,z$ as i,V$ as j,Av as k,nw as l,n$ as m,du as n,B$ as o,X$ as p,a as q,Vv as r,pa as s,Fn as t,F$ as u,Cr as v,Ft as w,tw as x,jl as y,ct as z};
