(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function n(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerPolicy&&(o.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?o.credentials="include":s.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=n(s);fetch(s.href,o)}})();const l=(e,t)=>function(){return arguments.length>=e?t.apply(this,arguments):n=>t(n,...arguments)},B=e=>e,rn=e=>()=>e,Ao=rn(!0),Dr=rn(!1),Nl=rn(void 0);function nt(e,t,n,r,s,o,i,a,u){switch(arguments.length){case 1:return e;case 2:return function(){return t(e.apply(this,arguments))};case 3:return function(){return n(t(e.apply(this,arguments)))};case 4:return function(){return r(n(t(e.apply(this,arguments))))};case 5:return function(){return s(r(n(t(e.apply(this,arguments)))))};case 6:return function(){return o(s(r(n(t(e.apply(this,arguments))))))};case 7:return function(){return i(o(s(r(n(t(e.apply(this,arguments)))))))};case 8:return function(){return a(i(o(s(r(n(t(e.apply(this,arguments))))))))};case 9:return function(){return u(a(i(o(s(r(n(t(e.apply(this,arguments)))))))))}}}function c(e,t,n,r,s,o,i,a,u){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return n(t(e));case 4:return r(n(t(e)));case 5:return s(r(n(t(e))));case 6:return o(s(r(n(t(e)))));case 7:return i(o(s(r(n(t(e))))));case 8:return a(i(o(s(r(n(t(e)))))));case 9:return u(a(i(o(s(r(n(t(e))))))));default:{let f=arguments[0];for(let h=1;h<arguments.length;h++)f=arguments[h](f);return f}}}function ce(e){return e==null}const Ll=335903614,xl=4150755663,jl=1481765933>>>0,Dl=1284865837>>>0,Kl=9007199254740992,ql=134217728;class rc{constructor(t,n,r,s){return ce(n)&&ce(t)?(n=Math.random()*4294967295>>>0,t=0):ce(n)&&(n=t,t=0),ce(s)&&ce(r)?(s=this._state?this._state[3]:xl,r=this._state?this._state[2]:Ll):ce(s)&&(s=r,r=0),this._state=new Int32Array([0,0,r>>>0,((s||0)|1)>>>0]),this._next(),Co(this._state,this._state[0],this._state[1],t>>>0,n>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(t){this._state[0]=t[0],this._state[1]=t[1],this._state[2]=t[2],this._state[3]=t[3]|1}integer(t){if(!t)return this._next();if(t=t>>>0,!(t&t-1))return this._next()&t-1;let n=0;const r=(-t>>>0)%t>>>0;for(n=this._next();n<r;n=this._next());return n%t}number(){const t=(this._next()&67108863)*1,n=(this._next()&134217727)*1;return(t*ql+n)/Kl}_next(){const t=this._state[0]>>>0,n=this._state[1]>>>0;Ul(this._state,t,n,jl,Dl),Co(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let r=t>>>18,s=(n>>>18|t<<14)>>>0;r=(r^t)>>>0,s=(s^n)>>>0;const o=(s>>>27|r<<5)>>>0,i=t>>>27,a=(-i>>>0&31)>>>0;return(o>>>i|o<<a)>>>0}}function Ul(e,t,n,r,s){let o=(n>>>16)*(s&65535)>>>0,i=(n&65535)*(s>>>16)>>>0,a=(n&65535)*(s&65535)>>>0,u=(n>>>16)*(s>>>16)+((i>>>16)+(o>>>16))>>>0;i=i<<16>>>0,a=a+i>>>0,a>>>0<i>>>0&&(u=u+1>>>0),o=o<<16>>>0,a=a+o>>>0,a>>>0<o>>>0&&(u=u+1>>>0),u=u+Math.imul(n,r)>>>0,u=u+Math.imul(t,s)>>>0,e[0]=u,e[1]=a}function Co(e,t,n,r,s){let o=t+r>>>0;const i=n+s>>>0;i>>>0<n>>>0&&(o=o+1|0),e[0]=o,e[1]=i}const Mr=new WeakMap,Wl=new rc,M=Symbol.for("@effect/data/Hash"),_=e=>{switch(typeof e){case"number":return vs(e);case"bigint":return G(e.toString(10));case"boolean":return G(String(e));case"symbol":return G(String(e));case"string":return G(e);case"undefined":return G("undefined");case"function":case"object":return e===null?G("null"):zl(e)?e[M]():sc(e);default:throw new Error("Bug in Equal.hashGeneric")}},sc=e=>(Mr.has(e)||Mr.set(e,vs(Wl.integer(Number.MAX_SAFE_INTEGER))),Mr.get(e)),A=e=>t=>t*53^e,tr=e=>e&3221225471|e>>>1&1073741824,zl=e=>typeof e=="object"&&e!==null&&M in e,vs=e=>{if(e!==e||e===1/0)return 0;let t=e|0;for(t!==e&&(t^=e*4294967295);e>4294967295;)t^=e/=4294967295;return tr(e)},G=e=>{let t=5381,n=e.length;for(;n;)t=t*33^e.charCodeAt(--n);return tr(t)},Gl=e=>{const t=Object.keys(e);let n=12289;for(let r=0;r<t.length;r++)n^=c(G(t[r]),A(_(e[t[r]])));return tr(n)},oc=e=>{let t=6151;for(let n=0;n<e.length;n++)t=c(t,A(_(e[n])));return tr(t)},O=Symbol.for("@effect/data/Equal");function S(){return arguments.length===1?e=>Ro(e,arguments[0]):Ro(arguments[0],arguments[1])}function Ro(e,t){if(e===t)return!0;const n=typeof e;return n!==typeof t?!1:(n==="object"||n==="function")&&e!==null&&t!==null&&Fo(e)&&Fo(t)?_(e)===_(t)&&e[O](t):!1}const Fo=e=>typeof e=="object"&&e!==null&&O in e,Hl=()=>(e,t)=>_(e)===_(t)&&S(e,t),Bl=(()=>{const e={[M](){return Gl(this)},[O](t){const n=Object.keys(this),r=Object.keys(t);if(n.length!==r.length)return!1;for(const s of n)if(!(s in t&&S(this[s],t[s])))return!1;return!0}};return Object.setPrototypeOf(e,Object.prototype)})(),er=e=>Vl(Object.assign({},e)),Vl=e=>Object.setPrototypeOf(e,Bl),Jl=e=>e._tag==="None",Yl=e=>e._tag==="Some",Ql=er({_tag:"None"}),Xl=e=>er({_tag:"Some",value:e}),Zl=e=>e._tag==="Left",tf=e=>e._tag==="Right",ef=e=>er({_tag:"Left",left:e}),nf=e=>er({_tag:"Right",right:e}),rf=e=>e.length>0,nr=e=>Array.isArray(e)?e:Array.from(e),sf=e=>t=>{const n=Object.keys(t);return e.imap(e.productAll(n.map(r=>t[r])),r=>{const s={};for(let o=0;o<r.length;o++)s[n[o]]=r[o];return s},r=>n.map(s=>r[s]))},rt=(e,t=(n,r)=>nr(r).reduce(e,n))=>({combine:e,combineMany:t}),of=rt((e,t)=>e+t),ic=rt((e,t)=>e+t),cc=rt((e,t)=>e*t,(e,t)=>{if(e===0)return 0;let n=e;for(const r of t){if(r===0)return 0;n=n*r}return n}),Es=rt((e,t)=>e&&t,(e,t)=>{if(e===!1)return!1;for(const n of t)if(n===!1)return!1;return!0}),ws=rt((e,t)=>e||t,(e,t)=>{if(e===!0)return!0;for(const n of t)if(n===!0)return!0;return!1}),cf=rt((e,t)=>e!==t),af=rt((e,t)=>e===t),uf=e=>rt(()=>e,()=>e),lf=l(3,(e,t,n)=>rt((r,s)=>t(e.combine(n(r),n(s))),(r,s)=>t(e.combineMany(n(r),nr(s).map(n))))),ff=(e,t)=>rt(([n,r],[s,o])=>[e.combine(n,s),t.combine(r,o)]),ac=e=>{const t=nr(e);return rt((n,r)=>{const s=Math.min(n.length,r.length,t.length),o=[];for(let i=0;i<s;i++)o.push(t[i].combine(n[i],r[i]));return o})},hf=(e,t)=>{const n=ac(t);return rt((r,s)=>[e.combine(r[0],s[0]),...n.combine(r.slice(1),s.slice(1))])},df=uf,gf={of:df,imap:lf,product:ff,productMany:hf,productAll:ac},pf=()=>rt((e,t)=>e.concat(t)),mf=sf(gf),Tt=(e,t)=>({combine:e.combine,combineMany:e.combineMany,empty:t,combineAll:n=>e.combineMany(t,n)}),yf=Tt(ic,0),_f=Tt(cc,1),bf=Tt(Es,!0),uc=Tt(ws,!1),Sf=()=>Tt(pf(),[]),rr=e=>{const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n].empty);return Tt(mf(e),t)},lc=e=>({compare:(t,n)=>t===n?0:e(t,n)}),fc=lc((e,t)=>e<t?-1:1),vf=l(2,(e,t)=>lc((n,r)=>e.compare(t(n),t(r)))),Ef=e=>l(2,(t,n)=>e.compare(t,n)!==-1);fc.compare;const wf=(e,t)=>e===t,kf=()=>wf,$f=kf();ic.combine;cc.combine;const Ln=fc,If=yf,Tf=_f;If.combineAll;Tf.combineAll;const Mf=e=>l(3,(t,n,r)=>e(t,n)),Of=e=>()=>({combine:e.coproduct,combineMany:e.coproductMany}),v=()=>Ql,I=Xl,W=Jl,D=Yl,ks=l(3,(e,t,n)=>W(e)?t():n(e.value)),wt=l(2,(e,t)=>W(e)?t():e.value),Af=l(2,(e,t)=>W(e)?t():e),Cf=e=>{let t=v();for(t of e)if(D(t))return t;return t},hc=e=>e==null?v():I(e),ae=wt(Nl),zt=l(2,(e,t)=>W(e)?v():I(t(e.value))),Rf=Mf(zt),Ff=(e,t)=>D(e)?e:t,Pf=(e,t)=>D(e)?e:Cf(t),Nf={imap:Rf,coproduct:Ff,coproductMany:Pf},Lf=Of(Nf),xf=e=>t=>e(t)?I(t):v(),jf=e=>l(2,(t,n)=>W(t)?!1:e(t.value,n)),ut=nf,pt=ef,vn=Zl,qe=tf,Df=(e,t)=>n=>e(n)?ut(n):pt(t(n)),Kf=$f,qf=of;qf.combine;const Uf=e=>e.length===0,Wf=(e,t)=>{const n=Math.max(1,Math.floor(e)),r=[t(0)];for(let s=1;s<n;s++)r.push(t(s));return r},pe=nr,zf=l(3,(e,t,n)=>Vt(e)?n(e):t()),Bt=l(2,(e,t)=>[t,...e]),Gf=e=>e.length===0,Hf=Gf,Vt=rf,Bf=(e,t)=>e<0||e>=t.length,dc=(e,t)=>Math.floor(Math.min(Math.max(0,e),t.length)),Vf=l(2,(e,t)=>{const n=Math.floor(t);if(Bf(n,e))throw new Error(`Index ${n} out of bounds`);return e[n]}),Y=Vf(0),me=e=>e.slice(1),Jf=l(2,(e,t)=>{const n=pe(e);return n.slice(0,dc(t,n))}),Yf=l(2,(e,t)=>{const n=pe(e);return n.slice(dc(t,n),n.length)}),Qf=e=>Array.from(e).reverse(),Xf=l(2,(e,t)=>{const n=Array.from(e);return n.sort(t.compare),n}),Zf=l(3,(e,t,n)=>{const r=pe(e),s=pe(t);return Vt(r)&&Vt(s)?th(s,n)(r):[]}),th=l(3,(e,t,n)=>{const r=[n(Y(e),Y(t))],s=Math.min(e.length,t.length);for(let o=1;o<s;o++)r[o]=n(e[o],t[o]);return r}),eh=l(2,(e,t)=>{const n=pe(e);return Vt(n)?nh(t)(n):[]}),nh=l(2,(e,t)=>{const n=[Y(e)],r=me(e);for(const s of r)n.every(o=>!t(s,o))&&n.push(s);return n}),rh=()=>[],gc=e=>[e],pc=l(2,(e,t)=>e.map(t)),sh=l(3,(e,t,n)=>pe(e).reduce((r,s,o)=>n(r,s,o),t)),mc=Sf,yc=Symbol.for("@effect/data/Chunk"),Po=[];function oh(e,t,n,r,s){for(let o=t;o<Math.min(e.length,t+s);o++)n[r+o-t]=e[o];return n}class V{constructor(t){switch(this.backing=t,this._id=yc,t._tag){case"IEmpty":{this.length=0,this.depth=0,this.left=this,this.right=this;break}case"IConcat":{this.length=t.left.length+t.right.length,this.depth=1+Math.max(t.left.depth,t.right.depth),this.left=t.left,this.right=t.right;break}case"IArray":{this.length=t.array.length,this.depth=0,this.left=bt,this.right=bt;break}case"ISingleton":{this.length=1,this.depth=0,this.left=bt,this.right=bt;break}}}get array(){return this.toReadonlyArray()}toReadonlyArray(){switch(this.backing._tag){case"IEmpty":return Po;case"IArray":return this.backing.array;default:{const t=new Array(this.length);return Kr(this,t,0),this.backing={_tag:"IArray",array:t},this.left=bt,this.right=bt,this.depth=0,t}}}toString(){return`Chunk(${this.toReadonlyArray().map(String).join(", ")})`}toJSON(){return{_tag:"Chunk",values:this.toReadonlyArray()}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}isNonEmpty(){return this.length>0}isEmpty(){return!this.isNonEmpty()}map(t){return this.backing._tag==="ISingleton"?K(t(this.backing.a)):z(pc(t)(J(this)))}flatMap(t){if(this.backing._tag==="ISingleton")return t(this.backing.a);let n=bt;for(const r of this)n=U(t(r))(n);return n}forEach(t){return this.backing._tag==="ISingleton"?t(this.backing.a):J(this).forEach(t)}append(t){return this.concat(K(t))}prepend(t){return K(t).concat(this)}concat(t){if(this.backing._tag==="IEmpty")return t;if(t.backing._tag==="IEmpty")return this;const n=t.depth-this.depth;if(Math.abs(n)<=1)return new V({_tag:"IConcat",left:this,right:t});if(n<-1)if(this.left.depth>=this.right.depth){const r=U(t)(this.right);return new V({_tag:"IConcat",left:this.left,right:r})}else{const r=U(t)(this.right.right);if(r.depth===this.depth-3){const s=new V({_tag:"IConcat",left:this.right.left,right:r});return new V({_tag:"IConcat",left:this.left,right:s})}else{const s=new V({_tag:"IConcat",left:this.left,right:this.right.left});return new V({_tag:"IConcat",left:s,right:r})}}else if(t.right.depth>=t.left.depth){const r=U(t.left)(this);return new V({_tag:"IConcat",left:r,right:t.right})}else{const r=U(t.left.left)(this);if(r.depth===t.depth-3){const s=new V({_tag:"IConcat",left:r,right:t.left.right});return new V({_tag:"IConcat",left:s,right:t.right})}else{const s=new V({_tag:"IConcat",left:t.left.right,right:t.right});return new V({_tag:"IConcat",left:r,right:s})}}}get(t){return t<0||t>=this.length?v():I(this.unsafeGet(t))}unsafeGet(t){switch(this.backing._tag){case"IEmpty":throw new Error("Index out of bounds");case"ISingleton":{if(t!==0)throw new Error("Index out of bounds");return this.backing.a}case"IArray":{if(t>=this.length||t<0)throw new Error("Index out of bounds");return this.backing.array[t]}case"IConcat":return t<this.left.length?this.left.unsafeGet(t):this.right.unsafeGet(t-this.left.length)}}[O](t){return _c(t)&&this.length===t.length?J(this).every((n,r)=>S(n,t.unsafeGet(r))):!1}[M](){return oc(J(this))}[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return Po[Symbol.iterator]();default:return J(this)[Symbol.iterator]()}}}const Kr=(e,t,n)=>{switch(e.backing._tag){case"IArray":{oh(e.backing.array,0,t,n,e.length);break}case"IConcat":{Kr(e.left,t,n),Kr(e.right,t,n+e.left.length);break}case"ISingleton":{t[n]=e.backing.a;break}}},_c=e=>typeof e=="object"&&e!=null&&"_id"in e&&e._id===yc,bt=new V({_tag:"IEmpty"}),it=()=>bt,$e=e=>_c(e)?e:new V({_tag:"IArray",array:Array.from(e)}),J=e=>e.toReadonlyArray(),bc=l(2,(e,t)=>e.get(t)),z=e=>new V({_tag:"IArray",array:e}),$s=l(2,(e,t)=>e.unsafeGet(t)),ih=l(2,(e,t)=>e.append(t)),mt=l(2,(e,t)=>e.prepend(t)),Is=l(2,(e,t)=>t<=0?bt:t>=e.length?e:z(Jf(t)(e.toReadonlyArray()))),Ts=l(2,(e,t)=>t<=0?e:t>=e.length?bt:z(Yf(t)(e.toReadonlyArray()))),U=l(2,(e,t)=>e.concat(t)),Sc=e=>{const t=[];let n=v();for(const r of e)(W(n)||!S(r,n.value))&&(t.push(r),n=I(r));return z(t)},fe=bc(0),sr=e=>e.isEmpty(),Jt=e=>e.isNonEmpty(),or=l(3,(e,t,n)=>c(J(e),sh(t,n))),Ie=l(2,(e,t)=>or(e,"",(n,r)=>n.length>0?`${n}${t}${r}`:r)),ch=e=>bc(e,e.length-1),ah=(...e)=>z(e),K=e=>new V({_tag:"ISingleton",a:e}),uh=l(2,(e,t)=>ah(...Wf(e,t))),he=l(2,(e,t)=>e.map(t)),lh=l(2,(e,t)=>e.backing._tag==="ISingleton"?K(t(e.backing.a,0)):z(c(J(e),pc(t)))),fh=(e,t)=>e<=t?uh(t-e+1,n=>e+n):K(e),Ms=e=>z(Qf(J(e))),qr=l(2,(e,t)=>c(J(e),Xf(t),z)),hh=l(2,(e,t)=>[Is(t)(e),Ts(t)(e)]),dh=l(2,(e,t)=>{let n=0;for(const r of J(e)){if(t(r))break;n++}return hh(n)(e)}),No=(e,t)=>{const n=[];let r=!0,s=e;for(;r;){const o=t(s);D(o)?(s=o.value[1],n.push(o.value[0])):r=!1}return z(n)},gh=e=>z(eh(Hl())(J(e))),xn=e=>$s(0)(e),He=e=>$s(e.length-1)(e),Lo=l(2,(e,t)=>ph(e,t,(n,r)=>[n,r])),ph=l(3,(e,t,n)=>{const r=J(e),s=J(t);return c(r,Zf(s,n),z)}),ye=xn,Ct=e=>Ts(e,1),Ur=Symbol.for("@effect/data/Global/globalStoreId");Ur in globalThis||(globalThis[Ur]=new Map);const Or=globalThis[Ur],mh=(e,t)=>(Or.has(e)||Or.set(e,t()),Or.get(e)),yh=Symbol.for("@effect/data/Context/Tag");class _h{constructor(t){if(this._id=yh,this._S=n=>n,typeof t<"u")return mh(t,()=>this)}}const vc=Symbol.for("@effect/data/Context");class _e{[O](t){if(bh(t)&&this.unsafeMap.size===t.unsafeMap.size){for(const n of this.unsafeMap.keys())if(!t.unsafeMap.has(n)||!S(this.unsafeMap.get(n),t.unsafeMap.get(n)))return!1;return!0}return!1}[M](){return vs(this.unsafeMap.size)}constructor(t){this.unsafeMap=t,this._id=vc,this._S=n=>n}}const bh=e=>typeof e=="object"&&e!==null&&"_id"in e&&e._id===vc,Sh=()=>new _e(new Map),vh=(e,t)=>new _e(new Map([[e,t]])),Eh=l(3,(e,t,n)=>{const r=new Map(e.unsafeMap);return r.set(t,n),new _e(r)}),wh=l(2,(e,t)=>{if(!e.unsafeMap.has(t))throw new Error("Service not found");return e.unsafeMap.get(t)}),kh=l(2,(e,t)=>{if(!e.unsafeMap.has(t))throw new Error("Service not found");return e.unsafeMap.get(t)}),$h=l(2,(e,t)=>{const n=new Map(e.unsafeMap);for(const[r,s]of t.unsafeMap)n.set(r,s);return new _e(n)}),Mt=e=>new _h(e),Os=Sh,As=vh,In=Eh,Ih=wh,Th=kh,Cs=$h,sn=Symbol.for("@effect/data/Differ/ContextPatch");function vt(e){return e}let Mh=class{constructor(){this._tag="Empty",this._Input=vt,this._Output=vt,this._id=sn}[M](){return G("ContextPatch(Empty)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id}},Oh=class{constructor(t,n){this.first=t,this.second=n,this._tag="AndThen",this._id=sn,this._Input=vt,this._Output=vt}[M](){return G("ContextPatch(AndThen)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&S(this.first,t.first)&&S(this.second,t.second)}};class Ah{constructor(t,n){this.tag=t,this.service=n,this._tag="AddService",this._id=sn,this._Input=vt,this._Output=vt}[M](){return G("ContextPatch(AddService)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&S(this.tag,t.tag)&&S(this.service,t.service)}}class Ch{constructor(t){this.tag=t,this._tag="RemoveService",this._id=sn,this._Input=vt,this._Output=vt}[M](){return G("ContextPatch(RemoveService)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&S(this.tag,t.tag)}}class Rh{constructor(t,n){this.tag=t,this.update=n,this._tag="UpdateService",this._id=sn,this._Input=vt,this._Output=vt}[M](){return G("ContextPatch(AndThen)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&S(this.tag,t.tag)&&S(this.update,t.update)}}const Ec=()=>new Mh,Fh=(e,t)=>{const n=new Map(e.unsafeMap);let r=Ec();for(const[s,o]of t.unsafeMap.entries())if(n.has(s)){const i=n.get(s);n.delete(s),S(i,o)||(r=Tn(new Rh(s,()=>o))(r))}else n.delete(s),r=Tn(new Ah(s,o))(r);for(const[s]of n.entries())r=Tn(new Ch(s))(r);return r},Tn=l(2,(e,t)=>new Oh(e,t)),Ph=l(2,(e,t)=>{let n=!1,r=K(e);const s=new Map(t.unsafeMap);for(;Jt(r);){const i=ye(r),a=Ct(r);switch(i._tag){case"Empty":{r=a;break}case"AddService":{s.set(i.tag,i.service),r=a;break}case"AndThen":{r=mt(mt(a,i.second),i.first);break}case"RemoveService":{s.delete(i.tag),r=a;break}case"UpdateService":{s.set(i.tag,i.update(s.get(i.tag))),n=!0,r=a;break}}}if(!n)return new _e(s);const o=new Map;for(const[i]of t.unsafeMap)s.has(i)&&(o.set(i,s.get(i)),s.delete(i));for(const[i,a]of s)o.set(i,a);return new _e(o)}),wc=Ec,Nh=Fh,Lh=Tn,xh=Ph,Yt=5,Rs=Math.pow(2,Yt),jh=Rs-1,Dh=Rs/2,Kh=Rs/4;function qh(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function be(e,t){return t>>>e&jh}function le(e){return 1<<e}function kc(e,t){return qh(e&t-1)}function de(e,t,n,r){let s=r;if(!e){const o=r.length;s=new Array(o);for(let i=0;i<o;++i)s[i]=r[i]}return s[t]=n,s}function $c(e,t,n){const r=n.length-1;let s=0,o=0,i=n;if(e)s=o=t;else for(i=new Array(r);s<t;)i[o++]=n[s++];for(++s;s<=r;)i[o++]=n[s++];return e&&(i.length=r),i}function Uh(e,t,n,r){const s=r.length;if(e){let u=s;for(;u>=t;)r[u--]=r[u];return r[t]=n,r}let o=0,i=0;const a=new Array(s+1);for(;o<t;)a[i++]=r[o++];for(a[t]=n;o<s;)a[++i]=r[o++];return a}class Wh{constructor(t,n){this.value=t,this.previous=n}}class $t{constructor(){this._tag="EmptyNode"}modify(t,n,r,s,o,i){const a=r(v());return W(a)?new $t:(++i.value,new Gt(t,s,o,a))}}function St(e){return e instanceof $t}function zh(e){return St(e)||e._tag==="LeafNode"||e._tag==="CollisionNode"}function ir(e,t){return St(e)?!1:t===e.edit}class Gt{constructor(t,n,r,s){this.edit=t,this.hash=n,this.key=r,this.value=s,this._tag="LeafNode"}modify(t,n,r,s,o,i){if(S(o,this.key)){const u=r(this.value);return u===this.value?this:W(u)?(--i.value,new $t):ir(this,t)?(this.value=u,this):new Gt(t,s,o,u)}const a=r(v());return W(a)?this:(++i.value,Ic(t,n,this.hash,this,s,new Gt(t,s,o,a)))}}class Fs{constructor(t,n,r){this.edit=t,this.hash=n,this.children=r,this._tag="CollisionNode"}modify(t,n,r,s,o,i){if(s===this.hash){const u=ir(this,t),f=this.updateCollisionList(u,t,this.hash,this.children,r,o,i);return f===this.children?this:f.length>1?new Fs(t,this.hash,f):f[0]}const a=r(v());return W(a)?this:(++i.value,Ic(t,n,this.hash,this,s,new Gt(t,s,o,a)))}updateCollisionList(t,n,r,s,o,i,a){const u=s.length;for(let h=0;h<u;++h){const d=s[h];if("key"in d&&S(i,d.key)){const g=d.value,y=o(g);return y===g?s:W(y)?(--a.value,$c(t,h,s)):de(t,h,new Gt(n,r,i,y),s)}}const f=o(v());return W(f)?s:(++a.value,de(t,u,new Gt(n,r,i,f),s))}}class Se{constructor(t,n,r){this.edit=t,this.mask=n,this.children=r,this._tag="IndexedNode"}modify(t,n,r,s,o,i){const a=this.mask,u=this.children,f=be(n,s),h=le(f),d=kc(a,h),g=a&h,y=ir(this,t);if(!g){const yt=new $t().modify(t,n+Yt,r,s,o,i);return yt?u.length>=Dh?Hh(t,f,yt,a,u):new Se(t,a|h,Uh(y,d,yt,u)):this}const E=u[d],N=E.modify(t,n+Yt,r,s,o,i);if(E===N)return this;let x=a,st;if(St(N)){if(x&=~h,!x)return new $t;if(u.length<=2&&zh(u[d^1]))return u[d^1];st=$c(y,d,u)}else st=de(y,d,N,u);return y?(this.mask=x,this.children=st,this):new Se(t,x,st)}}class Ps{constructor(t,n,r){this.edit=t,this.size=n,this.children=r,this._tag="ArrayNode"}modify(t,n,r,s,o,i){let a=this.size;const u=this.children,f=be(n,s),h=u[f],d=(h||new $t).modify(t,n+Yt,r,s,o,i);if(h===d)return this;const g=ir(this,t);let y;if(St(h)&&!St(d))++a,y=de(g,f,d,u);else if(!St(h)&&St(d)){if(--a,a<=Kh)return Gh(t,a,f,u);y=de(g,f,new $t,u)}else y=de(g,f,d,u);return g?(this.size=a,this.children=y,this):new Ps(t,a,y)}}function Gh(e,t,n,r){const s=new Array(t-1);let o=0,i=0;for(let a=0,u=r.length;a<u;++a)if(a!==n){const f=r[a];f&&!St(f)&&(s[o++]=f,i|=1<<a)}return new Se(e,i,s)}function Hh(e,t,n,r,s){const o=[];let i=r,a=0;for(let u=0;i;++u)i&1&&(o[u]=s[a++]),i>>>=1;return o[t]=n,new Ps(e,a+1,o)}function Bh(e,t,n,r,s,o){if(n===s)return new Fs(e,n,[o,r]);const i=be(t,n),a=be(t,s);if(i===a)return u=>new Se(e,le(i)|le(a),[u]);{const u=i<a?[r,o]:[o,r];return new Se(e,le(i)|le(a),u)}}function Ic(e,t,n,r,s,o){let i,a=t;for(;;){const u=Bh(e,a,n,r,s,o);if(typeof u=="function")i=new Wh(u,i),a=a+Yt;else{let f=u;for(;i!=null;)f=i.value(f),i=i.previous;return f}}}const Tc=Symbol.for("@effect/data/HashMap");class Ns{constructor(t,n,r,s){this._editable=t,this._edit=n,this._root=r,this._size=s,this._id=Tc}[Symbol.iterator](){return new cr(this,(t,n)=>[t,n])}[M](){let t=_("HashMap");for(const n of this)t^=A(_(n[0]))(_(n[1]));return t}[O](t){if(Jh(t)){if(t._size!==this._size)return!1;for(const n of this){const r=c(t,Ac(n[0],_(n[0])));if(W(r))return!1;if(!S(n[1],r.value))return!1}return!0}return!1}toString(){return`HashMap(${Array.from(this).map(([t,n])=>`[${String(t)}, ${String(n)}]`).join(", ")})`}toJSON(){return{_tag:"HashMap",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}}class cr{constructor(t,n){this.map=t,this.f=n,this.v=Mc(this.map._root,this.f,void 0)}next(){if(W(this.v))return{done:!0,value:void 0};const t=this.v.value;return this.v=jn(t.cont),{done:!1,value:t.value}}[Symbol.iterator](){return new cr(this.map,this.f)}}const jn=e=>e?Oc(e[0],e[1],e[2],e[3],e[4]):v(),Mc=(e,t,n=void 0)=>{switch(e._tag){case"LeafNode":return D(e.value)?I({value:t(e.key,e.value.value),cont:n}):jn(n);case"CollisionNode":case"ArrayNode":case"IndexedNode":{const r=e.children;return Oc(r.length,r,0,t,n)}default:return jn(n)}},Oc=(e,t,n,r,s)=>{for(;n<e;){const o=t[n++];if(o&&!St(o))return Mc(o,r,[e,t,n,r,s])}return jn(s)},Ls=()=>new Ns(!1,0,new $t,0),Vh=e=>{const t=Cc(Ls());for(const n of e)Wr(n[0],n[1])(t);return Zh(t)},Jh=e=>typeof e=="object"&&e!=null&&"_id"in e&&e._id===Tc,Ac=l(3,(e,t,n)=>{let r=e._root,s=0;for(;;)switch(r._tag){case"LeafNode":return S(t,r.key)?r.value:v();case"CollisionNode":{if(n===r.hash){const o=r.children;for(let i=0,a=o.length;i<a;++i){const u=o[i];if("key"in u&&S(t,u.key))return u.value}}return v()}case"IndexedNode":{const o=be(s,n),i=le(o);if(r.mask&i){r=r.children[kc(r.mask,i)],s+=Yt;break}return v()}case"ArrayNode":{if(r=r.children[be(s,n)],r){s+=Yt;break}return v()}default:return v()}}),Yh=l(2,(e,t)=>D(Ac(e,t,_(t)))),Wr=l(3,(e,t,n)=>Rc(e,t,()=>I(n))),Qh=l(3,(e,t,n)=>e._editable?(e._root=t,e._size=n,e):t===e._root?e:new Ns(e._editable,e._edit,t,n)),Xh=e=>new cr(e,t=>t),Dn=e=>e._size,Cc=e=>new Ns(!0,e._edit+1,e._root,e._size),Zh=e=>(e._editable=!1,e),Rc=l(3,(e,t,n)=>td(e,t,_(t),n)),td=l(4,(e,t,n,r)=>{const s={value:e._size},o=e._root.modify(e._editable?e._edit:NaN,0,r,n,t,s);return c(e,Qh(o,s.value))}),xo=l(2,(e,t)=>Rc(e,t,v)),ed=l(2,(e,t)=>Fc(e,void 0,(n,r,s)=>t(r,s))),Fc=l(3,(e,t,n)=>{const r=e._root;if(r._tag==="LeafNode")return D(r.value)?n(t,r.value.value,r.key):t;if(r._tag==="EmptyNode")return t;const s=[r.children];let o;for(;o=s.pop();)for(let i=0,a=o.length;i<a;){const u=o[i++];u&&!St(u)&&(u._tag==="LeafNode"?D(u.value)&&(t=n(t,u.value.value,u.key)):s.push(u.children))}return t}),Pc=Symbol.for("@effect/data/HashSet");class ar{constructor(t){this._keyMap=t,this._id=Pc}[Symbol.iterator](){return Xh(this._keyMap)}[M](){return A(_(this._keyMap))(_("HashSet"))}[O](t){return nd(t)?Dn(this._keyMap)===Dn(t._keyMap)&&S(this._keyMap,t._keyMap):!1}toString(){return`HashSet(${Array.from(this).map(String).join(", ")})`}toJSON(){return{_tag:"HashSet",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}}const nd=e=>typeof e=="object"&&e!=null&&"_id"in e&&e._id===Pc,ur=()=>new ar(Ls()),rd=e=>{const t=xs(ur());for(const n of e)Be(t,n);return js(t)},sd=(...e)=>{const t=xs(ur());for(const n of e)Be(t,n);return js(t)},od=l(2,(e,t)=>Yh(e._keyMap,t)),id=e=>Dn(e._keyMap),xs=e=>new ar(Cc(e._keyMap)),js=e=>(e._keyMap._editable=!1,e),Nc=l(2,(e,t)=>{const n=xs(e);return t(n),js(n)}),Be=l(2,(e,t)=>e._keyMap._editable?(Wr(t,!0)(e._keyMap),e):new ar(Wr(t,!0)(e._keyMap))),Lc=l(2,(e,t)=>e._keyMap._editable?(xo(t)(e._keyMap),e):new ar(xo(t)(e._keyMap))),cd=l(2,(e,t)=>Nc(e,n=>{for(const r of t)Lc(n,r)})),ad=l(2,(e,t)=>Nc(ur(),n=>{xc(e,r=>Be(n,r));for(const r of t)Be(n,r)})),xc=l(2,(e,t)=>ed(e._keyMap,(n,r)=>t(r))),ud=l(3,(e,t,n)=>Fc(e._keyMap,t,(r,s,o)=>n(r,o))),jc=Ls,Dc=Vh,ld=Dn,Et=ur,Kc=rd,Ds=sd,fd=od,qc=id,Ot=Be,Uc=Lc,jo=cd,ve=ad,hd=xc,Kn=ud,lr=Symbol.for("@effect/data/Differ/HashSetPatch");function fr(e){return e}class dd{constructor(){this._tag="Empty",this._Value=fr,this._id=lr}[M](){return G("HashSetPatch(Empty)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id}}class gd{constructor(t,n){this.first=t,this.second=n,this._tag="AndThen",this._Value=fr,this._id=lr}[M](){return G("HashSetPatch(AndThen)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&S(this.first,t.first)&&S(this.second,t.second)}}class pd{constructor(t){this.value=t,this._tag="Add",this._Value=fr,this._id=lr}[M](){return G("HashSetPatch(Add)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&S(this.value,t.value)}}class md{constructor(t){this.value=t,this._tag="Remove",this._Value=fr,this._id=lr}[M](){return G("HashSetPatch(Remove)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&S(this.value,t.value)}}const Wc=()=>new dd,yd=(e,t)=>{const[n,r]=Kn([e,Wc()],([s,o],i)=>fd(i)(s)?[Uc(i)(s),o]:[s,zr(new pd(i))(o)])(t);return Kn(r,(s,o)=>zr(new md(o))(s))(n)},zr=l(2,(e,t)=>new gd(e,t)),_d=l(2,(e,t)=>{let n=t,r=K(e);for(;Jt(r);){const s=ye(r),o=Ct(r);switch(s._tag){case"Empty":{r=o;break}case"AndThen":{r=mt(s.first)(mt(s.second)(o));break}case"Add":{n=Ot(s.value)(n),r=o;break}case"Remove":n=Uc(s.value)(n),r=o}}return n}),zc=Wc,bd=yd,Sd=zr,vd=_d,Ed=Symbol.for("@effect/data/Differ");class wd{constructor(t){this._id=Ed,this._P=B,this._V=B,this.empty=t.empty,this.diff=t.diff,this.combine=t.combine,this.patch=t.patch}}const hr=e=>new wd(e),kd=()=>hr({empty:wc(),combine:(e,t)=>Lh(t)(e),diff:(e,t)=>Nh(e,t),patch:(e,t)=>xh(t)(e)}),$d=()=>hr({empty:zc(),combine:(e,t)=>Sd(t)(e),diff:(e,t)=>bd(e,t),patch:(e,t)=>vd(t)(e)}),Id=()=>Td((e,t)=>t),Td=e=>hr({empty:B,combine:(t,n)=>t===B?n:n===B?t:r=>n(t(r)),diff:(t,n)=>S(t,n)?B:rn(n),patch:(t,n)=>e(n,t(n))}),Md=l(3,(e,t,n)=>e.diff(t,n)),Od=l(3,(e,t,n)=>e.combine(t,n)),Ad=l(3,(e,t,n)=>e.patch(t,n)),Gc=hr,Cd=kd,Rd=$d,Fd=Id,Pd=Symbol.for("@effect/data/MutableRef");class Nd{constructor(t){this.current=t,this._T=n=>n,this._id=Pd}get(){return this.current}set(t){return this.current=t,this}setAndGet(t){return this.current=t,this.current}getAndSet(t){const n=this.current;return this.current=t,n}compareAndSet(t,n){return S(t,this.current)?(this.current=n,!0):!1}pipe(t){return t(this)}update(t){return this.set(t(this.get()))}updateAndGet(t){return this.setAndGet(t(this.get()))}getAndUpdate(t){return this.getAndSet(t(this.get()))}toString(){return`MutableRef(${String(this.current)})`}toJSON(){return{_tag:"MutableRef",current:this.current}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}}const on=e=>new Nd(e),te=e=>e.current,Ld=e=>e.getAndUpdate(t=>t+1),ee=l(2,(e,t)=>e.set(t)),xd=["All","Fatal","Error","Warning","Info","Debug","Trace","None"],Te=e=>function(){if(Ht.tracingEnabled)return e.apply(this,arguments);Ht.tracingEnabled=!0;try{return e.apply(this,arguments)}finally{Ht.tracingEnabled=!1}},Me=e=>function(){if(!Ht.tracingEnabled)return e.apply(this,arguments);Ht.tracingEnabled=!1;try{return e.apply(this,arguments)}finally{Ht.tracingEnabled=!0}},_t=typeof process<"u"?process.env:void 0,Ht={minumumLogLevel:_t&&_t.EFFECT_LOG_LEVEL&&xd.includes(_t.EFFECT_LOG_LEVEL)?_t.EFFECT_LOG_LEVEL:"Info",traceStackLimit:_t&&_t.EFFECT_TRACING_STACK_LIMIT?Number.parseInt(_t.EFFECT_TRACING_STACK_LIMIT):5,tracingEnabled:!(_t&&_t.EFFECT_TRACING_ENABLED&&_t.EFFECT_TRACING_ENABLED==="false"),parseStack:e=>{const t=e.stack;if(t){const n=t.split(`
`);let r=0;for(let o=0;o<n.length;o++)n[o].startsWith("Error")&&(r=o);const s=[];for(let o=r+1;o<n.length;o++)if(n[o].includes("at")){const i=n[o].split(" ").filter(h=>h.length>0&&h!=="at"),a=i.length===2&&!i[0].includes("<anonymous>")?i[0]:void 0,f=(i.length===2?i[1]:i[0])?.match(/\(?(.*):(\d+):(\d+)/);f?s.push({name:a,fileName:f[1],line:Number.parseInt(f[2]),column:Number.parseInt(f[3])}):s.push(void 0)}else s.push(void 0);return s}return[]},filterStackFrame:e=>e!=null&&!e.fileName.match(/\/internal_effect_untraced/)},F=Ht,jd=Object.setPrototypeOf({toFrame(){if("parsed"in this)return this.parsed;const e=F.parseStack(this);return e&&e.length>=2&&e[0]&&e[1]?this.parsed={...e[this.depth-1],name:e[this.depth-2]?.name}:this.parsed=void 0,this.parsed}},Error.prototype),Ks=e=>(e.depth=Error.stackTraceLimit,Object.setPrototypeOf(e,jd),e),j=e=>{if(!F.tracingEnabled)return e(void 0,Me);F.tracingEnabled=!1;try{const t=Error.stackTraceLimit;Error.stackTraceLimit=3;const n=Ks(new Error);return Error.stackTraceLimit=t,e(n,Te)}finally{F.tracingEnabled=!0}},p=e=>function(){if(!F.tracingEnabled)return e(void 0,Me).apply(this,arguments);F.tracingEnabled=!1;try{const t=Error.stackTraceLimit;Error.stackTraceLimit=2;const n=Ks(new Error);return Error.stackTraceLimit=t,e(n,Te).apply(this,arguments)}finally{F.tracingEnabled=!0}},b=(e,t)=>{const n=typeof e=="number"?r=>r.length===e:e;return function(){if(!F.tracingEnabled){const r=t(void 0,Me);return n(arguments)?H(()=>r.apply(this,arguments)):s=>H(()=>r(s,...arguments))}F.tracingEnabled=!1;try{const r=Error.stackTraceLimit;Error.stackTraceLimit=2;const s=Ks(new Error);Error.stackTraceLimit=r;const o=t(s,Te);return n(arguments)?H(()=>o.apply(this,arguments)):i=>H(()=>o(i,...arguments))}finally{F.tracingEnabled=!0}}},H=e=>{if(!F.tracingEnabled)return e(Me);F.tracingEnabled=!1;try{return e(Te)}finally{F.tracingEnabled=!0}},Dd=(e,t)=>function(){if(!F.tracingEnabled){const n=t(Me);return arguments.length===e?H(()=>n.apply(this,arguments)):r=>H(()=>n(r,...arguments))}F.tracingEnabled=!1;try{const n=t(Te);return arguments.length===e?H(()=>n.apply(this,arguments)):r=>H(()=>n(r,...arguments))}finally{F.tracingEnabled=!0}},dr=e=>function(){if(!F.tracingEnabled)return H(()=>e(Me).apply(this,arguments));F.tracingEnabled=!1;try{return H(()=>e(Te).apply(this,arguments))}finally{F.tracingEnabled=!0}};var Do,Ko;const qs="@effect/io/Fiber/Id",Ve=Symbol.for(qs),Gr="None",Hr="Runtime",Kd="Composite";let qd=class{constructor(){this[Do]=Ve,this._tag=Gr}[(Do=Ve,M)](){return c(_(qs),A(_(this._tag)))}[O](t){return Hc(t)&&t._tag===Gr}};class Ud{constructor(t,n){this.id=t,this.startTimeMillis=n,this[Ko]=Ve,this._tag=Hr}[(Ko=Ve,M)](){return c(_(qs),A(_(this._tag)),A(_(this.id)),A(_(this.startTimeMillis)))}[O](t){return Hc(t)&&t._tag===Hr&&this.id===t.id&&this.startTimeMillis===t.startTimeMillis}}const Wd=new qd,Hc=e=>typeof e=="object"&&e!=null&&Ve in e,qn=e=>{switch(e._tag){case Gr:return Et();case Hr:return Ds(e.id);case Kd:return c(qn(e.left),ve(qn(e.right)))}},qo=on(0),zd=e=>Array.from(qn(e)).map(n=>`#${n}`).join(","),Gd=()=>{const e=te(qo);return c(qo,ee(e+1)),new Ud(e,new Date().getTime())},Ft=Wd,Hd=qn,Bc=Gd,Je=255,Vc=8,Br=e=>e&Je,Vr=e=>e>>Vc&Je,cn=(e,t)=>(e&Je)+((t&e&Je)<<Vc),Jc=cn(0,0),Bd=e=>cn(e,e),Vd=e=>cn(e,0),Jd=l(2,(e,t)=>cn(Br(e)&~t,Vr(e))),Yd=l(2,(e,t)=>e|t),Qd=e=>~e>>>0&Je,Xd=0,Oe=1<<0,Zd=1<<1,tg=1<<2,Jr=1<<4,Yc=1<<5,eg=e=>an(e,Yc),ng=l(2,(e,t)=>e|t),qt=e=>Qc(e)&&!og(e),Qc=e=>an(e,Oe),an=l(2,(e,t)=>(e&t)!==0),Xc=(...e)=>e.reduce((t,n)=>t|n,0),rg=Xc(Xd),sg=e=>an(e,Zd),Ar=e=>an(e,tg),og=e=>an(e,Jr),Yr=l(2,(e,t)=>cn(e^t,t)),Qr=l(2,(e,t)=>e&(Qd(Br(t))|Vr(t))|Br(t)&Vr(t)),ig=()=>Gc({empty:Jc,diff:(e,t)=>Yr(e,t),combine:(e,t)=>Yd(t)(e),patch:(e,t)=>Qr(t,e)}),cg=Jc,ag=Bd,Zc=Vd,Uo=Jd,un="Die",Qt="Empty",ln="Fail",fn="Interrupt",Xt="Annotated",Ee="Parallel",we="Sequential";var ta;const ea="@effect/io/Cause",na=Symbol.for(ea),ug={_E:e=>e},ne={[na]:ug,[M](){return c(_(ea),A(_(yg(this))))},[O](e){return lg(e)&&mg(this,e)}},Ye=(()=>{const e=Object.create(ne);return e._tag=Qt,e})(),ra=e=>{const t=Object.create(ne);return t._tag=ln,t.error=e,t},ge=e=>{const t=Object.create(ne);return t._tag=un,t.defect=e,t},Mn=e=>{const t=Object.create(ne);return t._tag=fn,t.fiberId=e,t},Un=(e,t)=>{const n=Object.create(ne);return n._tag=Xt,n.cause=e,n.annotation=t,n},Rt=(e,t)=>{const n=Object.create(ne);return n._tag=Ee,n.left=e,n.right=t,n},at=(e,t)=>{const n=Object.create(ne);return n._tag=we,n.left=e,n.right=t,n},lg=e=>typeof e=="object"&&e!=null&&na in e,fg=e=>e._tag===Qt,hg=e=>e._tag===Xt,dg=e=>e._tag===Qt?!0:Xe(e,!0,(t,n)=>{switch(n._tag){case Qt:return I(t);case un:case ln:case fn:return I(!1);default:return v()}}),sa=e=>Us(void 0,vg)(e),gg=e=>Ms(Xe(e,it(),(t,n)=>n._tag===un?I(c(t,mt(n.defect))):v())),oa=e=>Xe(e,Et(),(t,n)=>n._tag===fn?I(c(t,Ot(n.fiberId))):v()),ia=e=>Sg(e,t=>t._tag===ln?I(t.error):v()),ca=e=>{const t=ia(e);switch(t._tag){case"None":return ut(e);case"Some":return pt(t.value)}},pg=e=>aa(e,v(),()=>v(),t=>I(ge(t)),()=>v(),(t,n)=>c(t,zt(r=>Un(r,n))),(t,n)=>D(t)&&D(n)?I(at(t.value,n.value)):D(t)&&W(n)?I(t.value):W(t)&&D(n)?I(n.value):v(),(t,n)=>D(t)&&D(n)?I(Rt(t.value,n.value)):D(t)&&W(n)?I(t.value):W(t)&&D(n)?I(n.value):v()),Qe=e=>aa(e,Ye,()=>Ye,t=>ge(t),t=>Mn(t),(t,n)=>fg(t)?t:Un(t,n),(t,n)=>at(t,n),(t,n)=>Rt(t,n)),mg=(e,t)=>{let n=K(e),r=K(t);for(;Jt(n)&&Jt(r);){const[s,o]=c(ye(n),Xe([Et(),it()],([u,f],h)=>{const[d,g]=Xr(h);return I([c(u,ve(d)),c(f,U(g))])})),[i,a]=c(ye(r),Xe([Et(),it()],([u,f],h)=>{const[d,g]=Xr(h);return I([c(u,ve(d)),c(f,U(g))])}));if(!S(s,i))return!1;n=o,r=a}return!0},yg=e=>_g(K(e),it()),_g=(e,t)=>{for(;;){const[n,r]=c(e,or([Et(),it()],([o,i],a)=>{const[u,f]=Xr(a);return[c(o,ve(u)),c(i,U(f))]})),s=qc(n)>0?c(t,mt(n)):t;if(sr(r))return Ms(s);e=r,t=s}throw new Error("BUG: Cause.flattenCauseLoop - please report an issue at https://github.com/Effect-TS/io/issues")},bg=l(2,(e,t)=>{const n=c(e,ia,zt(t));switch(n._tag){case"None":return c(gg(e),fe,ks(()=>{const r=Array.from(oa(e)).flatMap(s=>Array.from(Hd(s)).map(o=>`#${o}`));return wg(r?`Interrupted by fibers: ${r.join(", ")}`:void 0)},B));case"Some":return n.value}}),Sg=l(2,(e,t)=>{const n=[e];for(;n.length>0;){const r=n.pop(),s=t(r);switch(s._tag){case"None":{switch(r._tag){case we:case Ee:{n.push(r.right),n.push(r.left);break}case Xt:{n.push(r.cause);break}}break}case"Some":return s}}return v()}),Xr=e=>{let t=e;const n=[];let r=Et(),s=it();for(;t!==void 0;)switch(t._tag){case Qt:{if(n.length===0)return[r,s];t=n.pop();break}case ln:{if(n.length===0)return[c(r,Ot(t.error)),s];r=c(r,Ot(t.error)),t=n.pop();break}case un:{if(n.length===0)return[c(r,Ot(t.defect)),s];r=c(r,Ot(t.defect)),t=n.pop();break}case fn:{if(n.length===0)return[c(r,Ot(t.fiberId)),s];r=c(r,Ot(t.fiberId)),t=n.pop();break}case Xt:{t=t.cause;break}case we:{switch(t.left._tag){case Qt:{t=t.right;break}case we:{t=at(t.left.left,at(t.left.right,t.right));break}case Ee:{t=Rt(at(t.left.left,t.right),at(t.left.right,t.right));break}case Xt:{t=at(t.left.cause,t.right);break}default:{s=c(s,mt(t.right)),t=t.left;break}}break}case Ee:{n.push(t.right),t=t.left;break}}throw new Error("BUG: Cause.evaluateCauseLoop - please report an issue at https://github.com/Effect-TS/io/issues")},vg={emptyCase:Ao,failCase:Dr,dieCase:Dr,interruptCase:Ao,annotatedCase:(e,t)=>t,sequentialCase:(e,t,n)=>t&&n,parallelCase:(e,t,n)=>t&&n},Wo="SequentialCase",zo="ParallelCase",Go="AnnotatedCase",aa=l(8,(e,t,n,r,s,o,i,a)=>Us(e,void 0,{emptyCase:()=>t,failCase:(u,f)=>n(f),dieCase:(u,f)=>r(f),interruptCase:(u,f)=>s(f),annotatedCase:(u,f,h)=>o(f,h),sequentialCase:(u,f,h)=>i(f,h),parallelCase:(u,f,h)=>a(f,h)})),Xe=l(3,(e,t,n)=>{let r=t,s=e;const o=[];for(;s!==void 0;){const i=n(r,s);switch(r=D(i)?i.value:r,s._tag){case we:{o.push(s.right),s=s.left;break}case Ee:{o.push(s.right),s=s.left;break}case Xt:{s=s.cause;break}default:{s=void 0;break}}s===void 0&&o.length>0&&(s=o.pop())}return r}),Us=l(3,(e,t,n)=>{const r=[e],s=[];for(;r.length>0;){const i=r.pop();switch(i._tag){case Qt:{s.push(ut(n.emptyCase(t)));break}case ln:{s.push(ut(n.failCase(t,i.error)));break}case un:{s.push(ut(n.dieCase(t,i.defect)));break}case fn:{s.push(ut(n.interruptCase(t,i.fiberId)));break}case Xt:{r.push(i.cause),s.push(pt({_tag:Go,annotation:i.annotation}));break}case we:{r.push(i.right),r.push(i.left),s.push(pt({_tag:Wo}));break}case Ee:{r.push(i.right),r.push(i.left),s.push(pt({_tag:zo}));break}}}const o=[];for(;s.length>0;){const i=s.pop();switch(i._tag){case"Left":{switch(i.left._tag){case Wo:{const a=o.pop(),u=o.pop(),f=n.sequentialCase(t,a,u);o.push(f);break}case zo:{const a=o.pop(),u=o.pop(),f=n.parallelCase(t,a,u);o.push(f);break}case Go:{const a=o.pop(),u=n.annotatedCase(t,a,i.left.annotation);o.push(u);break}}break}case"Right":{o.push(i.right);break}}}if(o.length===0)throw new Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/io/issues");return o.pop()}),Eg=(e,t)=>{const n={value:t,enumerable:!0},r={...e,toString(){return`${this._tag}: ${this.message}`}};return s=>Object.create(r,{_tag:n,message:{value:s,enumerable:!0}})},Zr=Symbol.for("@effect/io/Cause/errors/InterruptedException"),wg=Eg({[Zr]:Zr},"InterruptedException"),kg=e=>typeof e=="object"&&e!=null&&Zr in e,Ws=Symbol.for("@effect/io/Cause/StackAnnotation");class ts{constructor(t,n){this.stack=t,this.seq=n,this[ta]=Ws}}ta=Ws;const $g=on(0),ua=e=>typeof e=="object"&&e!=null&&Ws in e,hn="Pending",zs="Done",Ig="@effect/io/Deferred",Tg=Symbol.for(Ig),Mg={_E:e=>e,_A:e=>e},Gs=e=>({_tag:hn,joiners:e}),la=e=>({_tag:zs,effect:e}),On="Async",Og="Commit",Q="Failure",Cr="OnFailure",Wn="OnSuccess",zn="OnSuccessAndFailure",An="OpTraced",X="Success",fa="Sync",dn="UpdateRuntimeFlags",Gn="While",ha="WithRuntime",Cn="Yield",Hs="RevertFlags";class Ag{constructor(){this.running=!1,this.tasks=[]}get preferredExecution(){return"Async"}starveInternal(t){const n=this.tasks;this.tasks=[];for(let r=0;r<n.length;r++)n[r]();this.tasks.length===0?this.running=!1:this.starve(t)}starve(t=0){t>=2048?setTimeout(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(t+1))}scheduleTask(t){this.tasks.push(t),this.running||(this.running=!0,this.starve())}}const Cg=new Ag,Rg="@effect/io/Effect/Error",Fg=Symbol.for(Rg),Pg=e=>typeof e=="object"&&e!=null&&Fg in e,da=Symbol.for("@effect/io/Effect");class Ng{constructor(t){this.patch=t,this._tag=Hs}}const Lg={_R:e=>e,_E:e=>e,_A:e=>e},Z={[da]:Lg,[O](e){return this===e},[M](){return sc(this)},traced(e){if(e){const t=Object.create(Z);return t._tag=An,t.self=this,t.trace=e,t}return this}},Ho=e=>typeof e=="object"&&e!=null&&da in e,Bs=b(3,(e,t)=>(n,r,s)=>re(o=>c(n,m(i=>c(C(()=>o(t(r)(i))),We,m(a=>c(C(()=>t(s)(i,a)),ct(u=>{switch(a._tag){case Q:return q(Rt(a.cause,u));case X:return q(u)}},()=>a))))))).traced(e)),lt=b(2,e=>(t,n)=>c(t,m(()=>T(n))).traced(e)),It=p(e=>t=>c(t,lt(void 0)).traced(e)),ga=p(e=>(t,n=Ft)=>{const r=Object.create(Z);return r._tag=On,r.register=t,r.blockingOn=n,r.trace=void 0,e?r.traced(e):r}),Vs=p((e,t)=>(n,r=Ft)=>C(()=>{let s=L();return c(ga(o=>{const i=t(n)(o);qe(i)?o(i.right):s=i.left},r),Sa(()=>s))}).traced(e)),xg=p((e,t)=>(n,r=Ft)=>C(()=>{let s=L();return c(ga(o=>{s=t(n)(o)},r),Sa(()=>s))}).traced(e)),Bo=b(2,(e,t)=>(n,r)=>c(n,Js(t(r),T)).traced(e)),jg=p(e=>t=>q(ge(t)).traced(e)),Vo=p(e=>t=>c(t,Js(n=>T(pt(n)),n=>T(ut(n)))).traced(e)),pa=p(e=>()=>C(()=>yr(pn)).traced(e)),ma=p((e,t)=>n=>c(pa(),m(t(n))).traced(e)),We=p(e=>t=>c(t,qg(q,T)).traced(e)),dt=p(e=>t=>q(ra(t)).traced(e)),Dg=p((e,t)=>n=>Kg(()=>ra(t(n)())).traced(e)),q=p(e=>t=>{const n=Object.create(Z);return n._tag=Q,n.cause=t,n.trace=void 0,e?n.traced(e):n}),Kg=p((e,t)=>n=>c($(t(n)),m(q)).traced(e)),ya=p(e=>()=>Pt(t=>T(t.id())).traced(e)),m=b(2,(e,t)=>(n,r)=>{const s=Object.create(Z);return s._tag=Wn,s.first=n,s.successK=t(r),s.trace=void 0,e?s.traced(e):s}),_a=p(e=>t=>c(t,m(B)).traced(e)),qg=b(3,(e,t)=>(n,r,s)=>c(n,ct(o=>T(t(r)(o)),o=>T(t(s)(o)))).traced(e)),ct=b(3,(e,t)=>(n,r,s)=>{const o=Object.create(Z);return o._tag=zn,o.first=n,o.failK=t(r),o.successK=t(s),o.trace=void 0,e?o.traced(e):o}),Js=b(3,(e,t)=>(n,r,s)=>ct(n,o=>{const i=ca(o);switch(i._tag){case"Left":return t(r)(i.left);case"Right":return t(q)(i.right)}},s).traced(e)),kt=b(2,(e,t)=>(n,r)=>C(()=>{const s=Array.from(n),o=new Array(s.length);let i=0;return c(Ys(()=>i<s.length,()=>t(r)(s[i]),a=>{o[i++]=a}),lt(z(o)))}).traced(e)),gr=b(2,(e,t)=>(n,r)=>C(()=>{const s=Array.from(n);let o=0;return Ys(()=>o<s.length,()=>t(r)(s[o++]),()=>{})}).traced(e)),ba=p(e=>t=>{switch(t._tag){case"None":return dt(v()).traced(e);case"Some":return T(t.value).traced(e)}}),At=p(e=>t=>{switch(t._tag){case"Left":return dt(t.left).traced(e);case"Right":return T(t.right).traced(e)}}),Ug=p(e=>t=>{const n=Object.create(Z);return n._tag=dn,n.update=ag(Oe),n.scope=()=>t,n.trace=void 0,e?n.traced(e):n}),P=b(2,(e,t)=>(n,r)=>c(n,m(s=>$(()=>t(r)(s)))).traced(e)),Ze=b(2,(e,t)=>(n,r)=>ct(n,s=>{const o=ca(s);switch(o._tag){case"Left":return Dg(()=>t(r)(o.left));case"Right":return q(o.right)}},T).traced(e)),Hn=b(2,(e,t)=>(n,r)=>re(s=>ct(s(n),o=>{const i=tt(o);return c(t(r)(i),ct(a=>tt(at(o,a)),()=>i))},o=>{const i=se(o);return c(t(r)(i),ot(i))})).traced(e)),Sa=b(2,(e,t)=>(n,r)=>Hn(n,no(s=>sa(s)?It(t(r)(oa(s))):L(),()=>L())).traced(e)),Wg=b(2,(e,t)=>(n,r)=>c(n,Jg(t(r),T)).traced(e)),zg=p(e=>t=>Gg(t,B).traced(e)),Gg=b(2,(e,t)=>(n,r)=>c(n,Js(s=>jg(t(r)(s)),T)).traced(e)),pr=b(2,e=>(t,n)=>c(t,Zs(pn,n)).traced(e)),Hg=b(2,(e,t)=>(n,r)=>ma(s=>c(n,pr(t(r)(s)))).traced(e)),Bg=p(e=>t=>mr(t,T).traced(e)),Vg=p((e,t)=>(n,r)=>mr(n,s=>$(()=>t(r)(s))).traced(e)),mr=p((e,t)=>(n,r)=>C(()=>c(yr(pn),m(s=>t(r)(c(s,Th(n)))))).traced(e)),T=p(e=>t=>{const n=Object.create(Z);return n._tag=X,n.value=t,n.trace=void 0,e?n.traced(e):n}),C=p((e,t)=>n=>c($(t(n)),m(B)).traced(e)),$=p((e,t)=>n=>{const r=Object.create(Z);return r._tag=fa,r.evaluate=t(n),r.trace=void 0,e?r.traced(e):r}),va=b(2,(e,t)=>(n,r)=>c(n,m(s=>c(t(r)(s),lt(s)))).traced(e)),Ea=p((e,t)=>n=>Pt(r=>{const s=r.getFiberRef(es),o=c(s,wt(()=>r.scope()));return t(n)(Zs(es,I(o)))}).traced(e)),Jg=b(3,(e,t)=>(n,r,s)=>ct(n,o=>{const i=pg(o);switch(i._tag){case"None":return t(r)();case"Some":return q(i.value)}},t(s)).traced(e)),wa=p(e=>t=>{const n=Object.create(Z);return n._tag=dn,n.update=Zc(Oe),n.scope=()=>t,n.trace=void 0,e?n.traced(e):n}),re=p((e,t)=>n=>{const r=Object.create(Z);return r._tag=dn,r.update=Zc(Oe),r.scope=s=>Qc(s)?t(n)(Ug):t(n)(wa),r.trace=void 0,e?r.traced(e):r}),L=p(e=>t=>T(void 0).traced(e)),Yg=p(e=>t=>{const n=Object.create(Z);return n._tag=dn,n.update=t,n.scope=void 0,n.trace=void 0,e?n.traced(e):n}),Qg=b(2,e=>(t,n)=>c(n,m(r=>r?c(t,P(I)):T(v()))).traced(e)),Ys=p((e,t)=>(n,r,s)=>{const o=Object.create(Z);return o._tag=Gn,o.check=t(n),o.body=t(r),o.process=t(s),o.trace=void 0,e?o.traced(e):o}),Pt=p((e,t)=>n=>{const r=Object.create(Z);return r._tag=ha,r.withRuntime=t(n),r.trace=void 0,e?r.traced(e):r}),Xg=b(2,e=>(t,n)=>C(()=>Zs(eo,I(n))(t)).traced(e)),ka=p(e=>(t="normal")=>{const n=Object.create(Z);return n._tag=Cn,n.priority=t,n.trace=void 0,e?n.traced(e):n}),tn=b(2,e=>(t,n)=>m(t,r=>P(n,s=>[r,s])).traced(e)),Qs=b(2,e=>(t,n)=>m(t,r=>lt(n,r)).traced(e)),ot=b(2,e=>(t,n)=>m(t,()=>n).traced(e)),$a=b(3,(e,t)=>(n,r,s)=>m(n,o=>P(r,i=>t(s)(o,i))).traced(e)),Ia=p(e=>t=>c(ya(),m(n=>c(t,Ta(n)))).traced(e)),Ta=b(2,e=>(t,n)=>c(t.interruptAsFork(n),m(()=>t.await())).traced(e)),Zg={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER},tp={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4},ep={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4},np={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4},Ma={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4},rp={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4},sp={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0},op={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER},ip="@effect/io/FiberRef",cp=Symbol.for(ip),ap={_A:e=>e},yr=p(e=>t=>Oa(t,n=>[n,n]).traced(e)),Xs=b(2,(e,t)=>(n,r)=>m(yr(n),t(r)).traced(e)),Jo=b(2,e=>(t,n)=>Oa(t,()=>[void 0,n]).traced(e)),Oa=b(2,(e,t)=>(n,r)=>Pt(s=>{const[o,i]=t(r)(s.getFiberRef(n));return s.setFiberRef(n,i),T(o)}).traced(e)),Zs=b(3,e=>(t,n,r)=>Bs(Qs(yr(n),Jo(n,r)),()=>t,s=>Jo(n,s)).traced(e)),Nt=(e,t=B,n=(r,s)=>s)=>gn(e,Fd(),t,n),Aa=e=>gn(e,Rd(),zc()),Ca=e=>gn(e,Cd(),wc()),gn=(e,t,n,r=(s,o)=>o)=>({[cp]:ap,initial:e,diff:(s,o)=>c(t,Md(s,o)),combine:(s,o)=>c(t,Od(s,o)),patch:s=>o=>c(t,Ad(s,o)),fork:n,join:r}),up=e=>gn(e,ig(),cg),pn=Ca(Os()),lp=Nt(jc()),fp=Nt(Ma),hp=Nt(it()),to=Nt(Cg),eo=Nt(v()),Rr=Aa(Et()),es=Nt(v(),()=>v(),(e,t)=>e),En=Nt(Ye,()=>Ye,(e,t)=>e),Yo=Symbol.for("@effect/io/Scope"),Qo=Symbol.for("@effect/io/CloseableScope"),ns=p((e,t)=>(n,r)=>n.addFinalizer(t(r)).traced(e)),Bn=p(e=>(t,n)=>t.close(n).traced(e)),Xo=b(2,(e,t)=>(n,r)=>c(n,gp(t(r)),P(ks(()=>()=>L(),s=>o=>dp(s,o)(n)))).traced(e)),dp=b(3,e=>(t,n,r)=>C(()=>{switch(t.state._tag){case"Exited":return L();case"Running":{const s=t.state.finalizers.get(n);return t.state.finalizers.delete(n),s!=null?t.state.update(s)(r):L()}}}).traced(e)),gp=b(2,(e,t)=>(n,r)=>C(()=>{switch(n.state._tag){case"Exited":return n.state.nextKey+=1,c(t(r)(n.state.exit),lt(v()));case"Running":{const s=n.state.nextKey;return n.state.finalizers.set(s,r),n.state.nextKey+=1,T(I(s))}}}).traced(e)),pp=p(e=>()=>$(()=>({state:{_tag:"Running",nextKey:0,finalizers:new Map,update:B}})).traced(e)),mp=e=>e._tag==="Failure",yp=l(2,(e,t)=>{switch(e._tag){case Q:return e;case X:return se(t)}}),Fr=e=>yp(e,void 0),_p=e=>Fa(e,at),rs=e=>Fa(e,Rt),tt=e=>{const t=Object.create(Z);return t._tag=Q,t.cause=e,t.trace=void 0,t},bp=l(2,(e,t)=>{switch(e._tag){case Q:return e;case X:return t(e.value)}}),Sp=e=>c(e,bp(B)),Zo=l(2,(e,t)=>{switch(e._tag){case Q:return e;case X:return se(t(e.value))}}),no=l(3,(e,t,n)=>{switch(e._tag){case Q:return t(e.cause);case X:return n(e.value)}}),vp=l(3,(e,t,n)=>{switch(e._tag){case Q:return t(e.cause);case X:return n(e.value)}}),se=e=>{const t=Object.create(Z);return t._tag=X,t.value=e,t.trace=void 0,t},Ut=()=>se(void 0),Ra=l(4,(e,t,n,r)=>{switch(e._tag){case Q:switch(t._tag){case X:return e;case Q:return tt(r(e.cause,t.cause))}case X:switch(t._tag){case X:return se(n(e.value,t.value));case Q:return t}}}),Fa=(e,t)=>{const n=$e(e);return Jt(n)?c(Ct(n),or(c(ye(n),Zo(K)),(r,s)=>c(r,Ra(s,(o,i)=>c(o,mt(i)),t))),Zo(Ms),I):v()},_r=e=>({[Tg]:Mg,state:on(Gs([])),blockingOn:e}),Ep=p(e=>()=>c(ya(),m(t=>wp(t))).traced(e)),wp=p(e=>t=>$(()=>_r(t)).traced(e)),br=p(e=>t=>Vs(n=>{const r=te(t.state);switch(r._tag){case zs:return ut(r.effect);case hn:return c(t.state,ee(Gs([n,...r.joiners]))),pt(Ip(t,n))}},t.blockingOn).traced(e)),ro=b(2,e=>(t,n)=>$(()=>{const r=te(t.state);switch(r._tag){case zs:return!1;case hn:{c(t.state,ee(la(n)));for(let s=0;s<r.joiners.length;s++)r.joiners[s](n);return!0}}}).traced(e)),Pa=b(2,e=>(t,n)=>ro(t,dt(n)).traced(e)),kp=b(2,e=>(t,n)=>ro(t,q(n)).traced(e)),$p=b(2,e=>(t,n)=>ro(t,T(n)).traced(e)),so=(e,t)=>{const n=te(e.state);if(n._tag===hn){c(e.state,ee(la(t)));for(let r=n.joiners.length-1;r>=0;r--)n.joiners[r](t)}},Ip=(e,t)=>$(()=>{const n=te(e.state);n._tag===hn&&c(e.state,ee(Gs(n.joiners.filter(r=>r!==t))))});var Na;const Tp="@effect/io/Clock",oo=Symbol.for(Tp),La=Mt(oo),Mp=2**31-1,ti={unsafeSchedule(e,t){if(t.millis>Mp)return Dr;let n=!1;const r=setTimeout(()=>{n=!0,e()},t.millis);return()=>(clearTimeout(r),!n)}};class Op{constructor(){this[Na]=oo}unsafeCurrentTimeMillis(){return new Date().getTime()}currentTimeMillis(){return j(t=>$(()=>this.unsafeCurrentTimeMillis()).traced(t))}scheduler(){return j(t=>T(ti).traced(t))}sleep(t){return j(n=>Vs(r=>{const s=ti.unsafeSchedule(()=>r(L()),t);return pt(It($(s)))}).traced(n))}}Na=oo;const Ap=()=>new Op,xa="And",ja="Or",Da="InvalidData",Ka="MissingData",qa="SourceUnavailable",Ua="Unsupported",Cp="@effect/io/Config/Error",ei=Symbol.for(Cp),Ae={[ei]:ei},Wa=(e,t)=>{const n=Object.create(Ae);return n._tag=xa,n.left=e,n.right=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),n},za=(e,t)=>{const n=Object.create(Ae);return n._tag=ja,n.left=e,n.right=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),n},Rp=(e,t)=>{const n=Object.create(Ae);return n._tag=Da,n.path=e,n.message=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`(Invalid data at ${c(this.path,Ie("."))}: "${this.message}")`}}),n},oe=(e,t)=>{const n=Object.create(Ae);return n._tag=Ka,n.path=e,n.message=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`(Missing data at ${c(this.path,Ie("."))}: "${this.message}")`}}),n},Fp=(e,t,n)=>{const r=Object.create(Ae);return r._tag=qa,r.path=e,r.message=t,r.cause=n,Object.defineProperty(r,"toString",{enumerable:!1,value(){return`(Source unavailable at ${c(this.path,Ie("."))}: "${this.message}")`}}),r},Pp=(e,t)=>{const n=Object.create(Ae);return n._tag=Ua,n.path=e,n.message=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`(Unsupported operation at ${c(this.path,Ie("."))}: "${this.message}")`}}),n},Wt=l(2,(e,t)=>{switch(e._tag){case xa:return Wa(Wt(t)(e.left),Wt(t)(e.right));case ja:return za(Wt(t)(e.left),Wt(t)(e.right));case Da:return Rp(c(t,U(e.path)),e.message);case Ka:return oe(c(t,U(e.path)),e.message);case qa:return Fp(c(t,U(e.path)),e.message,e.cause);case Ua:return Pp(c(t,U(e.path)),e.message)}}),Np="Constant",Lp="Fail",xp="Fallback",jp="Described",Dp="Lazy",Kp="MapOrFail",qp="Nested",Up="Primitive",Wp="Sequence",zp="Table",Gp="ZipWith",Hp=e=>t=>oe(it(),`Expected ${t.description} with name ${e}`);var ni,ri;const Ga="@effect/data/List",io=Symbol.for(Ga),Ha={_A:e=>e};class Ba{constructor(t,n){this.head=t,this.tail=n,this._tag="Cons",this[ni]=Ha}toString(){return`List.Cons(${ii(this).map(String).join(", ")})`}toJSON(){return{_tag:"List.Cons",values:ii(this)}}[(ni=io,Symbol.for("nodejs.util.inspect.custom"))](){return this.toJSON()}[O](t){return Va(t)&&this._tag===t._tag&&Yp(this,t,S)}[M](){return G(Ga)}[Symbol.iterator](){let t=!1,n=this;return{next(){if(t)return this.return();if(n._tag==="Nil")return t=!0,this.return();const r=n.head;return n=n.tail,{done:t,value:r}},return(r){return t||(t=!0),{done:!0,value:r}}}}}class Bp{constructor(){this._tag="Nil",this[ri]=Ha}toString(){return"List.Nil"}toJSON(){return{_tag:"List.Nil"}}[(ri=io,Symbol.for("nodejs.util.inspect.custom"))](){return this.toJSON()}[M](){return oc(Array.from(this))}[O](t){return Va(t)&&this._tag===t._tag}[Symbol.iterator](){return{next(){return{done:!0,value:void 0}}}}}const Va=e=>typeof e=="object"&&e!=null&&io in e,Vp=e=>e._tag==="Nil",Jp=e=>e._tag==="Cons",si=e=>{let t=e,n=0;for(;!Vp(t);)n+=1,t=t.tail;return n},Yp=l(3,(e,t,n)=>{if(e===t)return!0;if(si(e)!==si(t))return!1;const r=e[Symbol.iterator](),s=t[Symbol.iterator]();let o,i;for(;!(o=r.next()).done&&!(i=s.next()).done;)if(!n(o.value,i.value))return!1;return!0}),Qp=new Bp,oi=(e,t)=>new Ba(e,t),Xp=e=>new Ba(e,Qp),ii=e=>Array.from(e),Zp={_tag:"Empty"},ci=l(2,(e,t)=>{let n=Xp(t),r=e;for(;Jp(n);){const s=n.head;switch(s._tag){case"Empty":{n=n.tail;break}case"AndThen":{n=oi(s.first,oi(s.second,n.tail));break}case"MapName":{r=he(r,s.f),n=n.tail;break}case"Nested":{r=mt(r,s.name),n=n.tail;break}case"Unnested":{if(c(fe(r),jf(Kf)(s.name)))r=Ct(r),n=n.tail;else return pt(oe(r,`Expected ${s.name} to be in path in ConfigProvider#unnested`));break}}}return ut(r)}),tm="@effect/io/Config/Provider",ss=Symbol.for(tm),em=Mt(ss),nm="@effect/io/Config/Provider/Flat",ai=Symbol.for(nm),rm=dr(e=>(t,n)=>({[ss]:ss,load:p(r=>s=>e(t)(s).traced(r)),flattened:n})),sm=dr(e=>(t,n,r)=>({[ai]:ai,patch:r,load:p(s=>(o,i,a=!0)=>e(t)(o,i,a).traced(s)),enumerateChildren:p(s=>o=>e(n)(o).traced(s))})),om=dr(()=>e=>rm(t=>m(ft(e,it(),t,!1),n=>c(fe(n),ks(()=>dt(oe(it(),`Expected a single value having structure: ${t}`)),T))),e)),im=dr(()=>(e={})=>{const{pathDelim:t,seqDelim:n}=Object.assign({},{pathDelim:"_",seqDelim:","},e),r=u=>c(u,Ie(t)),s=u=>u.split(t),o=()=>typeof process<"u"&&"env"in process&&typeof process.env=="object"?process.env:{};return om(sm((u,f,h=!0)=>{const d=r(u),g=o(),y=d in g?I(g[d]):v();return c(ba(y),Ze(()=>oe(u,`Expected ${d} to exist in the process context`)),m(E=>lm(E,u,f,n,h)))},u=>$(()=>{const f=o(),h=Object.keys(f),g=Array.from(h).map(y=>s(y.toUpperCase())).filter(y=>{for(let E=0;E<u.length;E++){const N=c(u,$s(E)),x=y[E];if(x===void 0||N!==x)return!1}return!0}).flatMap(y=>y.slice(u.length,u.length+1));return Kc(g)}),Zp))}),cm=(e,t,n,r)=>{const s=No(n.length,u=>u>=r.length?v():I([e(u),u+1])),o=No(r.length,u=>u>=n.length?v():I([t(u),u+1])),i=c(n,U(s)),a=c(r,U(o));return[i,a]},ft=(e,t,n,r)=>{const s=n;switch(s._tag){case Np:return T(K(s.value));case jp:return C(()=>ft(e,t,s.config,r));case Lp:return dt(oe(t,s.message));case xp:return c(C(()=>ft(e,t,s.first,r)),Bo(o=>s.condition(o)?c(ft(e,t,s.second,r),Bo(i=>dt(za(o,i)))):dt(o)));case Dp:return C(()=>ft(e,t,s.config(),r));case Kp:return C(()=>c(ft(e,t,s.original,r),m(kt(o=>c(At(s.mapOrFail(o)),Ze(Wt(t)))))));case qp:return C(()=>ft(e,c(t,U(K(s.name))),s.config,r));case Up:return c(At(ci(t,e.patch)),m(o=>c(e.load(o,s,r),m(i=>{if(sr(i)){const a=c(ch(o),wt(()=>"<n/a>"));return dt(Hp(a))}return T(i)}))));case Wp:return C(()=>c(ft(e,t,s.config,!0),P(K)));case zp:return C(()=>c(At(ci(t,e.patch)),m(o=>c(e.enumerateChildren(o),m(i=>c(i,kt(a=>ft(e,c(o,U(K(a))),s.valueConfig,r)),P(a=>{if(a.length===0)return K(jc());const u=J(a).map(J);return c(z(fm(u).map(z)),he(f=>Dc(Lo($e(i),f))))})))))));case Gp:return C(()=>c(ft(e,t,s.left,r),Vo,m(o=>c(ft(e,t,s.right,r),Vo,m(i=>{if(vn(o)&&vn(i))return dt(Wa(o.left,i.left));if(vn(o)&&qe(i))return dt(o.left);if(qe(o)&&vn(i))return dt(i.left);if(qe(o)&&qe(i)){const a=c(t,Ie(".")),u=am(t,a),[f,h]=cm(u,u,c(o.right,he(ut)),c(i.right,he(ut)));return c(f,Lo(h),kt(([d,g])=>c(At(d),tn(At(g)),P(([y,E])=>s.zip(y,E)))))}throw new Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/io/issues")})))))}},am=(e,t)=>n=>pt(oe(e,`The element at index ${n} in a sequence at path "${t}" was missing`)),um=(e,t)=>{const n=e.split(new RegExp(`\\s*${hm(t)}\\s*`));return z(n)},lm=(e,t,n,r,s)=>s?c(um(e,r),kt(o=>At(n.parse(o.trim()))),Ze(Wt(t))):c(At(n.parse(e)),P(K),Ze(Wt(t))),fm=e=>Object.keys(e[0]).map(t=>e.map(n=>n[t])),hm=e=>e.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&");var Ja;const dm="@effect/io/Random",co=Symbol.for(dm),gm=Mt(co);class pm{constructor(t){this.seed=t,this[Ja]=co,this.PRNG=new rc(t)}next(){return j(t=>$(()=>this.PRNG.number()).traced(t))}nextBoolean(){return j(t=>P(this.next(),n=>n>.5).traced(t))}nextInt(){return j(t=>$(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER)).traced(t))}nextRange(t,n){return j(r=>P(this.next(),s=>(n-t)*s+t).traced(r))}nextIntBetween(t,n){return j(r=>$(()=>this.PRNG.integer(1+n-t)+t).traced(r))}shuffle(t){return j(n=>mm(t,r=>this.nextIntBetween(0,r)).traced(n))}}Ja=co;const mm=(e,t)=>C(()=>c($(()=>Array.from(e)),m(n=>{const r=[];for(let s=n.length;s>=2;s=s-1)r.push(s);return c(r,gr(s=>c(t(s),P(o=>ym(n,s-1,o)))),lt($e(n)))}))),ym=(e,t,n)=>{const r=e[t];return e[t]=e[n],e[n]=r,e},_m=e=>new pm(e),bm=c(Os(),In(La,Ap()),In(gm,_m(Math.random()*4294967296>>>0)),In(em,im())),Sm=Ca(bm),vm=p(e=>t=>Em(n=>n.sleep(t)).traced(e)),Em=p((e,t)=>n=>Xs(Sm,r=>t(n)(c(r,Ih(La)))).traced(e)),Ya=Symbol.for("@effect/data/Duration");class Sr{constructor(t){this.millis=t,this._id=Ya}[M](){return _(this.millis)}[O](t){return wm(t)&&this.millis===t.millis}}const wm=e=>typeof e=="object"&&e!=null&&"_id"in e&&e._id===Ya,Qa=new Sr(0),km=new Sr(1/0),ao=e=>new Sr(e),$m={compare:(e,t)=>e.millis<t.millis?-1:e.millis>t.millis?1:0};$m.compare;const Im=l(2,(e,t)=>new Sr(e.millis+t.millis)),Tm=rt(Im),Mm=Tt(Tm,Qa);Mm.combineAll;const Om=vm,Am=Sp;var Xa;function Cm(e){return new mn(e)}const Za=Symbol.for("@effect/io/FiberRefs");class mn{constructor(t){this.locals=t,this[Xa]=Za}}Xa=Za;const Rm=(e,t,n,r=!1)=>{const s=e;let o=t,i=n,a=r,u;for(;u===void 0;)if(Vt(o)&&Vt(i)){const f=Y(o)[0],h=me(o),d=Y(i)[0],g=Y(i)[1],y=me(i);f.startTimeMillis<d.startTimeMillis?(i=y,a=!0):f.startTimeMillis>d.startTimeMillis?o=h:f.id<d.id?(i=y,a=!0):f.id>d.id?o=h:u=[g,a]}else u=[s.initial,!0];return u},Fm=l(3,(e,t,n)=>{const r=new Map(e.locals);for(const[s,o]of n.locals){const i=Y(o)[1];if(!S(Y(o)[0],t)){if(!r.has(s)){if(S(i,s.initial))continue;r.set(s,[[t,s.join(s.initial,i)]]);continue}const a=r.get(s),[u,f]=Rm(s,a,o);if(f){const h=s.diff(u,i),d=Y(a)[1],g=s.join(d,s.patch(h)(d));if(!S(d,g)){let y;const E=Y(a)[0];S(E,t)?y=Bt([E,g])(me(a)):y=Bt([t,g])(a),r.set(s,y)}}}}return new mn(new Map(r))}),tu=l(2,(e,t)=>{const n=new Map;for(const[r,s]of e.locals.entries()){const o=Y(s)[1],i=r.patch(r.fork)(o);S(o,i)?n.set(r,s):n.set(r,Bt([t,i])(s))}return new mn(n)}),eu=l(2,(e,t)=>{const n=new Map(e.locals);return n.delete(t),new mn(n)}),Pm=l(2,(e,t)=>e.locals.has(t)?I(Y(e.locals.get(t))[1]):v()),vr=l(2,(e,t)=>c(Pm(e,t),wt(()=>t.initial))),Vn=l(4,(e,t,n,r)=>{const s=e.locals.has(n)?e.locals.get(n):rh();let o;if(Hf(s))o=gc([t,r]);else{const[a,u]=Y(s);if(S(a,t)){if(S(u,r))return e;o=Bt([t,r])(me(s))}else o=Bt([t,r])(s)}const i=new Map(e.locals);return new mn(i.set(n,o))}),Nm=tu,ui=Vn,Lm=Cm,nu="Empty",ru="Add",su="Remove",ou="Update",iu="AndThen",xm=()=>({_tag:nu}),jm=(e,t)=>{const n=new Map(e.locals);let r=xm();for(const[s,o]of t.locals.entries()){const i=Y(o)[1],a=n.get(s);if(a!==void 0){const u=Y(a)[1];S(u,i)||(r=Pr({_tag:ou,fiberRef:s,patch:s.diff(u,i)})(r))}else r=Pr({_tag:ru,fiberRef:s,value:i})(r);n.delete(s)}for(const[s]of n.entries())r=Pr({_tag:su,fiberRef:s})(r);return r},Pr=l(2,(e,t)=>({_tag:iu,first:e,second:t})),Dm=l(3,(e,t,n)=>{let r=n,s=gc(e);for(;Vt(s);){const o=Y(s),i=me(s);switch(o._tag){case nu:{s=i;break}case ru:{r=Vn(r,t,o.fiberRef,o.value),s=i;break}case su:{r=eu(r,o.fiberRef),s=i;break}case ou:{const a=vr(r,o.fiberRef);r=Vn(r,t,o.fiberRef,o.fiberRef.patch(o.patch)(a)),s=i;break}case iu:{s=Bt(o.first)(Bt(o.second)(i));break}}}return r}),Km=Zg,qm=tp,Um=ep,Wm=np,zm=Ma,Gm=rp,Hm=sp,Bm=op,Vm=c(Ln,vf(e=>e.ordinal)),Jm=Ef(Vm),Ym=e=>{switch(e){case"All":return Km;case"Debug":return Gm;case"Error":return Um;case"Fatal":return qm;case"Info":return zm;case"Trace":return Hm;case"None":return Bm;case"Warning":return Wm}},Qm=e=>t=>`${t.label.replace(/[\s="]/g,"_")}=${e-t.startTime}ms`,Xm=Qm;var cu;const au=Symbol.for("@effect/io/Ref"),uu={_A:e=>e};class Zm{constructor(t){this.ref=t,this[cu]=uu}modify(t){return j((n,r)=>$(()=>{const s=te(this.ref),[o,i]=r(t)(s);return s!==i&&ee(i)(this.ref),o}).traced(n))}}cu=au;const lu=e=>new Zm(on(e)),li=p(e=>t=>$(()=>lu(t)).traced(e)),os=p(e=>t=>t.modify(n=>[n,n]).traced(e)),fu=b(2,e=>(t,n)=>t.modify(()=>[void 0,n]).traced(e)),ty=b(2,(e,t)=>(n,r)=>n.modify(t(r)).traced(e)),fi=b(2,(e,t)=>(n,r)=>n.modify(s=>[void 0,t(r)(s)]).traced(e)),hu=p(e=>t=>kt(t,B).traced(e)),ey=p(e=>t=>gr(t,B).traced(e)),ny=b(2,e=>(t,n)=>ot(Om(n),t).traced(e)),ry=p(e=>t=>c(t,ay(sy(),jm)).traced(e)),sy=p(e=>()=>Pt(t=>T(t.unsafeGetFiberRefs())).traced(e)),du=p((e,t)=>(n,r,s,o)=>C(()=>t(r)(n)?m(t(o)(n),()=>du(t(s)(n),t(r),t(s),t(o))):L()).traced(e)),oy=p(e=>t=>fy((n,r)=>c(t,Dm(n,r))).traced(e)),iy=b(3,e=>(t,n,r)=>cy(t,n,T(r)).traced(e)),cy=b(3,e=>(t,n,r)=>ma(s=>m(r,o=>pr(t,c(s,In(n,o))))).traced(e)),ay=b(3,(e,t)=>(n,r,s)=>m(r,o=>m(n,i=>P(r,a=>[t(s)(o,a),i]))).traced(e)),uy=p(e=>t=>c(kt(Object.entries(t),([n,r])=>P(r,s=>[n,s])),P(n=>{const r={};for(const[s,o]of n)r[s]=o;return r})).traced(e)),ly=p(e=>(...t)=>P(hu(t),J).traced(e)),fy=p((e,t)=>n=>Pt(r=>(r.setFiberRefs(t(n)(r.id(),r.unsafeGetFiberRefs())),L())).traced(e)),hy=Symbol.for("@effect/data/MutableHashMap");class hi{constructor(t,n,r){this.k=t,this.v=n,this.next=r}[Symbol.iterator](){let t=this,n=0;return{next:()=>{if(t){const r=[t.k,t.v];return t=t.next,n++,{value:r,done:!1}}else return{value:n,done:!0}}}}}class dy{constructor(){this._id=hy,this.backingMap=new Map,this.length=0}[Symbol.iterator](){return Array.from(this.backingMap.values()).flatMap(t=>{const n=[[t.k,t.v]];let r=t.next;for(;r;)n.push([r.k,r.v]),r=r.next;return n})[Symbol.iterator]()}toString(){return`MutableHashMap(${Array.from(this).map(([t,n])=>`[${String(t)}, ${String(n)}]`).join(", ")})`}toJSON(){return{_tag:"MutableHashMap",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}}const gy=()=>new dy,Kt=l(2,(e,t)=>{const n=_(t),r=e.backingMap.get(n);if(r===void 0)return v();let s=r;for(;s!==void 0;){if(S(t,s.k))return I(s.v);s=s.next}return v()}),Fe=l(2,(e,t)=>D(Kt(e,t))),Pe=l(3,(e,t,n)=>{const r=_(t),s=e.backingMap.get(r);if(s===void 0)return e.backingMap.set(r,new hi(t,n)),e.length=e.length+1,e;let o=s,i=s;for(;o!==void 0;){if(S(t,o.k))return o.v=n,e;i=o,o=o.next}return e.length=e.length+1,i.next=new hi(t,n),e}),gu="Sequential",py="Parallel",my={_tag:gu},yy=e=>e._tag===gu,_y=e=>e._tag===py,by=my,Sy=yy,vy=_y;var di,gi,pi;const Er="@effect/io/Fiber/Status",Zt=Symbol.for(Er),is="Done",mi="Running",yi="Suspended";class Ey{constructor(){this[di]=Zt,this._tag=is}[(di=Zt,M)](){return c(_(Er),A(_(this._tag)))}[O](t){return uo(t)&&t._tag===is}}class wy{constructor(t){this.runtimeFlags=t,this[gi]=Zt,this._tag=mi}[(gi=Zt,M)](){return c(_(Er),A(_(this._tag)),A(_(this.runtimeFlags)))}[O](t){return uo(t)&&t._tag===mi&&this.runtimeFlags===t.runtimeFlags}}class ky{constructor(t,n){this.runtimeFlags=t,this.blockingOn=n,this[pi]=Zt,this._tag=yi}[(pi=Zt,M)](){return c(_(Er),A(_(this._tag)),A(_(this.runtimeFlags)),A(_(this.blockingOn)))}[O](t){return uo(t)&&t._tag===yi&&this.runtimeFlags===t.runtimeFlags&&S(this.blockingOn,t.blockingOn)}}const $y=new Ey,Iy=e=>new wy(e),Ty=(e,t)=>new ky(e,t),uo=e=>typeof e=="object"&&e!=null&&Zt in e,My=e=>e._tag===is,Oy=$y,pu=Iy,Ay=Ty,Cy=My,lo="InterruptSignal",fo="Stateful",ho="Resume",go="YieldNow",_i=e=>({_tag:lo,cause:e}),Rn=e=>({_tag:fo,onFiber:e}),ue=e=>({_tag:ho,effect:e}),Ry=e=>({_tag:go,priority:e});var mu,yu;const Fy="@effect/io/Fiber/Scope",wr=Symbol.for(Fy),bi="@effect/io/FiberScope/Global";class Py{add(t,n){this.roots.add(n),n.unsafeAddObserver(()=>{this.roots.delete(n)})}constructor(){if(this[mu]=wr,this.fiberId=Ft,this.roots=new Set,typeof globalThis[bi]>"u")globalThis[bi]=this;else throw new Error("Bug: FiberScope.Global initialized twice (maybe coming from a duplicated module)")}}mu=wr;class Ny{constructor(t,n){this.fiberId=t,this.parent=n,this[yu]=wr}add(t,n){this.parent.tell(Rn(r=>{r.addChild(n),n.unsafeAddObserver(()=>{r.removeChild(n)})}))}}yu=wr;const Ly=e=>new Ny(e.id(),e),_u=new Py,xy="@effect/io/Fiber",jy=Symbol.for(xy),Dy={_E:e=>e,_A:e=>e},Ky="@effect/io/Fiber",qy=Symbol.for(Ky),Si=p(e=>t=>t.await().traced(e)),vi=p(e=>t=>Qs(_a(t.await()),t.inheritAll()).traced(e)),jt="@effect/io/Fiber/Current",Uy=Symbol.for("@effect/data/MutableList");class Wy{constructor(){this._id=Uy,this.head=void 0,this.tail=void 0,this._length=0}[Symbol.iterator](){let t=!1,n=this.head;return{next(){if(t)return this.return();if(n==null)return t=!0,this.return();const r=n.value;return n=n.next,{done:t,value:r}},return(r){return t||(t=!0),{done:!0,value:r}}}}toString(){return`MutableList(${Array.from(this).map(String).join(", ")})`}toJSON(){return{_tag:"MutableList",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}}class zy{constructor(t){this.value=t,this.removed=!1,this.prev=void 0,this.next=void 0}}const Gy=()=>new Wy,bu=e=>Su(e)===0,Su=e=>e._length,Hy=l(2,(e,t)=>{const n=new zy(t);return e.head===void 0&&(e.head=n),e.tail===void 0||(e.tail.next=n,n.prev=e.tail),e.tail=n,e._length+=1,e}),By=e=>{const t=e.head;if(t!==void 0)return Vy(e,t),t.value},Vy=(e,t)=>{t.removed||(t.removed=!0,t.prev!==void 0&&t.next!==void 0?(t.prev.next=t.next,t.next.prev=t.prev):t.prev!==void 0?(e.tail=t.prev,t.prev.next=void 0):t.next!==void 0?(e.head=t.next,t.next.prev=void 0):(e.tail=void 0,e.head=void 0),e._length>0&&(e._length-=1))},Jy=Symbol.for("@effect/data/MutableQueue");class Yy{constructor(t=void 0){this.capacity=t,this._tag="Bounded",this._id=Jy,this.queue=Gy()}[Symbol.iterator](){return Array.from(this.queue)[Symbol.iterator]()}toString(){return`MutableQueue(${Array.from(this).map(String).join(", ")})`}toJSON(){return{_tag:"MutableQueue",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}}const Qy=()=>new Yy,Ne=e=>bu(e.queue),Xy=l(2,(e,t)=>{const n=Su(e.queue);return e.capacity!==void 0&&n===e.capacity?!1:(Hy(t)(e.queue),!0)}),Ei=l(2,(e,t)=>bu(e.queue)?t:By(e.queue)),vu=e=>{if(typeof e=="object"&&e!=null&&"toString"in e&&typeof e.toString=="function"&&e.toString!==Object.prototype.toString)return e.toString();if(typeof e=="string")return`Error: ${e}`;if(typeof e=="object"&&e!==null&&"message"in e&&typeof e.message=="string"){const t=JSON.parse(JSON.stringify(e)),n=new Set(Object.keys(t));if(n.delete("name"),n.delete("message"),n.delete("_tag"),n.size===0)return`${"name"in e&&typeof e.name=="string"?e.name:"Error"}${"_tag"in e&&typeof e._tag=="string"?`(${e._tag})`:""}: ${e.message}`}return`Error: ${JSON.stringify(e)}`},Zy=e=>{const t=[];for(const n of e){const r=n?.toFrame();r&&F.filterStackFrame(r)&&t.push(Eu(r))}return t},t_=e=>W(e)?[]:e.value.stack.length>0?Zy(e.value.stack):[],e_=(e,t)=>[new r_(t._tag==="Some"?t.value.seq:0,e,t_(t).join(`\r
`))],n_=e=>{if(e.stack){const t=F.parseStack(e),n=[];for(const r of t)if(r)if(F.filterStackFrame(r))n.push(Eu(r));else break;return[vu(e),...n].join(`\r
`)}return String(e)},wi=e=>e instanceof Error?n_(e):vu(e);class r_{constructor(t,n,r){this.seq=t,this.message=n,this.stack=r}}const s_=e=>{if(sa(e))return"All fibers interrupted without errors.";const t=Us(e,void 0,{emptyCase:()=>[],dieCase:(r,s)=>[{message:wi(s),stack:v()}],failCase:(r,s)=>[{message:wi(s),stack:v()}],interruptCase:()=>[],parallelCase:(r,s,o)=>[...s,...o],sequentialCase:(r,s,o)=>[...s,...o],annotatedCase:(r,s,o)=>ua(o)?s.map(i=>({message:i.message,stack:c(zt(i.stack,a=>new ts(a.stack.length<F.traceStackLimit&&o.stack.length>0&&(a.stack.length>0&&He(o.stack)!==He(a.stack)||a.stack.length===0)?c(a.stack,U(o.stack),Sc,Is(F.traceStackLimit)):a.stack,a.seq)),Af(()=>I(o)))})):s}).flatMap(r=>e_(r.message,r.stack)),n=Array.from(t).sort((r,s)=>r.seq===s.seq?0:r.seq>s.seq?1:-1).map(r=>{let s=r.message;return r.stack&&r.stack.length>0&&(s+=`\r
${r.stack}`),s}).join(`\r
\r
`);return n.includes(`\r
`)?`\r
${n}\r
`:n};function Eu(e){return e?e.name?`    at ${e.name} (${e.fileName}:${e.line}:${e.column})`:`    at ${e.fileName}:${e.line}:${e.column}`:"    at <unknown>"}const o_="@effect/io/Logger",i_=Symbol.for(o_),c_={_Message:e=>e,_Output:e=>e},wu=e=>({[i_]:c_,log:e}),a_=wu((e,t,n,r,s,o,i)=>{const a=new Date,u=a.getTime();let h=[`timestamp=${a.toISOString()}`,`level=${t.label}`,`fiber=${zd(e)}`].join(" ");if(n.length>0&&(h=h+" message=",h=Nr(n,h)),r!=null&&r!=Ye&&(h=h+" cause=",h=Nr(s_(r),h)),Jt(o)){h=h+" ";let d=!0;for(const g of o)d?d=!1:h=h+" ",h=h+c(g,Xm(u))}if(c(i,ld)>0){h=h+" ";let d=!0;for(const[g,y]of i)d?d=!1:h=h+" ",h=h+f_(g),h=h+"=",h=Nr(y,h)}return h}),u_=e=>`"${e.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`,l_=/^[^\s"=]+$/,Nr=(e,t)=>t+(e.match(l_)?e:u_(e)),f_=e=>e.replace(/[\s="]/g,"_");function en(){const e=[];return{promise:()=>new Promise(n=>e.push(n)),resolve:n=>e.forEach(r=>r(n))}}const R={tasks:[],idleDeadline:void 0,frameTimeElapsed:!1,onIdleCallback:en(),onAnimationFrame:en(),frameWorkStartTime:void 0};function h_(){const e=en(),t={ready:e.promise,resolve:e.resolve};return R.tasks.push(t),R.tasks.length===1&&d_(),t}let Lr=!1,ki;function d_(){if(Lr)return;Lr=!0;const e=()=>{R.idleDeadline=void 0,R.frameTimeElapsed=!1,R.frameWorkStartTime=void 0},t=()=>{typeof requestIdleCallback<"u"&&(ki=requestIdleCallback(r=>{e(),R.idleDeadline=r,R.onIdleCallback.resolve(),R.onIdleCallback=en()}));const n=()=>{e(),R.onAnimationFrame.resolve(),R.onAnimationFrame=en(),R.tasks.length===0?(Lr=!1,typeof cancelIdleCallback<"u"&&cancelIdleCallback(ki)):t()};typeof requestAnimationFrame<"u"?requestAnimationFrame(n):setTimeout(n,16)};t()}function g_(e){const t=R.tasks.indexOf(e);t!==-1&&R.tasks.splice(t,1)}function p_(){R.tasks.length>0&&R.tasks[0].resolve()}let $i=0,Le=!1;function ku(){const e=Date.now();return!Le&&e-$i===0||($i=e,Le=e>=m_()||typeof navigator<"u"&&navigator.scheduling?.isInputPending?.()===!0,Le&&(R.frameTimeElapsed=!0)),Le}function m_(){if(R.frameWorkStartTime===void 0)return-1;const e=R.idleDeadline===void 0?Number.MAX_SAFE_INTEGER:Date.now()+R.idleDeadline.timeRemaining();return Math.min(R.frameWorkStartTime+5,e)}let Ii=0;const Fn=new Set;function y_(e){const t=Ii;return Fn.add(t),Promise.resolve().then(()=>{Promise.resolve().then(()=>{Fn.has(t)&&(e(),Fn.delete(t))})}),Ii+=1,t}function Ti(e){e!==void 0&&Fn.delete(e)}let wn=[];function __(e){if(wn.length===0){const t=new MessageChannel;t.port2.postMessage(void 0),t.port1.onmessage=()=>{t.port1.close(),t.port2.close();const n=wn;wn=[];for(const r of n)r()}}wn.push(e)}let xr;async function b_(){Ti(xr);const e=h_();await cs(),R.tasks[0]!==e&&(await e.ready(),ku()&&await cs()),g_(e),Ti(xr),xr=y_(()=>{p_()})}async function cs(){R.frameTimeElapsed&&await R.onAnimationFrame.promise(),typeof requestIdleCallback>"u"?(await new Promise(e=>__(e)),typeof navigator<"u"&&navigator.scheduling?.isInputPending?.()===!0?await cs():R.frameWorkStartTime===void 0&&(R.frameWorkStartTime=Date.now())):(await R.onIdleCallback.promise(),R.frameWorkStartTime===void 0&&(R.frameWorkStartTime=Date.now()))}function S_(){return ku()?b_():Promise.resolve()}var Mi;const $u="@effect/io/Metric/Boundaries",as=Symbol.for($u);class v_{constructor(t){this.values=t,this[Mi]=as}[(Mi=as,M)](){return c(_($u),A(_(this.values)))}[O](t){return E_(t)&&S(this.values,t.values)}}const E_=e=>typeof e=="object"&&e!=null&&as in e,w_=e=>{const t=c(e,U(K(Number.POSITIVE_INFINITY)),gh);return new v_(t)},k_=(e,t,n)=>c(fh(0,n-1),he(r=>e*Math.pow(t,r)),w_);var Oi,Ai,Ci,Ri;const $_="@effect/io/Metric/KeyType",Iu=Symbol.for($_),Tu="effect/io/Metric/KeyType/Counter",us=Symbol.for(Tu),I_="effect/io/Metric/KeyType/Frequency",T_=Symbol.for(I_),M_="effect/io/Metric/KeyType/Gauge",O_=Symbol.for(M_),Mu="effect/io/Metric/KeyType/Histogram",ls=Symbol.for(Mu),A_="effect/io/Metric/KeyType/Summary",C_=Symbol.for(A_),Ou={_In:e=>e,_Out:e=>e};class R_{constructor(){this[Oi]=Ou,this[Ai]=us}[(Oi=Iu,Ai=us,M)](){return _(Tu)}[O](t){return Au(t)}}class F_{constructor(t){this.boundaries=t,this[Ci]=Ou,this[Ri]=ls}[(Ci=Iu,Ri=ls,M)](){return c(_(Mu),A(_(this.boundaries)))}[O](t){return Cu(t)&&S(this.boundaries,t.boundaries)}}const P_=new R_,N_=e=>new F_(e),Au=e=>typeof e=="object"&&e!=null&&us in e,L_=e=>typeof e=="object"&&e!=null&&T_ in e,x_=e=>typeof e=="object"&&e!=null&&O_ in e,Cu=e=>typeof e=="object"&&e!=null&&ls in e,j_=e=>typeof e=="object"&&e!=null&&C_ in e;var Fi;const D_="@effect/io/Metric/Key",Ru=Symbol.for(D_),K_={_Type:e=>e};class po{constructor(t,n,r=Et()){this.name=t,this.keyType=n,this.tags=r,this[Fi]=K_}[(Fi=Ru,M)](){return c(_(this.name),A(_(this.keyType)),A(_(this.tags)))}[O](t){return q_(t)&&this.name===t.name&&S(this.keyType,t.keyType)&&S(this.tags,t.tags)}}const q_=e=>typeof e=="object"&&e!=null&&Ru in e,U_=e=>new po(e,P_),W_=(e,t)=>new po(e,N_(t)),z_=l(2,(e,t)=>qc(t)===0?e:new po(e.name,e.keyType,c(e.tags,ve(t))));var Pi,Ni,Li,xi,ji,Di,Ki,qi,Ui,Wi;const G_="@effect/io/Metric/State",yn=Symbol.for(G_),Fu="effect/io/Metric/State/Counter",fs=Symbol.for(Fu),Pu="effect/io/Metric/State/Frequency",hs=Symbol.for(Pu),Nu="effect/io/Metric/State/Gauge",ds=Symbol.for(Nu),Lu="effect/io/Metric/State/Histogram",gs=Symbol.for(Lu),xu="effect/io/Metric/State/Summary",ps=Symbol.for(xu),_n={_A:e=>e};class H_{constructor(t){this.count=t,this[Pi]=_n,this[Ni]=fs}[(Pi=yn,Ni=fs,M)](){return c(_(Fu),A(_(this.count)))}[O](t){return nb(t)&&this.count===t.count}}class B_{constructor(t){this.occurrences=t,this[Li]=_n,this[xi]=hs}[(Li=yn,xi=hs,M)](){return c(_(Pu),A(_(this.occurrences)))}[O](t){return rb(t)&&S(this.occurrences,t.occurrences)}}class V_{constructor(t){this.value=t,this[ji]=_n,this[Di]=ds}[(ji=yn,Di=ds,M)](){return c(_(Nu),A(_(this.value)))}[O](t){return sb(t)&&this.value===t.value}}class J_{constructor(t,n,r,s,o){this.buckets=t,this.count=n,this.min=r,this.max=s,this.sum=o,this[Ki]=_n,this[qi]=gs}[(Ki=yn,qi=gs,M)](){return c(_(Lu),A(_(this.buckets)),A(_(this.count)),A(_(this.min)),A(_(this.max)),A(_(this.sum)))}[O](t){return ob(t)&&S(this.buckets,t.buckets)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}}class Y_{constructor(t,n,r,s,o,i){this.error=t,this.quantiles=n,this.count=r,this.min=s,this.max=o,this.sum=i,this[Ui]=_n,this[Wi]=ps}[(Ui=yn,Wi=ps,M)](){return c(_(xu),A(_(this.error)),A(_(this.quantiles)),A(_(this.count)),A(_(this.min)),A(_(this.max)),A(_(this.sum)))}[O](t){return ib(t)&&this.error===t.error&&S(this.quantiles,t.quantiles)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}}const Q_=e=>new H_(e),X_=e=>new B_(e),Z_=e=>new V_(e),tb=(e,t,n,r,s)=>new J_(e,t,n,r,s),eb=(e,t,n,r,s,o)=>new Y_(e,t,n,r,s,o),nb=e=>typeof e=="object"&&e!=null&&fs in e,rb=e=>typeof e=="object"&&e!=null&&hs in e,sb=e=>typeof e=="object"&&e!=null&&ds in e,ob=e=>typeof e=="object"&&e!=null&&gs in e,ib=e=>typeof e=="object"&&e!=null&&ps in e,cb="@effect/io/Metric/Hook",ab=Symbol.for(cb),ub={_In:e=>e,_Out:e=>e},bn=(e,t)=>({[ab]:ub,update:t,get:e}),lb=e=>{let t=0;return bn(()=>Q_(t),n=>{t=t+n})},fb=e=>{const t=new Map,n=s=>{const o=t.get(s)??0;t.set(s,o+1)},r=()=>Dc(Array.from(t.entries()).map(([s,o])=>[s,o]));return bn(()=>X_(r()),n)},hb=(e,t)=>{let n=t;return bn(()=>Z_(n),r=>{n=r})},db=e=>{const t=e.keyType.boundaries.values,n=t.length,r=Array(n+1),s=Array(n);let o=0,i=0,a=Number.MAX_VALUE,u=Number.MIN_VALUE;c(t,qr(Ln),lh((d,g)=>{s[d]=g}));const f=d=>{let g=0,y=n;for(;g!==y;){const E=Math.floor(g+(y-g)/2),N=s[E];d<=N?y=E:g=E,y===g+1&&(d<=s[g]?y=g:g=y)}r[g]=r[g]+1,o=o+1,i=i+d,d<a&&(a=d),d>u&&(u=d)},h=()=>{const d=[];let g=0,y=0;for(;g!=n;){const E=s[g],N=r[g];y=y+N,d.push([E,y]),g=g+1}return $e(d)};return bn(()=>tb(h(),o,a,u,i),f)},gb=e=>{const{error:t,maxAge:n,maxSize:r,quantiles:s}=e.keyType,o=c(s,qr(Ln)),i=Array(r);let a=0,u=0,f=0,h=Number.MAX_VALUE,d=Number.MIN_VALUE;const g=E=>{const N=[];let x=0;for(;x!==r-1;){const st=i[x];if(st!=null){const[yt,xt]=st,Re=ao(E-yt);Re.millis>=0&&Re<=n&&N.push(xt)}x=x+1}return pb(t,o,c($e(N),qr(Ln)))},y=(E,N)=>{if(r>0){a=a+1;const x=a%r;i[x]=[N,E]}u=u+1,f=f+E,E<h&&(h=E),E>d&&(d=E)};return bn(()=>eb(t,g(Date.now()),u,h,d,f),([E,N])=>y(E,N))},pb=(e,t,n)=>{const r=n.length;if(sr(t))return it();const s=xn(t),o=c(t,Ts(1)),i=c(o,or(K(zi(e,r,v(),0,s,n)),(a,u)=>{const f=xn(a);return c(a,ih(zi(e,r,f.value,f.consumed,u,f.rest)))}));return c(i,he(a=>[a.quantile,a.value]))},zi=(e,t,n,r,s,o)=>{let i=e,a=t,u=n,f=r,h=s,d=o,g=e,y=t,E=n,N=r,x=s,st=o;for(;;){if(sr(d))return{quantile:h,value:v(),consumed:f,rest:it()};if(h===1)return{quantile:h,value:I(He(d)),consumed:f+d.length,rest:it()};const yt=c(d,dh(Tr=>Tr>xn(d))),xt=h*a,Re=i/2*xt,ie=f+yt[0].length,Pl=Math.abs(ie-xt);if(ie<xt-Re){g=i,y=a,E=fe(d),N=ie,x=h,st=yt[1],i=g,a=y,u=E,f=N,h=x,d=st;continue}if(ie>xt+Re)return{quantile:h,value:u,consumed:f,rest:d};switch(u._tag){case"None":{g=i,y=a,E=fe(d),N=ie,x=h,st=yt[1],i=g,a=y,u=E,f=N,h=x,d=st;continue}case"Some":{const Tr=Math.abs(xt-u.value);if(Pl<Tr){g=i,y=a,E=fe(d),N=ie,x=h,st=yt[1],i=g,a=y,u=E,f=N,h=x,d=st;continue}return{quantile:h,value:I(u.value),consumed:f,rest:d}}}}throw new Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/io/issues")},mb="@effect/io/Metric/Pair",yb=Symbol.for(mb),_b={_Type:e=>e},bb=(e,t)=>({[yb]:_b,metricKey:e,metricState:t});var ju;const Sb="@effect/io/Metric/Registry",Du=Symbol.for(Sb);class vb{constructor(){this[ju]=Du,this.map=gy()}snapshot(){const t=[];for(const[n,r]of this.map)t.push(bb(n,r.get()));return Kc(t)}get(t){const n=c(this.map,Kt(t),ae);if(n==null){if(Au(t.keyType))return this.getCounter(t);if(x_(t.keyType))return this.getGauge(t);if(L_(t.keyType))return this.getFrequency(t);if(Cu(t.keyType))return this.getHistogram(t);if(j_(t.keyType))return this.getSummary(t);throw new Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/io/issues")}else return n}getCounter(t){let n=c(this.map,Kt(t),ae);if(n==null){const r=lb();c(this.map,Fe(t))||c(this.map,Pe(t,r)),n=r}return n}getFrequency(t){let n=c(this.map,Kt(t),ae);if(n==null){const r=fb();c(this.map,Fe(t))||c(this.map,Pe(t,r)),n=r}return n}getGauge(t){let n=c(this.map,Kt(t),ae);if(n==null){const r=hb(t,0);c(this.map,Fe(t))||c(this.map,Pe(t,r)),n=r}return n}getHistogram(t){let n=c(this.map,Kt(t),ae);if(n==null){const r=db(t);c(this.map,Fe(t))||c(this.map,Pe(t,r)),n=r}return n}getSummary(t){let n=c(this.map,Kt(t),ae);if(n==null){const r=gb(t);c(this.map,Fe(t))||c(this.map,Pe(t,r)),n=r}return n}}ju=Du;const Eb=()=>new vb,wb="@effect/io/Metric",kb=Symbol.for(wb),$b={_Type:e=>e,_In:e=>e,_Out:e=>e},Ib=Eb(),Tb=function(e,t,n){return Object.assign(p((s,o)=>i=>va(i,a=>$(()=>o(t)(a,Et()))).traced(s)),{[kb]:$b,keyType:e,unsafeUpdate:t,unsafeValue:n})},mo=e=>Ku(U_(e)),Ku=e=>{const t=n=>{const r=c(e,z_(n));return Ib.get(r)};return Tb(e.keyType,(n,r)=>t(r).update(n),n=>t(n).get())},Mb=(e,t)=>Ku(W_(e,t));var qu,Uu,Wu;const Ob="@effect/io/Supervisor",yo=Symbol.for(Ob),_o={_T:e=>e};class kr{constructor(t,n){this.underlying=t,this.value0=n,this[qu]=_o}value(){return j(t=>this.value0().traced(t))}onStart(t,n,r,s){this.underlying.onStart(t,n,r,s)}onEnd(t,n){this.underlying.onEnd(t,n)}onEffect(t,n){this.underlying.onEffect(t,n)}onSuspend(t){this.underlying.onSuspend(t)}onResume(t){this.underlying.onResume(t)}map(t){return new kr(this,()=>c(this.value(),P(t)))}zip(t){return new Ce(this,t)}}qu=yo;class Ce{constructor(t,n){this.left=t,this.right=n,this[Uu]=_o}value(){return j(t=>tn(this.left.value(),this.right.value()).traced(t))}onStart(t,n,r,s){this.left.onStart(t,n,r,s),this.right.onStart(t,n,r,s)}onEnd(t,n){this.left.onEnd(t,n),this.right.onEnd(t,n)}onEffect(t,n){this.left.onEffect(t,n),this.right.onEffect(t,n)}onSuspend(t){this.left.onSuspend(t),this.right.onSuspend(t)}onResume(t){this.left.onResume(t),this.right.onResume(t)}map(t){return new kr(this,()=>c(this.value(),P(t)))}zip(t){return new Ce(this,t)}}Uu=yo;class Ab{constructor(t){this.effect=t,this[Wu]=_o}value(){return j(t=>this.effect.traced(t))}onStart(t,n,r,s){}onEnd(t,n){}onEffect(t,n){}onSuspend(t){}onResume(t){}map(t){return new kr(this,()=>c(this.value(),P(t)))}zip(t){return new Ce(this,t)}}Wu=yo;const Cb=e=>new Ab(e),$r=Cb(L()),zu="Empty",Gu="AddSupervisor",Hu="RemoveSupervisor",Bu="AndThen",ze={_tag:zu},Pn=(e,t)=>({_tag:Bu,first:e,second:t}),Rb=(e,t)=>Fb(t,K(e)),Fb=(e,t)=>{let n=e,r=t;for(;Jt(r);){const s=ye(r);switch(s._tag){case zu:{r=Ct(r);break}case Gu:{n=n.zip(s.supervisor),r=Ct(r);break}case Hu:{n=ms(n,s.supervisor),r=Ct(r);break}case Bu:{r=mt(s.first)(mt(s.second)(Ct(r)));break}}}return n},ms=(e,t)=>S(e,t)?$r:e instanceof Ce?ms(e.left,t).zip(ms(e.right,t)):e,Jn=e=>S(e,$r)?Et():e instanceof Ce?c(Jn(e.left),ve(Jn(e.right))):Ds(e),Pb=(e,t)=>{if(S(e,t))return ze;const n=Jn(e),r=Jn(t),s=c(r,jo(n),Kn(ze,(i,a)=>Pn(i,{_tag:Gu,supervisor:a}))),o=c(n,jo(r),Kn(ze,(i,a)=>Pn(i,{_tag:Hu,supervisor:a})));return Pn(s,o)},Nb=Gc({empty:ze,patch:Rb,combine:Pn,diff:Pb});var Gi,Hi;const Lb=mo("effect_fiber_started"),xb=mo("effect_fiber_successes"),jb=mo("effect_fiber_failures"),Db=Mb("effect_fiber_lifetimes",k_(1,2,100)),xe="Continue",Kb="Done",Bi="Yield",Vi="YieldInBackground",qb={_E:e=>e,_A:e=>e},je=e=>{throw new Error(`BUG: FiberRuntime - ${JSON.stringify(e)} - please report an issue at https://github.com/Effect-TS/io/issues`)},kn={[Wn]:(e,t,n)=>t.successK(n),[zn]:(e,t,n)=>t.successK(n),[Hs]:(e,t,n)=>(e.patchRuntimeFlags(e._runtimeFlags,t.patch),qt(e._runtimeFlags)&&e.isInterrupted()?tt(e.getInterruptedCause()):se(n)),[Gn]:(e,t,n)=>(t.process(n),t.check()?(e.pushStack(t),t.body()):L())},Ub={[lo]:(e,t,n,r)=>(e.processNewInterruptSignal(r.cause),qt(t)?tt(r.cause):n),[ho]:(e,t,n,r)=>{throw new Error("It is illegal to have multiple concurrent run loops in a single fiber")},[fo]:(e,t,n,r)=>(r.onFiber(e,pu(t)),n),[go]:(e,t,n,r)=>c(ka(r.priority),m(()=>n))};class Vu{constructor(t,n,r){if(this[Gi]=Dy,this[Hi]=qb,this._queue=Qy(),this._children=null,this._observers=new Array,this._running=!1,this._stack=[],this._asyncInterruptor=null,this._asyncBlockingOn=null,this._exitValue=null,this._traceStack=[],this.run=()=>{this.drainQueueOnCurrentThread()},this._runtimeFlags=r,this._fiberId=t,this._fiberRefs=n,Ar(r)){const s=this.getFiberRef(Rr);Lb.unsafeUpdate(1,s)}}id(){return this._fiberId}resume(t){this.tell(ue(t))}status(){return this.ask((t,n)=>n)}runtimeFlags(){return this.ask((t,n)=>Cy(n)?t._runtimeFlags:n.runtimeFlags)}scope(){return Ly(this)}children(){return this.ask(t=>$e(t.getChildren()))}getChildren(){return this._children===null&&(this._children=new Set),this._children}getSupervisor(){return this.getFiberRef(nS)}getInterruptedCause(){return this.getFiberRef(En)}fiberRefs(){return this.ask(t=>t.unsafeGetFiberRefs())}ask(t){return H(()=>C(()=>{const n=_r(this._fiberId);return this.tell(Rn((r,s)=>{so(n,$(()=>t(r,s)))})),br(n)}))}tell(t){c(this._queue,Xy(t)),this._running||(this._running=!0,this.drainQueueLaterOnExecutor("normal"))}await(){return H(()=>xg(t=>{const n=r=>t(T(r));return this.tell(Rn((r,s)=>{r._exitValue!==null?n(this._exitValue):r.unsafeAddObserver(n)})),$(()=>this.tell(Rn((r,s)=>{r.unsafeRemoveObserver(n)})))},this.id()))}inheritAll(){return H(()=>Pt((t,n)=>{const r=t.id(),s=t.unsafeGetFiberRefs(),o=n.runtimeFlags,i=this.unsafeGetFiberRefs(),a=Fm(s,r,i);t.setFiberRefs(a);const u=t.getFiberRef(Yi),f=c(Yr(o,u),Uo(Oe),Uo(Jr));return Yg(f)}))}poll(){return H(()=>$(()=>hc(this._exitValue)))}unsafePoll(){return this._exitValue}interruptAsFork(t){return H(()=>$(()=>this.tell(_i(Mn(t)))))}unsafeAddObserver(t){this._exitValue!==null?t(this._exitValue):this._observers.push(t)}unsafeRemoveObserver(t){this._observers=this._observers.filter(n=>n!==t)}unsafeGetFiberRefs(){return this.setFiberRef(Yi,this._runtimeFlags),this._fiberRefs}unsafeDeleteFiberRef(t){this._fiberRefs=eu(this._fiberRefs,t)}getFiberRef(t){return vr(this._fiberRefs,t)}setFiberRef(t,n){this._fiberRefs=Vn(this._fiberRefs,this._fiberId,t,n)}setFiberRefs(t){this._fiberRefs=t}addChild(t){this.getChildren().add(t)}removeChild(t){this.getChildren().delete(t)}drainQueueOnCurrentThread(){let t=!0;for(;t;){let n=xe;const r=globalThis[jt];globalThis[jt]=this;try{for(;n===xe;)n=Ne(this._queue)?Kb:this.evaluateMessageWhileSuspended(c(this._queue,Ei(null)))}finally{this._running=!1,globalThis[jt]=r}!Ne(this._queue)&&!this._running?(this._running=!0,n===Bi?(this.drainQueueLaterOnExecutor("normal"),t=!1):n===Vi?(this.drainQueueLaterOnExecutor("background"),t=!1):t=!0):t=!1}}drainQueueLaterOnExecutor(t){t==="normal"?this.getFiberRef(to).scheduleTask(this.run):S_().then(()=>{this.run()})}drainQueueWhileRunning(t,n){let r=n;for(;!Ne(this._queue);){const s=c(this._queue,Ei(void 0));r=Ub[s._tag](this,t,r,s)}return r}isInterrupted(){return!dg(this.getFiberRef(En))}addInterruptedCause(t){const n=this.getFiberRef(En);this.setFiberRef(En,at(n,t))}processNewInterruptSignal(t){this.addInterruptedCause(t),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(this._children===null||this._children.size===0)return!1;let t=!1;for(const n of this._children)n.tell(_i(Mn(this.id()))),t=!0;return t}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){const t=this._children.values();this._children=null;let n=!1;const r=()=>{const s=t.next();return s.done?$(()=>{n=!0}):It(s.value.await())};return Ys(()=>!n,()=>r(),()=>{})}return null}reportExitValue(t){if(Ar(this._runtimeFlags)){const n=this.getFiberRef(Rr);switch(t._tag){case X:{xb.unsafeUpdate(1,n);break}case Q:{jb.unsafeUpdate(1,n);break}}}}setExitValue(t){if(this._exitValue=t,Ar(this._runtimeFlags)){const n=this.getFiberRef(Rr),r=this.id().startTimeMillis,s=new Date().getTime();Db.unsafeUpdate((s-r)/1e3,n)}this.reportExitValue(t);for(let n=this._observers.length-1;n>=0;n--)this._observers[n](t)}getLoggers(){return this.getFiberRef(Gb)}log(t,n,r){const s=D(r)?r.value:this.getFiberRef(fp),o=this.getFiberRef(hp),i=this.getFiberRef(lp),a=this.getLoggers(),u=this.unsafeGetFiberRefs();c(a,hd(f=>{f.log(this.id(),s,t,n,u,o,i)}))}evaluateMessageWhileSuspended(t){switch(t._tag){case go:return t.priority==="background"?Vi:Bi;case lo:return this.processNewInterruptSignal(t.cause),this._asyncInterruptor!==null&&(this._asyncInterruptor(tt(t.cause)),this._asyncInterruptor=null),xe;case ho:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(t.effect),xe;case fo:return t.onFiber(this,this._exitValue!==null?Oy:Ay(this._runtimeFlags,this._asyncBlockingOn)),xe;default:return je(t)}}evaluateEffect(t){this.getSupervisor().onResume(this);try{let n=qt(this._runtimeFlags)&&this.isInterrupted()?tt(this.getInterruptedCause()):t;for(;n!==null;)try{const r=this.runLoop(n);this._runtimeFlags=c(this._runtimeFlags,ng(Jr));const s=this.interruptAllChildren();s!==null?n=H(()=>m(s,()=>r)):(Ne(this._queue)?this.setExitValue(r):this.tell(ue(r)),n=null)}catch(r){if(Ho(r))r._tag===Cn?eg(this._runtimeFlags)?(this.tell(Ry(r.priority)),this.tell(ue(Ut())),n=null):n=Ut():r._tag===On&&(n=null);else throw r}}finally{this.getSupervisor().onSuspend(this)}}start(t){if(this._running)this.tell(ue(t));else{this._running=!0;const n=globalThis[jt];globalThis[jt]=this;try{this.evaluateEffect(t)}finally{this._running=!1,globalThis[jt]=n,Ne(this._queue)||this.drainQueueLaterOnExecutor("normal")}}}startFork(t){this.tell(ue(t))}patchRuntimeFlags(t,n){const r=Qr(t,n);return globalThis[jt]=this,this._runtimeFlags=r,r}initiateAsync(t,n){let r=!1;const s=o=>{r||(r=!0,this.tell(ue(o)))};qt(t)&&(this._asyncInterruptor=s);try{n(s)}catch(o){s(q(ge(o)))}}pushStack(t){this._stack.push(t),"trace"in t&&t.trace&&this._traceStack.push(t.trace)}popStack(){const t=this._stack.pop();if(t)return"trace"in t&&t.trace&&this._traceStack.pop(),t}getNextSuccessCont(){let t=this.popStack();for(;t;){if(t._tag!==Cr&&t._tag!==An)return t;t=this.popStack()}}getNextFailCont(){let t=this.popStack();for(;t;){if(t._tag!==Wn&&t._tag!==Gn&&t._tag!==An)return t;t=this.popStack()}}[(Gi=jy,Hi=qy,fa)](t){const n=t.evaluate(),r=this.getNextSuccessCont();if(r!==void 0)return r._tag in kn||je(r),kn[r._tag](this,r,n);throw se(n)}[X](t){const n=t,r=this.getNextSuccessCont();if(r!==void 0)return r._tag in kn||je(r),kn[r._tag](this,r,n.value);throw n}[Q](t){let n=t.cause;if(hg(n)&&ua(n.annotation)){const s=n.annotation.stack,o=this.stackToLines();n=Un(n.cause,new ts(c(s.length===0?o:o.length===0||He(s)===He(o)?s:c(s,U(o)),Sc,Is(F.traceStackLimit)),n.annotation.seq))}else n=Un(t.cause,new ts(this.stackToLines(),Ld($g)));const r=this.getNextFailCont();if(r!==void 0)switch(r._tag){case Cr:case zn:return qt(this._runtimeFlags)&&this.isInterrupted()?tt(Qe(n)):r.failK(n);case Hs:return this.patchRuntimeFlags(this._runtimeFlags,r.patch),qt(this._runtimeFlags)&&this.isInterrupted()?tt(at(n,this.getInterruptedCause())):tt(n);default:je(r)}else throw tt(n)}[ha](t){return t.withRuntime(this,pu(this._runtimeFlags))}[dn](t){if(t.scope===void 0)return this.patchRuntimeFlags(this._runtimeFlags,t.update),Ut();{const n=t.update,r=this._runtimeFlags,s=Qr(r,n);if(s===r)return t.scope(r);if(qt(s)&&this.isInterrupted())return tt(this.getInterruptedCause());{this.patchRuntimeFlags(this._runtimeFlags,n);const o=Yr(s,r);return this.pushStack(new Ng(o)),t.scope(r)}}}[Wn](t){return this.pushStack(t),t.first}[An](t){return this.pushStack(t),t.self}[Cr](t){return this.pushStack(t),t.first}[zn](t){return this.pushStack(t),t.first}[On](t){throw this._asyncBlockingOn=t.blockingOn,this.initiateAsync(this._runtimeFlags,t.register),t}[Cn](t){throw t}[Gn](t){const n=t.check,r=t.body;return n()?(this.pushStack(t),r()):Ut()}[Og](t){return t.commit()}runLoop(t){let n=t,r=0;for(;;){if(sg(this._runtimeFlags)&&this.getSupervisor().onEffect(this,n),n=this.drainQueueWhileRunning(this._runtimeFlags,n),r+=1,r>=2048){r=0;const s=n;n=c(ka(),m(()=>s))}try{n._tag in this||je(n),n=this[n._tag](n)}catch(s){if(Ho(s)){if(s._tag===Cn||s._tag===On)throw s;if(s._tag===X||s._tag===Q)return s}else Pg(s)?n=tt(s.cause):kg(s)?n=tt(at(ge(s),Mn(Ft))):n=tt(ge(s))}}}stackToLines(){if(this._traceStack.length===0)return it();const t=[];let n=this._traceStack.length-1;for(;n>=0&&t.length<F.traceStackLimit;){const r=this._traceStack[n];t.push(r),n=n-1}return z(t)}}const Wb=Nt(Ym(F.minumumLogLevel)),zb=wu((e,t,n,r,s,o,i)=>{const a=a_.log(e,t,n,r,s,o,i),u=vr(s,Wb);Jm(u)(t)&&globalThis.console.log(a)}),Gb=Aa(Ds(zb)),Ji=b(2,(e,t)=>(n,r)=>Xs(eo,s=>s._tag==="None"?Ju(n,t(r)):Bb(n,s.value,r)).traced(e)),Hb=b(2,(e,t)=>(n,r)=>Xs(eo,s=>s._tag==="None"?bo(n,t(r)):Yu(n,s.value,r)).traced(e)),Ju=(e,t)=>C(()=>{const n=Array.from(e).map((o,i)=>[o,i]),r=new Array(n.length);return ot(bo(n,([o,i])=>m(t(o),a=>$(()=>r[i]=a))),T(z(r)))}),bo=(e,t)=>C(()=>{const n=Array.from(e),r=n.length;return r===0?L():r===1?It(t(n[0])):re(s=>{const o=_r(Ft);let i=0;const a=Ea(u=>kt(n,f=>c(u(c(s(C(()=>t(f))),ct(h=>ot(Pa(o,void 0),q(h)),()=>(i+1===r?so(o,L()):i=i+1,L())))),So)));return m(a,u=>ct(s(br(o)),f=>m(Ju(u,Ia),h=>{const d=rs(h);return d._tag==="Some"&&mp(d.value)?q(Rt(Qe(f),d.value.cause)):q(Qe(f))}),()=>gr(u,f=>f.inheritAll())))})}),Bb=(e,t,n)=>C(()=>{const r=Array.from(e).map((i,a)=>[i,a]),s=new Array(r.length);return ot(Yu(r,t,([i,a])=>P(n(i),u=>s[a]=u)),T(z(s)))}),Yu=(e,t,n)=>C(()=>{const r=e[Symbol.iterator](),s=m($(()=>r.next()),i=>i.done?L():m(It(n(i.value)),()=>s)),o=[];for(let i=0;i<t;i++)o.push(s);return bo(o,B)}),So=p(e=>t=>Yb(t,_u).traced(e)),Vb=(e,t,n,r=null)=>{const s=Jb(e,t,n,r);return s.resume(e),s},Jb=(e,t,n,r=null)=>{const s=Bc(),o=t.unsafeGetFiberRefs(),i=tu(o,s),a=new Vu(s,i,n),u=vr(i,pn),f=a.getSupervisor();return f.onStart(u,e,I(t),a),a.unsafeAddObserver(d=>f.onEnd(d,a)),(r!==null?r:c(t.getFiberRef(es),wt(()=>t.scope()))).add(n,a),a},Yb=(e,t)=>Pt((n,r)=>T(Vb(e,n,r.runtimeFlags,t))),Qb=p((e,t)=>n=>mr(Qu,t(n)).traced(e)),Xb=p(e=>t=>m(Ir(),n=>tS(n)(t)).traced(e)),Zb=(e,t)=>n=>C(()=>{switch(n.state._tag){case"Exited":return L();case"Running":{const r=n.state.finalizers,s=n.state.update,o=Array.from(r.keys()).sort((i,a)=>a-i).map(i=>r.get(i));return n.state={_tag:"Exited",nextKey:n.state.nextKey,exit:t,update:s},Sy(e)?c(o,kt(i=>We(s(i)(t))),m(i=>c(_p(i),zt(Fr),wt(()=>Ut())))):vy(e)?c(o,Ji(i=>We(s(i)(t))),m(i=>c(rs(i),zt(Fr),wt(()=>Ut())))):c(o,Ji(i=>We(s(i)(t))),m(i=>c(rs(i),zt(Fr),wt(()=>Ut()))),Xg(e.parallelism))}}}),Qu=Mt(),Ir=p(e=>(t=by)=>P(pp(),n=>({[Yo]:Yo,[Qo]:Qo,fork:r=>j(s=>wa(c(Ir(r),m(o=>c(n,Xo(i=>Bn(o,i)),va(i=>ns(o,i)),lt(o))))).traced(s)),close:r=>j(s=>It(Zb(t,r)(n)).traced(s)),addFinalizer:r=>j(s=>It(Xo(r)(n)).traced(s))})).traced(e)),Xu=b(2,e=>(t,n)=>Hg(t,Cs(As(Qu,n))).traced(e)),tS=b(2,e=>(t,n)=>c(t,Xu(n),Hn(r=>n.close(r))).traced(e)),eS=e=>gn(e,Nb,ze),Yi=up(rg),nS=eS($r),Qi=p(e=>t=>c(Ia(t),So,It).traced(e));var Zu,tl;class rS{constructor(t){this.permits=t,this.waiters=new Array,this.taken=0,this.take=n=>j(r=>Vs(s=>{if(this.free<n){const o=()=>{if(this.free>=n){const i=this.waiters.findIndex(a=>a===o);i!==-1&&this.waiters.splice(i,1),this.taken+=n,s(T(n))}};return this.waiters.push(o),pt($(()=>{const i=this.waiters.findIndex(a=>a===o);i!==-1&&this.waiters.splice(i,1)}))}return this.taken+=n,ut(T(n))}).traced(r)),this.release=n=>j(r=>Pt(s=>(this.taken-=n,s.getFiberRef(to).scheduleTask(()=>{this.waiters.forEach(o=>o())}),L())).traced(r)),this.withPermits=n=>j(r=>s=>H(()=>re(o=>m(o(this.take(n)),i=>oS(o(s),this.release(i))))).traced(r))}get free(){return this.permits-this.taken}}const sS=e=>new rS(e),oS=b(2,e=>(t,n)=>re(r=>ct(r(t),s=>ct(n,o=>q(at(s,o)),()=>q(s)),s=>lt(n,s))).traced(e)),iS=b(2,e=>(t,n)=>el(t,n,(r,s)=>s).traced(e)),el=b(3,(e,t)=>(n,r,s)=>re(o=>Ea(i=>{const a=_r(Ft),u=on(!1);return c(Xi(n,i,o,a,u),tn(Xi(r,i,o,a,u)),m(([f,h])=>c(o(br(a)),ct(d=>c(Qi(f),ot(Qi(h)),ot(c(Si(f),tn(Si(h)),m(([g,y])=>c(g,Ra(y,s,Rt),no(E=>q(Rt(Qe(d),E)),()=>q(Qe(d)))))))),()=>$a(vi(f),vi(h),t(s))))))})).traced(e)),Xi=(e,t,n,r,s)=>So(ct(t(n(e)),o=>ot(Pa(r,void 0),q(o)),o=>te(s)?(so(r,L()),T(o)):(c(s,ee(!0)),T(o)))),cS="@effect/io/Ref/Synchronized",aS=Symbol.for(cS),uS={_A:e=>e};class lS{constructor(t,n){this.ref=t,this.withLock=n,this[Zu]=uS,this[tl]=uu}modify(t){return j((n,r)=>this.modifyEffect(s=>T(r(t)(s))).traced(n))}modifyEffect(t){return j((n,r)=>this.withLock(c(m(os(this.ref),r(t)),m(([s,o])=>lt(fu(this.ref,o),s)))).traced(n))}}Zu=aS,tl=au;const fS=p(e=>t=>$(()=>hS(t)).traced(e)),hS=e=>{const t=lu(e),n=sS(1);return new lS(t,n.withPermits(1))},dS="ExtendScope",gS="Fold",nl="Fresh",rl="FromEffect",pS="Scoped",sl="Suspend",ol="ProvideTo",il="ZipWith",cl="ZipWithPar",mS=Ta,yS=e=>(t,n)=>{const r=Bc();let s=ui(e.fiberRefs,r,pn,e.context);n&&(s=ui(s,r,to,n));const o=new Vu(r,Nm(s,r),e.runtimeFlags),i=o.getSupervisor();return i!==$r&&(i.onStart(e.context,t,v(),o),o.unsafeAddObserver(a=>i.onEnd(a,o))),_u.add(e.runtimeFlags,o),o.start(t),o},al=e=>(t,n)=>{const r=yS(e)(t);return n&&r.unsafeAddObserver(s=>{n(s)}),(s,o)=>al(e)(c(r,mS(s??Ft)),o?i=>o(Am(i)):void 0)},_S=e=>t=>new Promise((n,r)=>{al(e)(t,s=>{switch(s._tag){case X:{n(s.value);break}case Q:{r(c(s.cause,bg(B)));break}}})});class bS{constructor(t,n,r){this.context=t,this.runtimeFlags=n,this.fiberRefs=r}}const SS=(e,t,n)=>new bS(e,t,n),vS=Xc(Oe,Yc),ES=SS(Os(),vS,Lm(new Map)),wS=_S(ES),kS=b(2,(e,t)=>(n,r)=>n.modifyEffect(t(r)).traced(e)),$S="@effect/io/Layer",IS=Symbol.for($S),TS={_RIn:e=>e,_E:e=>e,_ROut:e=>e},nn={[IS]:TS},MS=e=>e._tag===nl;class OS{constructor(t){this.ref=t}getOrElseMemoize(t,n){return c(kS(this.ref,r=>{const s=r.get(t);if(s!==void 0){const[o,i]=s,a=c(o,m(([u,f])=>c(oy(u),lt(f))),Hn(no(()=>L(),()=>ns(n,i))));return T([a,r])}return c(li(0),m(o=>c(Ep(),m(i=>c(li(()=>L()),P(a=>{const u=re(h=>c(Ir(),m(d=>c(h(m(ll(t,d),g=>ry(g(this)))),We,m(g=>{switch(g._tag){case Q:return c(kp(i,g.cause),ot(Bn(d,g)),ot(q(g.cause)));case X:return c(fu(a,y=>c(Bn(d,y),Qg(ty(o,E=>[E===1,E-1])),It)),ot(fi(o,y=>y+1)),ot(ns(n,y=>c(os(a),m(E=>E(y))))),ot($p(i,g.value)),lt(g.value[1]))}}))))),f=[c(br(i),Hn(vp(()=>L(),()=>fi(o,h=>h+1)))),h=>c(os(a),m(d=>d(h)))];return[u,MS(t)?r:r.set(t,f)]}))))))}),_a)}}const AS=()=>c(fS(new Map),P(e=>new OS(e))),ul=b(2,e=>(t,n)=>m(AS(),r=>m(ll(t,n),s=>s(r))).traced(e)),ll=(e,t)=>{const n=e;switch(n._tag){case dS:return $(()=>r=>Qb(s=>r.getOrElseMemoize(n.layer,s)));case gS:return $(()=>r=>c(r.getOrElseMemoize(n.layer,t),ct(s=>r.getOrElseMemoize(n.failureK(s),t),s=>r.getOrElseMemoize(n.successK(s),t))));case nl:return $(()=>r=>c(n.layer,ul(t)));case rl:return $(()=>r=>n.effect);case ol:return $(()=>r=>c(r.getOrElseMemoize(n.first,t),m(s=>c(r.getOrElseMemoize(n.second,t),pr(s)))));case pS:return $(()=>r=>Xu(n.effect,t));case sl:return $(()=>r=>r.getOrElseMemoize(n.evaluate(),t));case il:return $(()=>r=>c(r.getOrElseMemoize(n.first,t),$a(r.getOrElseMemoize(n.second,t),n.zipK)));case cl:return $(()=>r=>c(r.getOrElseMemoize(n.first,t),el(r.getOrElseMemoize(n.second,t),n.zipK)))}},fl=()=>vo(pa()),hl=(e,t)=>vo(P(t,n=>As(e,n)));function vo(e){const t=Object.create(nn);return t._tag=rl,t.effect=e,t}const CS=l(2,(e,t)=>PS(e,t,(n,r)=>c(n,Cs(r)))),RS=l(2,(e,t)=>dl(()=>{const n=Object.create(nn);return n._tag=ol,n.first=Object.create(nn,{_tag:{value:il,enumerable:!0},first:{value:fl(),enumerable:!0},second:{value:e},zipK:{value:(r,s)=>c(r,Cs(s))}}),n.second=t,n})),FS=(e,t)=>vo(T(As(e,t))),dl=e=>{const t=Object.create(nn);return t._tag=sl,t.evaluate=e,t},PS=Dd(3,e=>(t,n,r)=>dl(()=>{const s=Object.create(nn);return s._tag=cl,s.first=t,s.second=n,s.zipK=e(r),s})),NS=b(2,e=>(t,n)=>Bs(Ir(),r=>m(ul(n,r),s=>pr(t,s)),(r,s)=>Bn(r,s)).traced(e)),LS=b(2,e=>(t,n)=>NS(t,c(fl(),CS(n))).traced(e)),xS=l(2,(e,t)=>hl(t,e)),jS=Bs,Sn=lt,gl=hu,Nn=ey,pl=ny,ke=m,DS=kt,KS=gr,qS=Hb,US=At,Eo=ba,WS=du,zS=P,ml=Ze,GS=zg,HS=Wg,yl=iy,Yn=LS,BS=Xb,Ge=Bg,_l=Vg,Qn=mr,VS=uy,De=C,w=$,wo=xS,JS=ly,ys=L,YS=wS,QS=tn,Xn=Qs,et=ot,XS=iS,Zn=(e,t,n,r)=>({_tag:"Hsla",h:e,s:t,l:n,a:r}),ZS=(e,t,n)=>Zn(e,t,n,1),tv=ZS(360,1,1),Ue=e=>{switch(e._tag){case"Hex":return e.value;case"Hsla":{const{h:t,s:n,l:r,a:s}=e,o=h=>Math.round(h*100)/100,i=o(t),a=o(n*100)+"%",u=o(r*100)+"%",f=String(s);return s===1?`hsl(${i}, ${a}, ${u})`:`hsla(${i}, ${a}, ${u}, ${f})`}}};class ko{constructor(t){this.message=t,this._tag="CanvasError"}}const gt=Mt(),ev=k(e=>w(()=>e.canvas.width)),nv=k(e=>w(()=>e.canvas.height));VS({width:ev,height:nv});k(e=>w(()=>e.canvas.toDataURL()));const _s=e=>Lt(t=>{t.fillStyle=e});Lt(e=>e.fillStyle);k(e=>w(()=>e.font));function rv(e){return k(t=>c(w(()=>t.font=e),Sn(t)))}k(e=>w(()=>e.globalAlpha));k(e=>w(()=>e.globalCompositeOperation));k(e=>w(()=>e.imageSmoothingEnabled));k(e=>c(w(()=>e.lineCap)));k(e=>c(w(()=>e.lineDashOffset)));k(e=>c(w(()=>e.lineJoin)));function sv(e){return Lt(t=>{t.lineWidth=e})}k(e=>c(w(()=>e.lineWidth)));k(e=>w(()=>e.miterLimit));function bl(e){return Lt(t=>{t.strokeStyle=e})}Lt(e=>e.strokeStyle);function ov(e){return k(t=>c(w(()=>t.shadowBlur=e),Sn(t)))}k(e=>w(()=>e.shadowBlur));function iv(e){return k(t=>w(()=>t.shadowColor=e))}k(e=>c(w(()=>e.shadowColor)));function cv(e){return k(t=>c(w(()=>t.shadowOffsetX=e),Sn(t)))}k(e=>c(w(()=>e.shadowOffsetX)));function av(e){return k(t=>c(w(()=>t.shadowOffsetY=e),Sn(t)))}k(e=>c(w(()=>e.shadowOffsetY)));Lt(e=>e.textAlign);k(e=>w(()=>e.textBaseline));function uv(e,t,n,r,s,o=!1){return k(i=>c(w(()=>i.arc(e,t,n,r,s,o)),Sn(i)))}const $o=Lt(e=>{e.beginPath()});function lv(e,t,n,r){return k(s=>w(()=>{s.clearRect(e,t,n,r)}))}function fv(e,t){return k(n=>w(()=>{typeof t<"u"?n.clip(t,e):typeof e<"u"?n.clip(e):n.clip()}))}const hv=k(e=>w(()=>{e.closePath()})),Sl=(e,t,n)=>k(r=>w(()=>{r.drawImage(e,t,n)}));function dv(e,t,n,r,s,o,i,a=!1){return k(u=>w(()=>{u.ellipse(e,t,n,r,s,o,i,a)}))}const gv=(e,t)=>k(n=>w(()=>{typeof t<"u"?n.fill(t,e):typeof e<"u"?n.fill(e):n.fill()}));function pv(e,t,n,r){return k(s=>w(()=>{s.fillRect(e,t,n,r)}))}const mv=(e,t,n,r)=>k(s=>w(()=>{typeof r<"u"?s.fillText(e,t,n,r):s.fillText(e,t,n)}));k(e=>w(()=>e.getLineDash()));k(e=>w(()=>e.getTransform()));const yv=(e,t)=>Lt(n=>{n.lineTo(e,t)});function _v(e,t){return k(n=>w(()=>{n.moveTo(e,t)}))}function vl(e,t,n,r){return k(s=>w(()=>{s.rect(e,t,n,r)}))}const bv=k(e=>w(()=>{e.restore()})),El=e=>k(t=>w(()=>{t.rotate(e)})),Sv=k(e=>w(()=>{e.save()})),vv=(e,t)=>k(n=>w(()=>{n.scale(e,t)}));function Ev(e){return k(t=>w(()=>{typeof e<"u"?t.stroke(e):t.stroke()}))}const wl=(e,t)=>k(n=>w(()=>{n.translate(e,t)})),wv=e=>c($o,et(e),Xn(gv())),kl=e=>c($o,et(e),Xn(Ev()));function Lt(e){return k(t=>w(()=>e(t)))}function ht(e){return BS(jS(Sv,t=>e,t=>bv))}function k(e){return Qn(gt,e)}const Io=hl,kv=RS,$v=FS;function Zi(e){const t=typeof e=="string"?Iv(e):e instanceof HTMLElement?Mv(e):Tv(e);return Yn(t)}function Iv(e){return Io(gt,Ov(e))}function Tv(e){return $v(gt,e)}function Mv(e){return Io(gt,ke(Tl(e),Il))}function Ov(e){return ke(Av(e),Il)}function Av(e){return c(w(()=>document.getElementById(e)),ke($l),ml(()=>new ko(`No such element with id ${e} exists`)),ke(Tl))}const $l=nt(hc,Eo);function Il(e){return c(w(()=>e.getContext("2d")),ke($l),ml(t=>new ko(`${e.id} is not an instance of HTMLCanvasElement`)))}const Tl=nt(Df(e=>e instanceof HTMLCanvasElement,()=>new ko("element is not an instance of HTMLCanvasElement")),US),Ml=Mt(),Cv=wo(_l(gt,e=>Pv(e)),Ml),Ol=Mt(),Rv=kv(Cv,Io(Ol,_l(Ml,e=>Fv(e))));function Fv(e){return function t(n){switch(n._tag){case"Arc":return e.arc(n.x,n.y,n.r,n.start,n.end,n.anticlockwise);case"Composite":return qS(n.shapes,r=>t(r));case"Ellipse":return e.ellipse(n.x,n.y,n.rx,n.ry,n.rotation,n.start,n.end,n.anticlockwise);case"Path":return c(n.points,zf(ys,([r,...s])=>JS(e.moveTo(r.x,r.y),DS(s,({x:o,y:i})=>e.lineTo(o,i)))),et(n.closed?e.closePath:ys()));case"Rect":return e.rect(n.x,n.y,n.width,n.height)}}}function Pv(e){const t=yl(gt,e);return{moveTo:nt(_v,t),lineTo:nt(yv,t),closePath:t(hv),ellipse:nt(dv,t),rect:nt(vl,t),arc:nt(uv,t),drawImage:nt(Sl,t)}}const Nv=bf,Lv=uc,To=e=>!e;Es.combine;Es.combine;ws.combine;ws.combine;cf.combine;af.combine;Nv.combineAll;Lv.combineAll;const xv={show:e=>[e.style,e.variant,e.weight].filter(D).map(wt(rn(""))).join(" ")},jv=nt(Uf,To),Dv={show:({fontFamily:e,size:t,fontOptions:n})=>[xv.show(n),`${t}px`,e].filter(jv).join(" ")},Al=Mt(),Kv=c(Ge(Ol),QS(Ge(gt)),zS(([e,t])=>Uv(e,t)),wo(Al));function qv(e){return c(Qn(Al,t=>t(e)),Yn(Kv),Yn(Rv))}function Uv(e,t){return n;function n(s){return yl(r(s),gt,t)}function r(s){switch(s._tag){case"Clipped":return ht(c($o,et(e(s.shape)),et(fv()),et(De(()=>n(s.drawing)))));case"Fill":return ht(c(Dt(s.style.color,nt(Ue,_s)),et(wv(e(s.shape)))));case"Many":return c(Ge(gt),Xn(KS(s.drawings,o=>n(o))));case"Outline":return c(Ge(gt),Xn(c(Nn([Dt(s.style.color,nt(Ue,bl)),Dt(s.style.lineWidth,sv),kl(e(s.shape))]),ht)));case"Rotate":return ht(c(El(s.angle),et(De(()=>n(s.drawing)))));case"Scale":return ht(c(vv(s.scaleX,s.scaleY),et(De(()=>n(s.drawing)))));case"Text":return c(Nn([rv(Dv.show(s.font)),Dt(s.style.color,nt(Ue,_s)),mv(s.text,s.x,s.y)]),ht,et(Ge(gt)));case"Translate":return ht(c(wl(s.translateX,s.translateY),et(De(()=>n(s.drawing)))));case"WithShadow":return ht(c(Nn([Dt(s.shadow.color,nt(Ue,iv)),Dt(s.shadow.blur,ov),Dt(s.shadow.offset,o=>c(cv(o.x),et(av(o.y))))]),et(De(()=>n(s.drawing)))));case"Image":return Sl(s.image,s.source.x,s.source.y)}}}const Dt=(e,t)=>c(Eo(e),ke(t),HS(ys)),jr=(e,t,n,r)=>({_tag:"Rect",x:e,y:t,width:n,height:r});rr({_tag:{combineAll:()=>"Path",combineMany:()=>"Path",combine:()=>"Path",empty:"Path"},closed:uc,points:mc()});const $n=mc(),Mo=()=>Tt(Lf(),v()),Oo=Mo(),Cl=Mo(),Wv=Mo(),tc=(e,t)=>({_tag:"Fill",shape:e,style:t}),ec=e=>({color:I(e)}),zv=(e,t)=>({_tag:"Outline",shape:e,style:t}),Gv=e=>({color:I(e),lineWidth:v()}),Ke=e=>({_tag:"Many",drawings:e});function Hv(e){return t=>({_tag:"Rotate",angle:e,drawing:t})}function Bv(e,t){return n=>({_tag:"Translate",translateX:e,translateY:t,drawing:n})}const Vv=qv;rr({color:Oo});rr({color:Oo,lineWidth:Cl});rr({color:Oo,blur:Cl,offset:Wv});const Rl=Tt(rt((e,t)=>e._tag==="Many"&&t._tag==="Many"?Ke($n.combineAll([e.drawings,t.drawings])):e._tag==="Many"?Ke($n.combineAll([e.drawings,[t]])):t._tag==="Many"?Ke($n.combineAll([[e],t.drawings])):Ke([e,t])),Ke($n.empty)),Jv=Rl.combineAll;Rl.combine;const bs=Mt(),Yv=xf(e=>e instanceof HTMLButtonElement),Qv=c(Eo(Yv(document.getElementById("restart"))),GS,wo(bs)),nc=e=>t=>w(()=>{t.disabled?t.addEventListener("click",e):t.removeEventListener("click",e),t.disabled=!t.disabled});function Fl(e){return WS(0,t=>t<=360,t=>t+5,t=>e(-t*Math.PI/180))}const Xv=gl([_s("magenta"),pv(-20,-20,40,40),bl(Ue(Zn(180,.5,.25,1))),kl(vl(-5,-5,10,10))]);function Zv(e){return ht(Nn([lv(-50,-50,100,100),El(e),Xv]))}const tE=ht(gl([wl(50,50),Fl(e=>pl(Zv(e),ao(16)))])),eE=Jv([tc(jr(-50,-50,100,100),ec(tv)),tc(jr(-20,-20,40,40),ec(Zn(-180,.5,.5,1))),zv(jr(-5,-5,10,10),Gv(Zn(-180,.5,.25,1)))]),nE=e=>c(eE,Hv(e),Bv(50,50)),rE=ht(Fl(e=>pl(Vv(nE(-e)),ao(16))));function Ss(){return c(Qn(bs,nc(Ss)),et(Zi("canvas2")(tE)),XS(Zi("canvas3")(rE)),et(Qn(bs,nc(Ss))),Yn(Qv),YS)}Ss();
