(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();const l=(e,t)=>function(){return arguments.length>=e?t.apply(this,arguments):n=>t(n,...arguments)},Q=e=>e,yn=e=>()=>e,ri=yn(!0),nr=yn(!1),Cc=yn(void 0),oi=Cc;function rt(e,t,n,s,r,o,i,a,u){switch(arguments.length){case 1:return e;case 2:return function(){return t(e.apply(this,arguments))};case 3:return function(){return n(t(e.apply(this,arguments)))};case 4:return function(){return s(n(t(e.apply(this,arguments))))};case 5:return function(){return r(s(n(t(e.apply(this,arguments)))))};case 6:return function(){return o(r(s(n(t(e.apply(this,arguments))))))};case 7:return function(){return i(o(r(s(n(t(e.apply(this,arguments)))))))};case 8:return function(){return a(i(o(r(s(n(t(e.apply(this,arguments))))))))};case 9:return function(){return u(a(i(o(r(s(n(t(e.apply(this,arguments)))))))))}}}function c(e,t,n,s,r,o,i,a,u){switch(arguments.length){case 1:return e;case 2:return t(e);case 3:return n(t(e));case 4:return s(n(t(e)));case 5:return r(s(n(t(e))));case 6:return o(r(s(n(t(e)))));case 7:return i(o(r(s(n(t(e))))));case 8:return a(i(o(r(s(n(t(e)))))));case 9:return u(a(i(o(r(s(n(t(e))))))));default:{let h=arguments[0];for(let f=1;f<arguments.length;f++)h=arguments[f](h);return h}}}function pe(e){return e==null}const ff=335903614,hf=4150755663,df=1481765933>>>0,gf=1284865837>>>0,pf=9007199254740992,mf=134217728;class Rc{constructor(t,n,s,r){return pe(n)&&pe(t)?(n=Math.random()*4294967295>>>0,t=0):pe(n)&&(n=t,t=0),pe(r)&&pe(s)?(r=this._state?this._state[3]:hf,s=this._state?this._state[2]:ff):pe(r)&&(r=s,s=0),this._state=new Int32Array([0,0,s>>>0,((r||0)|1)>>>0]),this._next(),ii(this._state,this._state[0],this._state[1],t>>>0,n>>>0),this._next(),this}getState(){return[this._state[0],this._state[1],this._state[2],this._state[3]]}setState(t){this._state[0]=t[0],this._state[1]=t[1],this._state[2]=t[2],this._state[3]=t[3]|1}integer(t){if(!t)return this._next();if(t=t>>>0,!(t&t-1))return this._next()&t-1;let n=0;const s=(-t>>>0)%t>>>0;for(n=this._next();n<s;n=this._next());return n%t}number(){const t=(this._next()&67108863)*1,n=(this._next()&134217727)*1;return(t*mf+n)/pf}_next(){const t=this._state[0]>>>0,n=this._state[1]>>>0;yf(this._state,t,n,df,gf),ii(this._state,this._state[0],this._state[1],this._state[2],this._state[3]);let s=t>>>18,r=(n>>>18|t<<14)>>>0;s=(s^t)>>>0,r=(r^n)>>>0;const o=(r>>>27|s<<5)>>>0,i=t>>>27,a=(-i>>>0&31)>>>0;return(o>>>i|o<<a)>>>0}}function yf(e,t,n,s,r){let o=(n>>>16)*(r&65535)>>>0,i=(n&65535)*(r>>>16)>>>0,a=(n&65535)*(r&65535)>>>0,u=(n>>>16)*(r>>>16)+((i>>>16)+(o>>>16))>>>0;i=i<<16>>>0,a=a+i>>>0,a>>>0<i>>>0&&(u=u+1>>>0),o=o<<16>>>0,a=a+o>>>0,a>>>0<o>>>0&&(u=u+1>>>0),u=u+Math.imul(n,s)>>>0,u=u+Math.imul(t,r)>>>0,e[0]=u,e[1]=a}function ii(e,t,n,s,r){let o=t+s>>>0;const i=n+r>>>0;i>>>0<n>>>0&&(o=o+1|0),e[0]=o,e[1]=i}const Gs=new WeakMap,_f=new Rc,A=Symbol.for("@effect/data/Hash"),_=e=>{switch(typeof e){case"number":return jr(e);case"bigint":return J(e.toString(10));case"boolean":return J(String(e));case"symbol":return J(String(e));case"string":return J(e);case"undefined":return J("undefined");case"function":case"object":return e===null?J("null"):bf(e)?e[A]():Fc(e);default:throw new Error("Bug in Equal.hashGeneric")}},Fc=e=>(Gs.has(e)||Gs.set(e,jr(_f.integer(Number.MAX_SAFE_INTEGER))),Gs.get(e)),M=e=>t=>t*53^e,fs=e=>e&3221225471|e>>>1&1073741824,bf=e=>typeof e=="object"&&e!==null&&A in e,jr=e=>{if(e!==e||e===1/0)return 0;let t=e|0;for(t!==e&&(t^=e*4294967295);e>4294967295;)t^=e/=4294967295;return fs(e)},J=e=>{let t=5381,n=e.length;for(;n;)t=t*33^e.charCodeAt(--n);return fs(t)},Sf=e=>{const t=Object.keys(e);let n=12289;for(let s=0;s<t.length;s++)n^=c(J(t[s]),M(_(e[t[s]])));return fs(n)},Pc=e=>{let t=6151;for(let n=0;n<e.length;n++)t=c(t,M(_(e[n])));return fs(t)},O=Symbol.for("@effect/data/Equal");function v(){return arguments.length===1?e=>ci(e,arguments[0]):ci(arguments[0],arguments[1])}function ci(e,t){if(e===t)return!0;const n=typeof e;return n!==typeof t?!1:(n==="object"||n==="function")&&e!==null&&t!==null&&ai(e)&&ai(t)?_(e)===_(t)&&e[O](t):!1}const ai=e=>typeof e=="object"&&e!==null&&O in e,vf=()=>(e,t)=>_(e)===_(t)&&v(e,t),$f=(()=>{const e={[A](){return Sf(this)},[O](t){const n=Object.keys(this),s=Object.keys(t);if(n.length!==s.length)return!1;for(const r of n)if(!(r in t&&v(this[r],t[r])))return!1;return!0}};return Object.setPrototypeOf(e,Object.prototype)})(),hs=e=>Ef(Object.assign({},e)),Ef=e=>Object.setPrototypeOf(e,$f),wf=e=>e._tag==="None",kf=e=>e._tag==="Some",If=hs({_tag:"None"}),Tf=e=>hs({_tag:"Some",value:e}),Mf=e=>e._tag==="Left",Af=e=>e._tag==="Right",Of=e=>hs({_tag:"Left",left:e}),Cf=e=>hs({_tag:"Right",right:e}),Rf=e=>e.length>0,ds=e=>Array.isArray(e)?e:Array.from(e),Ff=e=>t=>{const n=Object.keys(t);return e.imap(e.productAll(n.map(s=>t[s])),s=>{const r={};for(let o=0;o<s.length;o++)r[n[o]]=s[o];return r},s=>n.map(r=>s[r]))},ot=(e,t=(n,s)=>ds(s).reduce(e,n))=>({combine:e,combineMany:t}),Pf=ot((e,t)=>e+t),Nc=ot((e,t)=>e+t),Lc=ot((e,t)=>e*t,(e,t)=>{if(e===0)return 0;let n=e;for(const s of t){if(s===0)return 0;n=n*s}return n}),Dr=ot((e,t)=>e&&t,(e,t)=>{if(e===!1)return!1;for(const n of t)if(n===!1)return!1;return!0}),qr=ot((e,t)=>e||t,(e,t)=>{if(e===!0)return!0;for(const n of t)if(n===!0)return!0;return!1}),Nf=ot((e,t)=>e!==t),Lf=ot((e,t)=>e===t),xf=e=>ot(()=>e,()=>e),jf=l(3,(e,t,n)=>ot((s,r)=>t(e.combine(n(s),n(r))),(s,r)=>t(e.combineMany(n(s),ds(r).map(n))))),Df=(e,t)=>ot(([n,s],[r,o])=>[e.combine(n,r),t.combine(s,o)]),xc=e=>{const t=ds(e);return ot((n,s)=>{const r=Math.min(n.length,s.length,t.length),o=[];for(let i=0;i<r;i++)o.push(t[i].combine(n[i],s[i]));return o})},qf=(e,t)=>{const n=xc(t);return ot((s,r)=>[e.combine(s[0],r[0]),...n.combine(s.slice(1),r.slice(1))])},Kf=xf,Wf={of:Kf,imap:jf,product:Df,productMany:qf,productAll:xc},Uf=()=>ot((e,t)=>e.concat(t)),zf=Ff(Wf),Rt=(e,t)=>({combine:e.combine,combineMany:e.combineMany,empty:t,combineAll:n=>e.combineMany(t,n)}),Gf=Rt(Nc,0),Hf=Rt(Lc,1),Bf=Rt(Dr,!0),jc=Rt(qr,!1),Vf=()=>Rt(Uf(),[]),gs=e=>{const t={};for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n].empty);return Rt(zf(e),t)},Dc=e=>({compare:(t,n)=>t===n?0:e(t,n)}),qc=Dc((e,t)=>e<t?-1:1),Jf=l(2,(e,t)=>Dc((n,s)=>e.compare(t(n),t(s)))),Yf=e=>l(2,(t,n)=>e.compare(t,n)!==-1);qc.compare;const Qf=(e,t)=>e===t,Xf=()=>Qf,Zf=Xf();Nc.combine;Lc.combine;const Vn=qc,th=Gf,eh=Hf;th.combineAll;eh.combineAll;const nh=e=>l(3,(t,n,s)=>e(t,n)),sh=e=>()=>({combine:e.coproduct,combineMany:e.coproductMany}),S=()=>If,k=Tf,W=wf,q=kf,Kr=l(3,(e,t,n)=>W(e)?t():n(e.value)),At=l(2,(e,t)=>W(e)?t():e.value),rh=l(2,(e,t)=>W(e)?t():e),oh=e=>{let t=S();for(t of e)if(q(t))return t;return t},Kc=e=>e==null?S():k(e),me=At(Cc),Jt=l(2,(e,t)=>W(e)?S():k(t(e.value))),ih=nh(Jt),B$=l(2,(e,t)=>W(e)?S():t(e.value)),ch=(e,t)=>q(e)?e:t,ah=(e,t)=>q(e)?e:oh(t),uh={imap:ih,coproduct:ch,coproductMany:ah},lh=sh(uh),fh=e=>t=>e(t)?k(t):S(),hh=e=>l(2,(t,n)=>W(t)?!1:e(t.value,n)),ht=Cf,dt=Of,Xe=Mf,Ze=Af,V$=l(3,(e,t,n)=>Xe(e)?t(e.left):n(e.right)),dh=(e,t)=>n=>e(n)?ht(n):dt(t(n)),gh=Zf,ph=Pf;ph.combine;const mh=e=>e.length===0,Wc=(e,t)=>{const n=Math.max(1,Math.floor(e)),s=[t(0)];for(let r=1;r<n;r++)s.push(t(r));return s},yh=(e,t)=>e<=t?Wc(t-e+1,n=>e+n):[e],$e=ds,_h=l(3,(e,t,n)=>ee(e)?n(e):t()),te=l(2,(e,t)=>[t,...e]),bh=l(2,(e,t)=>[...e,t]),Sh=e=>e.length===0,Uc=Sh,ee=Rf,vh=(e,t)=>e<0||e>=t.length,zc=(e,t)=>Math.floor(Math.min(Math.max(0,e),t.length)),$h=l(2,(e,t)=>{const n=Math.floor(t);if(vh(n,e))throw new Error(`Index ${n} out of bounds`);return e[n]}),nt=$h(0),Ee=e=>e.slice(1),Eh=l(2,(e,t)=>{const n=$e(e);return n.slice(0,zc(t,n))}),wh=l(2,(e,t)=>{const n=$e(e);return n.slice(zc(t,n),n.length)}),kh=e=>Array.from(e).reverse(),Ih=l(2,(e,t)=>{const n=Array.from(e);return n.sort(t.compare),n}),Th=l(3,(e,t,n)=>{const s=$e(e),r=$e(t);return ee(s)&&ee(r)?Mh(r,n)(s):[]}),Mh=l(3,(e,t,n)=>{const s=[n(nt(e),nt(t))],r=Math.min(e.length,t.length);for(let o=1;o<r;o++)s[o]=n(e[o],t[o]);return s}),Ah=l(2,(e,t)=>{const n=$e(e);return ee(n)?Oh(t)(n):[]}),Oh=l(2,(e,t)=>{const n=[nt(e)],s=Ee(e);for(const r of s)n.every(o=>!t(r,o))&&n.push(r);return n}),Ch=()=>[],Gc=e=>[e],Wr=l(2,(e,t)=>e.map(t)),J$=l(2,(e,t)=>{if(Uc(e))return[];const n=[];for(let s=0;s<e.length;s++)n.push(...t(e[s],s));return n}),Hc=l(3,(e,t,n)=>$e(e).reduce((s,r,o)=>n(s,r,o),t)),Rh={reduce:Hc},Bc=Vf,Vc=Symbol.for("@effect/data/Chunk"),ui=[];function Fh(e,t,n,s,r){for(let o=t;o<Math.min(e.length,t+r);o++)n[s+o-t]=e[o];return n}class Z{constructor(t){switch(this.backing=t,this._id=Vc,t._tag){case"IEmpty":{this.length=0,this.depth=0,this.left=this,this.right=this;break}case"IConcat":{this.length=t.left.length+t.right.length,this.depth=1+Math.max(t.left.depth,t.right.depth),this.left=t.left,this.right=t.right;break}case"IArray":{this.length=t.array.length,this.depth=0,this.left=vt,this.right=vt;break}case"ISingleton":{this.length=1,this.depth=0,this.left=vt,this.right=vt;break}}}get array(){return this.toReadonlyArray()}toReadonlyArray(){switch(this.backing._tag){case"IEmpty":return ui;case"IArray":return this.backing.array;default:{const t=new Array(this.length);return sr(this,t,0),this.backing={_tag:"IArray",array:t},this.left=vt,this.right=vt,this.depth=0,t}}}toString(){return`Chunk(${this.toReadonlyArray().map(String).join(", ")})`}toJSON(){return{_tag:"Chunk",values:this.toReadonlyArray()}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}isNonEmpty(){return this.length>0}isEmpty(){return!this.isNonEmpty()}map(t){return this.backing._tag==="ISingleton"?K(t(this.backing.a)):z(Wr(t)(G(this)))}flatMap(t){if(this.backing._tag==="ISingleton")return t(this.backing.a);let n=vt;for(const s of this)n=U(t(s))(n);return n}forEach(t){return this.backing._tag==="ISingleton"?t(this.backing.a):G(this).forEach(t)}append(t){return this.concat(K(t))}prepend(t){return K(t).concat(this)}concat(t){if(this.backing._tag==="IEmpty")return t;if(t.backing._tag==="IEmpty")return this;const n=t.depth-this.depth;if(Math.abs(n)<=1)return new Z({_tag:"IConcat",left:this,right:t});if(n<-1)if(this.left.depth>=this.right.depth){const s=U(t)(this.right);return new Z({_tag:"IConcat",left:this.left,right:s})}else{const s=U(t)(this.right.right);if(s.depth===this.depth-3){const r=new Z({_tag:"IConcat",left:this.right.left,right:s});return new Z({_tag:"IConcat",left:this.left,right:r})}else{const r=new Z({_tag:"IConcat",left:this.left,right:this.right.left});return new Z({_tag:"IConcat",left:r,right:s})}}else if(t.right.depth>=t.left.depth){const s=U(t.left)(this);return new Z({_tag:"IConcat",left:s,right:t.right})}else{const s=U(t.left.left)(this);if(s.depth===t.depth-3){const r=new Z({_tag:"IConcat",left:s,right:t.left.right});return new Z({_tag:"IConcat",left:r,right:t.right})}else{const r=new Z({_tag:"IConcat",left:t.left.right,right:t.right});return new Z({_tag:"IConcat",left:s,right:r})}}}get(t){return t<0||t>=this.length?S():k(this.unsafeGet(t))}unsafeGet(t){switch(this.backing._tag){case"IEmpty":throw new Error("Index out of bounds");case"ISingleton":{if(t!==0)throw new Error("Index out of bounds");return this.backing.a}case"IArray":{if(t>=this.length||t<0)throw new Error("Index out of bounds");return this.backing.array[t]}case"IConcat":return t<this.left.length?this.left.unsafeGet(t):this.right.unsafeGet(t-this.left.length)}}[O](t){return Jc(t)&&this.length===t.length?G(this).every((n,s)=>v(n,t.unsafeGet(s))):!1}[A](){return Pc(G(this))}[Symbol.iterator](){switch(this.backing._tag){case"IArray":return this.backing.array[Symbol.iterator]();case"IEmpty":return ui[Symbol.iterator]();default:return G(this)[Symbol.iterator]()}}}const sr=(e,t,n)=>{switch(e.backing._tag){case"IArray":{Fh(e.backing.array,0,t,n,e.length);break}case"IConcat":{sr(e.left,t,n),sr(e.right,t,n+e.left.length);break}case"ISingleton":{t[n]=e.backing.a;break}}},Jc=e=>typeof e=="object"&&e!=null&&"_id"in e&&e._id===Vc,vt=new Z({_tag:"IEmpty"}),ct=()=>vt,ue=e=>Jc(e)?e:new Z({_tag:"IArray",array:Array.from(e)}),G=e=>e.toReadonlyArray(),Yc=l(2,(e,t)=>e.get(t)),z=e=>new Z({_tag:"IArray",array:e}),Ur=l(2,(e,t)=>e.unsafeGet(t)),Ph=l(2,(e,t)=>e.append(t)),gt=l(2,(e,t)=>e.prepend(t)),zr=l(2,(e,t)=>t<=0?vt:t>=e.length?e:z(Eh(t)(e.toReadonlyArray()))),Gr=l(2,(e,t)=>t<=0?e:t>=e.length?vt:z(wh(t)(e.toReadonlyArray()))),U=l(2,(e,t)=>e.concat(t)),Qc=e=>{const t=[];let n=S();for(const s of e)(W(n)||!v(s,n.value))&&(t.push(s),n=k(s));return z(t)},Y$=l(2,(e,t)=>G(e).every(n=>t(n))),be=Yc(0),ps=e=>e.isEmpty(),Dt=e=>e.isNonEmpty(),ne=l(3,(e,t,n)=>c(G(e),Hc(t,n))),Ce=l(2,(e,t)=>ne(e,"",(n,s)=>n.length>0?`${n}${t}${s}`:s)),Nh=e=>Yc(e,e.length-1),Lh=(...e)=>z(e),K=e=>new Z({_tag:"ISingleton",a:e}),xh=l(2,(e,t)=>Lh(...Wc(e,t))),Se=l(2,(e,t)=>e.map(t)),jh=l(2,(e,t)=>e.backing._tag==="ISingleton"?K(t(e.backing.a,0)):z(c(G(e),Wr(t)))),Q$=l(3,(e,t,n)=>{let s=t;const r=[];for(const o of G(e)){const i=n(s,o);s=i[0],r.push(i[1])}return[s,z(r)]}),Dh=(e,t)=>e<=t?xh(t-e+1,n=>e+n):K(e),Hr=e=>z(kh(G(e))),rr=l(2,(e,t)=>c(G(e),Ih(t),z)),qh=l(2,(e,t)=>[zr(t)(e),Gr(t)(e)]),Kh=l(2,(e,t)=>{let n=0;for(const s of G(e)){if(t(s))break;n++}return qh(n)(e)}),li=(e,t)=>{const n=[];let s=!0,r=e;for(;s;){const o=t(r);q(o)?(r=o.value[1],n.push(o.value[0])):s=!1}return z(n)},Wh=e=>z(Ah(vf())(G(e))),Jn=e=>Ur(0)(e),sn=e=>Ur(e.length-1)(e),fi=l(2,(e,t)=>Uh(e,t,(n,s)=>[n,s])),Uh=l(3,(e,t,n)=>{const s=G(e),r=G(t);return c(s,Th(r,n),z)}),se=Jn,Mt=e=>Gr(e,1),or=Symbol.for("@effect/data/Global/globalStoreId");or in globalThis||(globalThis[or]=new Map);const Hs=globalThis[or],zh=(e,t)=>(Hs.has(e)||Hs.set(e,t()),Hs.get(e)),Gh=Symbol.for("@effect/data/Context/Tag");class Hh{constructor(t){if(this._id=Gh,this._S=n=>n,typeof t<"u")return zh(t,()=>this)}}const Xc=Symbol.for("@effect/data/Context");class we{[O](t){if(Bh(t)&&this.unsafeMap.size===t.unsafeMap.size){for(const n of this.unsafeMap.keys())if(!t.unsafeMap.has(n)||!v(this.unsafeMap.get(n),t.unsafeMap.get(n)))return!1;return!0}return!1}[A](){return jr(this.unsafeMap.size)}constructor(t){this.unsafeMap=t,this._id=Xc,this._S=n=>n}}const Bh=e=>typeof e=="object"&&e!==null&&"_id"in e&&e._id===Xc,Vh=()=>new we(new Map),Jh=(e,t)=>new we(new Map([[e,t]])),Yh=l(3,(e,t,n)=>{const s=new Map(e.unsafeMap);return s.set(t,n),new we(s)}),Qh=l(2,(e,t)=>{if(!e.unsafeMap.has(t))throw new Error("Service not found");return e.unsafeMap.get(t)}),Xh=l(2,(e,t)=>{if(!e.unsafeMap.has(t))throw new Error("Service not found");return e.unsafeMap.get(t)}),Zh=l(2,(e,t)=>{const n=new Map(e.unsafeMap);for(const[s,r]of t.unsafeMap)n.set(s,r);return new we(n)}),Ft=e=>new Hh(e),Br=Vh,Vr=Jh,tn=Yh,td=Qh,Zc=Xh,Jr=Zh,_n=Symbol.for("@effect/data/Differ/ContextPatch");function kt(e){return e}let ed=class{constructor(){this._tag="Empty",this._Input=kt,this._Output=kt,this._id=_n}[A](){return J("ContextPatch(Empty)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id}},nd=class{constructor(t,n){this.first=t,this.second=n,this._tag="AndThen",this._id=_n,this._Input=kt,this._Output=kt}[A](){return J("ContextPatch(AndThen)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&v(this.first,t.first)&&v(this.second,t.second)}};class sd{constructor(t,n){this.tag=t,this.service=n,this._tag="AddService",this._id=_n,this._Input=kt,this._Output=kt}[A](){return J("ContextPatch(AddService)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&v(this.tag,t.tag)&&v(this.service,t.service)}}class rd{constructor(t){this.tag=t,this._tag="RemoveService",this._id=_n,this._Input=kt,this._Output=kt}[A](){return J("ContextPatch(RemoveService)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&v(this.tag,t.tag)}}class od{constructor(t,n){this.tag=t,this.update=n,this._tag="UpdateService",this._id=_n,this._Input=kt,this._Output=kt}[A](){return J("ContextPatch(AndThen)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&v(this.tag,t.tag)&&v(this.update,t.update)}}const ta=()=>new ed,id=(e,t)=>{const n=new Map(e.unsafeMap);let s=ta();for(const[r,o]of t.unsafeMap.entries())if(n.has(r)){const i=n.get(r);n.delete(r),v(i,o)||(s=qn(new od(r,()=>o))(s))}else n.delete(r),s=qn(new sd(r,o))(s);for(const[r]of n.entries())s=qn(new rd(r))(s);return s},qn=l(2,(e,t)=>new nd(e,t)),cd=l(2,(e,t)=>{let n=!1,s=K(e);const r=new Map(t.unsafeMap);for(;Dt(s);){const i=se(s),a=Mt(s);switch(i._tag){case"Empty":{s=a;break}case"AddService":{r.set(i.tag,i.service),s=a;break}case"AndThen":{s=gt(gt(a,i.second),i.first);break}case"RemoveService":{r.delete(i.tag),s=a;break}case"UpdateService":{r.set(i.tag,i.update(r.get(i.tag))),n=!0,s=a;break}}}if(!n)return new we(r);const o=new Map;for(const[i]of t.unsafeMap)r.has(i)&&(o.set(i,r.get(i)),r.delete(i));for(const[i,a]of r)o.set(i,a);return new we(o)}),ea=ta,ad=id,ud=qn,ld=cd,re=5,Yr=Math.pow(2,re),fd=Yr-1,hd=Yr/2,dd=Yr/4;function gd(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),e=e+(e>>4)&252645135,e+=e>>8,e+=e>>16,e&127}function ke(e,t){return t>>>e&fd}function _e(e){return 1<<e}function na(e,t){return gd(e&t-1)}function ve(e,t,n,s){let r=s;if(!e){const o=s.length;r=new Array(o);for(let i=0;i<o;++i)r[i]=s[i]}return r[t]=n,r}function sa(e,t,n){const s=n.length-1;let r=0,o=0,i=n;if(e)r=o=t;else for(i=new Array(s);r<t;)i[o++]=n[r++];for(++r;r<=s;)i[o++]=n[r++];return e&&(i.length=s),i}function pd(e,t,n,s){const r=s.length;if(e){let u=r;for(;u>=t;)s[u--]=s[u];return s[t]=n,s}let o=0,i=0;const a=new Array(r+1);for(;o<t;)a[i++]=s[o++];for(a[t]=n;o<r;)a[++i]=s[o++];return a}class md{constructor(t,n){this.value=t,this.previous=n}}class Ot{constructor(){this._tag="EmptyNode"}modify(t,n,s,r,o,i){const a=s(S());return W(a)?new Ot:(++i.value,new Yt(t,r,o,a))}}function $t(e){return e instanceof Ot}function yd(e){return $t(e)||e._tag==="LeafNode"||e._tag==="CollisionNode"}function ms(e,t){return $t(e)?!1:t===e.edit}class Yt{constructor(t,n,s,r){this.edit=t,this.hash=n,this.key=s,this.value=r,this._tag="LeafNode"}modify(t,n,s,r,o,i){if(v(o,this.key)){const u=s(this.value);return u===this.value?this:W(u)?(--i.value,new Ot):ms(this,t)?(this.value=u,this):new Yt(t,r,o,u)}const a=s(S());return W(a)?this:(++i.value,ra(t,n,this.hash,this,r,new Yt(t,r,o,a)))}}class Qr{constructor(t,n,s){this.edit=t,this.hash=n,this.children=s,this._tag="CollisionNode"}modify(t,n,s,r,o,i){if(r===this.hash){const u=ms(this,t),h=this.updateCollisionList(u,t,this.hash,this.children,s,o,i);return h===this.children?this:h.length>1?new Qr(t,this.hash,h):h[0]}const a=s(S());return W(a)?this:(++i.value,ra(t,n,this.hash,this,r,new Yt(t,r,o,a)))}updateCollisionList(t,n,s,r,o,i,a){const u=r.length;for(let f=0;f<u;++f){const d=r[f];if("key"in d&&v(i,d.key)){const m=d.value,b=o(m);return b===m?r:W(b)?(--a.value,sa(t,f,r)):ve(t,f,new Yt(n,s,i,b),r)}}const h=o(S());return W(h)?r:(++a.value,ve(t,u,new Yt(n,s,i,h),r))}}class Ie{constructor(t,n,s){this.edit=t,this.mask=n,this.children=s,this._tag="IndexedNode"}modify(t,n,s,r,o,i){const a=this.mask,u=this.children,h=ke(n,r),f=_e(h),d=na(a,f),m=a&f,b=ms(this,t);if(!m){const bt=new Ot().modify(t,n+re,s,r,o,i);return bt?u.length>=hd?bd(t,h,bt,a,u):new Ie(t,a|f,pd(b,d,bt,u)):this}const E=u[d],L=E.modify(t,n+re,s,r,o,i);if(E===L)return this;let j=a,it;if($t(L)){if(j&=~f,!j)return new Ot;if(u.length<=2&&yd(u[d^1]))return u[d^1];it=sa(b,d,u)}else it=ve(b,d,L,u);return b?(this.mask=j,this.children=it,this):new Ie(t,j,it)}}class Xr{constructor(t,n,s){this.edit=t,this.size=n,this.children=s,this._tag="ArrayNode"}modify(t,n,s,r,o,i){let a=this.size;const u=this.children,h=ke(n,r),f=u[h],d=(f||new Ot).modify(t,n+re,s,r,o,i);if(f===d)return this;const m=ms(this,t);let b;if($t(f)&&!$t(d))++a,b=ve(m,h,d,u);else if(!$t(f)&&$t(d)){if(--a,a<=dd)return _d(t,a,h,u);b=ve(m,h,new Ot,u)}else b=ve(m,h,d,u);return m?(this.size=a,this.children=b,this):new Xr(t,a,b)}}function _d(e,t,n,s){const r=new Array(t-1);let o=0,i=0;for(let a=0,u=s.length;a<u;++a)if(a!==n){const h=s[a];h&&!$t(h)&&(r[o++]=h,i|=1<<a)}return new Ie(e,i,r)}function bd(e,t,n,s,r){const o=[];let i=s,a=0;for(let u=0;i;++u)i&1&&(o[u]=r[a++]),i>>>=1;return o[t]=n,new Xr(e,a+1,o)}function Sd(e,t,n,s,r,o){if(n===r)return new Qr(e,n,[o,s]);const i=ke(t,n),a=ke(t,r);if(i===a)return u=>new Ie(e,_e(i)|_e(a),[u]);{const u=i<a?[s,o]:[o,s];return new Ie(e,_e(i)|_e(a),u)}}function ra(e,t,n,s,r,o){let i,a=t;for(;;){const u=Sd(e,a,n,s,r,o);if(typeof u=="function")i=new md(u,i),a=a+re;else{let h=u;for(;i!=null;)h=i.value(h),i=i.previous;return h}}}const oa=Symbol.for("@effect/data/HashMap");class Zr{constructor(t,n,s,r){this._editable=t,this._edit=n,this._root=s,this._size=r,this._id=oa}[Symbol.iterator](){return new ys(this,(t,n)=>[t,n])}[A](){let t=_("HashMap");for(const n of this)t^=M(_(n[0]))(_(n[1]));return t}[O](t){if($d(t)){if(t._size!==this._size)return!1;for(const n of this){const s=c(t,aa(n[0],_(n[0])));if(W(s))return!1;if(!v(n[1],s.value))return!1}return!0}return!1}toString(){return`HashMap(${Array.from(this).map(([t,n])=>`[${String(t)}, ${String(n)}]`).join(", ")})`}toJSON(){return{_tag:"HashMap",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}}class ys{constructor(t,n){this.map=t,this.f=n,this.v=ia(this.map._root,this.f,void 0)}next(){if(W(this.v))return{done:!0,value:void 0};const t=this.v.value;return this.v=Yn(t.cont),{done:!1,value:t.value}}[Symbol.iterator](){return new ys(this.map,this.f)}}const Yn=e=>e?ca(e[0],e[1],e[2],e[3],e[4]):S(),ia=(e,t,n=void 0)=>{switch(e._tag){case"LeafNode":return q(e.value)?k({value:t(e.key,e.value.value),cont:n}):Yn(n);case"CollisionNode":case"ArrayNode":case"IndexedNode":{const s=e.children;return ca(s.length,s,0,t,n)}default:return Yn(n)}},ca=(e,t,n,s,r)=>{for(;n<e;){const o=t[n++];if(o&&!$t(o))return ia(o,s,[e,t,n,s,r])}return Yn(r)},to=()=>new Zr(!1,0,new Ot,0),vd=e=>{const t=ua(to());for(const n of e)ir(n[0],n[1])(t);return Id(t)},$d=e=>typeof e=="object"&&e!=null&&"_id"in e&&e._id===oa,aa=l(3,(e,t,n)=>{let s=e._root,r=0;for(;;)switch(s._tag){case"LeafNode":return v(t,s.key)?s.value:S();case"CollisionNode":{if(n===s.hash){const o=s.children;for(let i=0,a=o.length;i<a;++i){const u=o[i];if("key"in u&&v(t,u.key))return u.value}}return S()}case"IndexedNode":{const o=ke(r,n),i=_e(o);if(s.mask&i){s=s.children[na(s.mask,i)],r+=re;break}return S()}case"ArrayNode":{if(s=s.children[ke(r,n)],s){r+=re;break}return S()}default:return S()}}),Ed=l(2,(e,t)=>q(aa(e,t,_(t)))),ir=l(3,(e,t,n)=>la(e,t,()=>k(n))),wd=l(3,(e,t,n)=>e._editable?(e._root=t,e._size=n,e):t===e._root?e:new Zr(e._editable,e._edit,t,n)),kd=e=>new ys(e,t=>t),Qn=e=>e._size,ua=e=>new Zr(!0,e._edit+1,e._root,e._size),Id=e=>(e._editable=!1,e),la=l(3,(e,t,n)=>Td(e,t,_(t),n)),Td=l(4,(e,t,n,s)=>{const r={value:e._size},o=e._root.modify(e._editable?e._edit:NaN,0,s,n,t,r);return c(e,wd(o,r.value))}),hi=l(2,(e,t)=>la(e,t,S)),Md=l(2,(e,t)=>fa(e,void 0,(n,s,r)=>t(s,r))),fa=l(3,(e,t,n)=>{const s=e._root;if(s._tag==="LeafNode")return q(s.value)?n(t,s.value.value,s.key):t;if(s._tag==="EmptyNode")return t;const r=[s.children];let o;for(;o=r.pop();)for(let i=0,a=o.length;i<a;){const u=o[i++];u&&!$t(u)&&(u._tag==="LeafNode"?q(u.value)&&(t=n(t,u.value.value,u.key)):r.push(u.children))}return t}),ha=Symbol.for("@effect/data/HashSet");class _s{constructor(t){this._keyMap=t,this._id=ha}[Symbol.iterator](){return kd(this._keyMap)}[A](){return M(_(this._keyMap))(_("HashSet"))}[O](t){return Ad(t)?Qn(this._keyMap)===Qn(t._keyMap)&&v(this._keyMap,t._keyMap):!1}toString(){return`HashSet(${Array.from(this).map(String).join(", ")})`}toJSON(){return{_tag:"HashSet",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}}const Ad=e=>typeof e=="object"&&e!=null&&"_id"in e&&e._id===ha,bs=()=>new _s(to()),Od=e=>{const t=eo(bs());for(const n of e)rn(t,n);return no(t)},Cd=(...e)=>{const t=eo(bs());for(const n of e)rn(t,n);return no(t)},Rd=l(2,(e,t)=>Ed(e._keyMap,t)),Fd=e=>Qn(e._keyMap),eo=e=>new _s(ua(e._keyMap)),no=e=>(e._keyMap._editable=!1,e),da=l(2,(e,t)=>{const n=eo(e);return t(n),no(n)}),rn=l(2,(e,t)=>e._keyMap._editable?(ir(t,!0)(e._keyMap),e):new _s(ir(t,!0)(e._keyMap))),ga=l(2,(e,t)=>e._keyMap._editable?(hi(t)(e._keyMap),e):new _s(hi(t)(e._keyMap))),Pd=l(2,(e,t)=>da(e,n=>{for(const s of t)ga(n,s)})),Nd=l(2,(e,t)=>da(bs(),n=>{pa(e,s=>rn(n,s));for(const s of t)rn(n,s)})),pa=l(2,(e,t)=>Md(e._keyMap,(n,s)=>t(s))),Ld=l(3,(e,t,n)=>fa(e._keyMap,t,(s,r,o)=>n(s,o))),ma=to,ya=vd,xd=Qn,It=bs,_a=Od,so=Cd,jd=Rd,ba=Fd,Lt=rn,Sa=ga,di=Pd,Te=Nd,Dd=pa,Xn=Ld,Ss=Symbol.for("@effect/data/Differ/HashSetPatch");function vs(e){return e}class qd{constructor(){this._tag="Empty",this._Value=vs,this._id=Ss}[A](){return J("HashSetPatch(Empty)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id}}class Kd{constructor(t,n){this.first=t,this.second=n,this._tag="AndThen",this._Value=vs,this._id=Ss}[A](){return J("HashSetPatch(AndThen)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&v(this.first,t.first)&&v(this.second,t.second)}}class Wd{constructor(t){this.value=t,this._tag="Add",this._Value=vs,this._id=Ss}[A](){return J("HashSetPatch(Add)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&v(this.value,t.value)}}class Ud{constructor(t){this.value=t,this._tag="Remove",this._Value=vs,this._id=Ss}[A](){return J("HashSetPatch(Remove)")}[O](t){return typeof t=="object"&&t!==null&&"_id"in t&&t._id===this._id&&"_tag"in t&&t._tag===this._id&&v(this.value,t.value)}}const va=()=>new qd,zd=(e,t)=>{const[n,s]=Xn([e,va()],([r,o],i)=>jd(i)(r)?[Sa(i)(r),o]:[r,cr(new Wd(i))(o)])(t);return Xn(s,(r,o)=>cr(new Ud(o))(r))(n)},cr=l(2,(e,t)=>new Kd(e,t)),Gd=l(2,(e,t)=>{let n=t,s=K(e);for(;Dt(s);){const r=se(s),o=Mt(s);switch(r._tag){case"Empty":{s=o;break}case"AndThen":{s=gt(r.first)(gt(r.second)(o));break}case"Add":{n=Lt(r.value)(n),s=o;break}case"Remove":n=Sa(r.value)(n),s=o}}return n}),$a=va,Hd=zd,Bd=cr,Vd=Gd,Jd=Symbol.for("@effect/data/Differ");class Yd{constructor(t){this._id=Jd,this._P=Q,this._V=Q,this.empty=t.empty,this.diff=t.diff,this.combine=t.combine,this.patch=t.patch}}const $s=e=>new Yd(e),Qd=()=>$s({empty:ea(),combine:(e,t)=>ud(t)(e),diff:(e,t)=>ad(e,t),patch:(e,t)=>ld(t)(e)}),Xd=()=>$s({empty:$a(),combine:(e,t)=>Bd(t)(e),diff:(e,t)=>Hd(e,t),patch:(e,t)=>Vd(t)(e)}),Zd=()=>tg((e,t)=>t),tg=e=>$s({empty:Q,combine:(t,n)=>t===Q?n:n===Q?t:s=>n(t(s)),diff:(t,n)=>v(t,n)?Q:yn(n),patch:(t,n)=>e(n,t(n))}),eg=l(3,(e,t,n)=>e.diff(t,n)),ng=l(3,(e,t,n)=>e.combine(t,n)),sg=l(3,(e,t,n)=>e.patch(t,n)),Ea=$s,rg=Qd,og=Xd,ig=Zd,cg=Symbol.for("@effect/data/MutableRef");class ag{constructor(t){this.current=t,this._T=n=>n,this._id=cg}get(){return this.current}set(t){return this.current=t,this}setAndGet(t){return this.current=t,this.current}getAndSet(t){const n=this.current;return this.current=t,n}compareAndSet(t,n){return v(t,this.current)?(this.current=n,!0):!1}pipe(t){return t(this)}update(t){return this.set(t(this.get()))}updateAndGet(t){return this.setAndGet(t(this.get()))}getAndUpdate(t){return this.getAndSet(t(this.get()))}toString(){return`MutableRef(${String(this.current)})`}toJSON(){return{_tag:"MutableRef",current:this.current}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}}const Re=e=>new ag(e),ug=l(3,(e,t,n)=>e.compareAndSet(t,n)),le=e=>e.current,lg=e=>e.getAndUpdate(t=>t+1),fe=l(2,(e,t)=>e.set(t)),fg=["All","Fatal","Error","Warning","Info","Debug","Trace","None"],Fe=e=>function(){if(Qt.tracingEnabled)return e.apply(this,arguments);Qt.tracingEnabled=!0;try{return e.apply(this,arguments)}finally{Qt.tracingEnabled=!1}},Pe=e=>function(){if(!Qt.tracingEnabled)return e.apply(this,arguments);Qt.tracingEnabled=!1;try{return e.apply(this,arguments)}finally{Qt.tracingEnabled=!0}},St=typeof process<"u"?process.env:void 0,Qt={minumumLogLevel:St&&St.EFFECT_LOG_LEVEL&&fg.includes(St.EFFECT_LOG_LEVEL)?St.EFFECT_LOG_LEVEL:"Info",traceStackLimit:St&&St.EFFECT_TRACING_STACK_LIMIT?Number.parseInt(St.EFFECT_TRACING_STACK_LIMIT):5,tracingEnabled:!(St&&St.EFFECT_TRACING_ENABLED&&St.EFFECT_TRACING_ENABLED==="false"),parseStack:e=>{const t=e.stack;if(t){const n=t.split(`
`);let s=0;for(let o=0;o<n.length;o++)n[o].startsWith("Error")&&(s=o);const r=[];for(let o=s+1;o<n.length;o++)if(n[o].includes("at")){const i=n[o].split(" ").filter(f=>f.length>0&&f!=="at"),a=i.length===2&&!i[0].includes("<anonymous>")?i[0]:void 0,h=(i.length===2?i[1]:i[0])?.match(/\(?(.*):(\d+):(\d+)/);h?r.push({name:a,fileName:h[1],line:Number.parseInt(h[2]),column:Number.parseInt(h[3])}):r.push(void 0)}else r.push(void 0);return r}return[]},filterStackFrame:e=>e!=null&&!e.fileName.match(/\/internal_effect_untraced/)},P=Qt,hg=Object.setPrototypeOf({toFrame(){if("parsed"in this)return this.parsed;const e=P.parseStack(this);return e&&e.length>=2&&e[0]&&e[1]?this.parsed={...e[this.depth-1],name:e[this.depth-2]?.name}:this.parsed=void 0,this.parsed}},Error.prototype),ro=e=>(e.depth=Error.stackTraceLimit,Object.setPrototypeOf(e,hg),e),D=e=>{if(!P.tracingEnabled)return e(void 0,Pe);P.tracingEnabled=!1;try{const t=Error.stackTraceLimit;Error.stackTraceLimit=3;const n=ro(new Error);return Error.stackTraceLimit=t,e(n,Fe)}finally{P.tracingEnabled=!0}},g=e=>function(){if(!P.tracingEnabled)return e(void 0,Pe).apply(this,arguments);P.tracingEnabled=!1;try{const t=Error.stackTraceLimit;Error.stackTraceLimit=2;const n=ro(new Error);return Error.stackTraceLimit=t,e(n,Fe).apply(this,arguments)}finally{P.tracingEnabled=!0}},y=(e,t)=>{const n=typeof e=="number"?s=>s.length===e:e;return function(){if(!P.tracingEnabled){const s=t(void 0,Pe);return n(arguments)?Y(()=>s.apply(this,arguments)):r=>Y(()=>s(r,...arguments))}P.tracingEnabled=!1;try{const s=Error.stackTraceLimit;Error.stackTraceLimit=2;const r=ro(new Error);Error.stackTraceLimit=s;const o=t(r,Fe);return n(arguments)?Y(()=>o.apply(this,arguments)):i=>Y(()=>o(i,...arguments))}finally{P.tracingEnabled=!0}}},Y=e=>{if(!P.tracingEnabled)return e(Pe);P.tracingEnabled=!1;try{return e(Fe)}finally{P.tracingEnabled=!0}},dg=(e,t)=>function(){if(!P.tracingEnabled){const n=t(Pe);return arguments.length===e?Y(()=>n.apply(this,arguments)):s=>Y(()=>n(s,...arguments))}P.tracingEnabled=!1;try{const n=t(Fe);return arguments.length===e?Y(()=>n.apply(this,arguments)):s=>Y(()=>n(s,...arguments))}finally{P.tracingEnabled=!0}},Es=e=>function(){if(!P.tracingEnabled)return Y(()=>e(Pe).apply(this,arguments));P.tracingEnabled=!1;try{return Y(()=>e(Fe).apply(this,arguments))}finally{P.tracingEnabled=!0}};var gi,pi,mi;const ws="@effect/io/Fiber/Id",oe=Symbol.for(ws),on="None",ar="Runtime",ur="Composite";let gg=class{constructor(){this[gi]=oe,this._tag=on}[(gi=oe,A)](){return c(_(ws),M(_(this._tag)))}[O](t){return oo(t)&&t._tag===on}};class pg{constructor(t,n){this.id=t,this.startTimeMillis=n,this[pi]=oe,this._tag=ar}[(pi=oe,A)](){return c(_(ws),M(_(this._tag)),M(_(this.id)),M(_(this.startTimeMillis)))}[O](t){return oo(t)&&t._tag===ar&&this.id===t.id&&this.startTimeMillis===t.startTimeMillis}}class mg{constructor(t,n){this.left=t,this.right=n,this[mi]=oe,this._tag=ur}[(mi=oe,A)](){return c(_(ws),M(_(this._tag)),M(_(this.left)),M(_(this.right)))}[O](t){return oo(t)&&t._tag===ur&&v(this.left,t.left)&&v(this.right,t.right)}}const yg=new gg,oo=e=>typeof e=="object"&&e!=null&&oe in e,_g=l(2,(e,t)=>e._tag===on?t:t._tag===on?e:new mg(e,t)),Zn=e=>{switch(e._tag){case on:return It();case ar:return so(e.id);case ur:return c(Zn(e.left),Te(Zn(e.right)))}},yi=Re(0),bg=e=>Array.from(Zn(e)).map(n=>`#${n}`).join(","),Sg=()=>{const e=le(yi);return c(yi,fe(e+1)),new pg(e,new Date().getTime())},qt=yg,vg=_g,$g=Zn,wa=Sg,cn=255,ka=8,lr=e=>e&cn,fr=e=>e>>ka&cn,bn=(e,t)=>(e&cn)+((t&e&cn)<<ka),Ia=bn(0,0),Eg=e=>bn(e,e),wg=e=>bn(e,0),kg=l(2,(e,t)=>bn(lr(e)&~t,fr(e))),Ig=l(2,(e,t)=>e|t),Tg=e=>~e>>>0&cn,Mg=0,Ne=1<<0,Ag=1<<1,Og=1<<2,hr=1<<4,Ta=1<<5,Cg=e=>Sn(e,Ta),Rg=l(2,(e,t)=>e|t),Bt=e=>Ma(e)&&!Ng(e),Ma=e=>Sn(e,Ne),Sn=l(2,(e,t)=>(e&t)!==0),Aa=(...e)=>e.reduce((t,n)=>t|n,0),Fg=Aa(Mg),Pg=e=>Sn(e,Ag),Bs=e=>Sn(e,Og),Ng=e=>Sn(e,hr),dr=l(2,(e,t)=>bn(e^t,t)),gr=l(2,(e,t)=>e&(Tg(lr(t))|fr(t))|lr(t)&fr(t)),Lg=()=>Ea({empty:Ia,diff:(e,t)=>dr(e,t),combine:(e,t)=>Ig(t)(e),patch:(e,t)=>gr(t,e)}),xg=Ia,jg=Eg,Oa=wg,_i=kg,Le="Die",ie="Empty",vn="Fail",$n="Interrupt",ce="Annotated",Me="Parallel",Ae="Sequential";var Ca;const Ra="@effect/io/Cause",Fa=Symbol.for(Ra),Dg={_E:e=>e},he={[Fa]:Dg,[A](){return c(_(Ra),M(_(Vg(this))))},[O](e){return qg(e)&&Bg(this,e)}},Ct=(()=>{const e=Object.create(he);return e._tag=ie,e})(),xe=e=>{const t=Object.create(he);return t._tag=vn,t.error=e,t},Et=e=>{const t=Object.create(he);return t._tag=Le,t.defect=e,t},Xt=e=>{const t=Object.create(he);return t._tag=$n,t.fiberId=e,t},an=(e,t)=>{const n=Object.create(he);return n._tag=ce,n.cause=e,n.annotation=t,n},Tt=(e,t)=>{const n=Object.create(he);return n._tag=Me,n.left=e,n.right=t,n},tt=(e,t)=>{const n=Object.create(he);return n._tag=Ae,n.left=e,n.right=t,n},qg=e=>typeof e=="object"&&e!=null&&Fa in e,Kg=e=>e._tag===ie,eE=e=>e._tag===Le,Wg=e=>e._tag===ce,Ug=e=>e._tag===ie?!0:ln(e,!0,(t,n)=>{switch(n._tag){case ie:return k(t);case Le:case vn:case $n:return k(!1);default:return S()}}),Pa=e=>ks(void 0,Xg)(e),zg=e=>Hr(ln(e,ct(),(t,n)=>n._tag===Le?k(c(t,gt(n.defect))):S())),Na=e=>ln(e,It(),(t,n)=>n._tag===$n?k(c(t,Lt(n.fiberId))):S()),La=e=>Qg(e,t=>t._tag===vn?k(t.error):S()),xa=e=>{const t=La(e);switch(t._tag){case"None":return ht(e);case"Some":return dt(t.value)}},Gg=e=>io(e,S(),()=>S(),t=>k(Et(t)),()=>S(),(t,n)=>c(t,Jt(s=>an(s,n))),(t,n)=>q(t)&&q(n)?k(tt(t.value,n.value)):q(t)&&W(n)?k(t.value):W(t)&&q(n)?k(n.value):S(),(t,n)=>q(t)&&q(n)?k(Tt(t.value,n.value)):q(t)&&W(n)?k(t.value):W(t)&&q(n)?k(n.value):S()),un=e=>io(e,Ct,()=>Ct,t=>Et(t),t=>Xt(t),(t,n)=>Kg(t)?t:an(t,n),(t,n)=>tt(t,n),(t,n)=>Tt(t,n)),nE=l(2,(e,t)=>Hg(e,n=>xe(t(n)))),Hg=l(2,(e,t)=>io(e,Ct,n=>t(n),n=>Et(n),n=>Xt(n),(n,s)=>an(n,s),(n,s)=>tt(n,s),(n,s)=>Tt(n,s))),Bg=(e,t)=>{let n=K(e),s=K(t);for(;Dt(n)&&Dt(s);){const[r,o]=c(se(n),ln([It(),ct()],([u,h],f)=>{const[d,m]=pr(f);return k([c(u,Te(d)),c(h,U(m))])})),[i,a]=c(se(s),ln([It(),ct()],([u,h],f)=>{const[d,m]=pr(f);return k([c(u,Te(d)),c(h,U(m))])}));if(!v(r,i))return!1;n=o,s=a}return!0},Vg=e=>Jg(K(e),ct()),Jg=(e,t)=>{for(;;){const[n,s]=c(e,ne([It(),ct()],([o,i],a)=>{const[u,h]=pr(a);return[c(o,Te(u)),c(i,U(h))]})),r=ba(n)>0?c(t,gt(n)):t;if(ps(s))return Hr(r);e=s,t=r}throw new Error("BUG: Cause.flattenCauseLoop - please report an issue at https://github.com/Effect-TS/io/issues")},Yg=l(2,(e,t)=>{const n=c(e,La,Jt(t));switch(n._tag){case"None":return c(zg(e),be,Kr(()=>{const s=Array.from(Na(e)).flatMap(r=>Array.from($g(r)).map(o=>`#${o}`));return tp(s?`Interrupted by fibers: ${s.join(", ")}`:void 0)},Q));case"Some":return n.value}}),Qg=l(2,(e,t)=>{const n=[e];for(;n.length>0;){const s=n.pop(),r=t(s);switch(r._tag){case"None":{switch(s._tag){case Ae:case Me:{n.push(s.right),n.push(s.left);break}case ce:{n.push(s.cause);break}}break}case"Some":return r}}return S()}),pr=e=>{let t=e;const n=[];let s=It(),r=ct();for(;t!==void 0;)switch(t._tag){case ie:{if(n.length===0)return[s,r];t=n.pop();break}case vn:{if(n.length===0)return[c(s,Lt(t.error)),r];s=c(s,Lt(t.error)),t=n.pop();break}case Le:{if(n.length===0)return[c(s,Lt(t.defect)),r];s=c(s,Lt(t.defect)),t=n.pop();break}case $n:{if(n.length===0)return[c(s,Lt(t.fiberId)),r];s=c(s,Lt(t.fiberId)),t=n.pop();break}case ce:{t=t.cause;break}case Ae:{switch(t.left._tag){case ie:{t=t.right;break}case Ae:{t=tt(t.left.left,tt(t.left.right,t.right));break}case Me:{t=Tt(tt(t.left.left,t.right),tt(t.left.right,t.right));break}case ce:{t=tt(t.left.cause,t.right);break}default:{r=c(r,gt(t.right)),t=t.left;break}}break}case Me:{n.push(t.right),t=t.left;break}}throw new Error("BUG: Cause.evaluateCauseLoop - please report an issue at https://github.com/Effect-TS/io/issues")},Xg={emptyCase:ri,failCase:nr,dieCase:nr,interruptCase:ri,annotatedCase:(e,t)=>t,sequentialCase:(e,t,n)=>t&&n,parallelCase:(e,t,n)=>t&&n},bi="SequentialCase",Si="ParallelCase",vi="AnnotatedCase",io=l(8,(e,t,n,s,r,o,i,a)=>ks(e,void 0,{emptyCase:()=>t,failCase:(u,h)=>n(h),dieCase:(u,h)=>s(h),interruptCase:(u,h)=>r(h),annotatedCase:(u,h,f)=>o(h,f),sequentialCase:(u,h,f)=>i(h,f),parallelCase:(u,h,f)=>a(h,f)})),ln=l(3,(e,t,n)=>{let s=t,r=e;const o=[];for(;r!==void 0;){const i=n(s,r);switch(s=q(i)?i.value:s,r._tag){case Ae:{o.push(r.right),r=r.left;break}case Me:{o.push(r.right),r=r.left;break}case ce:{r=r.cause;break}default:{r=void 0;break}}r===void 0&&o.length>0&&(r=o.pop())}return s}),ks=l(3,(e,t,n)=>{const s=[e],r=[];for(;s.length>0;){const i=s.pop();switch(i._tag){case ie:{r.push(ht(n.emptyCase(t)));break}case vn:{r.push(ht(n.failCase(t,i.error)));break}case Le:{r.push(ht(n.dieCase(t,i.defect)));break}case $n:{r.push(ht(n.interruptCase(t,i.fiberId)));break}case ce:{s.push(i.cause),r.push(dt({_tag:vi,annotation:i.annotation}));break}case Ae:{s.push(i.right),s.push(i.left),r.push(dt({_tag:bi}));break}case Me:{s.push(i.right),s.push(i.left),r.push(dt({_tag:Si}));break}}}const o=[];for(;r.length>0;){const i=r.pop();switch(i._tag){case"Left":{switch(i.left._tag){case bi:{const a=o.pop(),u=o.pop(),h=n.sequentialCase(t,a,u);o.push(h);break}case Si:{const a=o.pop(),u=o.pop(),h=n.parallelCase(t,a,u);o.push(h);break}case vi:{const a=o.pop(),u=n.annotatedCase(t,a,i.left.annotation);o.push(u);break}}break}case"Right":{o.push(i.right);break}}}if(o.length===0)throw new Error("BUG: Cause.reduceWithContext - please report an issue at https://github.com/Effect-TS/io/issues");return o.pop()}),co=(e,t)=>{const n={value:t,enumerable:!0},s={...e,toString(){return`${this._tag}: ${this.message}`}};return r=>Object.create(s,{_tag:n,message:{value:r,enumerable:!0}})},$i=Symbol.for("@effect/io/Cause/errors/RuntimeException"),Zg=co({[$i]:$i},"RuntimeException"),mr=Symbol.for("@effect/io/Cause/errors/InterruptedException"),tp=co({[mr]:mr},"InterruptedException"),ep=e=>typeof e=="object"&&e!=null&&mr in e,Ei=Symbol.for("@effect/io/Cause/errors/IllegalArgument"),np=co({[Ei]:Ei},"IllegalArgumentException"),ao=Symbol.for("@effect/io/Cause/StackAnnotation");class yr{constructor(t,n){this.stack=t,this.seq=n,this[Ca]=ao}}Ca=ao;const sp=Re(0),ja=e=>typeof e=="object"&&e!=null&&ao in e,rp=()=>({emptyCase:()=>Ct,failCase:(e,t)=>xe(t),dieCase:(e,t)=>Et(t),interruptCase:(e,t)=>Xt(t),annotatedCase:(e,t,n)=>t,sequentialCase:(e,t,n)=>tt(t,n),parallelCase:(e,t,n)=>Tt(t,n)}),sE=e=>ks(e,void 0,rp()),En="Pending",uo="Done",op="@effect/io/Deferred",ip=Symbol.for(op),cp={_E:e=>e,_A:e=>e},lo=e=>({_tag:En,joiners:e}),Da=e=>({_tag:uo,effect:e}),Kn="Async",ap="Commit",H="Failure",Wn="OnFailure",ts="OnSuccess",es="OnSuccessAndFailure",Un="OpTraced",B="Success",qa="Sync",wn="UpdateRuntimeFlags",ns="While",Ka="WithRuntime",zn="Yield",fo="RevertFlags";class up{constructor(){this.running=!1,this.tasks=[]}get preferredExecution(){return"Async"}starveInternal(t){const n=this.tasks;this.tasks=[];for(let s=0;s<n.length;s++)n[s]();this.tasks.length===0?this.running=!1:this.starve(t)}starve(t=0){t>=2048?setTimeout(()=>this.starveInternal(0),0):Promise.resolve(void 0).then(()=>this.starveInternal(t+1))}scheduleTask(t){this.tasks.push(t),this.running||(this.running=!0,this.starve())}}const lp=new up,fp="@effect/io/Effect/Error",_r=Symbol.for(fp),hp=e=>typeof e=="object"&&e!=null&&_r in e,dp=e=>({[_r]:_r,_tag:"EffectError",cause:e}),Wa=Symbol.for("@effect/io/Effect");class gp{constructor(t){this.patch=t,this._tag=fo}}const pp={_R:e=>e,_E:e=>e,_A:e=>e},X={[Wa]:pp,[O](e){return this===e},[A](){return Fc(this)},traced(e){if(e){const t=Object.create(X);return t._tag=Un,t.self=this,t.trace=e,t}return this}},wi=e=>typeof e=="object"&&e!=null&&Wa in e,ho=y(3,(e,t)=>(n,s,r)=>_t(o=>c(n,p(i=>c(C(()=>o(t(s)(i))),Zt,p(a=>c(C(()=>t(r)(i,a)),st(u=>{switch(a._tag){case H:return x(Tt(a.cause,u));case B:return x(u)}},()=>a))))))).traced(e)),lt=y(2,e=>(t,n)=>c(t,p(()=>I(n))).traced(e)),at=g(e=>t=>c(t,lt(void 0)).traced(e)),Is=g(e=>(t,n=qt)=>{const s=Object.create(X);return s._tag=Kn,s.register=t,s.blockingOn=n,s.trace=void 0,e?s.traced(e):s}),Ts=g((e,t)=>(n,s=qt)=>C(()=>{let r=R();return c(Is(o=>{const i=t(n)(o);Ze(i)?o(i.right):r=i.left},s),yo(()=>r))}).traced(e)),mp=g((e,t)=>(n,s=qt)=>C(()=>{let r=R();return c(Is(o=>{r=t(n)(o)},s),yo(()=>r))}).traced(e)),yp=y(2,(e,t)=>(n,s)=>{const r=Object.create(X);return r._tag=Wn,r.first=n,r.failK=t(s),r.trace=void 0,e?r.traced(e):r}),ki=y(2,(e,t)=>(n,s)=>c(n,As(t(s),I)).traced(e)),Ua=g(e=>t=>x(Et(t)).traced(e)),_p=g((e,t)=>n=>po(()=>Et(t(n)())).traced(e)),za=g(e=>t=>C(()=>t).traced(e)),Ii=g(e=>t=>c(t,As(n=>I(dt(n)),n=>I(ht(n)))).traced(e)),go=g(e=>()=>C(()=>Fs(Tn)).traced(e)),Ga=g((e,t)=>n=>c(go(),p(t(n))).traced(e)),Zt=g(e=>t=>c(t,Ba(x,I)).traced(e)),mt=g(e=>t=>x(xe(t)).traced(e)),bp=g((e,t)=>n=>po(()=>xe(t(n)())).traced(e)),x=g(e=>t=>{const n=Object.create(X);return n._tag=H,n.cause=t,n.trace=void 0,e?n.traced(e):n}),po=g((e,t)=>n=>c(T(t(n)),p(x)).traced(e)),mo=g(e=>()=>ft(t=>I(t.id())).traced(e)),Ha=g((e,t)=>n=>ft(s=>t(n)(s.id())).traced(e)),p=y(2,(e,t)=>(n,s)=>{const r=Object.create(X);return r._tag=ts,r.first=n,r.successK=t(s),r.trace=void 0,e?r.traced(e):r}),Ms=g(e=>t=>c(t,p(Q)).traced(e)),Ba=y(3,(e,t)=>(n,s,r)=>c(n,st(o=>I(t(s)(o)),o=>I(t(r)(o)))).traced(e)),st=y(3,(e,t)=>(n,s,r)=>{const o=Object.create(X);return o._tag=es,o.first=n,o.failK=t(s),o.successK=t(r),o.trace=void 0,e?o.traced(e):o}),As=y(3,(e,t)=>(n,s,r)=>st(n,o=>{const i=xa(o);switch(i._tag){case"Left":return t(s)(i.left);case"Right":return t(x)(i.right)}},r).traced(e)),wt=y(2,(e,t)=>(n,s)=>C(()=>{const r=Array.from(n),o=new Array(r.length);let i=0;return c(_o(()=>i<r.length,()=>t(s)(r[i]),a=>{o[i++]=a}),lt(z(o)))}).traced(e)),Os=y(2,(e,t)=>(n,s)=>C(()=>{const r=Array.from(n);let o=0;return _o(()=>o<r.length,()=>t(s)(r[o++]),()=>{})}).traced(e)),Va=g(e=>t=>{switch(t._tag){case"None":return mt(S()).traced(e);case"Some":return I(t.value).traced(e)}}),xt=g(e=>t=>{switch(t._tag){case"Left":return mt(t.left).traced(e);case"Right":return I(t.right).traced(e)}}),Sp=g(e=>()=>c(mo(),p(t=>vp(t))).traced(e)),vp=g(e=>t=>x(Xt(t)).traced(e)),ss=g(e=>t=>{const n=Object.create(X);return n._tag=wn,n.update=jg(Ne),n.scope=()=>t,n.trace=void 0,e?n.traced(e):n}),$p=y(2,e=>(t,n)=>_t(s=>c(s(t),Zt,p(r=>em(n,r)))).traced(e)),N=y(2,(e,t)=>(n,s)=>c(n,p(r=>T(()=>t(s)(r)))).traced(e)),fn=y(2,(e,t)=>(n,s)=>st(n,r=>{const o=xa(r);switch(o._tag){case"Left":return bp(()=>t(s)(o.left));case"Right":return x(o.right)}},I).traced(e)),Ep=g(e=>()=>Ts(()=>{const t=setInterval(()=>{},2147483647);return dt(T(()=>clearInterval(t)))}).traced(e)),hn=y(2,(e,t)=>(n,s)=>_t(r=>st(r(n),o=>{const i=V(o);return c(t(s)(i),st(a=>V(tt(o,a)),()=>i))},o=>{const i=Pt(o);return c(t(s)(i),et(i))})).traced(e)),yo=y(2,(e,t)=>(n,s)=>hn(n,Ps(r=>Pa(r)?at(t(s)(Na(r))):R(),()=>R())).traced(e)),wp=y(2,(e,t)=>(n,s)=>c(n,Mp(t(s),I)).traced(e)),kp=g(e=>t=>Ip(t,Q).traced(e)),Ip=y(2,(e,t)=>(n,s)=>c(n,As(r=>Ua(t(s)(r)),I)).traced(e)),je=y(2,e=>(t,n)=>c(t,$o(Tn,n)).traced(e)),Ja=y(2,(e,t)=>(n,s)=>Ga(r=>c(n,je(t(s)(r)))).traced(e)),Ya=g(e=>t=>Cs(t,I).traced(e)),Tp=g((e,t)=>(n,s)=>Cs(n,r=>T(()=>t(s)(r))).traced(e)),Cs=g((e,t)=>(n,s)=>C(()=>c(Fs(Tn),p(r=>t(s)(c(r,Zc(n)))))).traced(e)),I=g(e=>t=>{const n=Object.create(X);return n._tag=B,n.value=t,n.trace=void 0,e?n.traced(e):n}),C=g((e,t)=>n=>c(T(t(n)),p(Q)).traced(e)),T=g((e,t)=>n=>{const s=Object.create(X);return s._tag=qa,s.evaluate=t(n),s.trace=void 0,e?s.traced(e):s}),De=y(2,(e,t)=>(n,s)=>c(n,p(r=>c(t(s)(r),lt(r)))).traced(e)),Qa=g((e,t)=>n=>ft(s=>{const r=s.getFiberRef(gn),o=c(r,At(()=>s.scope()));return t(n)($o(gn,k(o)))}).traced(e)),Mp=y(3,(e,t)=>(n,s,r)=>st(n,o=>{const i=Gg(o);switch(i._tag){case"None":return t(s)();case"Some":return x(i.value)}},t(r)).traced(e)),Rs=g(e=>t=>{const n=Object.create(X);return n._tag=wn,n.update=Oa(Ne),n.scope=()=>t,n.trace=void 0,e?n.traced(e):n}),_t=g((e,t)=>n=>{const s=Object.create(X);return s._tag=wn,s.update=Oa(Ne),s.scope=r=>Ma(r)?t(n)(ss):t(n)(Rs),s.trace=void 0,e?s.traced(e):s}),R=g(e=>t=>I(void 0).traced(e)),Ap=g(e=>t=>{const n=Object.create(X);return n._tag=wn,n.update=t,n.scope=void 0,n.trace=void 0,e?n.traced(e):n}),Op=y(2,e=>(t,n)=>c(n,p(s=>s?c(t,N(k)):I(S()))).traced(e)),_o=g((e,t)=>(n,s,r)=>{const o=Object.create(X);return o._tag=ns,o.check=t(n),o.body=t(s),o.process=t(r),o.trace=void 0,e?o.traced(e):o}),ft=g((e,t)=>n=>{const s=Object.create(X);return s._tag=Ka,s.withRuntime=t(n),s.trace=void 0,e?s.traced(e):s}),Cp=y(2,e=>(t,n)=>C(()=>$o(wo,k(n))(t)).traced(e)),bo=g(e=>(t="normal")=>{const n=Object.create(X);return n._tag=zn,n.priority=t,n.trace=void 0,e?n.traced(e):n}),dn=y(2,e=>(t,n)=>p(t,s=>N(n,r=>[s,r])).traced(e)),kn=y(2,e=>(t,n)=>p(t,s=>lt(n,s)).traced(e)),et=y(2,e=>(t,n)=>p(t,()=>n).traced(e)),So=y(3,(e,t)=>(n,s,r)=>p(n,o=>N(s,i=>t(r)(o,i))).traced(e)),qe=g(e=>t=>c(mo(),p(n=>c(t,Xa(n)))).traced(e)),Xa=y(2,e=>(t,n)=>c(t.interruptAsFork(n),p(()=>t.await())).traced(e)),Rp={_tag:"All",syslog:0,label:"ALL",ordinal:Number.MIN_SAFE_INTEGER},Fp={_tag:"Fatal",syslog:2,label:"FATAL",ordinal:5e4},Pp={_tag:"Error",syslog:3,label:"ERROR",ordinal:4e4},Np={_tag:"Warning",syslog:4,label:"WARN",ordinal:3e4},Za={_tag:"Info",syslog:6,label:"INFO",ordinal:2e4},Lp={_tag:"Debug",syslog:7,label:"DEBUG",ordinal:1e4},xp={_tag:"Trace",syslog:7,label:"TRACE",ordinal:0},jp={_tag:"None",syslog:7,label:"OFF",ordinal:Number.MAX_SAFE_INTEGER},Dp="@effect/io/FiberRef",qp=Symbol.for(Dp),Kp={_A:e=>e},Fs=g(e=>t=>tu(t,n=>[n,n]).traced(e)),vo=y(2,(e,t)=>(n,s)=>p(Fs(n),t(s)).traced(e)),Ti=y(2,e=>(t,n)=>tu(t,()=>[void 0,n]).traced(e)),tu=y(2,(e,t)=>(n,s)=>ft(r=>{const[o,i]=t(s)(r.getFiberRef(n));return r.setFiberRef(n,i),I(o)}).traced(e)),$o=y(3,e=>(t,n,s)=>ho(kn(Fs(n),Ti(n,s)),()=>t,r=>Ti(n,r)).traced(e)),Kt=(e,t=Q,n=(s,r)=>r)=>In(e,ig(),t,n),eu=e=>In(e,og(),$a()),nu=e=>In(e,rg(),ea()),In=(e,t,n,s=(r,o)=>o)=>({[qp]:Kp,initial:e,diff:(r,o)=>c(t,eg(r,o)),combine:(r,o)=>c(t,ng(r,o)),patch:r=>o=>c(t,sg(r,o)),fork:n,join:s}),Wp=e=>In(e,Lg(),xg),Tn=nu(Br()),Up=Kt(ma()),zp=Kt(Za),Gp=Kt(ct()),Eo=Kt(lp),wo=Kt(S()),Vs=eu(It()),gn=Kt(S(),()=>S(),(e,t)=>e),Nn=Kt(Ct,()=>Ct,(e,t)=>e),Mi=Symbol.for("@effect/io/Scope"),Ai=Symbol.for("@effect/io/CloseableScope"),rE=g(e=>(t,n)=>t.addFinalizer(()=>at(n)).traced(e)),rs=g((e,t)=>(n,s)=>n.addFinalizer(t(s)).traced(e)),os=g(e=>(t,n)=>t.close(n).traced(e)),oE=g(e=>(t,n)=>t.fork(n).traced(e)),Oi=y(2,(e,t)=>(n,s)=>c(n,Bp(t(s)),N(Kr(()=>()=>R(),r=>o=>Hp(r,o)(n)))).traced(e)),Hp=y(3,e=>(t,n,s)=>C(()=>{switch(t.state._tag){case"Exited":return R();case"Running":{const r=t.state.finalizers.get(n);return t.state.finalizers.delete(n),r!=null?t.state.update(r)(s):R()}}}).traced(e)),Bp=y(2,(e,t)=>(n,s)=>C(()=>{switch(n.state._tag){case"Exited":return n.state.nextKey+=1,c(t(s)(n.state.exit),lt(S()));case"Running":{const r=n.state.nextKey;return n.state.finalizers.set(r,s),n.state.nextKey+=1,I(k(r))}}}).traced(e)),Vp=g(e=>()=>T(()=>({state:{_tag:"Running",nextKey:0,finalizers:new Map,update:Q}})).traced(e)),su=e=>e._tag==="Failure",Jp=e=>e._tag==="Success",Yp=l(2,(e,t)=>{switch(e._tag){case H:return e;case B:return Pt(t)}}),Js=e=>Yp(e,void 0),ru=e=>cu(e,tt),br=e=>cu(e,Tt),ou=e=>V(xe(e)),V=e=>{const t=Object.create(X);return t._tag=H,t.cause=e,t.trace=void 0,t},Qp=l(2,(e,t)=>{switch(e._tag){case H:return e;case B:return t(e.value)}}),Xp=e=>c(e,Qp(Q)),Sr=l(2,(e,t)=>{switch(e._tag){case H:return e;case B:return Pt(t(e.value))}}),Ps=l(3,(e,t,n)=>{switch(e._tag){case H:return t(e.cause);case B:return n(e.value)}}),iu=l(3,(e,t,n)=>{switch(e._tag){case H:return t(e.cause);case B:return n(e.value)}}),Pt=e=>{const t=Object.create(X);return t._tag=B,t.value=e,t.trace=void 0,t},jt=()=>Pt(void 0),Zp=l(2,(e,t)=>ko(e,t,(n,s)=>s,tt)),ko=l(4,(e,t,n,s)=>{switch(e._tag){case H:switch(t._tag){case B:return e;case H:return V(s(e.cause,t.cause))}case B:switch(t._tag){case B:return Pt(n(e.value,t.value));case H:return t}}}),cu=(e,t)=>{const n=ue(e);return Dt(n)?c(Mt(n),ne(c(se(n),Sr(K)),(s,r)=>c(s,ko(r,(o,i)=>c(o,gt(i)),t))),Sr(Hr),k):S()},Ns=e=>({[ip]:cp,state:Re(lo([])),blockingOn:e}),Io=g(e=>()=>c(mo(),p(t=>tm(t))).traced(e)),tm=g(e=>t=>T(()=>Ns(t)).traced(e)),Mn=g(e=>t=>Ts(n=>{const s=le(t.state);switch(s._tag){case uo:return ht(s.effect);case En:return c(t.state,fe(lo([n,...s.joiners]))),dt(nm(t,n))}},t.blockingOn).traced(e)),Ls=y(2,e=>(t,n)=>T(()=>{const s=le(t.state);switch(s._tag){case uo:return!1;case En:{c(t.state,fe(Da(n)));for(let r=0;r<s.joiners.length;r++)s.joiners[r](n);return!0}}}).traced(e)),em=y(2,e=>(t,n)=>Ls(t,za(n)).traced(e)),au=y(2,e=>(t,n)=>Ls(t,mt(n)).traced(e)),To=y(2,e=>(t,n)=>Ls(t,x(n)).traced(e)),Mo=y(2,e=>(t,n)=>Ls(t,I(n)).traced(e)),Ao=(e,t)=>{const n=le(e.state);if(n._tag===En){c(e.state,fe(Da(t)));for(let s=n.joiners.length-1;s>=0;s--)n.joiners[s](t)}},nm=(e,t)=>T(()=>{const n=le(e.state);n._tag===En&&c(e.state,fe(lo(n.joiners.filter(s=>s!==t))))});var uu;const sm="@effect/io/Clock",Oo=Symbol.for(sm),lu=Ft(Oo),rm=2**31-1,Ci={unsafeSchedule(e,t){if(t.millis>rm)return nr;let n=!1;const s=setTimeout(()=>{n=!0,e()},t.millis);return()=>(clearTimeout(s),!n)}};class om{constructor(){this[uu]=Oo}unsafeCurrentTimeMillis(){return new Date().getTime()}currentTimeMillis(){return D(t=>T(()=>this.unsafeCurrentTimeMillis()).traced(t))}scheduler(){return D(t=>I(Ci).traced(t))}sleep(t){return D(n=>Ts(s=>{const r=Ci.unsafeSchedule(()=>s(R()),t);return dt(at(T(r)))}).traced(n))}}uu=Oo;const im=()=>new om,fu="And",hu="Or",du="InvalidData",gu="MissingData",pu="SourceUnavailable",mu="Unsupported",cm="@effect/io/Config/Error",Ri=Symbol.for(cm),Ke={[Ri]:Ri},yu=(e,t)=>{const n=Object.create(Ke);return n._tag=fu,n.left=e,n.right=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`${this.left} and ${this.right}`}}),n},_u=(e,t)=>{const n=Object.create(Ke);return n._tag=hu,n.left=e,n.right=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`${this.left} or ${this.right}`}}),n},am=(e,t)=>{const n=Object.create(Ke);return n._tag=du,n.path=e,n.message=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`(Invalid data at ${c(this.path,Ce("."))}: "${this.message}")`}}),n},de=(e,t)=>{const n=Object.create(Ke);return n._tag=gu,n.path=e,n.message=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`(Missing data at ${c(this.path,Ce("."))}: "${this.message}")`}}),n},um=(e,t,n)=>{const s=Object.create(Ke);return s._tag=pu,s.path=e,s.message=t,s.cause=n,Object.defineProperty(s,"toString",{enumerable:!1,value(){return`(Source unavailable at ${c(this.path,Ce("."))}: "${this.message}")`}}),s},lm=(e,t)=>{const n=Object.create(Ke);return n._tag=mu,n.path=e,n.message=t,Object.defineProperty(n,"toString",{enumerable:!1,value(){return`(Unsupported operation at ${c(this.path,Ce("."))}: "${this.message}")`}}),n},Vt=l(2,(e,t)=>{switch(e._tag){case fu:return yu(Vt(t)(e.left),Vt(t)(e.right));case hu:return _u(Vt(t)(e.left),Vt(t)(e.right));case du:return am(c(t,U(e.path)),e.message);case gu:return de(c(t,U(e.path)),e.message);case pu:return um(c(t,U(e.path)),e.message,e.cause);case mu:return lm(c(t,U(e.path)),e.message)}}),fm="Constant",hm="Fail",dm="Fallback",gm="Described",pm="Lazy",mm="MapOrFail",ym="Nested",_m="Primitive",bm="Sequence",Sm="Table",vm="ZipWith",$m=e=>t=>de(ct(),`Expected ${t.description} with name ${e}`);var Fi,Pi;const bu="@effect/data/List",Co=Symbol.for(bu),Su={_A:e=>e};class vu{constructor(t,n){this.head=t,this.tail=n,this._tag="Cons",this[Fi]=Su}toString(){return`List.Cons(${xi(this).map(String).join(", ")})`}toJSON(){return{_tag:"List.Cons",values:xi(this)}}[(Fi=Co,Symbol.for("nodejs.util.inspect.custom"))](){return this.toJSON()}[O](t){return $u(t)&&this._tag===t._tag&&Im(this,t,v)}[A](){return J(bu)}[Symbol.iterator](){let t=!1,n=this;return{next(){if(t)return this.return();if(n._tag==="Nil")return t=!0,this.return();const s=n.head;return n=n.tail,{done:t,value:s}},return(s){return t||(t=!0),{done:!0,value:s}}}}}class Em{constructor(){this._tag="Nil",this[Pi]=Su}toString(){return"List.Nil"}toJSON(){return{_tag:"List.Nil"}}[(Pi=Co,Symbol.for("nodejs.util.inspect.custom"))](){return this.toJSON()}[A](){return Pc(Array.from(this))}[O](t){return $u(t)&&this._tag===t._tag}[Symbol.iterator](){return{next(){return{done:!0,value:void 0}}}}}const $u=e=>typeof e=="object"&&e!=null&&Co in e,wm=e=>e._tag==="Nil",km=e=>e._tag==="Cons",Ni=e=>{let t=e,n=0;for(;!wm(t);)n+=1,t=t.tail;return n},Im=l(3,(e,t,n)=>{if(e===t)return!0;if(Ni(e)!==Ni(t))return!1;const s=e[Symbol.iterator](),r=t[Symbol.iterator]();let o,i;for(;!(o=s.next()).done&&!(i=r.next()).done;)if(!n(o.value,i.value))return!1;return!0}),Tm=new Em,Li=(e,t)=>new vu(e,t),Mm=e=>new vu(e,Tm),xi=e=>Array.from(e),Am={_tag:"Empty"},ji=l(2,(e,t)=>{let n=Mm(t),s=e;for(;km(n);){const r=n.head;switch(r._tag){case"Empty":{n=n.tail;break}case"AndThen":{n=Li(r.first,Li(r.second,n.tail));break}case"MapName":{s=Se(s,r.f),n=n.tail;break}case"Nested":{s=gt(s,r.name),n=n.tail;break}case"Unnested":{if(c(be(s),hh(gh)(r.name)))s=Mt(s),n=n.tail;else return dt(de(s,`Expected ${r.name} to be in path in ConfigProvider#unnested`));break}}}return ht(s)}),Om="@effect/io/Config/Provider",vr=Symbol.for(Om),Cm=Ft(vr),Rm="@effect/io/Config/Provider/Flat",Di=Symbol.for(Rm),Fm=Es(e=>(t,n)=>({[vr]:vr,load:g(s=>r=>e(t)(r).traced(s)),flattened:n})),Pm=Es(e=>(t,n,s)=>({[Di]:Di,patch:s,load:g(r=>(o,i,a=!0)=>e(t)(o,i,a).traced(r)),enumerateChildren:g(r=>o=>e(n)(o).traced(r))})),Nm=Es(()=>e=>Fm(t=>p(pt(e,ct(),t,!1),n=>c(be(n),Kr(()=>mt(de(ct(),`Expected a single value having structure: ${t}`)),I))),e)),Lm=Es(()=>(e={})=>{const{pathDelim:t,seqDelim:n}=Object.assign({},{pathDelim:"_",seqDelim:","},e),s=u=>c(u,Ce(t)),r=u=>u.split(t),o=()=>typeof process<"u"&&"env"in process&&typeof process.env=="object"?process.env:{};return Nm(Pm((u,h,f=!0)=>{const d=s(u),m=o(),b=d in m?k(m[d]):S();return c(Va(b),fn(()=>de(u,`Expected ${d} to exist in the process context`)),p(E=>qm(E,u,h,n,f)))},u=>T(()=>{const h=o(),f=Object.keys(h),m=Array.from(f).map(b=>r(b.toUpperCase())).filter(b=>{for(let E=0;E<u.length;E++){const L=c(u,Ur(E)),j=b[E];if(j===void 0||L!==j)return!1}return!0}).flatMap(b=>b.slice(u.length,u.length+1));return _a(m)}),Am))}),xm=(e,t,n,s)=>{const r=li(n.length,u=>u>=s.length?S():k([e(u),u+1])),o=li(s.length,u=>u>=n.length?S():k([t(u),u+1])),i=c(n,U(r)),a=c(s,U(o));return[i,a]},pt=(e,t,n,s)=>{const r=n;switch(r._tag){case fm:return I(K(r.value));case gm:return C(()=>pt(e,t,r.config,s));case hm:return mt(de(t,r.message));case dm:return c(C(()=>pt(e,t,r.first,s)),ki(o=>r.condition(o)?c(pt(e,t,r.second,s),ki(i=>mt(_u(o,i)))):mt(o)));case pm:return C(()=>pt(e,t,r.config(),s));case mm:return C(()=>c(pt(e,t,r.original,s),p(wt(o=>c(xt(r.mapOrFail(o)),fn(Vt(t)))))));case ym:return C(()=>pt(e,c(t,U(K(r.name))),r.config,s));case _m:return c(xt(ji(t,e.patch)),p(o=>c(e.load(o,r,s),p(i=>{if(ps(i)){const a=c(Nh(o),At(()=>"<n/a>"));return mt($m(a))}return I(i)}))));case bm:return C(()=>c(pt(e,t,r.config,!0),N(K)));case Sm:return C(()=>c(xt(ji(t,e.patch)),p(o=>c(e.enumerateChildren(o),p(i=>c(i,wt(a=>pt(e,c(o,U(K(a))),r.valueConfig,s)),N(a=>{if(a.length===0)return K(ma());const u=G(a).map(G);return c(z(Km(u).map(z)),Se(h=>ya(fi(ue(i),h))))})))))));case vm:return C(()=>c(pt(e,t,r.left,s),Ii,p(o=>c(pt(e,t,r.right,s),Ii,p(i=>{if(Xe(o)&&Xe(i))return mt(yu(o.left,i.left));if(Xe(o)&&Ze(i))return mt(o.left);if(Ze(o)&&Xe(i))return mt(i.left);if(Ze(o)&&Ze(i)){const a=c(t,Ce(".")),u=jm(t,a),[h,f]=xm(u,u,c(o.right,Se(ht)),c(i.right,Se(ht)));return c(h,fi(f),wt(([d,m])=>c(xt(d),dn(xt(m)),N(([b,E])=>r.zip(b,E)))))}throw new Error("BUG: ConfigProvider.fromFlatLoop - please report an issue at https://github.com/Effect-TS/io/issues")})))))}},jm=(e,t)=>n=>dt(de(e,`The element at index ${n} in a sequence at path "${t}" was missing`)),Dm=(e,t)=>{const n=e.split(new RegExp(`\\s*${Wm(t)}\\s*`));return z(n)},qm=(e,t,n,s,r)=>r?c(Dm(e,s),wt(o=>xt(n.parse(o.trim()))),fn(Vt(t))):c(xt(n.parse(e)),N(K),fn(Vt(t))),Km=e=>Object.keys(e[0]).map(t=>e.map(n=>n[t])),Wm=e=>e.replace(/[/\-\\^$*+?.()|[\]{}]/g,"\\$&");var Eu;const Um="@effect/io/Random",Ro=Symbol.for(Um),zm=Ft(Ro);class Gm{constructor(t){this.seed=t,this[Eu]=Ro,this.PRNG=new Rc(t)}next(){return D(t=>T(()=>this.PRNG.number()).traced(t))}nextBoolean(){return D(t=>N(this.next(),n=>n>.5).traced(t))}nextInt(){return D(t=>T(()=>this.PRNG.integer(Number.MAX_SAFE_INTEGER)).traced(t))}nextRange(t,n){return D(s=>N(this.next(),r=>(n-t)*r+t).traced(s))}nextIntBetween(t,n){return D(s=>T(()=>this.PRNG.integer(1+n-t)+t).traced(s))}shuffle(t){return D(n=>Hm(t,s=>this.nextIntBetween(0,s)).traced(n))}}Eu=Ro;const Hm=(e,t)=>C(()=>c(T(()=>Array.from(e)),p(n=>{const s=[];for(let r=n.length;r>=2;r=r-1)s.push(r);return c(s,Os(r=>c(t(r),N(o=>Bm(n,r-1,o)))),lt(ue(n)))}))),Bm=(e,t,n)=>{const s=e[t];return e[t]=e[n],e[n]=s,e},Vm=e=>new Gm(e),Jm=c(Br(),tn(lu,im()),tn(zm,Vm(Math.random()*4294967296>>>0)),tn(Cm,Lm())),Ym=nu(Jm),Qm=g(e=>()=>wu(t=>t.currentTimeMillis()).traced(e)),Xm=g(e=>t=>wu(n=>n.sleep(t)).traced(e)),wu=g((e,t)=>n=>vo(Ym,s=>t(n)(c(s,td(lu)))).traced(e)),ku=Symbol.for("@effect/data/Duration");class xs{constructor(t){this.millis=t,this._id=ku}[A](){return _(this.millis)}[O](t){return Zm(t)&&this.millis===t.millis}}const Zm=e=>typeof e=="object"&&e!=null&&"_id"in e&&e._id===ku,Iu=new xs(0),ty=new xs(1/0),Tu=e=>new xs(e),ey={compare:(e,t)=>e.millis<t.millis?-1:e.millis>t.millis?1:0};ey.compare;const ny=l(2,(e,t)=>new xs(e.millis+t.millis)),sy=ot(ny),ry=Rt(sy,Iu);ry.combineAll;const oy=Xm,iy=Qm,iE=su,cE=Jp,aE=ru,uE=ou,lE=V,cy=Xp,fE=Sr,hE=Ps,dE=Pt,gE=jt,pE=Zp;var Mu;function ay(e){return new An(e)}const Au=Symbol.for("@effect/io/FiberRefs");class An{constructor(t){this.locals=t,this[Mu]=Au}}Mu=Au;const uy=(e,t,n,s=!1)=>{const r=e;let o=t,i=n,a=s,u;for(;u===void 0;)if(ee(o)&&ee(i)){const h=nt(o)[0],f=Ee(o),d=nt(i)[0],m=nt(i)[1],b=Ee(i);h.startTimeMillis<d.startTimeMillis?(i=b,a=!0):h.startTimeMillis>d.startTimeMillis?o=f:h.id<d.id?(i=b,a=!0):h.id>d.id?o=f:u=[m,a]}else u=[r.initial,!0];return u},ly=l(3,(e,t,n)=>{const s=new Map(e.locals);for(const[r,o]of n.locals){const i=nt(o)[1];if(!v(nt(o)[0],t)){if(!s.has(r)){if(v(i,r.initial))continue;s.set(r,[[t,r.join(r.initial,i)]]);continue}const a=s.get(r),[u,h]=uy(r,a,o);if(h){const f=r.diff(u,i),d=nt(a)[1],m=r.join(d,r.patch(f)(d));if(!v(d,m)){let b;const E=nt(a)[0];v(E,t)?b=te([E,m])(Ee(a)):b=te([t,m])(a),s.set(r,b)}}}}return new An(new Map(s))}),Ou=l(2,(e,t)=>{const n=new Map;for(const[s,r]of e.locals.entries()){const o=nt(r)[1],i=s.patch(s.fork)(o);v(o,i)?n.set(s,r):n.set(s,te([t,i])(r))}return new An(n)}),Cu=l(2,(e,t)=>{const n=new Map(e.locals);return n.delete(t),new An(n)}),fy=l(2,(e,t)=>e.locals.has(t)?k(nt(e.locals.get(t))[1]):S()),js=l(2,(e,t)=>c(fy(e,t),At(()=>t.initial))),is=l(4,(e,t,n,s)=>{const r=e.locals.has(n)?e.locals.get(n):Ch();let o;if(Uc(r))o=Gc([t,s]);else{const[a,u]=nt(r);if(v(a,t)){if(v(u,s))return e;o=te([t,s])(Ee(r))}else o=te([t,s])(r)}const i=new Map(e.locals);return new An(i.set(n,o))}),hy=Ou,qi=is,dy=ay,Ru="Empty",Fu="Add",Pu="Remove",Nu="Update",Lu="AndThen",gy=()=>({_tag:Ru}),py=(e,t)=>{const n=new Map(e.locals);let s=gy();for(const[r,o]of t.locals.entries()){const i=nt(o)[1],a=n.get(r);if(a!==void 0){const u=nt(a)[1];v(u,i)||(s=Ys({_tag:Nu,fiberRef:r,patch:r.diff(u,i)})(s))}else s=Ys({_tag:Fu,fiberRef:r,value:i})(s);n.delete(r)}for(const[r]of n.entries())s=Ys({_tag:Pu,fiberRef:r})(s);return s},Ys=l(2,(e,t)=>({_tag:Lu,first:e,second:t})),my=l(3,(e,t,n)=>{let s=n,r=Gc(e);for(;ee(r);){const o=nt(r),i=Ee(r);switch(o._tag){case Ru:{r=i;break}case Fu:{s=is(s,t,o.fiberRef,o.value),r=i;break}case Pu:{s=Cu(s,o.fiberRef),r=i;break}case Nu:{const a=js(s,o.fiberRef);s=is(s,t,o.fiberRef,o.fiberRef.patch(o.patch)(a)),r=i;break}case Lu:{r=te(o.first)(te(o.second)(i));break}}}return s});class Fo{constructor(t){this.self=t,this.called=!1}next(t){return this.called?{value:t,done:!0}:(this.called=!0,{value:this.self,done:!1})}return(t){return{value:t,done:!0}}throw(t){throw t}[Symbol.iterator](){return new Fo(this.self)}}const yy=Rp,_y=Fp,by=Pp,Sy=Np,xu=Za,vy=Lp,$y=xp,Ey=jp,wy=c(Vn,Jf(e=>e.ordinal)),ky=Yf(wy),Iy=e=>{switch(e){case"All":return yy;case"Debug":return vy;case"Error":return by;case"Fatal":return _y;case"Info":return xu;case"Trace":return $y;case"None":return Ey;case"Warning":return Sy}},Ty=e=>t=>`${t.label.replace(/[\s="]/g,"_")}=${e-t.startTime}ms`,My=Ty;var ju;const Du=Symbol.for("@effect/io/Ref"),qu={_A:e=>e};class Ay{constructor(t){this.ref=t,this[ju]=qu}modify(t){return D((n,s)=>T(()=>{const r=le(this.ref),[o,i]=s(t)(r);return r!==i&&fe(i)(this.ref),o}).traced(n))}}ju=Du;const Ku=e=>new Ay(Re(e)),$r=g(e=>t=>T(()=>Ku(t)).traced(e)),cs=g(e=>t=>t.modify(n=>[n,n]).traced(e)),Po=y(2,e=>(t,n)=>t.modify(()=>[void 0,n]).traced(e)),Wu=y(2,(e,t)=>(n,s)=>n.modify(t(s)).traced(e)),Ki=y(2,(e,t)=>(n,s)=>n.modify(r=>[void 0,t(s)(r)]).traced(e)),Oy=y(2,(e,t)=>(n,s)=>n.modify(r=>{const o=t(s)(r);return[o,o]}).traced(e)),Cy=$r,mE=cs,Ry=Wu,yE=Po,_E=Oy,Fy=g((e,t)=>n=>T(()=>{try{return t(n)()}catch(s){throw dp(xe(s))}}).traced(e)),Uu=g(e=>t=>wt(t,Q).traced(e)),Py=g(e=>t=>Os(t,Q).traced(e)),Ny=y(2,e=>(t,n)=>et(oy(n),t).traced(e)),Ly=g(e=>t=>po(()=>Et(Zg(t))).traced(e)),xy=g(e=>t=>c(t,Hu(Ky(),py)).traced(e)),zu=y(3,(e,t)=>(n,s,r)=>As(n,o=>I(t(s)(o)),o=>I(t(r)(o))).traced(e)),jy=g(e=>t=>{const n=c(p(t,()=>bo()),p(()=>n));return n.traced(e)});class Dy{constructor(t){this.value=t}[Symbol.iterator](){return new Fo(this)}}const qy=g((e,t)=>n=>C(()=>{const s=t(()=>n(i=>new Dy(i)))(),r=t(()=>s.next())(),o=i=>i.done?I(i.value):c(i.value.value,p(a=>o(t(()=>s.next(a))())));return o(r)}).traced(e)),Ky=g(e=>()=>ft(t=>I(t.unsafeGetFiberRefs())).traced(e)),Wy=g(e=>t=>zu(t,oi,oi).traced(e)),Uy=k(xu),zy=g(e=>t=>ft(n=>(n.log(t,Ct,S()),R())).traced(e)),Gy=g(e=>t=>ft(n=>(n.log(t,Ct,Uy),R())).traced(e)),Gu=g((e,t)=>(n,s,r,o)=>C(()=>t(s)(n)?p(t(o)(n),()=>Gu(t(r)(n),t(s),t(r),t(o))):R()).traced(e)),Hy=g(e=>t=>e_((n,s)=>c(t,my(n,s))).traced(e)),By=y(3,e=>(t,n,s)=>Vy(t,n,I(s)).traced(e)),Vy=y(3,e=>(t,n,s)=>Ga(r=>p(s,o=>je(t,c(r,tn(n,o))))).traced(e)),Hu=y(3,(e,t)=>(n,s,r)=>p(s,o=>p(n,i=>N(s,a=>[t(r)(o,a),i]))).traced(e)),Jy=g(e=>t=>c(wt(Object.entries(t),([n,s])=>N(s,r=>[n,r])),N(n=>{const s={};for(const[r,o]of n)s[r]=o;return s})).traced(e)),Yy=y(2,(e,t)=>(n,s)=>st(n,r=>et(t(s)(r),x(r)),I).traced(e)),Qy=g(e=>t=>Xy(t,iy()).traced(e)),Xy=y(2,e=>(t,n)=>Hu(t,n,(s,r)=>Tu(r-s)).traced(e)),Zy=g((e,t)=>n=>p(t(Fy)(n),s=>Is(r=>{s.then(o=>r(Pt(o))).catch(o=>r(ou(o)))})).traced(e)),t_=g(e=>(...t)=>N(Uu(t),G).traced(e)),e_=g((e,t)=>n=>ft(s=>(s.setFiberRefs(t(n)(s.id(),s.unsafeGetFiberRefs())),R())).traced(e)),n_=y(3,(e,t)=>(n,s,r)=>Ja(n,o=>c(o,tn(s,t(r)(Zc(o,s))))).traced(e)),s_=Symbol.for("@effect/data/MutableHashMap");class Wi{constructor(t,n,s){this.k=t,this.v=n,this.next=s}[Symbol.iterator](){let t=this,n=0;return{next:()=>{if(t){const s=[t.k,t.v];return t=t.next,n++,{value:s,done:!1}}else return{value:n,done:!0}}}}}class r_{constructor(){this._id=s_,this.backingMap=new Map,this.length=0}[Symbol.iterator](){return Array.from(this.backingMap.values()).flatMap(t=>{const n=[[t.k,t.v]];let s=t.next;for(;s;)n.push([s.k,s.v]),s=s.next;return n})[Symbol.iterator]()}toString(){return`MutableHashMap(${Array.from(this).map(([t,n])=>`[${String(t)}, ${String(n)}]`).join(", ")})`}toJSON(){return{_tag:"MutableHashMap",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}}const o_=()=>new r_,Ht=l(2,(e,t)=>{const n=_(t),s=e.backingMap.get(n);if(s===void 0)return S();let r=s;for(;r!==void 0;){if(v(t,r.k))return k(r.v);r=r.next}return S()}),ze=l(2,(e,t)=>q(Ht(e,t))),Ge=l(3,(e,t,n)=>{const s=_(t),r=e.backingMap.get(s);if(r===void 0)return e.backingMap.set(s,new Wi(t,n)),e.length=e.length+1,e;let o=r,i=r;for(;o!==void 0;){if(v(t,o.k))return o.v=n,e;i=o,o=o.next}return e.length=e.length+1,i.next=new Wi(t,n),e}),Bu="Sequential",i_="Parallel",c_={_tag:Bu},a_=e=>e._tag===Bu,u_=e=>e._tag===i_,Vu=c_,l_=a_,f_=u_;var Ui,zi,Gi;const Ds="@effect/io/Fiber/Status",ae=Symbol.for(Ds),Er="Done",Hi="Running",Bi="Suspended";class h_{constructor(){this[Ui]=ae,this._tag=Er}[(Ui=ae,A)](){return c(_(Ds),M(_(this._tag)))}[O](t){return No(t)&&t._tag===Er}}class d_{constructor(t){this.runtimeFlags=t,this[zi]=ae,this._tag=Hi}[(zi=ae,A)](){return c(_(Ds),M(_(this._tag)),M(_(this.runtimeFlags)))}[O](t){return No(t)&&t._tag===Hi&&this.runtimeFlags===t.runtimeFlags}}class g_{constructor(t,n){this.runtimeFlags=t,this.blockingOn=n,this[Gi]=ae,this._tag=Bi}[(Gi=ae,A)](){return c(_(Ds),M(_(this._tag)),M(_(this.runtimeFlags)),M(_(this.blockingOn)))}[O](t){return No(t)&&t._tag===Bi&&this.runtimeFlags===t.runtimeFlags&&v(this.blockingOn,t.blockingOn)}}const p_=new h_,m_=e=>new d_(e),y_=(e,t)=>new g_(e,t),No=e=>typeof e=="object"&&e!=null&&ae in e,__=e=>e._tag===Er,b_=p_,Ju=m_,S_=y_,v_=__,Lo="InterruptSignal",xo="Stateful",jo="Resume",Do="YieldNow",Vi=e=>({_tag:Lo,cause:e}),Gn=e=>({_tag:xo,onFiber:e}),ye=e=>({_tag:jo,effect:e}),$_=e=>({_tag:Do,priority:e});var Yu,Qu;const E_="@effect/io/Fiber/Scope",qs=Symbol.for(E_),Ji="@effect/io/FiberScope/Global";class w_{add(t,n){this.roots.add(n),n.unsafeAddObserver(()=>{this.roots.delete(n)})}constructor(){if(this[Yu]=qs,this.fiberId=qt,this.roots=new Set,typeof globalThis[Ji]>"u")globalThis[Ji]=this;else throw new Error("Bug: FiberScope.Global initialized twice (maybe coming from a duplicated module)")}}Yu=qs;class k_{constructor(t,n){this.fiberId=t,this.parent=n,this[Qu]=qs}add(t,n){this.parent.tell(Gn(s=>{s.addChild(n),n.unsafeAddObserver(()=>{s.removeChild(n)})}))}}Qu=qs;const I_=e=>new k_(e.id(),e),Xu=new w_,T_="@effect/io/Fiber",M_=Symbol.for(T_),A_={_E:e=>e,_A:e=>e},O_="@effect/io/Fiber",C_=Symbol.for(O_),as=g(e=>t=>t.await().traced(e)),Zu=g(e=>t=>t.inheritAll().traced(e)),wr=g(e=>t=>kn(Ms(t.await()),t.inheritAll()).traced(e)),zt="@effect/io/Fiber/Current",R_=Symbol.for("@effect/data/MutableList");class F_{constructor(){this._id=R_,this.head=void 0,this.tail=void 0,this._length=0}[Symbol.iterator](){let t=!1,n=this.head;return{next(){if(t)return this.return();if(n==null)return t=!0,this.return();const s=n.value;return n=n.next,{done:t,value:s}},return(s){return t||(t=!0),{done:!0,value:s}}}}toString(){return`MutableList(${Array.from(this).map(String).join(", ")})`}toJSON(){return{_tag:"MutableList",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}}class P_{constructor(t){this.value=t,this.removed=!1,this.prev=void 0,this.next=void 0}}const N_=()=>new F_,tl=e=>el(e)===0,el=e=>e._length,L_=l(2,(e,t)=>{const n=new P_(t);return e.head===void 0&&(e.head=n),e.tail===void 0||(e.tail.next=n,n.prev=e.tail),e.tail=n,e._length+=1,e}),x_=e=>{const t=e.head;if(t!==void 0)return j_(e,t),t.value},j_=(e,t)=>{t.removed||(t.removed=!0,t.prev!==void 0&&t.next!==void 0?(t.prev.next=t.next,t.next.prev=t.prev):t.prev!==void 0?(e.tail=t.prev,t.prev.next=void 0):t.next!==void 0?(e.head=t.next,t.next.prev=void 0):(e.tail=void 0,e.head=void 0),e._length>0&&(e._length-=1))},D_=Symbol.for("@effect/data/MutableQueue");class q_{constructor(t=void 0){this.capacity=t,this._tag="Bounded",this._id=D_,this.queue=N_()}[Symbol.iterator](){return Array.from(this.queue)[Symbol.iterator]()}toString(){return`MutableQueue(${Array.from(this).map(String).join(", ")})`}toJSON(){return{_tag:"MutableQueue",values:Array.from(this)}}[Symbol.for("nodejs.util.inspect.custom")](){return this.toJSON()}}const K_=()=>new q_,He=e=>tl(e.queue),W_=l(2,(e,t)=>{const n=el(e.queue);return e.capacity!==void 0&&n===e.capacity?!1:(L_(t)(e.queue),!0)}),Yi=l(2,(e,t)=>tl(e.queue)?t:x_(e.queue)),bE=Io,U_=Mn,SE=To,vE=Mo,nl=e=>{if(typeof e=="object"&&e!=null&&"toString"in e&&typeof e.toString=="function"&&e.toString!==Object.prototype.toString)return e.toString();if(typeof e=="string")return`Error: ${e}`;if(typeof e=="object"&&e!==null&&"message"in e&&typeof e.message=="string"){const t=JSON.parse(JSON.stringify(e)),n=new Set(Object.keys(t));if(n.delete("name"),n.delete("message"),n.delete("_tag"),n.size===0)return`${"name"in e&&typeof e.name=="string"?e.name:"Error"}${"_tag"in e&&typeof e._tag=="string"?`(${e._tag})`:""}: ${e.message}`}return`Error: ${JSON.stringify(e)}`},z_=e=>{const t=[];for(const n of e){const s=n?.toFrame();s&&P.filterStackFrame(s)&&t.push(sl(s))}return t},G_=e=>W(e)?[]:e.value.stack.length>0?z_(e.value.stack):[],H_=(e,t)=>[new V_(t._tag==="Some"?t.value.seq:0,e,G_(t).join(`\r
`))],B_=e=>{if(e.stack){const t=P.parseStack(e),n=[];for(const s of t)if(s)if(P.filterStackFrame(s))n.push(sl(s));else break;return[nl(e),...n].join(`\r
`)}return String(e)},Qi=e=>e instanceof Error?B_(e):nl(e);class V_{constructor(t,n,s){this.seq=t,this.message=n,this.stack=s}}const J_=e=>{if(Pa(e))return"All fibers interrupted without errors.";const t=ks(e,void 0,{emptyCase:()=>[],dieCase:(s,r)=>[{message:Qi(r),stack:S()}],failCase:(s,r)=>[{message:Qi(r),stack:S()}],interruptCase:()=>[],parallelCase:(s,r,o)=>[...r,...o],sequentialCase:(s,r,o)=>[...r,...o],annotatedCase:(s,r,o)=>ja(o)?r.map(i=>({message:i.message,stack:c(Jt(i.stack,a=>new yr(a.stack.length<P.traceStackLimit&&o.stack.length>0&&(a.stack.length>0&&sn(o.stack)!==sn(a.stack)||a.stack.length===0)?c(a.stack,U(o.stack),Qc,zr(P.traceStackLimit)):a.stack,a.seq)),rh(()=>k(o)))})):r}).flatMap(s=>H_(s.message,s.stack)),n=Array.from(t).sort((s,r)=>s.seq===r.seq?0:s.seq>r.seq?1:-1).map(s=>{let r=s.message;return s.stack&&s.stack.length>0&&(r+=`\r
${s.stack}`),r}).join(`\r
\r
`);return n.includes(`\r
`)?`\r
${n}\r
`:n};function sl(e){return e?e.name?`    at ${e.name} (${e.fileName}:${e.line}:${e.column})`:`    at ${e.fileName}:${e.line}:${e.column}`:"    at <unknown>"}const Y_="@effect/io/Logger",Q_=Symbol.for(Y_),X_={_Message:e=>e,_Output:e=>e},rl=e=>({[Q_]:X_,log:e}),Z_=rl((e,t,n,s,r,o,i)=>{const a=new Date,u=a.getTime();let f=[`timestamp=${a.toISOString()}`,`level=${t.label}`,`fiber=${bg(e)}`].join(" ");if(n.length>0&&(f=f+" message=",f=Qs(n,f)),s!=null&&s!=Ct&&(f=f+" cause=",f=Qs(J_(s),f)),Dt(o)){f=f+" ";let d=!0;for(const m of o)d?d=!1:f=f+" ",f=f+c(m,My(u))}if(c(i,xd)>0){f=f+" ";let d=!0;for(const[m,b]of i)d?d=!1:f=f+" ",f=f+nb(m),f=f+"=",f=Qs(b,f)}return f}),tb=e=>`"${e.replace(/\\([\s\S])|(")/g,"\\$1$2")}"`,eb=/^[^\s"=]+$/,Qs=(e,t)=>t+(e.match(eb)?e:tb(e)),nb=e=>e.replace(/[\s="]/g,"_");function pn(){const e=[];return{promise:()=>new Promise(n=>e.push(n)),resolve:n=>e.forEach(s=>s(n))}}const F={tasks:[],idleDeadline:void 0,frameTimeElapsed:!1,onIdleCallback:pn(),onAnimationFrame:pn(),frameWorkStartTime:void 0};function sb(){const e=pn(),t={ready:e.promise,resolve:e.resolve};return F.tasks.push(t),F.tasks.length===1&&rb(),t}let Xs=!1,Xi;function rb(){if(Xs)return;Xs=!0;const e=()=>{F.idleDeadline=void 0,F.frameTimeElapsed=!1,F.frameWorkStartTime=void 0},t=()=>{typeof requestIdleCallback<"u"&&(Xi=requestIdleCallback(s=>{e(),F.idleDeadline=s,F.onIdleCallback.resolve(),F.onIdleCallback=pn()}));const n=()=>{e(),F.onAnimationFrame.resolve(),F.onAnimationFrame=pn(),F.tasks.length===0?(Xs=!1,typeof cancelIdleCallback<"u"&&cancelIdleCallback(Xi)):t()};typeof requestAnimationFrame<"u"?requestAnimationFrame(n):setTimeout(n,16)};t()}function ob(e){const t=F.tasks.indexOf(e);t!==-1&&F.tasks.splice(t,1)}function ib(){F.tasks.length>0&&F.tasks[0].resolve()}let Zi=0,Be=!1;function ol(){const e=Date.now();return!Be&&e-Zi===0||(Zi=e,Be=e>=cb()||typeof navigator<"u"&&navigator.scheduling?.isInputPending?.()===!0,Be&&(F.frameTimeElapsed=!0)),Be}function cb(){if(F.frameWorkStartTime===void 0)return-1;const e=F.idleDeadline===void 0?Number.MAX_SAFE_INTEGER:Date.now()+F.idleDeadline.timeRemaining();return Math.min(F.frameWorkStartTime+5,e)}let tc=0;const Hn=new Set;function ab(e){const t=tc;return Hn.add(t),Promise.resolve().then(()=>{Promise.resolve().then(()=>{Hn.has(t)&&(e(),Hn.delete(t))})}),tc+=1,t}function ec(e){e!==void 0&&Hn.delete(e)}let Ln=[];function ub(e){if(Ln.length===0){const t=new MessageChannel;t.port2.postMessage(void 0),t.port1.onmessage=()=>{t.port1.close(),t.port2.close();const n=Ln;Ln=[];for(const s of n)s()}}Ln.push(e)}let Zs;async function lb(){ec(Zs);const e=sb();await kr(),F.tasks[0]!==e&&(await e.ready(),ol()&&await kr()),ob(e),ec(Zs),Zs=ab(()=>{ib()})}async function kr(){F.frameTimeElapsed&&await F.onAnimationFrame.promise(),typeof requestIdleCallback>"u"?(await new Promise(e=>ub(e)),typeof navigator<"u"&&navigator.scheduling?.isInputPending?.()===!0?await kr():F.frameWorkStartTime===void 0&&(F.frameWorkStartTime=Date.now())):(await F.onIdleCallback.promise(),F.frameWorkStartTime===void 0&&(F.frameWorkStartTime=Date.now()))}function fb(){return ol()?lb():Promise.resolve()}var nc;const il="@effect/io/Metric/Boundaries",Ir=Symbol.for(il);class hb{constructor(t){this.values=t,this[nc]=Ir}[(nc=Ir,A)](){return c(_(il),M(_(this.values)))}[O](t){return db(t)&&v(this.values,t.values)}}const db=e=>typeof e=="object"&&e!=null&&Ir in e,gb=e=>{const t=c(e,U(K(Number.POSITIVE_INFINITY)),Wh);return new hb(t)},pb=(e,t,n)=>c(Dh(0,n-1),Se(s=>e*Math.pow(t,s)),gb);var sc,rc,oc,ic;const mb="@effect/io/Metric/KeyType",cl=Symbol.for(mb),al="effect/io/Metric/KeyType/Counter",Tr=Symbol.for(al),yb="effect/io/Metric/KeyType/Frequency",_b=Symbol.for(yb),bb="effect/io/Metric/KeyType/Gauge",Sb=Symbol.for(bb),ul="effect/io/Metric/KeyType/Histogram",Mr=Symbol.for(ul),vb="effect/io/Metric/KeyType/Summary",$b=Symbol.for(vb),ll={_In:e=>e,_Out:e=>e};class Eb{constructor(){this[sc]=ll,this[rc]=Tr}[(sc=cl,rc=Tr,A)](){return _(al)}[O](t){return fl(t)}}class wb{constructor(t){this.boundaries=t,this[oc]=ll,this[ic]=Mr}[(oc=cl,ic=Mr,A)](){return c(_(ul),M(_(this.boundaries)))}[O](t){return hl(t)&&v(this.boundaries,t.boundaries)}}const kb=new Eb,Ib=e=>new wb(e),fl=e=>typeof e=="object"&&e!=null&&Tr in e,Tb=e=>typeof e=="object"&&e!=null&&_b in e,Mb=e=>typeof e=="object"&&e!=null&&Sb in e,hl=e=>typeof e=="object"&&e!=null&&Mr in e,Ab=e=>typeof e=="object"&&e!=null&&$b in e;var cc;const Ob="@effect/io/Metric/Key",dl=Symbol.for(Ob),Cb={_Type:e=>e};class qo{constructor(t,n,s=It()){this.name=t,this.keyType=n,this.tags=s,this[cc]=Cb}[(cc=dl,A)](){return c(_(this.name),M(_(this.keyType)),M(_(this.tags)))}[O](t){return Rb(t)&&this.name===t.name&&v(this.keyType,t.keyType)&&v(this.tags,t.tags)}}const Rb=e=>typeof e=="object"&&e!=null&&dl in e,Fb=e=>new qo(e,kb),Pb=(e,t)=>new qo(e,Ib(t)),Nb=l(2,(e,t)=>ba(t)===0?e:new qo(e.name,e.keyType,c(e.tags,Te(t))));var ac,uc,lc,fc,hc,dc,gc,pc,mc,yc;const Lb="@effect/io/Metric/State",On=Symbol.for(Lb),gl="effect/io/Metric/State/Counter",Ar=Symbol.for(gl),pl="effect/io/Metric/State/Frequency",Or=Symbol.for(pl),ml="effect/io/Metric/State/Gauge",Cr=Symbol.for(ml),yl="effect/io/Metric/State/Histogram",Rr=Symbol.for(yl),_l="effect/io/Metric/State/Summary",Fr=Symbol.for(_l),Cn={_A:e=>e};class xb{constructor(t){this.count=t,this[ac]=Cn,this[uc]=Ar}[(ac=On,uc=Ar,A)](){return c(_(gl),M(_(this.count)))}[O](t){return Bb(t)&&this.count===t.count}}class jb{constructor(t){this.occurrences=t,this[lc]=Cn,this[fc]=Or}[(lc=On,fc=Or,A)](){return c(_(pl),M(_(this.occurrences)))}[O](t){return Vb(t)&&v(this.occurrences,t.occurrences)}}class Db{constructor(t){this.value=t,this[hc]=Cn,this[dc]=Cr}[(hc=On,dc=Cr,A)](){return c(_(ml),M(_(this.value)))}[O](t){return Jb(t)&&this.value===t.value}}class qb{constructor(t,n,s,r,o){this.buckets=t,this.count=n,this.min=s,this.max=r,this.sum=o,this[gc]=Cn,this[pc]=Rr}[(gc=On,pc=Rr,A)](){return c(_(yl),M(_(this.buckets)),M(_(this.count)),M(_(this.min)),M(_(this.max)),M(_(this.sum)))}[O](t){return Yb(t)&&v(this.buckets,t.buckets)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}}class Kb{constructor(t,n,s,r,o,i){this.error=t,this.quantiles=n,this.count=s,this.min=r,this.max=o,this.sum=i,this[mc]=Cn,this[yc]=Fr}[(mc=On,yc=Fr,A)](){return c(_(_l),M(_(this.error)),M(_(this.quantiles)),M(_(this.count)),M(_(this.min)),M(_(this.max)),M(_(this.sum)))}[O](t){return Qb(t)&&this.error===t.error&&v(this.quantiles,t.quantiles)&&this.count===t.count&&this.min===t.min&&this.max===t.max&&this.sum===t.sum}}const Wb=e=>new xb(e),Ub=e=>new jb(e),zb=e=>new Db(e),Gb=(e,t,n,s,r)=>new qb(e,t,n,s,r),Hb=(e,t,n,s,r,o)=>new Kb(e,t,n,s,r,o),Bb=e=>typeof e=="object"&&e!=null&&Ar in e,Vb=e=>typeof e=="object"&&e!=null&&Or in e,Jb=e=>typeof e=="object"&&e!=null&&Cr in e,Yb=e=>typeof e=="object"&&e!=null&&Rr in e,Qb=e=>typeof e=="object"&&e!=null&&Fr in e,Xb="@effect/io/Metric/Hook",Zb=Symbol.for(Xb),tS={_In:e=>e,_Out:e=>e},Rn=(e,t)=>({[Zb]:tS,update:t,get:e}),eS=e=>{let t=0;return Rn(()=>Wb(t),n=>{t=t+n})},nS=e=>{const t=new Map,n=r=>{const o=t.get(r)??0;t.set(r,o+1)},s=()=>ya(Array.from(t.entries()).map(([r,o])=>[r,o]));return Rn(()=>Ub(s()),n)},sS=(e,t)=>{let n=t;return Rn(()=>zb(n),s=>{n=s})},rS=e=>{const t=e.keyType.boundaries.values,n=t.length,s=Array(n+1),r=Array(n);let o=0,i=0,a=Number.MAX_VALUE,u=Number.MIN_VALUE;c(t,rr(Vn),jh((d,m)=>{r[d]=m}));const h=d=>{let m=0,b=n;for(;m!==b;){const E=Math.floor(m+(b-m)/2),L=r[E];d<=L?b=E:m=E,b===m+1&&(d<=r[m]?b=m:m=b)}s[m]=s[m]+1,o=o+1,i=i+d,d<a&&(a=d),d>u&&(u=d)},f=()=>{const d=[];let m=0,b=0;for(;m!=n;){const E=r[m],L=s[m];b=b+L,d.push([E,b]),m=m+1}return ue(d)};return Rn(()=>Gb(f(),o,a,u,i),h)},oS=e=>{const{error:t,maxAge:n,maxSize:s,quantiles:r}=e.keyType,o=c(r,rr(Vn)),i=Array(s);let a=0,u=0,h=0,f=Number.MAX_VALUE,d=Number.MIN_VALUE;const m=E=>{const L=[];let j=0;for(;j!==s-1;){const it=i[j];if(it!=null){const[bt,Ut]=it,Ue=Tu(E-bt);Ue.millis>=0&&Ue<=n&&L.push(Ut)}j=j+1}return iS(t,o,c(ue(L),rr(Vn)))},b=(E,L)=>{if(s>0){a=a+1;const j=a%s;i[j]=[L,E]}u=u+1,h=h+E,E<f&&(f=E),E>d&&(d=E)};return Rn(()=>Hb(t,m(Date.now()),u,f,d,h),([E,L])=>b(E,L))},iS=(e,t,n)=>{const s=n.length;if(ps(t))return ct();const r=Jn(t),o=c(t,Gr(1)),i=c(o,ne(K(_c(e,s,S(),0,r,n)),(a,u)=>{const h=Jn(a);return c(a,Ph(_c(e,s,h.value,h.consumed,u,h.rest)))}));return c(i,Se(a=>[a.quantile,a.value]))},_c=(e,t,n,s,r,o)=>{let i=e,a=t,u=n,h=s,f=r,d=o,m=e,b=t,E=n,L=s,j=r,it=o;for(;;){if(ps(d))return{quantile:f,value:S(),consumed:h,rest:ct()};if(f===1)return{quantile:f,value:k(sn(d)),consumed:h+d.length,rest:ct()};const bt=c(d,Kh(zs=>zs>Jn(d))),Ut=f*a,Ue=i/2*Ut,ge=h+bt[0].length,lf=Math.abs(ge-Ut);if(ge<Ut-Ue){m=i,b=a,E=be(d),L=ge,j=f,it=bt[1],i=m,a=b,u=E,h=L,f=j,d=it;continue}if(ge>Ut+Ue)return{quantile:f,value:u,consumed:h,rest:d};switch(u._tag){case"None":{m=i,b=a,E=be(d),L=ge,j=f,it=bt[1],i=m,a=b,u=E,h=L,f=j,d=it;continue}case"Some":{const zs=Math.abs(Ut-u.value);if(lf<zs){m=i,b=a,E=be(d),L=ge,j=f,it=bt[1],i=m,a=b,u=E,h=L,f=j,d=it;continue}return{quantile:f,value:k(u.value),consumed:h,rest:d}}}}throw new Error("BUG: MetricHook.resolveQuantiles - please report an issue at https://github.com/Effect-TS/io/issues")},cS="@effect/io/Metric/Pair",aS=Symbol.for(cS),uS={_Type:e=>e},lS=(e,t)=>({[aS]:uS,metricKey:e,metricState:t});var bl;const fS="@effect/io/Metric/Registry",Sl=Symbol.for(fS);class hS{constructor(){this[bl]=Sl,this.map=o_()}snapshot(){const t=[];for(const[n,s]of this.map)t.push(lS(n,s.get()));return _a(t)}get(t){const n=c(this.map,Ht(t),me);if(n==null){if(fl(t.keyType))return this.getCounter(t);if(Mb(t.keyType))return this.getGauge(t);if(Tb(t.keyType))return this.getFrequency(t);if(hl(t.keyType))return this.getHistogram(t);if(Ab(t.keyType))return this.getSummary(t);throw new Error("BUG: MetricRegistry.get - unknown MetricKeyType - please report an issue at https://github.com/Effect-TS/io/issues")}else return n}getCounter(t){let n=c(this.map,Ht(t),me);if(n==null){const s=eS();c(this.map,ze(t))||c(this.map,Ge(t,s)),n=s}return n}getFrequency(t){let n=c(this.map,Ht(t),me);if(n==null){const s=nS();c(this.map,ze(t))||c(this.map,Ge(t,s)),n=s}return n}getGauge(t){let n=c(this.map,Ht(t),me);if(n==null){const s=sS(t,0);c(this.map,ze(t))||c(this.map,Ge(t,s)),n=s}return n}getHistogram(t){let n=c(this.map,Ht(t),me);if(n==null){const s=rS(t);c(this.map,ze(t))||c(this.map,Ge(t,s)),n=s}return n}getSummary(t){let n=c(this.map,Ht(t),me);if(n==null){const s=oS(t);c(this.map,ze(t))||c(this.map,Ge(t,s)),n=s}return n}}bl=Sl;const dS=()=>new hS,gS="@effect/io/Metric",pS=Symbol.for(gS),mS={_Type:e=>e,_In:e=>e,_Out:e=>e},yS=dS(),_S=function(e,t,n){return Object.assign(g((r,o)=>i=>De(i,a=>T(()=>o(t)(a,It()))).traced(r)),{[pS]:mS,keyType:e,unsafeUpdate:t,unsafeValue:n})},Ko=e=>vl(Fb(e)),vl=e=>{const t=n=>{const s=c(e,Nb(n));return yS.get(s)};return _S(e.keyType,(n,s)=>t(s).update(n),n=>t(n).get())},bS=(e,t)=>vl(Pb(e,t));var $l,El,wl;const SS="@effect/io/Supervisor",Wo=Symbol.for(SS),Uo={_T:e=>e};class Ks{constructor(t,n){this.underlying=t,this.value0=n,this[$l]=Uo}value(){return D(t=>this.value0().traced(t))}onStart(t,n,s,r){this.underlying.onStart(t,n,s,r)}onEnd(t,n){this.underlying.onEnd(t,n)}onEffect(t,n){this.underlying.onEffect(t,n)}onSuspend(t){this.underlying.onSuspend(t)}onResume(t){this.underlying.onResume(t)}map(t){return new Ks(this,()=>c(this.value(),N(t)))}zip(t){return new We(this,t)}}$l=Wo;class We{constructor(t,n){this.left=t,this.right=n,this[El]=Uo}value(){return D(t=>dn(this.left.value(),this.right.value()).traced(t))}onStart(t,n,s,r){this.left.onStart(t,n,s,r),this.right.onStart(t,n,s,r)}onEnd(t,n){this.left.onEnd(t,n),this.right.onEnd(t,n)}onEffect(t,n){this.left.onEffect(t,n),this.right.onEffect(t,n)}onSuspend(t){this.left.onSuspend(t),this.right.onSuspend(t)}onResume(t){this.left.onResume(t),this.right.onResume(t)}map(t){return new Ks(this,()=>c(this.value(),N(t)))}zip(t){return new We(this,t)}}El=Wo;class vS{constructor(t){this.effect=t,this[wl]=Uo}value(){return D(t=>this.effect.traced(t))}onStart(t,n,s,r){}onEnd(t,n){}onEffect(t,n){}onSuspend(t){}onResume(t){}map(t){return new Ks(this,()=>c(this.value(),N(t)))}zip(t){return new We(this,t)}}wl=Wo;const $S=e=>new vS(e),Ws=$S(R()),kl="Empty",Il="AddSupervisor",Tl="RemoveSupervisor",Ml="AndThen",en={_tag:kl},Bn=(e,t)=>({_tag:Ml,first:e,second:t}),ES=(e,t)=>wS(t,K(e)),wS=(e,t)=>{let n=e,s=t;for(;Dt(s);){const r=se(s);switch(r._tag){case kl:{s=Mt(s);break}case Il:{n=n.zip(r.supervisor),s=Mt(s);break}case Tl:{n=Pr(n,r.supervisor),s=Mt(s);break}case Ml:{s=gt(r.first)(gt(r.second)(Mt(s)));break}}}return n},Pr=(e,t)=>v(e,t)?Ws:e instanceof We?Pr(e.left,t).zip(Pr(e.right,t)):e,us=e=>v(e,Ws)?It():e instanceof We?c(us(e.left),Te(us(e.right))):so(e),kS=(e,t)=>{if(v(e,t))return en;const n=us(e),s=us(t),r=c(s,di(n),Xn(en,(i,a)=>Bn(i,{_tag:Il,supervisor:a}))),o=c(n,di(s),Xn(en,(i,a)=>Bn(i,{_tag:Tl,supervisor:a})));return Bn(r,o)},IS=Ea({empty:en,patch:ES,combine:Bn,diff:kS});var bc,Sc;const TS=Ko("effect_fiber_started"),MS=Ko("effect_fiber_successes"),AS=Ko("effect_fiber_failures"),OS=bS("effect_fiber_lifetimes",pb(1,2,100)),Ve="Continue",CS="Done",vc="Yield",$c="YieldInBackground",RS={_E:e=>e,_A:e=>e},Je=e=>{throw new Error(`BUG: FiberRuntime - ${JSON.stringify(e)} - please report an issue at https://github.com/Effect-TS/io/issues`)},xn={[ts]:(e,t,n)=>t.successK(n),[es]:(e,t,n)=>t.successK(n),[fo]:(e,t,n)=>(e.patchRuntimeFlags(e._runtimeFlags,t.patch),Bt(e._runtimeFlags)&&e.isInterrupted()?V(e.getInterruptedCause()):Pt(n)),[ns]:(e,t,n)=>(t.process(n),t.check()?(e.pushStack(t),t.body()):R())},FS={[Lo]:(e,t,n,s)=>(e.processNewInterruptSignal(s.cause),Bt(t)?V(s.cause):n),[jo]:(e,t,n,s)=>{throw new Error("It is illegal to have multiple concurrent run loops in a single fiber")},[xo]:(e,t,n,s)=>(s.onFiber(e,Ju(t)),n),[Do]:(e,t,n,s)=>c(bo(s.priority),p(()=>n))};class Al{constructor(t,n,s){if(this[bc]=A_,this[Sc]=RS,this._queue=K_(),this._children=null,this._observers=new Array,this._running=!1,this._stack=[],this._asyncInterruptor=null,this._asyncBlockingOn=null,this._exitValue=null,this._traceStack=[],this.run=()=>{this.drainQueueOnCurrentThread()},this._runtimeFlags=s,this._fiberId=t,this._fiberRefs=n,Bs(s)){const r=this.getFiberRef(Vs);TS.unsafeUpdate(1,r)}}id(){return this._fiberId}resume(t){this.tell(ye(t))}status(){return this.ask((t,n)=>n)}runtimeFlags(){return this.ask((t,n)=>v_(n)?t._runtimeFlags:n.runtimeFlags)}scope(){return I_(this)}children(){return this.ask(t=>ue(t.getChildren()))}getChildren(){return this._children===null&&(this._children=new Set),this._children}getSupervisor(){return this.getFiberRef(VS)}getInterruptedCause(){return this.getFiberRef(Nn)}fiberRefs(){return this.ask(t=>t.unsafeGetFiberRefs())}ask(t){return Y(()=>C(()=>{const n=Ns(this._fiberId);return this.tell(Gn((s,r)=>{Ao(n,T(()=>t(s,r)))})),Mn(n)}))}tell(t){c(this._queue,W_(t)),this._running||(this._running=!0,this.drainQueueLaterOnExecutor("normal"))}await(){return Y(()=>mp(t=>{const n=s=>t(I(s));return this.tell(Gn((s,r)=>{s._exitValue!==null?n(this._exitValue):s.unsafeAddObserver(n)})),T(()=>this.tell(Gn((s,r)=>{s.unsafeRemoveObserver(n)})))},this.id()))}inheritAll(){return Y(()=>ft((t,n)=>{const s=t.id(),r=t.unsafeGetFiberRefs(),o=n.runtimeFlags,i=this.unsafeGetFiberRefs(),a=ly(r,s,i);t.setFiberRefs(a);const u=t.getFiberRef(wc),h=c(dr(o,u),_i(Ne),_i(hr));return Ap(h)}))}poll(){return Y(()=>T(()=>Kc(this._exitValue)))}unsafePoll(){return this._exitValue}interruptAsFork(t){return Y(()=>T(()=>this.tell(Vi(Xt(t)))))}unsafeAddObserver(t){this._exitValue!==null?t(this._exitValue):this._observers.push(t)}unsafeRemoveObserver(t){this._observers=this._observers.filter(n=>n!==t)}unsafeGetFiberRefs(){return this.setFiberRef(wc,this._runtimeFlags),this._fiberRefs}unsafeDeleteFiberRef(t){this._fiberRefs=Cu(this._fiberRefs,t)}getFiberRef(t){return js(this._fiberRefs,t)}setFiberRef(t,n){this._fiberRefs=is(this._fiberRefs,this._fiberId,t,n)}setFiberRefs(t){this._fiberRefs=t}addChild(t){this.getChildren().add(t)}removeChild(t){this.getChildren().delete(t)}drainQueueOnCurrentThread(){let t=!0;for(;t;){let n=Ve;const s=globalThis[zt];globalThis[zt]=this;try{for(;n===Ve;)n=He(this._queue)?CS:this.evaluateMessageWhileSuspended(c(this._queue,Yi(null)))}finally{this._running=!1,globalThis[zt]=s}!He(this._queue)&&!this._running?(this._running=!0,n===vc?(this.drainQueueLaterOnExecutor("normal"),t=!1):n===$c?(this.drainQueueLaterOnExecutor("background"),t=!1):t=!0):t=!1}}drainQueueLaterOnExecutor(t){t==="normal"?this.getFiberRef(Eo).scheduleTask(this.run):fb().then(()=>{this.run()})}drainQueueWhileRunning(t,n){let s=n;for(;!He(this._queue);){const r=c(this._queue,Yi(void 0));s=FS[r._tag](this,t,s,r)}return s}isInterrupted(){return!Ug(this.getFiberRef(Nn))}addInterruptedCause(t){const n=this.getFiberRef(Nn);this.setFiberRef(Nn,tt(n,t))}processNewInterruptSignal(t){this.addInterruptedCause(t),this.sendInterruptSignalToAllChildren()}sendInterruptSignalToAllChildren(){if(this._children===null||this._children.size===0)return!1;let t=!1;for(const n of this._children)n.tell(Vi(Xt(this.id()))),t=!0;return t}interruptAllChildren(){if(this.sendInterruptSignalToAllChildren()){const t=this._children.values();this._children=null;let n=!1;const s=()=>{const r=t.next();return r.done?T(()=>{n=!0}):at(r.value.await())};return _o(()=>!n,()=>s(),()=>{})}return null}reportExitValue(t){if(Bs(this._runtimeFlags)){const n=this.getFiberRef(Vs);switch(t._tag){case B:{MS.unsafeUpdate(1,n);break}case H:{AS.unsafeUpdate(1,n);break}}}}setExitValue(t){if(this._exitValue=t,Bs(this._runtimeFlags)){const n=this.getFiberRef(Vs),s=this.id().startTimeMillis,r=new Date().getTime();OS.unsafeUpdate((r-s)/1e3,n)}this.reportExitValue(t);for(let n=this._observers.length-1;n>=0;n--)this._observers[n](t)}getLoggers(){return this.getFiberRef(LS)}log(t,n,s){const r=q(s)?s.value:this.getFiberRef(zp),o=this.getFiberRef(Gp),i=this.getFiberRef(Up),a=this.getLoggers(),u=this.unsafeGetFiberRefs();c(a,Dd(h=>{h.log(this.id(),r,t,n,u,o,i)}))}evaluateMessageWhileSuspended(t){switch(t._tag){case Do:return t.priority==="background"?$c:vc;case Lo:return this.processNewInterruptSignal(t.cause),this._asyncInterruptor!==null&&(this._asyncInterruptor(V(t.cause)),this._asyncInterruptor=null),Ve;case jo:return this._asyncInterruptor=null,this._asyncBlockingOn=null,this.evaluateEffect(t.effect),Ve;case xo:return t.onFiber(this,this._exitValue!==null?b_:S_(this._runtimeFlags,this._asyncBlockingOn)),Ve;default:return Je(t)}}evaluateEffect(t){this.getSupervisor().onResume(this);try{let n=Bt(this._runtimeFlags)&&this.isInterrupted()?V(this.getInterruptedCause()):t;for(;n!==null;)try{const s=this.runLoop(n);this._runtimeFlags=c(this._runtimeFlags,Rg(hr));const r=this.interruptAllChildren();r!==null?n=Y(()=>p(r,()=>s)):(He(this._queue)?this.setExitValue(s):this.tell(ye(s)),n=null)}catch(s){if(wi(s))s._tag===zn?Cg(this._runtimeFlags)?(this.tell($_(s.priority)),this.tell(ye(jt())),n=null):n=jt():s._tag===Kn&&(n=null);else throw s}}finally{this.getSupervisor().onSuspend(this)}}start(t){if(this._running)this.tell(ye(t));else{this._running=!0;const n=globalThis[zt];globalThis[zt]=this;try{this.evaluateEffect(t)}finally{this._running=!1,globalThis[zt]=n,He(this._queue)||this.drainQueueLaterOnExecutor("normal")}}}startFork(t){this.tell(ye(t))}patchRuntimeFlags(t,n){const s=gr(t,n);return globalThis[zt]=this,this._runtimeFlags=s,s}initiateAsync(t,n){let s=!1;const r=o=>{s||(s=!0,this.tell(ye(o)))};Bt(t)&&(this._asyncInterruptor=r);try{n(r)}catch(o){r(x(Et(o)))}}pushStack(t){this._stack.push(t),"trace"in t&&t.trace&&this._traceStack.push(t.trace)}popStack(){const t=this._stack.pop();if(t)return"trace"in t&&t.trace&&this._traceStack.pop(),t}getNextSuccessCont(){let t=this.popStack();for(;t;){if(t._tag!==Wn&&t._tag!==Un)return t;t=this.popStack()}}getNextFailCont(){let t=this.popStack();for(;t;){if(t._tag!==ts&&t._tag!==ns&&t._tag!==Un)return t;t=this.popStack()}}[(bc=M_,Sc=C_,qa)](t){const n=t.evaluate(),s=this.getNextSuccessCont();if(s!==void 0)return s._tag in xn||Je(s),xn[s._tag](this,s,n);throw Pt(n)}[B](t){const n=t,s=this.getNextSuccessCont();if(s!==void 0)return s._tag in xn||Je(s),xn[s._tag](this,s,n.value);throw n}[H](t){let n=t.cause;if(Wg(n)&&ja(n.annotation)){const r=n.annotation.stack,o=this.stackToLines();n=an(n.cause,new yr(c(r.length===0?o:o.length===0||sn(r)===sn(o)?r:c(r,U(o)),Qc,zr(P.traceStackLimit)),n.annotation.seq))}else n=an(t.cause,new yr(this.stackToLines(),lg(sp)));const s=this.getNextFailCont();if(s!==void 0)switch(s._tag){case Wn:case es:return Bt(this._runtimeFlags)&&this.isInterrupted()?V(un(n)):s.failK(n);case fo:return this.patchRuntimeFlags(this._runtimeFlags,s.patch),Bt(this._runtimeFlags)&&this.isInterrupted()?V(tt(n,this.getInterruptedCause())):V(n);default:Je(s)}else throw V(n)}[Ka](t){return t.withRuntime(this,Ju(this._runtimeFlags))}[wn](t){if(t.scope===void 0)return this.patchRuntimeFlags(this._runtimeFlags,t.update),jt();{const n=t.update,s=this._runtimeFlags,r=gr(s,n);if(r===s)return t.scope(s);if(Bt(r)&&this.isInterrupted())return V(this.getInterruptedCause());{this.patchRuntimeFlags(this._runtimeFlags,n);const o=dr(r,s);return this.pushStack(new gp(o)),t.scope(s)}}}[ts](t){return this.pushStack(t),t.first}[Un](t){return this.pushStack(t),t.self}[Wn](t){return this.pushStack(t),t.first}[es](t){return this.pushStack(t),t.first}[Kn](t){throw this._asyncBlockingOn=t.blockingOn,this.initiateAsync(this._runtimeFlags,t.register),t}[zn](t){throw t}[ns](t){const n=t.check,s=t.body;return n()?(this.pushStack(t),s()):jt()}[ap](t){return t.commit()}runLoop(t){let n=t,s=0;for(;;){if(Pg(this._runtimeFlags)&&this.getSupervisor().onEffect(this,n),n=this.drainQueueWhileRunning(this._runtimeFlags,n),s+=1,s>=2048){s=0;const r=n;n=c(bo(),p(()=>r))}try{n._tag in this||Je(n),n=this[n._tag](n)}catch(r){if(wi(r)){if(r._tag===zn||r._tag===Kn)throw r;if(r._tag===B||r._tag===H)return r}else hp(r)?n=V(r.cause):ep(r)?n=V(tt(Et(r),Xt(qt))):n=V(Et(r))}}}stackToLines(){if(this._traceStack.length===0)return ct();const t=[];let n=this._traceStack.length-1;for(;n>=0&&t.length<P.traceStackLimit;){const s=this._traceStack[n];t.push(s),n=n-1}return z(t)}}const PS=Kt(Iy(P.minumumLogLevel)),NS=rl((e,t,n,s,r,o,i)=>{const a=Z_.log(e,t,n,s,r,o,i),u=js(r,PS);ky(u)(t)&&globalThis.console.log(a)}),LS=eu(so(NS)),xS=g((e,t)=>(n,s)=>c(De(n,r=>jS(o=>t(s)(r,o))),Rs).traced(e)),jS=g((e,t)=>n=>p(go(),s=>p(Fl(),r=>rs(r,o=>c(t(n)(o),je(s),at)))).traced(e)),Ec=y(2,(e,t)=>(n,s)=>vo(wo,r=>r._tag==="None"?Ol(n,t(s)):qS(n,r.value,s)).traced(e)),DS=y(2,(e,t)=>(n,s)=>vo(wo,r=>r._tag==="None"?zo(n,t(s)):Cl(n,r.value,s)).traced(e)),Ol=(e,t)=>C(()=>{const n=Array.from(e).map((o,i)=>[o,i]),s=new Array(n.length);return et(zo(n,([o,i])=>p(t(o),a=>T(()=>s[i]=a))),I(z(s)))}),zo=(e,t)=>C(()=>{const n=Array.from(e),s=n.length;return s===0?R():s===1?at(t(n[0])):_t(r=>{const o=Ns(qt);let i=0;const a=Qa(u=>wt(n,h=>c(u(c(r(C(()=>t(h))),st(f=>et(au(o,void 0),x(f)),()=>(i+1===s?Ao(o,R()):i=i+1,R())))),Fn)));return p(a,u=>st(r(Mn(o)),h=>p(Ol(u,qe),f=>{const d=br(f);return d._tag==="Some"&&su(d.value)?x(Tt(un(h),d.value.cause)):x(un(h))}),()=>Os(u,h=>h.inheritAll())))})}),qS=(e,t,n)=>C(()=>{const s=Array.from(e).map((i,a)=>[i,a]),r=new Array(s.length);return et(Cl(s,t,([i,a])=>N(n(i),u=>r[a]=u)),I(z(r)))}),Cl=(e,t,n)=>C(()=>{const s=e[Symbol.iterator](),r=p(T(()=>s.next()),i=>i.done?R():p(at(n(i.value)),()=>r)),o=[];for(let i=0;i<t;i++)o.push(r);return zo(o,Q)}),tr=g(e=>t=>ft((n,s)=>I(Rl(t,n,s.runtimeFlags))).traced(e)),Fn=g(e=>t=>KS(t,Xu).traced(e)),Rl=(e,t,n,s=null)=>{const r=Nr(e,t,n,s);return r.resume(e),r},Nr=(e,t,n,s=null)=>{const r=wa(),o=t.unsafeGetFiberRefs(),i=Ou(o,r),a=new Al(r,i,n),u=js(i,Tn),h=a.getSupervisor();return h.onStart(u,e,k(t),a),a.unsafeAddObserver(d=>h.onEnd(d,a)),(s!==null?s:c(t.getFiberRef(gn),At(()=>t.scope()))).add(n,a),a},KS=(e,t)=>ft((n,s)=>I(Rl(e,n,s.runtimeFlags,t))),WS=g(e=>t=>{const n=ue(t);if(!Dt(n))return _p(()=>np("Received an empty collection of effects"));const s=se(n),r=Mt(n),o=i=>c(Zu(i[1]),lt(i[0]));return c(Io(),p(i=>c(Cy(r.length),p(a=>_t(u=>c(tr(ss(s)),p(h=>c(r,wt(f=>tr(ss(f))),N(f=>c(f,gt(h))),De(f=>c(f,ne(R(),(d,m)=>c(d,et(c(as(m),p(US(f,m,i,a)),tr,at)))))),p(f=>c(u(c(U_(i),p(o))),yo(()=>c(f,ne(R(),(d,m)=>c(d,kn(qe(m)))))))))))))))).traced(e)}),US=(e,t,n,s)=>r=>c(r,iu(o=>c(Ry(s,i=>[i===0?c(To(n,o),at):R(),i-1]),Ms),o=>c(Mo(n,[o,t]),p(i=>i?c(e,ne(R(),(a,u)=>u===t?a:c(a,kn(qe(u))))):R())))),Fl=g(e=>()=>Ya(Go).traced(e)),Pl=g((e,t)=>n=>Cs(Go,t(n)).traced(e)),zS=g(e=>t=>p(Us(),n=>HS(n)(t)).traced(e)),GS=(e,t)=>n=>C(()=>{switch(n.state._tag){case"Exited":return R();case"Running":{const s=n.state.finalizers,r=n.state.update,o=Array.from(s.keys()).sort((i,a)=>a-i).map(i=>s.get(i));return n.state={_tag:"Exited",nextKey:n.state.nextKey,exit:t,update:r},l_(e)?c(o,wt(i=>Zt(r(i)(t))),p(i=>c(ru(i),Jt(Js),At(()=>jt())))):f_(e)?c(o,Ec(i=>Zt(r(i)(t))),p(i=>c(br(i),Jt(Js),At(()=>jt())))):c(o,Ec(i=>Zt(r(i)(t))),p(i=>c(br(i),Jt(Js),At(()=>jt()))),Cp(e.parallelism))}}}),Go=Ft(),Us=g(e=>(t=Vu)=>N(Vp(),n=>({[Mi]:Mi,[Ai]:Ai,fork:s=>D(r=>Rs(c(Us(s),p(o=>c(n,Oi(i=>os(o,i)),De(i=>rs(o,i)),lt(o))))).traced(r)),close:s=>D(r=>at(GS(t,s)(n)).traced(r)),addFinalizer:s=>D(r=>at(Oi(s)(n)).traced(r))})).traced(e)),Nl=y(2,e=>(t,n)=>Ja(t,Jr(Vr(Go,n))).traced(e)),HS=y(2,e=>(t,n)=>c(t,Nl(n),hn(s=>n.close(s))).traced(e)),BS=e=>In(e,IS,en),wc=Wp(Fg),VS=BS(Ws),kc=g(e=>t=>c(qe(t),Fn,at).traced(e));var Ll,xl;class JS{constructor(t){this.permits=t,this.waiters=new Array,this.taken=0,this.take=n=>D(s=>Ts(r=>{if(this.free<n){const o=()=>{if(this.free>=n){const i=this.waiters.findIndex(a=>a===o);i!==-1&&this.waiters.splice(i,1),this.taken+=n,r(I(n))}};return this.waiters.push(o),dt(T(()=>{const i=this.waiters.findIndex(a=>a===o);i!==-1&&this.waiters.splice(i,1)}))}return this.taken+=n,ht(I(n))}).traced(s)),this.release=n=>D(s=>ft(r=>(this.taken-=n,r.getFiberRef(Eo).scheduleTask(()=>{this.waiters.forEach(o=>o())}),R())).traced(s)),this.withPermits=n=>D(s=>r=>Y(()=>_t(o=>p(o(this.take(n)),i=>jl(o(r),this.release(i))))).traced(s))}get free(){return this.permits-this.taken}}const YS=e=>new JS(e),jl=y(2,e=>(t,n)=>_t(s=>st(s(t),r=>st(n,o=>x(tt(r,o)),()=>x(r)),r=>lt(n,r))).traced(e)),QS=y(2,e=>(t,n)=>_t(s=>p(n.fork(Vu),r=>c(s(t),hn(o=>r.close(o)),Fn,De(o=>r.addFinalizer(()=>Ha(i=>v(i,o.id())?R():at(qe(o)))))))).traced(e)),XS=g(e=>t=>Pl(n=>QS(t,n)).traced(e)),ZS=y(4,(e,t)=>(n,s,r,o)=>ft((i,a)=>{const u=a.runtimeFlags,h=Re(!0),f=Nr(n,i,u),d=Nr(s,i,u);return f.startFork(n),d.startFork(s),f.setFiberRef(gn,k(i.scope())),d.setFiberRef(gn,k(i.scope())),c(Is(m=>{f.unsafeAddObserver(()=>Ic(f,d,t(r),h,m)),d.unsafeAddObserver(()=>Ic(d,f,t(o),h,m))},c(f.id(),vg(d.id()))))}).traced(e)),Ic=(e,t,n,s,r)=>{ug(!0,!1)(s)&&r(n(e,t))},tv=y(4,(e,t)=>(n,s,r,o)=>ZS(n,s,(i,a)=>p(i.await(),u=>{switch(u._tag){case B:return p(i.inheritAll(),()=>t(r)(u,a));case H:return t(r)(u,a)}}),(i,a)=>p(i.await(),u=>{switch(u._tag){case B:return p(i.inheritAll(),()=>t(o)(u,a));case H:return t(o)(u,a)}})).traced(e)),ev=y(2,e=>(t,n)=>Dl(t,n,(s,r)=>r).traced(e)),Dl=y(3,(e,t)=>(n,s,r)=>_t(o=>Qa(i=>{const a=Ns(qt),u=Re(!1);return c(Tc(n,i,o,a,u),dn(Tc(s,i,o,a,u)),p(([h,f])=>c(o(Mn(a)),st(d=>c(kc(h),et(kc(f)),et(c(as(h),dn(as(f)),p(([m,b])=>c(m,ko(b,r,Tt),Ps(E=>x(Tt(un(d),E)),()=>x(un(d)))))))),()=>So(wr(h),wr(f),t(r))))))})).traced(e)),Tc=(e,t,n,s,r)=>Fn(st(t(n(e)),o=>et(au(s,void 0),x(o)),o=>le(r)?(Ao(s,R()),I(o)):(c(r,fe(!0)),I(o)))),nv="@effect/io/Ref/Synchronized",sv=Symbol.for(nv),rv={_A:e=>e};class ov{constructor(t,n){this.ref=t,this.withLock=n,this[Ll]=rv,this[xl]=qu}modify(t){return D((n,s)=>this.modifyEffect(r=>I(s(t)(r))).traced(n))}modifyEffect(t){return D((n,s)=>this.withLock(c(p(cs(this.ref),s(t)),p(([r,o])=>lt(Po(this.ref,o),r)))).traced(n))}}Ll=sv,xl=Du;const iv=g(e=>t=>T(()=>cv(t)).traced(e)),cv=e=>{const t=Ku(e),n=YS(1);return new ov(t,n.withPermits(1))},av="ExtendScope",uv="Fold",ql="Fresh",Kl="FromEffect",lv="Scoped",Wl="Suspend",Ul="ProvideTo",zl="ZipWith",Gl="ZipWithPar",$E=as,EE=Zu,wE=qe,fv=Xa,kE=wr,hv=e=>(t,n)=>{const s=wa();let r=qi(e.fiberRefs,s,Tn,e.context);n&&(r=qi(r,s,Eo,n));const o=new Al(s,hy(r,s),e.runtimeFlags),i=o.getSupervisor();return i!==Ws&&(i.onStart(e.context,t,S(),o),o.unsafeAddObserver(a=>i.onEnd(a,o))),Xu.add(e.runtimeFlags,o),o.start(t),o},Hl=e=>(t,n)=>{const s=hv(e)(t);return n&&s.unsafeAddObserver(r=>{n(r)}),(r,o)=>Hl(e)(c(s,fv(r??qt)),o?i=>o(cy(i)):void 0)},dv=e=>t=>new Promise((n,s)=>{Hl(e)(t,r=>{switch(r._tag){case B:{n(r.value);break}case H:{s(c(r.cause,Yg(Q)));break}}})});class gv{constructor(t,n,s){this.context=t,this.runtimeFlags=n,this.fiberRefs=s}}const pv=(e,t,n)=>new gv(e,t,n),mv=Aa(Ne,Ta),yv=pv(Br(),mv,dy(new Map)),_v=dv(yv),bv=y(2,(e,t)=>(n,s)=>n.modifyEffect(t(s)).traced(e)),Sv="@effect/io/Layer",vv=Symbol.for(Sv),$v={_RIn:e=>e,_E:e=>e,_ROut:e=>e},mn={[vv]:$v},Ev=e=>e._tag===ql;class wv{constructor(t){this.ref=t}getOrElseMemoize(t,n){return c(bv(this.ref,s=>{const r=s.get(t);if(r!==void 0){const[o,i]=r,a=c(o,p(([u,h])=>c(Hy(u),lt(h))),hn(Ps(()=>R(),()=>rs(n,i))));return I([a,s])}return c($r(0),p(o=>c(Io(),p(i=>c($r(()=>R()),N(a=>{const u=_t(f=>c(Us(),p(d=>c(f(p(Vl(t,d),m=>xy(m(this)))),Zt,p(m=>{switch(m._tag){case H:return c(To(i,m.cause),et(os(d,m)),et(x(m.cause)));case B:return c(Po(a,b=>c(os(d,b),Op(Wu(o,E=>[E===1,E-1])),at)),et(Ki(o,b=>b+1)),et(rs(n,b=>c(cs(a),p(E=>E(b))))),et(Mo(i,m.value)),lt(m.value[1]))}}))))),h=[c(Mn(i),hn(iu(()=>R(),()=>Ki(o,f=>f+1)))),f=>c(cs(a),p(d=>d(f)))];return[u,Ev(t)?s:s.set(t,h)]}))))))}),Ms)}}const kv=()=>c(iv(new Map),N(e=>new wv(e))),Bl=y(2,e=>(t,n)=>p(kv(),s=>p(Vl(t,n),r=>r(s))).traced(e)),Vl=(e,t)=>{const n=e;switch(n._tag){case av:return T(()=>s=>Pl(r=>s.getOrElseMemoize(n.layer,r)));case uv:return T(()=>s=>c(s.getOrElseMemoize(n.layer,t),st(r=>s.getOrElseMemoize(n.failureK(r),t),r=>s.getOrElseMemoize(n.successK(r),t))));case ql:return T(()=>s=>c(n.layer,Bl(t)));case Kl:return T(()=>s=>n.effect);case Ul:return T(()=>s=>c(s.getOrElseMemoize(n.first,t),p(r=>c(s.getOrElseMemoize(n.second,t),je(r)))));case lv:return T(()=>s=>Nl(n.effect,t));case Wl:return T(()=>s=>s.getOrElseMemoize(n.evaluate(),t));case zl:return T(()=>s=>c(s.getOrElseMemoize(n.first,t),So(s.getOrElseMemoize(n.second,t),n.zipK)));case Gl:return T(()=>s=>c(s.getOrElseMemoize(n.first,t),Dl(s.getOrElseMemoize(n.second,t),n.zipK)))}},Jl=()=>Ho(go()),Yl=(e,t)=>Ho(N(t,n=>Vr(e,n)));function Ho(e){const t=Object.create(mn);return t._tag=Kl,t.effect=e,t}const Iv=l(2,(e,t)=>Av(e,t,(n,s)=>c(n,Jr(s)))),Tv=l(2,(e,t)=>Ql(()=>{const n=Object.create(mn);return n._tag=Ul,n.first=Object.create(mn,{_tag:{value:zl,enumerable:!0},first:{value:Jl(),enumerable:!0},second:{value:e},zipK:{value:(s,r)=>c(s,Jr(r))}}),n.second=t,n})),Mv=(e,t)=>Ho(I(Vr(e,t))),Ql=e=>{const t=Object.create(mn);return t._tag=Wl,t.evaluate=e,t},Av=dg(3,e=>(t,n,s)=>Ql(()=>{const r=Object.create(mn);return r._tag=Gl,r.first=t,r.second=n,r.zipK=e(s),r})),Ov=y(2,e=>(t,n)=>ho(Us(),s=>p(Bl(n,s),r=>je(t,r)),(s,r)=>os(s,r)).traced(e)),Cv=y(2,e=>(t,n)=>Ov(t,c(Jl(),Iv(n))).traced(e)),Rv=l(2,(e,t)=>Yl(t,e)),IE=xS,Fv=ho,Pn=lt,TE=yp,ME=Uu,er=Py,Pv=Ny,AE=Ua,OE=Ly,CE=za,RE=jl,FE=Zt,PE=x,NE=Ha,Oe=p,LE=Ms,Nv=wt,Lv=Os,xv=DS,xE=jy,jE=Fn,DE=XS,jv=xt,Bo=Va,qE=qy,KE=Wy,WE=Sp,UE=ss,zE=$p,GE=zy,HE=Gy,Dv=Gu,qv=N,Xl=fn,BE=zu,VE=Ba,JE=st,YE=Ep,Kv=kp,Wv=wp,QE=je,Zl=By,Lr=Cv,XE=WS,ZE=tv,tw=Fl,Uv=zS,nn=Ya,tf=Tp,Vo=Cs,zv=Jy,ew=I,Ye=C,$=T,nw=De,sw=Yy,rw=Qy,Jo=Rv,ow=Zy,Gv=t_,iw=Rs,cw=_t,xr=R,aw=_v,Hv=n_,Bv=dn,ls=kn,ut=et,uw=So,lw=ev,Vv=(e,t,n,s)=>({_tag:"Hsla",h:e,s:t,l:n,a:s}),ef=(e,t,n)=>Vv(e,t,n,1),fw=ef(0,0,0),hw=ef(360,1,1),jn=e=>{switch(e._tag){case"Hex":return e.value;case"Hsla":{const{h:t,s:n,l:s,a:r}=e,o=f=>Math.round(f*100)/100,i=o(t),a=o(n*100)+"%",u=o(s*100)+"%",h=String(r);return r===1?`hsl(${i}, ${a}, ${u})`:`hsla(${i}, ${a}, ${u}, ${h})`}}};class Yo{constructor(t){this.message=t,this._tag="CanvasError"}}const yt=Ft(),Jv=w(e=>$(()=>e.canvas.width)),Yv=w(e=>$(()=>e.canvas.height)),dw=zv({width:Jv,height:Yv});w(e=>$(()=>e.canvas.toDataURL()));const Mc=e=>Wt(t=>{t.fillStyle=e});Wt(e=>e.fillStyle);w(e=>$(()=>e.font));function Qv(e){return w(t=>c($(()=>t.font=e),Pn(t)))}w(e=>$(()=>e.globalAlpha));w(e=>$(()=>e.globalCompositeOperation));w(e=>$(()=>e.imageSmoothingEnabled));w(e=>c($(()=>e.lineCap)));w(e=>c($(()=>e.lineDashOffset)));w(e=>c($(()=>e.lineJoin)));function Xv(e){return Wt(t=>{t.lineWidth=e})}w(e=>c($(()=>e.lineWidth)));w(e=>$(()=>e.miterLimit));function Zv(e){return Wt(t=>{t.strokeStyle=e})}Wt(e=>e.strokeStyle);function t$(e){return w(t=>c($(()=>t.shadowBlur=e),Pn(t)))}w(e=>$(()=>e.shadowBlur));function e$(e){return w(t=>$(()=>t.shadowColor=e))}w(e=>c($(()=>e.shadowColor)));function n$(e){return w(t=>c($(()=>t.shadowOffsetX=e),Pn(t)))}w(e=>c($(()=>e.shadowOffsetX)));function s$(e){return w(t=>c($(()=>t.shadowOffsetY=e),Pn(t)))}w(e=>c($(()=>e.shadowOffsetY)));Wt(e=>e.textAlign);w(e=>$(()=>e.textBaseline));function r$(e,t,n,s,r,o=!1){return w(i=>c($(()=>i.arc(e,t,n,s,r,o)),Pn(i)))}const Qo=Wt(e=>{e.beginPath()});function gw(e,t,n,s){return w(r=>$(()=>{r.clearRect(e,t,n,s)}))}function o$(e,t){return w(n=>$(()=>{typeof t<"u"?n.clip(t,e):typeof e<"u"?n.clip(e):n.clip()}))}const i$=w(e=>$(()=>{e.closePath()})),nf=(e,t,n)=>w(s=>$(()=>{s.drawImage(e,t,n)}));function c$(e,t,n,s,r,o,i,a=!1){return w(u=>$(()=>{u.ellipse(e,t,n,s,r,o,i,a)}))}const a$=(e,t)=>w(n=>$(()=>{typeof t<"u"?n.fill(t,e):typeof e<"u"?n.fill(e):n.fill()}));function pw(e,t,n,s){return w(r=>$(()=>{r.fillRect(e,t,n,s)}))}const u$=(e,t,n,s)=>w(r=>$(()=>{typeof s<"u"?r.fillText(e,t,n,s):r.fillText(e,t,n)}));function mw(e,t,n,s){return w(r=>$(()=>r.getImageData(e,t,n,s)))}w(e=>$(()=>e.getLineDash()));w(e=>$(()=>e.getTransform()));const l$=(e,t)=>Wt(n=>{n.lineTo(e,t)});function f$(e,t){return w(n=>$(()=>{n.moveTo(e,t)}))}function h$(e,t,n,s){return w(r=>$(()=>{r.rect(e,t,n,s)}))}const d$=w(e=>$(()=>{e.restore()})),g$=e=>w(t=>$(()=>{t.rotate(e)})),p$=w(e=>$(()=>{e.save()})),m$=(e,t)=>w(n=>$(()=>{n.scale(e,t)}));function y$(e){return w(t=>$(()=>{typeof e<"u"?t.stroke(e):t.stroke()}))}const _$=(e,t)=>w(n=>$(()=>{n.translate(e,t)})),b$=e=>c(Qo,ut(e),ls(a$())),S$=e=>c(Qo,ut(e),ls(y$()));function Wt(e){return w(t=>$(()=>e(t)))}function Nt(e){return Uv(Fv(p$,t=>e,t=>d$))}function w(e){return Vo(yt,e)}const Xo=Yl,v$=Tv,$$=Mv;function yw(e){const t=typeof e=="string"?E$(e):e instanceof HTMLElement?k$(e):w$(e);return Lr(t)}function E$(e){return Xo(yt,I$(e))}function w$(e){return $$(yt,e)}function k$(e){return Xo(yt,Oe(of(e),rf))}function I$(e){return Oe(T$(e),rf)}function T$(e){return c($(()=>document.getElementById(e)),Oe(sf),Xl(()=>new Yo(`No such element with id ${e} exists`)),Oe(of))}const sf=rt(Kc,Bo);function rf(e){return c($(()=>e.getContext("2d")),Oe(sf),Xl(t=>new Yo(`${e.id} is not an instance of HTMLCanvasElement`)))}const of=rt(dh(e=>e instanceof HTMLCanvasElement,()=>new Yo("element is not an instance of HTMLCanvasElement")),jv),cf=Ft(),M$=Jo(tf(yt,e=>C$(e)),cf),Zo=Ft(),A$=v$(M$,Xo(Zo,tf(cf,e=>O$(e)))),_w=e=>Hv(Zo,t=>n=>n._tag!="Composite"?Pv(e)(t(n)):t(n));function O$(e){return function t(n){switch(n._tag){case"Arc":return e.arc(n.x,n.y,n.r,n.start,n.end,n.anticlockwise);case"Composite":return xv(n.shapes,s=>t(s));case"Ellipse":return e.ellipse(n.x,n.y,n.rx,n.ry,n.rotation,n.start,n.end,n.anticlockwise);case"Path":return c(n.points,_h(xr,([s,...r])=>Gv(e.moveTo(s.x,s.y),Nv(r,({x:o,y:i})=>e.lineTo(o,i)))),ut(n.closed?e.closePath:xr()));case"Rect":return e.rect(n.x,n.y,n.width,n.height)}}}function C$(e){const t=Zl(yt,e);return{moveTo:rt(f$,t),lineTo:rt(l$,t),closePath:t(i$),ellipse:rt(c$,t),rect:rt(h$,t),arc:rt(r$,t),drawImage:rt(nf,t)}}const R$=Bf,F$=jc,ti=e=>!e;Dr.combine;Dr.combine;qr.combine;qr.combine;Nf.combine;Lf.combine;R$.combineAll;F$.combineAll;const P$={show:e=>[e.style,e.variant,e.weight].filter(q).map(At(yn(""))).join(" ")},N$=rt(mh,ti),L$={show:({fontFamily:e,size:t,fontOptions:n})=>[P$.show(n),`${t}px`,e].filter(N$).join(" ")},ei=Ft(),x$=c(nn(Zo),Bv(nn(yt)),qv(([e,t])=>q$(e,t)),Jo(ei));function j$(e){return Vo(ei,t=>t(e))}function D$(e){return c(Vo(ei,t=>t(e)),Lr(x$),Lr(A$))}function q$(e,t){return n;function n(r){return Zl(s(r),yt,t)}function s(r){switch(r._tag){case"Clipped":return Nt(c(Qo,ut(e(r.shape)),ut(o$()),ut(Ye(()=>n(r.drawing)))));case"Fill":return Nt(c(Gt(r.style.color,rt(jn,Mc)),ut(b$(e(r.shape)))));case"Many":return c(nn(yt),ls(Lv(r.drawings,o=>n(o))));case"Outline":return c(nn(yt),ls(c(er([Gt(r.style.color,rt(jn,Zv)),Gt(r.style.lineWidth,Xv),S$(e(r.shape))]),Nt)));case"Rotate":return Nt(c(g$(r.angle),ut(Ye(()=>n(r.drawing)))));case"Scale":return Nt(c(m$(r.scaleX,r.scaleY),ut(Ye(()=>n(r.drawing)))));case"Text":return c(er([Qv(L$.show(r.font)),Gt(r.style.color,rt(jn,Mc)),u$(r.text,r.x,r.y)]),Nt,ut(nn(yt)));case"Translate":return Nt(c(_$(r.translateX,r.translateY),ut(Ye(()=>n(r.drawing)))));case"WithShadow":return Nt(c(er([Gt(r.shadow.color,rt(jn,e$)),Gt(r.shadow.blur,t$),Gt(r.shadow.offset,o=>c(n$(o.x),ut(s$(o.y))))]),ut(Ye(()=>n(r.drawing)))));case"Image":return nf(r.image,r.source.x,r.source.y)}}}const Gt=(e,t)=>c(Bo(e),Oe(t),Wv(xr)),Ac=e=>({_tag:"Radians",radians:e}),Oc=e=>{switch(e._tag){case"Degrees":return e.degrees*(Math.PI/180);case"Radians":return e.radians}},K$=(e,t)=>({x:e,y:t}),bw=(e,t,n)=>({_tag:"Arc",x:e,y:t,r:n,start:Oc(Ac(0)),end:Oc(Ac(Math.PI*2)),anticlockwise:!1});function W$(e){return e.reduce(U$.empty,(t,n)=>({_tag:"Path",closed:!0,points:bh(n)(t.points)}))}const Sw=(e,t,n,s)=>({_tag:"Rect",x:e,y:t,width:n,height:s}),vw=e=>c(yh(0,e-1),Wr(t=>c(t*Math.PI/(e/2),n=>K$(Math.sin(n),Math.cos(n)))),W$(Rh)),U$=gs({_tag:{combineAll:()=>"Path",combineMany:()=>"Path",combine:()=>"Path",empty:"Path"},closed:jc,points:Bc()}),Dn=Bc(),ni=()=>Rt(lh(),S()),si=ni(),af=ni(),z$=ni(),$w=e=>t=>({_tag:"Clipped",shape:e,drawing:t}),Ew=(e,t)=>({_tag:"Fill",shape:e,style:t}),ww=e=>({color:k(e)}),kw=(e,t)=>({_tag:"Outline",shape:e,style:t}),Iw=e=>({color:k(e),lineWidth:S()}),Qe=e=>({_tag:"Many",drawings:e});function Tw(e){return t=>({_tag:"Rotate",angle:e,drawing:t})}function Mw(e,t){return n=>({_tag:"Scale",scaleX:e,scaleY:t,drawing:n})}const Aw=(e,t,n)=>({_tag:"Image",image:e,source:t,dest:n});function Ow(e,t){return n=>({_tag:"Translate",translateX:e,translateY:t,drawing:n})}function Cw(e){return t=>({_tag:"WithShadow",shadow:e,drawing:t})}const Rw=e=>({color:S(),blur:k(e),offset:S()}),Fw=e=>({color:k(e),blur:S(),offset:S()}),Pw=D$,Nw=j$;gs({color:si});gs({color:si,lineWidth:af});const Lw=gs({color:si,blur:af,offset:z$}),uf=Rt(ot((e,t)=>e._tag==="Many"&&t._tag==="Many"?Qe(Dn.combineAll([e.drawings,t.drawings])):e._tag==="Many"?Qe(Dn.combineAll([e.drawings,[t]])):t._tag==="Many"?Qe(Dn.combineAll([[e],t.drawings])):Qe([e,t])),Qe(Dn.empty)),xw=uf.combineAll,jw=uf.combine,G$=Ft(),H$=fh(e=>e instanceof HTMLButtonElement),Dw=c(Bo(H$(document.getElementById("restart"))),Kv,Jo(G$)),qw=e=>t=>$(()=>{t.disabled?t.addEventListener("click",e):t.removeEventListener("click",e),t.disabled=!t.disabled});function Kw(e){return Dv(0,t=>t<=360,t=>t+5,t=>e(-t*Math.PI/180))}export{rE as $,qw as A,lw as B,yw as C,er as D,gw as E,g$ as F,Ow as G,Tw as H,hw as I,xe as J,xa as K,np as L,Et as M,an as N,eE as O,Wg as P,ja as Q,G$ as R,yr as S,sE as T,sp as U,Xt as V,nE as W,os as X,Nl as Y,Us as Z,oE as _,Zv as a,aE as a$,Ft as a0,Jo as a1,tf as a2,yt as a3,Zl as a4,rt as a5,Pn as a6,Qo as a7,y$ as a8,v$ as a9,Ye as aA,hE as aB,jE as aC,wE as aD,ct as aE,P as aF,z as aG,Y as aH,RE as aI,Bv as aJ,iw as aK,CE as aL,dE as aM,zr as aN,Qc as aO,sn as aP,U as aQ,lg as aR,lE as aS,Lv as aT,ew as aU,q as aV,Es as aW,OE as aX,TE as aY,fE as aZ,Nv as a_,f$ as aa,l$ as ab,qE as ac,Cy as ad,nn as ae,Oe as af,yE as ag,qv as ah,nw as ai,mE as aj,_E as ak,xr as al,KE as am,iE as an,D as ao,FE as ap,uw as aq,pE as ar,y as as,g as at,V$ as au,S as av,Q as aw,$ as ax,QE as ay,JE as az,S$ as b,b$,At as b0,gE as b1,Uv as b2,tw as b3,Vu as b4,bE as b5,DE as b6,ls as b7,U_ as b8,EE as b9,k as bA,l as bB,K as bC,ps as bD,Xl as bE,BE as bF,Kr as bG,Q$ as bH,Se as bI,ne as bJ,cE as bK,Dh as bL,AE as bM,mw as bN,ow as bO,Aw as bP,dw as bQ,m$ as bR,Bo as bS,Kc as bT,Y$ as bU,K$ as bV,Kv as bW,GE as bX,rw as bY,B$ as bZ,bw as b_,Fv as ba,YE as bb,zE as bc,sw as bd,PE as be,LE as bf,Ry as bg,NE as bh,WE as bi,vE as bj,dt as bk,ht as bl,SE as bm,uE as bn,VE as bo,$E as bp,UE as bq,kE as br,ZE as bs,IE as bt,v as bu,cw as bv,Dt as bw,Ur as bx,Gr as by,ri as bz,ME as c,r$ as c0,Xv as c1,A$ as c2,_w as c3,x$ as c4,Dv as c5,HE as c6,Nw as c7,Cw as c8,Lw as c9,Fw as ca,Rw as cb,Mw as cc,Qe as cd,vw as ce,uf as cf,jw as cg,yh as ch,Wr as ci,fw as cj,J$ as ck,Wc as cl,xE as cm,$w as cn,ef as co,XE as cp,_$ as d,xw as e,pw as f,Ew as g,ww as h,Sw as i,Iw as j,Vv as k,Kw as l,Pv as m,Tu as n,kw as o,Pw as p,c as q,h$ as r,Mc as s,jn as t,aw as u,Lr as v,Nt as w,Dw as x,Vo as y,ut as z};
